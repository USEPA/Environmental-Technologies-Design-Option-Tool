VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmAbout 
   Appearance      =   0  'Flat
   BackColor       =   &H00C0C0C0&
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "About"
   ClientHeight    =   4560
   ClientLeft      =   3930
   ClientTop       =   2805
   ClientWidth     =   5640
   BeginProperty Font 
      Name            =   "MS Sans Serif"
      Size            =   8.25
      Charset         =   0
      Weight          =   700
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   ForeColor       =   &H80000008&
   LinkTopic       =   "Form2"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   PaletteMode     =   1  'UseZOrder
   ScaleHeight     =   4560
   ScaleWidth      =   5640
   Begin VB.CommandButton cmdOK 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      Cancel          =   -1  'True
      Caption         =   "&OK"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   345
      Left            =   4200
      TabIndex        =   8
      Top             =   3240
      Width           =   1365
   End
   Begin VB.PictureBox picIcon 
      Appearance      =   0  'Flat
      BackColor       =   &H00C0C0C0&
      BorderStyle     =   0  'None
      ForeColor       =   &H80000008&
      Height          =   555
      Left            =   150
      Picture         =   "About.frx":0000
      ScaleHeight     =   555
      ScaleWidth      =   615
      TabIndex        =   7
      Top             =   330
      Width           =   615
   End
   Begin Threed.SSPanel SSPanel1 
      Height          =   1065
      Left            =   60
      TabIndex        =   15
      Top             =   1860
      Width           =   5505
      _Version        =   65536
      _ExtentX        =   9710
      _ExtentY        =   1879
      _StockProps     =   15
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.Label lblSerialNumber 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "{Z_SERIALNUMBER}"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   225
         Left            =   90
         TabIndex        =   19
         Top             =   750
         Width           =   5325
         WordWrap        =   -1  'True
      End
      Begin VB.Label lblUserName 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "{Z_USERNAME}"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   225
         Left            =   90
         TabIndex        =   18
         Top             =   90
         Width           =   5325
      End
      Begin VB.Label lblUserCompany 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "{Z_USERCOMPANY}"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   225
         Left            =   90
         TabIndex        =   17
         Top             =   300
         Width           =   5325
      End
      Begin VB.Label Label1 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Serial Number:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   225
         Left            =   90
         TabIndex        =   16
         Top             =   510
         Width           =   1065
      End
   End
   Begin VB.Label lblVersionInfo 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "(Build Code XX)"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   225
      Index           =   5
      Left            =   1260
      TabIndex        =   20
      Top             =   1350
      Width           =   4215
   End
   Begin VB.Label lblWarning 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "extent possible under law."
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   225
      Index           =   5
      Left            =   60
      TabIndex        =   14
      Top             =   4290
      Width           =   3975
   End
   Begin VB.Label lblWarning 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "penalties, and will be prosecuted to the maximum"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   225
      Index           =   4
      Left            =   60
      TabIndex        =   13
      Top             =   4080
      Width           =   3975
   End
   Begin VB.Label lblWarning 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "portion of it, may result in severe civil and criminal"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   225
      Index           =   3
      Left            =   60
      TabIndex        =   12
      Top             =   3870
      Width           =   3975
   End
   Begin VB.Label lblWarning 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "reproduction or distribution of this program, or any"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   225
      Index           =   2
      Left            =   60
      TabIndex        =   11
      Top             =   3660
      Width           =   3975
   End
   Begin VB.Label lblWarning 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "copyright law and international treaties.  Unauthorized"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   225
      Index           =   1
      Left            =   60
      TabIndex        =   10
      Top             =   3450
      Width           =   3975
   End
   Begin VB.Label lblWarning 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Warning: This computer program is protected by"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   225
      Index           =   0
      Left            =   60
      TabIndex        =   9
      Top             =   3240
      Width           =   3975
   End
   Begin VB.Line Line1 
      BorderWidth     =   2
      X1              =   60
      X2              =   5550
      Y1              =   3090
      Y2              =   3090
   End
   Begin VB.Label lbldesc 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "This program is licensed to:"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   225
      Index           =   0
      Left            =   60
      TabIndex        =   6
      Top             =   1620
      Width           =   4215
   End
   Begin VB.Label lblVersionInfo 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Houghton, Michigan"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   225
      Index           =   4
      Left            =   1260
      TabIndex        =   5
      Top             =   1140
      Width           =   4215
   End
   Begin VB.Label lblVersionInfo 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Michigan Technological University"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   225
      Index           =   3
      Left            =   1260
      TabIndex        =   4
      Top             =   930
      Width           =   4215
   End
   Begin VB.Label lblVersionInfo 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "{copyright info}"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   225
      Index           =   2
      Left            =   1260
      TabIndex        =   3
      Top             =   720
      Width           =   4215
   End
   Begin VB.Label lblVersionInfo 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "{expiration info}"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   225
      Index           =   1
      Left            =   1260
      TabIndex        =   2
      Top             =   510
      Width           =   4215
   End
   Begin VB.Label lblVersionInfo 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "{version info}"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   225
      Index           =   0
      Left            =   1260
      TabIndex        =   1
      Top             =   300
      Width           =   4215
   End
   Begin VB.Label lblProgramName 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "{AppName}"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   225
      Left            =   1260
      TabIndex        =   0
      Top             =   90
      Width           =   4215
   End
End
Attribute VB_Name = "frmAbout"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit


Private Sub cmdOK_Click()
  Unload Me
End Sub

Private Sub Form_Load()
  Me.Left = (Screen.Width - Me.Width) / 2
  Me.Top = (Screen.Height - Me.Height) / 2
  
  'VARIOUS LABELS.
  lblProgramName.Caption = AppName
  lblVersionInfo(0).Caption = "Version " & get_program_version_with_build_info()
  lblVersionInfo(1).Caption = get_expiration_info()
  lblVersionInfo(2).Caption = "Copyright " & AppCopyrightYears
  lblUserName.Caption = Trim$(lfd.Z_USERNAME)
  lblUserCompany.Caption = Trim$(lfd.Z_USERCOMPANY)
  lblSerialNumber.Caption = Trim$(lfd.Z_SERIALNUMBER)
  'lblSerialNumber.Caption = "WWWWWW-WWWWW-WWWWW-WWWWW-WWWWW"
  lblVersionInfo(5).Caption = "(Build Code " & get_program_version_with_build_info_VB4 & ")"

End Sub

VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "Threed32.OCX"
Begin VB.Form frmCompoProp 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Component Properties"
   ClientHeight    =   6480
   ClientLeft      =   450
   ClientTop       =   1050
   ClientWidth     =   8820
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   6480
   ScaleWidth      =   8820
   Begin Threed.SSFrame SSFrame3 
      Height          =   1575
      Left            =   2430
      TabIndex        =   46
      Top             =   4410
      Width           =   6315
      _Version        =   65536
      _ExtentX        =   11139
      _ExtentY        =   2778
      _StockProps     =   14
      Caption         =   "Freundlich Isotherm Parameters"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.TextBox txtDataComponentProperty 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   288
         Index           =   6
         Left            =   2340
         TabIndex        =   11
         Text            =   "element 6"
         Top             =   660
         Width           =   1212
      End
      Begin VB.TextBox txtDataComponentProperty 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   288
         Index           =   5
         Left            =   2340
         TabIndex        =   10
         Text            =   "element 5"
         Top             =   300
         Width           =   1212
      End
      Begin VB.ComboBox cboSource 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Left            =   2340
         Style           =   2  'Dropdown List
         TabIndex        =   12
         Top             =   1020
         Width           =   3915
      End
      Begin VB.ComboBox txtPropUnits 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   5
         Left            =   3660
         Style           =   2  'Dropdown List
         TabIndex        =   47
         TabStop         =   0   'False
         Top             =   270
         Width           =   2595
      End
      Begin VB.Label lblComponentProperty 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Freundlich 1/n"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   6
         Left            =   810
         TabIndex        =   50
         Top             =   690
         Width           =   1455
      End
      Begin VB.Label lblComponentProperty 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Freundlich K"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   810
         TabIndex        =   49
         Top             =   330
         Width           =   1455
      End
      Begin VB.Label lblComponentProperty 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Source of K and 1/n"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   11
         Left            =   390
         TabIndex        =   48
         Top             =   1080
         Width           =   1875
      End
   End
   Begin Threed.SSFrame ssframe_StEPP 
      Height          =   1905
      Left            =   30
      TabIndex        =   42
      Top             =   270
      Width           =   2355
      _Version        =   65536
      _ExtentX        =   4154
      _ExtentY        =   3360
      _StockProps     =   14
      Caption         =   "StEPP Link"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin Threed.SSCommand cmdImportClipboard 
         Height          =   525
         Left            =   90
         TabIndex        =   43
         TabStop         =   0   'False
         ToolTipText     =   "Click here to import properties from a StEPP clipboard transfer"
         Top             =   1260
         Width           =   2175
         _Version        =   65536
         _ExtentX        =   3836
         _ExtentY        =   926
         _StockProps     =   78
         Caption         =   "Clip&board"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSCommand cmdImportFromFile 
         Height          =   525
         Left            =   90
         TabIndex        =   44
         TabStop         =   0   'False
         ToolTipText     =   "Click here to import properties from a StEPP export file"
         Top             =   750
         Width           =   2175
         _Version        =   65536
         _ExtentX        =   3836
         _ExtentY        =   926
         _StockProps     =   78
         Caption         =   "StEPP &Export File"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin VB.Label Label2 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Obtain properties from StEPP via:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   380
         Left            =   90
         TabIndex        =   45
         Top             =   270
         Width           =   2100
      End
   End
   Begin Threed.SSFrame SSFrame1 
      Height          =   2865
      Left            =   9030
      TabIndex        =   37
      Top             =   600
      Visible         =   0   'False
      Width           =   3255
      _Version        =   65536
      _ExtentX        =   5741
      _ExtentY        =   5054
      _StockProps     =   14
      Caption         =   "Unused -- Invisible"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.CommandButton cmdCancelOld 
         Appearance      =   0  'Flat
         Caption         =   "&Cancel"
         Height          =   495
         Left            =   540
         TabIndex        =   41
         Top             =   1500
         Width           =   2175
      End
      Begin Threed.SSCommand cmdCaData 
         Height          =   345
         Left            =   1650
         TabIndex        =   38
         Top             =   540
         Visible         =   0   'False
         Width           =   1170
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "&Isotherms"
         ForeColor       =   255
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Enabled         =   0   'False
      End
      Begin Threed.SSCommand cmdIPES 
         Height          =   375
         Left            =   1620
         TabIndex        =   39
         Top             =   900
         Visible         =   0   'False
         Width           =   1170
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "IP&ES"
         ForeColor       =   255
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Enabled         =   0   'False
      End
      Begin VB.Label Label1 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   " * K is in (mg/g)*(L/mg)^(1/n)"
         Enabled         =   0   'False
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   120
         TabIndex        =   40
         Top             =   240
         Visible         =   0   'False
         Width           =   2655
      End
   End
   Begin VB.TextBox txtDataComponentProperty 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   285
      Index           =   0
      Left            =   4770
      TabIndex        =   0
      Text            =   "element 0"
      Top             =   690
      Width           =   2895
   End
   Begin VB.TextBox txtDataComponentProperty 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   288
      Index           =   1
      Left            =   4770
      TabIndex        =   1
      Text            =   "element 1"
      Top             =   1050
      Width           =   1212
   End
   Begin VB.TextBox txtDataComponentProperty 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   288
      Index           =   2
      Left            =   4770
      TabIndex        =   2
      Text            =   "element 2"
      Top             =   1410
      Width           =   1212
   End
   Begin VB.TextBox txtDataComponentProperty 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   288
      Index           =   4
      Left            =   4770
      TabIndex        =   4
      Text            =   "element 4"
      Top             =   2130
      Width           =   1212
   End
   Begin VB.TextBox txtDataComponentProperty 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   288
      Index           =   3
      Left            =   4770
      TabIndex        =   3
      Text            =   "element 3"
      Top             =   1770
      Width           =   1212
   End
   Begin VB.TextBox txtDataComponentProperty 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   288
      Index           =   7
      Left            =   4770
      TabIndex        =   7
      Text            =   "element 7"
      Top             =   3210
      Width           =   1212
   End
   Begin VB.TextBox txtDataComponentProperty 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   288
      Index           =   8
      Left            =   4770
      TabIndex        =   8
      Text            =   "element 8"
      Top             =   3570
      Width           =   1212
   End
   Begin VB.TextBox txtDataComponentProperty 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   288
      Index           =   9
      Left            =   4770
      TabIndex        =   6
      Text            =   "element 9"
      Top             =   2850
      Width           =   1212
   End
   Begin VB.TextBox txtDataComponentProperty 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   288
      Index           =   10
      Left            =   4770
      TabIndex        =   5
      Text            =   "element 10"
      Top             =   2490
      Width           =   1212
   End
   Begin VB.ComboBox txtPropUnits 
      Appearance      =   0  'Flat
      BackColor       =   &H00C0C0C0&
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Index           =   1
      Left            =   6030
      Style           =   2  'Dropdown List
      TabIndex        =   20
      TabStop         =   0   'False
      Top             =   1020
      Width           =   1275
   End
   Begin VB.ComboBox txtPropUnits 
      Appearance      =   0  'Flat
      BackColor       =   &H00C0C0C0&
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Index           =   2
      Left            =   6030
      Style           =   2  'Dropdown List
      TabIndex        =   19
      TabStop         =   0   'False
      Top             =   1380
      Width           =   1275
   End
   Begin VB.ComboBox txtPropUnits 
      Appearance      =   0  'Flat
      BackColor       =   &H00C0C0C0&
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Index           =   7
      Left            =   6030
      Style           =   2  'Dropdown List
      TabIndex        =   18
      TabStop         =   0   'False
      Top             =   3180
      Width           =   1275
   End
   Begin VB.ComboBox txtPropUnits 
      Appearance      =   0  'Flat
      BackColor       =   &H00C0C0C0&
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Index           =   3
      Left            =   6030
      Style           =   2  'Dropdown List
      TabIndex        =   17
      TabStop         =   0   'False
      Top             =   1740
      Width           =   1275
   End
   Begin VB.ComboBox txtPropUnits 
      Appearance      =   0  'Flat
      BackColor       =   &H00C0C0C0&
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Index           =   4
      Left            =   6030
      Style           =   2  'Dropdown List
      TabIndex        =   16
      TabStop         =   0   'False
      Top             =   2100
      Width           =   1275
   End
   Begin VB.ComboBox txtPropUnits 
      Appearance      =   0  'Flat
      BackColor       =   &H00C0C0C0&
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Index           =   10
      Left            =   6030
      Style           =   2  'Dropdown List
      TabIndex        =   15
      TabStop         =   0   'False
      Top             =   2460
      Width           =   1275
   End
   Begin VB.ComboBox txtPropUnits 
      Appearance      =   0  'Flat
      BackColor       =   &H00C0C0C0&
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Index           =   9
      Left            =   6030
      Style           =   2  'Dropdown List
      TabIndex        =   14
      TabStop         =   0   'False
      Top             =   2820
      Width           =   1275
   End
   Begin VB.ComboBox cboChemName 
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   4770
      Style           =   2  'Dropdown List
      TabIndex        =   13
      TabStop         =   0   'False
      Top             =   30
      Width           =   2895
   End
   Begin VB.TextBox txtDataComponentProperty 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   288
      Index           =   11
      Left            =   4770
      TabIndex        =   9
      Text            =   "element 11"
      Top             =   3930
      Width           =   1212
   End
   Begin Threed.SSCommand cmdFreundlich 
      Height          =   855
      Left            =   120
      TabIndex        =   21
      TabStop         =   0   'False
      ToolTipText     =   "Click here to edit the Freundlich K and 1/n values for this component"
      Top             =   3930
      Width           =   2175
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      Caption         =   "&Freundlich K and 1/n"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdCancelOK 
      Height          =   495
      Index           =   1
      Left            =   120
      TabIndex        =   22
      TabStop         =   0   'False
      ToolTipText     =   "Click here to save the changes to the component(s) you have edited"
      Top             =   5490
      Width           =   2175
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      Caption         =   "&OK"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdKinetics 
      Height          =   855
      Left            =   120
      TabIndex        =   23
      TabStop         =   0   'False
      ToolTipText     =   "Click here to edit the kinetic parameters for this component"
      Top             =   3090
      Width           =   2175
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      Caption         =   "&Kinetics"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdCancelOK 
      Height          =   495
      Index           =   0
      Left            =   120
      TabIndex        =   36
      TabStop         =   0   'False
      ToolTipText     =   "Click here to abandon any changes you have made to this component"
      Top             =   5010
      Width           =   2175
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      Caption         =   "&Cancel"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSPanel SSPanel2 
      Align           =   2  'Align Bottom
      Height          =   405
      Left            =   0
      TabIndex        =   51
      Top             =   6075
      Width           =   8820
      _Version        =   65536
      _ExtentX        =   15557
      _ExtentY        =   714
      _StockProps     =   15
      ForeColor       =   -2147483640
      BackColor       =   12632256
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin Threed.SSPanel sspanel_Dirty 
         Height          =   285
         Left            =   60
         TabIndex        =   52
         Top             =   60
         Width           =   2115
         _Version        =   65536
         _ExtentX        =   3731
         _ExtentY        =   503
         _StockProps     =   15
         Caption         =   "sspanel_Dirty"
         ForeColor       =   -2147483640
         BackColor       =   12632256
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelOuter      =   1
      End
      Begin Threed.SSPanel sspanel_Status 
         Height          =   285
         Left            =   2220
         TabIndex        =   53
         Top             =   60
         Width           =   6520
         _Version        =   65536
         _ExtentX        =   11501
         _ExtentY        =   503
         _StockProps     =   15
         Caption         =   "sspanel_Status"
         ForeColor       =   -2147483640
         BackColor       =   12632256
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelOuter      =   1
      End
   End
   Begin VB.Label lblComponentProperty 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Name"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   0
      Left            =   2640
      TabIndex        =   35
      Top             =   720
      Width           =   2055
   End
   Begin VB.Label lblComponentProperty 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Molecular Weight"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   1
      Left            =   2640
      TabIndex        =   34
      Top             =   1080
      Width           =   2055
   End
   Begin VB.Label lblComponentProperty 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Molar Volume @ NBP"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   2
      Left            =   2640
      TabIndex        =   33
      Top             =   1440
      Width           =   2055
   End
   Begin VB.Label lblComponentProperty 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Initial Concentration"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   4
      Left            =   2640
      TabIndex        =   32
      Top             =   2160
      Width           =   2055
   End
   Begin VB.Label lblComponentProperty 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Boiling Point"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   3
      Left            =   2640
      TabIndex        =   31
      Top             =   1800
      Width           =   2055
   End
   Begin VB.Label lblComponentProperty 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Vapor Pressure"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   7
      Left            =   2640
      TabIndex        =   30
      Top             =   3240
      Width           =   2055
   End
   Begin VB.Label lblUnit 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "-"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   8
      Left            =   6030
      TabIndex        =   29
      Top             =   3600
      Width           =   1275
   End
   Begin VB.Label lblComponentProperty 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Refractive Index"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   8
      Left            =   2640
      TabIndex        =   28
      Top             =   3600
      Width           =   2055
   End
   Begin VB.Label lblComponentProperty 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Solubility"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   9
      Left            =   2640
      TabIndex        =   27
      Top             =   2880
      Width           =   2055
   End
   Begin VB.Label lblComponentProperty 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Liquid Density"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   10
      Left            =   2640
      TabIndex        =   26
      Top             =   2520
      Width           =   2055
   End
   Begin VB.Label lblComponentProperty 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "CAS Number"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   12
      Left            =   2640
      TabIndex        =   25
      Top             =   3960
      Width           =   2055
   End
   Begin VB.Label lblUnit 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "-"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   0
      Left            =   6030
      TabIndex        =   24
      Top             =   3960
      Width           =   1275
   End
End
Attribute VB_Name = "frmCompoProp"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Dim FORM_MODE As Integer
Const FORM_MODE_ADDNEW = 1
Const FORM_MODE_EDIT = 2
Dim USER_HIT_CANCEL As Boolean
Dim USER_HIT_OK As Boolean
Dim frmCompoProp_Is_Dirty As Boolean

Dim START_AT_COMPNUMBER As Integer
Dim CurrentCompNumber As Integer
Dim TempComponents(1 To Number_Compo_Max) As ComponentPropertyType
        'USED TO STORE TEMPORARY COPIES OF COMPONENTS.
        'THIS ALLOWS A ROLLBACK IF THE USER HITS CANCEL.

Dim HALT_CBOCHEMNAME As Boolean
Dim HALT_CBOSOURCE As Boolean





Const frmCompoProp_declarations_end = True


Sub frmCompoProp_Add( _
    OUTPUT_Raise_Dirty_Flag As Boolean)
  FORM_MODE = FORM_MODE_ADDNEW
  frmCompoProp.Show 1
  If (USER_HIT_OK) Then
    OUTPUT_Raise_Dirty_Flag = True
  Else
    OUTPUT_Raise_Dirty_Flag = False
  End If
End Sub
Sub frmCompoProp_Edit( _
    OUTPUT_Raise_Dirty_Flag As Boolean, _
    INPUT_Start_At_CompNumber)
  FORM_MODE = FORM_MODE_EDIT
  START_AT_COMPNUMBER = INPUT_Start_At_CompNumber
  frmCompoProp.Show 1
  If (USER_HIT_OK) Then
    OUTPUT_Raise_Dirty_Flag = True
  Else
    OUTPUT_Raise_Dirty_Flag = False
  End If
End Sub
'RETURNS:
'- true = it's okay to unload now.
'- false = cancel the unload.
Function frmCompoProp_Query_Unload() As Integer
Dim RetVal As Integer
Dim msg As String
  If (Not frmCompoProp_Is_Dirty) Then
    frmCompoProp_Query_Unload = True
    Exit Function
  End If
  msg = "Are you sure you want to abandon the changes " & _
      "made to " & IIf(Number_Component = 1, "this component", "these components") & " ?" & _
      vbCrLf & vbCrLf & _
      "If you want to abandon the changes, click Yes." & _
      vbCrLf & _
      "If you want to save the " & _
      "changes, click No, then click OK."
  RetVal = MsgBox(msg, vbCritical + vbYesNo, App.Title & " : Abandon Changes ?")
  Select Case RetVal
    Case vbYes:
      frmCompoProp_Query_Unload = True
      Exit Function
    Case vbNo:
      frmCompoProp_Query_Unload = False
      Exit Function
  End Select
End Function


Sub Update_Display_of_KFreundlich(IndexOfChangedProperty As Integer)
''Sub Update_Display_of_KFreundlich(IndexOfChangedProperty As Integer, OldPropertyValue As Double)
''NOTE: THIS SUBROUTINE IS _NEVER_ CALLED UNLESS THE PROPERTY HAS CHANGED,
''SO THE VALUE OldPropertyValue IS NO LONGER NEEDED.
'Dim NoUnitsOnChangedProperty As Integer
'Dim OldK As String
'Dim NewK As String
'Dim KUnits As String
'Dim temp As String
'Dim CheckINI As String
'
'Dim A_Property_Changed As Integer
'Dim The_MW_Changed As Integer
'Dim Invalidate_Isotherm_K As Integer
'Dim Invalidate_IPES_K As Integer
'Dim K_Reverted As Integer
'
'Dim ReverseConversionFactor As Double
'Dim ThisValue As Double
'Dim i As Integer
'
'Dim Current_CheckValue As Integer
'
'  'THE PHILOSOPHY OF FREUNDLICH K DATA ENTRY.
'  '==========================================
'  'If the source of the K and 1/n for a chemical is:
'  '(1). User-entry.  They may do what they wish with any chemical
'  '     property.  If they change the 1/n or MW, the internally-stored
'  '     value for Freundlich K is updated so that it remains constant
'  '     on the screen.
'  '(2). IPES Routines.  They should not modify any chemical property.
'  '     If they do, a message box will pop up which tells them that
'  '     their K and 1/n from IPES have been invalidated, and their
'  '     K and 1/n will revert to the user-entered numbers.
'  '(3). Isotherm Database.  They should not modify molecular weight.
'  '     If they do, a message box will pop up which tells them that
'  '     their K and 1/n from the Isotherm Database have been
'  '     invalidated, and their K and 1/n will revert to the user-entered
'  '     numbers.
'
'  'Update display of Freundlich K, which is dependent upon MW and 1/n
'  '(depending on which units for Freundlich K have been chosen).
'  OldK = txtDataComponentProperty(5).Text
'  Call txtPropUnits_Click(5)
'  NewK = txtDataComponentProperty(5).Text
'  KUnits = txtPropUnits(5).List(txtPropUnits(5).ListIndex)
'
'  '----- INVALIDATE K AND 1/N FROM IPES OR ISOTHERM DATABASE IF NECESSARY
'  A_Property_Changed = False
'  The_MW_Changed = False
'  Invalidate_Isotherm_K = False
'  Invalidate_IPES_K = False
'  K_Reverted = False
'  If ((IndexOfChangedProperty = 1) Or (IndexOfChangedProperty = 2) Or (IndexOfChangedProperty = 3) Or (IndexOfChangedProperty = 4) Or (IndexOfChangedProperty = 7) Or (IndexOfChangedProperty = 8) Or (IndexOfChangedProperty = 9) Or (IndexOfChangedProperty = 10)) Then
'    If (OldPropertyValue <> txtDataComponentProperty(IndexOfChangedProperty).Text) Then
'      A_Property_Changed = True
'    End If
'  End If
'  If (IndexOfChangedProperty = 1) Then
'    If (OldPropertyValue <> txtDataComponentProperty(IndexOfChangedProperty).Text) Then
'      The_MW_Changed = True
'    End If
'  End If
'  If (A_Property_Changed) Then
'    'The IPES K and 1/n are invalidated if any property has changed.
'    If (Component(0).IPESResult_K <> -1) Then
'      Invalidate_IPES_K = True
'    End If
'  End If
'  If (The_MW_Changed) Then
'    'The Isotherm Database K and 1/n are invalidated if MW has changed.
'    If (Component(0).IsothermDB_K <> -1) Then
'      Invalidate_Isotherm_K = True
'    End If
'  End If
'
'  If (Invalidate_IPES_K) Then
'    '-- IPES K and 1/n are now invalid!
'    Component(0).IPESResult_K = -1
'    Component(0).IPESResult_OneOverN = -1
'    If (cboSource.ListIndex = 1) Then
'      '-- Change from IPES to user-entry.
'      cboSource.ListIndex = 2
'      K_Reverted = True
'    End If
'    Call Update_cboSource
'  End If
'  If (Invalidate_Isotherm_K) Then
'    '-- Isotherm Database K and 1/n are now invalid!
'    Component(0).IsothermDB_K = -1
'    Component(0).IsothermDB_OneOverN = -1
'    If (cboSource.ListIndex = 0) Then
'      '-- Change from IPES to user-entry.
'      cboSource.ListIndex = 2
'      K_Reverted = True
'    End If
'    Call Update_cboSource
'  End If
'
'  '-- Inform user of what the hell just happened.
'  If ((Invalidate_IPES_K) Or (Invalidate_Isotherm_K)) Then
'    temp = "A property has changed.  "
'    temp = temp & "This has caused the values of Freundlich K and 1/n from the "
'    If (Invalidate_IPES_K) Then
'      temp = temp & "IPES Results"
'    End If
'    If (Invalidate_Isotherm_K) Then
'      If (Invalidate_IPES_K) Then
'        temp = temp & " and the "
'      End If
'      temp = temp & "Isotherm Database"
'    End If
'    temp = temp & " to become invalidated for this chemical."
'    If (K_Reverted) Then
'      temp = temp & "  This chemical has reverted to user-entered K and 1/n."
'    End If
'    MsgBox temp, MB_ICONEXCLAMATION, Application_Name
'''''''    Exit Sub
'  End If
'
'  '----- UPON CHANGE OF MW OR FREUNDLICH 1/N, UPDATE K
'  If ((IndexOfChangedProperty = 1) Or (IndexOfChangedProperty = 6)) Then
'    If (OldPropertyValue <> txtDataComponentProperty(IndexOfChangedProperty).Text) Then
'      '--- Note: Freundlich K is stored internally in (mg/g)*(L/mg)^(1/n).
'      '... In order to keep K constant in the currently-displayed set of units,
'      '... it is (sometimes) necessary to change the internally-stored value.
'      '... The user should be informed of what the heck is going on here.
'
'      'STEP ONE: Determine the new K in (mg/g)*(L/mg)^(1/n) units
'      ReverseConversionFactor = 1 / KFreundlichConversionFactor(CInt(txtPropUnits(5).ListIndex), Component(0).Use_OneOverN, Component(0).MW)
'      Component(0).Use_K = CDbl(OldK) * ReverseConversionFactor
'      'Update display of K:
'      Call txtPropUnits_Click(5)
'
'      'STEP TWO: Inform the user of what just happened
'      'frmGoAway_Caption = "Warning: Freundlich K Updated"
'      If (IndexOfChangedProperty = 1) Then
'        temp = "molecular weight"
'        NoUnitsOnChangedProperty = False
'      ElseIf (IndexOfChangedProperty = 6) Then
'        temp = "Freundlich 1/n"
'        NoUnitsOnChangedProperty = True
'      End If
'      temp = "The property of " & temp & " was manually changed to "
'      temp = temp & txtDataComponentProperty(IndexOfChangedProperty).Text
'      If (Not NoUnitsOnChangedProperty) Then
'        temp = temp & " ("
'        temp = temp & txtPropUnits(IndexOfChangedProperty).List(txtPropUnits(IndexOfChangedProperty).ListIndex)
'        temp = temp & ")"
'      End If
'      temp = temp & "." & Chr$(13)
'      temp = temp & "This causes a change in the value of Freundlich K:" & Chr$(13)
'      temp = temp & "    Old value = " & OldK & " (" & KUnits & ")" & Chr$(13)
'      temp = temp & "    New values:" & Chr$(13)
'      For i = 0 To 3
'        ThisValue = _
'            Component(0).Use_K * _
'            KFreundlichConversionFactor(i, Component(0).Use_OneOverN, Component(0).MW)
'        temp = temp & "        " & _
'            Format$(ThisValue, NumericalFormat(5)) & _
'            " (" & txtPropUnits(5).List(i) & ")" & Chr$(13)
'      Next i
'      'frmGoAway_Text = temp
'
'      'The property of molecular weight was manually changed to 156.77 mg/mmol.
'      'This causes a change in the value of Freundlich K.
'      '    Old value = ___________ (unit)
'      '    New values:
'      '        ___________ (unit)
'      '        ___________ (unit)
'      '        ___________ (unit)
'      '        ___________ (unit)
'
'      CheckINI = ini_getsetting("has_seen_freundlichK_warning")
'      If (CheckINI = "1") Then
'        Current_CheckValue = 1
'      Else
'        Current_CheckValue = 0
'      End If
'      'frmGoAway_CheckText = "Never display this warning again"
'      If (Current_CheckValue <> 1) Then
'        Call frmGoAway.frmGoAway_Run( _
'            frmCompoProp, _
'            "Warning: Freundlich K Was Updated", _
'            temp, _
'            "Never display this warning again", _
'            Current_CheckValue)
'      End If
'      Call ini_putsetting("has_seen_freundlichK_warning", Trim$(Str$(frmGoAway_CheckValue)))
'      Exit Sub
'    End If
'  End If
End Sub
Sub Update_cboSource()
  HALT_CBOSOURCE = True
  'POPULATE FREUNDLICH K AND 1/N SOURCE BOX.
  cboSource.Clear
  If (Component(0).IsothermDB_K > 0#) And (Component(0).IsothermDB_OneOverN > 0#) Then
    'ENABLE ISOTHERM DATABASE AS SOURCE.
    cboSource.AddItem "Isotherm Database"
  Else
    cboSource.AddItem "(Isotherm Database)"
  End If
  If (Component(0).IPESResult_K > 0#) And (Component(0).IPESResult_OneOverN > 0#) Then
    'ENABLE IPES AS SOURCE.
    cboSource.AddItem "Isotherm Parameter Estimation"
  Else
    cboSource.AddItem "(Isotherm Parameter Estimation)"
  End If
  cboSource.AddItem "User Entry"
  'DISPLAY CURRENT SOURCE.
  Select Case Component(0).Source_KandOneOverN
    Case KNSOURCE_ISOTHERMDB: cboSource.ListIndex = 0
    Case KNSOURCE_IPES: cboSource.ListIndex = 1
    Case KNSOURCE_USERINPUT: cboSource.ListIndex = 2
  End Select
  HALT_CBOSOURCE = False
End Sub
Sub frmCompoProp_PopulateUnits()
  'MAIN BLOCK.
  Call unitsys_register(frmCompoProp, lblComponentProperty(1), _
      txtDataComponentProperty(1), txtPropUnits(1), "molecular_weight", _
      PropertyUnits.MW, "g/gmol", "", "", 100#, True)
  Call unitsys_register(frmCompoProp, lblComponentProperty(2), _
      txtDataComponentProperty(2), txtPropUnits(2), "molar_volume", _
      PropertyUnits.MolarVolume, "mL/gmol", "", "", 100#, True)
  Call unitsys_register(frmCompoProp, lblComponentProperty(3), _
      txtDataComponentProperty(3), txtPropUnits(3), "temperature", _
      PropertyUnits.BP, "C", "", "", 100#, True)
  Call unitsys_register(frmCompoProp, lblComponentProperty(4), _
      txtDataComponentProperty(4), txtPropUnits(4), "concentration", _
      PropertyUnits.InitialConcentration, "mg/L", "", "", 100#, True)
  Call unitsys_register(frmCompoProp, lblComponentProperty(10), _
      txtDataComponentProperty(10), txtPropUnits(10), "density", _
      PropertyUnits.Liquid_Density, "g/mL", "", "", 100#, True)
  Call unitsys_register(frmCompoProp, lblComponentProperty(9), _
      txtDataComponentProperty(9), txtPropUnits(9), "concentration", _
      PropertyUnits.Aqueous_Solubility, "mg/L", "", "", 100#, True)
  Call unitsys_register(frmCompoProp, lblComponentProperty(7), _
      txtDataComponentProperty(7), txtPropUnits(7), "pressure", _
      PropertyUnits.Vapor_Pressure, "Pa", "", "", 100#, True)
  Call unitsys_register(frmCompoProp, lblComponentProperty(8), _
      txtDataComponentProperty(8), Nothing, "", _
      "", "", "", "", 100#, False)
  Call unitsys_register(frmCompoProp, lblComponentProperty(11), _
      txtDataComponentProperty(11), Nothing, "", _
      "", "", "0", "0", 100#, False)
  'FREUNDLICH K AND 1/N BLOCK.
  Call unitsys_register(frmCompoProp, lblComponentProperty(5), _
      txtDataComponentProperty(5), txtPropUnits(5), "freundlich_k", _
      PropertyUnits.k, "(mg/g)*(L/mg)^(1/n)", "", "", 100#, True)
  Call unitsys_register(frmCompoProp, lblComponentProperty(6), _
      txtDataComponentProperty(6), Nothing, "", _
      "", "", "", "", 100#, False)
End Sub
Sub Store_Unit_Settings()
  PropertyUnits.MW = unitsys_get_units(txtPropUnits(1))
  PropertyUnits.MolarVolume = unitsys_get_units(txtPropUnits(2))
  PropertyUnits.BP = unitsys_get_units(txtPropUnits(3))
  PropertyUnits.InitialConcentration = unitsys_get_units(txtPropUnits(4))
  PropertyUnits.Liquid_Density = unitsys_get_units(txtPropUnits(10))
  PropertyUnits.Aqueous_Solubility = unitsys_get_units(txtPropUnits(9))
  PropertyUnits.Vapor_Pressure = unitsys_get_units(txtPropUnits(7))
  PropertyUnits.k = unitsys_get_units(txtPropUnits(5))
End Sub


Private Sub cboChemName_Click()
  If (HALT_CBOCHEMNAME) Then Exit Sub
  TempComponents(CurrentCompNumber) = Component(0)
  CurrentCompNumber = cboChemName.ListIndex + 1
  Component(0) = TempComponents(CurrentCompNumber)
  Call frmCompoProp_Refresh
  Call Update_cboSource
End Sub
Private Sub cboSource_Click()
Dim KandOneOverN_Enabled As Integer
Dim X As Integer
Dim temp As String
  If (HALT_CBOSOURCE) Then Exit Sub
  If (Left$(cboSource.List(cboSource.ListIndex), 1) = "(") Then
    'UNABLE TO USE THAT SOURCE!
    X = cboSource.ListIndex
    cboSource.ListIndex = 2
    Select Case X
      Case 0
        temp = "You must first select an isotherm from the isotherm database.  "
        temp = temp & "Click on the button marked " & Chr$(34) & _
            "Freundlich K and 1/n" & Chr$(34) & " to do so."
        Call Show_Error(temp)
      Case 1
        temp = "You must first calculate K and 1/n using IPES.  "
        temp = temp & "To do so, click on the button marked " & Chr$(34) & _
            "Freundlich K and 1/n" & Chr$(34) & " and then click on " & _
            Chr$(34) & "Re-calculate" & Chr$(34) & " from within the next window."
        Call Show_Error(temp)
    End Select
  End If
  'UPDATE INTERNAL RECORDS.
  Select Case cboSource.ListIndex
    Case 0:       'ISOTHERM DB.
      Component(0).Source_KandOneOverN = KNSOURCE_ISOTHERMDB
      Component(0).Use_K = Component(0).IsothermDB_K
      Component(0).Use_OneOverN = Component(0).IsothermDB_OneOverN
      KandOneOverN_Enabled = False
    Case 1:       'IP ESTIMATION.
      Component(0).Source_KandOneOverN = KNSOURCE_IPES
      Component(0).Use_K = Component(0).IPESResult_K
      Component(0).Use_OneOverN = Component(0).IPESResult_OneOverN
      KandOneOverN_Enabled = False
    Case 2:       'USER INPUT.
      Component(0).Source_KandOneOverN = KNSOURCE_USERINPUT
      Component(0).Use_K = Component(0).UserEntered_K
      Component(0).Use_OneOverN = Component(0).UserEntered_OneOverN
      KandOneOverN_Enabled = True
  End Select
  'UPDATE WINDOW.
  Call txtPropUnits_Click(5)
  'txtDataComponentProperty(5) = Format$(Component(0).Use_K, "0.000")
  'txtDataComponentProperty(6) = Format$(Component(0).Use_OneOverN, "0.000")
  txtDataComponentProperty(5).Locked = Not KandOneOverN_Enabled
  txtDataComponentProperty(6).Locked = Not KandOneOverN_Enabled
  Call frmCompoProp_Refresh     'THIS CALL REDISPLAYS FREUNDLICH 1/N.
End Sub


Private Sub cmdCancelOK_Click(Index As Integer)
Dim i As Integer
  Select Case Index
    Case 0:     'CANCEL.
      If (frmCompoProp_Query_Unload() = False) Then
        'THE CANCEL WAS CANCELLED.
        Exit Sub
      End If
      USER_HIT_CANCEL = True
      USER_HIT_OK = False
      Unload Me
      Exit Sub
    Case 1:     'OK.
      'UPDATE KINETIC COEFFICIENTS.
      If Component(0).Corr(1) Then
        Component(0).kf = kf(0)
      End If
      If Component(0).Corr(2) Then
        Component(0).Ds = Ds(0)
      End If
      If Component(0).Corr(3) Then
        Component(0).Dp = Dp(0)
      End If
      If (FORM_MODE = FORM_MODE_ADDNEW) Then
        '/////////////////// ADD NEW COMPONENT CODE //////////////////////////////////////////////////////////////////////////////////////
        'ADD COMPONENT TO ROOM PROPERTIES DATA AREA.
        RoomParams.COUNT_CONTAMINANT = RoomParams.COUNT_CONTAMINANT + 1
        RoomParams.ROOM_C0(RoomParams.COUNT_CONTAMINANT) = 0#
        RoomParams.ROOM_EMIT(RoomParams.COUNT_CONTAMINANT) = 1.7
    
        'ADD COMPONENT TO MAIN DATA AREA.
        Number_Component = Number_Component + 1
        Component(Number_Component) = Component(0)
        'FRMMAIN.cmdViewDimensionless.Enabled = True
        'FRMMAIN.cmdEditComponent.Enabled = True
        'FRMMAIN.cmdDeleteComponent.Enabled = True
        'FRMMAIN.lstComponents.AddItem txtDataComponentProperty(0)
        'frmMain.cboSelectCompo.Enabled = True
        'frmMain.cboSelectCompo.AddItem txtDataComponentProperty(0)
        'If (Number_Component = Number_Compo_Max) Then
        '  frmMain.cmdAddComponent.Enabled = False
        'End If
        'frmMain.cboSelectCompo.ListIndex = frmMain.cboSelectCompo.ListCount - 1
        ''Update the corresponding kinetic data displayed
        'Call Update_Display_Kinetic
      Else
        '/////////////////// EDIT EXISTING COMPONENT(S) CODE //////////////////////////////////////////////////////////////////////////////////////
        TempComponents(CurrentCompNumber) = Component(0)
        For i = 1 To Number_Component
          Component(i) = TempComponents(i)
        Next i
        ''Update the display of the name
        'For N = 1 To frmMain.cboSelectCompo.ListCount
        '  frmMain.lstComponents.List(N - 1) = Component(N).name
        '  frmMain.cboSelectCompo.List(N - 1) = Component(N).name
        'Next
        'frmMain.cboSelectCompo.ListIndex = cboChemName.ListIndex
      End If
      'If (Number_Component > 0) Then
      '  frmMain.mnuRunItem(0).Enabled = True
      '  frmMain.mnuRunItem(1).Enabled = True
      '  frmMain.mnuRunItem(2).Enabled = True
      '  frmMain.mnuOptionsItem(0).Enabled = True
      '  frmMain.mnuOptionsItem(1).Enabled = True  'Variable Influent concentration
      '  frmMain.mnuOptionsItem(2).Enabled = True  'Variable Effluent concentration
      'End If
      'STORE ALL UNIT SETTINGS.
      Call Store_Unit_Settings
      'REFRESH MAIN WINDOW.
      Call frmMain_Refresh
      'EXIT OUT OF HERE.
      USER_HIT_CANCEL = False
      USER_HIT_OK = True
      Unload Me
      Exit Sub
  End Select
End Sub


Private Sub cmdFreundlich_Click()
Dim Raise_Dirty_Flag As Boolean
  Screen.MousePointer = 11
  Call frmFreundlich.frmFreundlich_Run(Raise_Dirty_Flag)
  If (Raise_Dirty_Flag) Then
    'UPDATE SOURCE OF K AND 1/N SCROLLBOX.
    Call Update_cboSource
    'THROW DIRTY FLAG.
    Call frmCompoProp_DirtyStatus_Throw
  End If
  'REFRESH VALUES, ESPECIALLY K AND 1/n.
  Call frmCompoProp_Refresh
End Sub


Private Sub cmdImportClipboard_Click()
Dim Was_Aborted As Boolean
  Call Do_ImportClipboard(Was_Aborted)
  If (Was_Aborted) Then
    Exit Sub
  Else
    'STORE ALL UNIT SETTINGS.
    Call Store_Unit_Settings
    'REFRESH MAIN WINDOW.
    Call frmMain_Refresh
    'EXIT OUT OF HERE.
    USER_HIT_CANCEL = False
    USER_HIT_OK = True
    Unload Me
    Exit Sub
  End If
End Sub
Private Sub cmdImportFromFile_Click()
Dim f As Integer
Dim LineCount As Integer
Dim ThisLine As String
Dim AllLines As String
Dim InvalidFile As Boolean
Const MAX_LINE_COUNT = 1000     'SOMEWHAT ARBITRARY.
  On Error GoTo err_cmdImportFromFile_Click
  frmMain.CommonDialog1.CancelError = True
  frmMain.CommonDialog1.DialogTitle = "Load StEPP Export File"
  frmMain.CommonDialog1.Filter = "All Files (*.*)|*.*|StEPP Export Files (*.exp)|*.exp"
  frmMain.CommonDialog1.FilterIndex = 2
  frmMain.CommonDialog1.flags = _
      cdlOFNFileMustExist + _
      cdlOFNPathMustExist
  frmMain.CommonDialog1.Action = 1
  If (frmMain.CommonDialog1.Filename = "") Then
    Exit Sub
  End If
  f = FreeFile
  LineCount = 0
  Open frmMain.CommonDialog1.Filename For Input As #f
  InvalidFile = False
  Do While (1 = 1)
    If (EOF(f)) Then Exit Do
    Line Input #f, ThisLine
    AllLines = AllLines & ThisLine & Chr$(13) & Chr$(10)
    LineCount = LineCount + 1
    If (LineCount > MAX_LINE_COUNT) Then
      InvalidFile = True
      Exit Do
    End If
  Loop
  Close #f
  If (InvalidFile) Then
    Call Show_Error("This is not a valid StEPP export file.")
    Exit Sub
  End If
  'DO THE IMPORT.
  Clipboard.SetText AllLines
  Call cmdImportClipboard_Click
  Exit Sub
exit_err_cmdImportFromFile_Click:
  Exit Sub
err_cmdImportFromFile_Click:
  If (Err.number = cdlCancel) Then
    'DO NOTHING.
  Else
    Call Show_Trapped_Error("cmdImportFromFile_Click")
  End If
  Resume exit_err_cmdImportFromFile_Click
End Sub


Private Sub cmdKinetics_Click()
Dim Raise_Dirty_Flag As Boolean
  Call frmKinetic.frmKinetic_Run(Raise_Dirty_Flag)
  If (Raise_Dirty_Flag) Then
    'THROW DIRTY FLAG.
    Call frmCompoProp_DirtyStatus_Throw
  End If
End Sub


Private Sub Form_Load()
Dim i As Integer
  'MISC INITS.
  Me.Height = 6885
  Me.Width = 8940
  Call CenterOnForm(Me, frmMain)
  'ADD/EDIT MODE RELATED.
  If (FORM_MODE = FORM_MODE_ADDNEW) Then
    'ADD MODE RELATED INITIALIZATION.
    '---- CREATE DEFAULT COMPONENT.
    '---- NOTE: GLOBAL COMPONENT(0) IS USED FOR THE CURRENT COMPONENT.
    Call SetComponentDefaults(Component(0), 0)
    '---- VARIOUS VISIBILITY SETTINGS.
    cboChemName.Visible = False
    ssframe_StEPP.Visible = True
    ''---- DATA ALREADY CONSIDERED CHANGED (DUE TO ADD MODE).
    'Call frmCompoProp_DirtyStatus_Throw
    '---- DATA UNCHANGED AS YET.
    Call frmCompoProp_DirtyStatus_Clear
  Else
    'EDIT MODE RELATED INITIALIZATION.
    '---- TRANSFER COMPONENTS TO LOCAL STORAGE.
    '---- NOTE: GLOBAL COMPONENT(0) IS USED FOR THE CURRENT COMPONENT.
    For i = 1 To Number_Component
      TempComponents(i) = Component(i)
    Next i
    Component(0) = Component(START_AT_COMPNUMBER)
    CurrentCompNumber = START_AT_COMPNUMBER
    '---- POPULATE COMPONENT NAME SCROLLBOX.
    HALT_CBOCHEMNAME = True
    cboChemName.Clear
    For i = 1 To Number_Component
      cboChemName.AddItem Trim$(Component(i).Name)
    Next i
    cboChemName.ListIndex = START_AT_COMPNUMBER - 1
    HALT_CBOCHEMNAME = False
    '---- VARIOUS VISIBILITY SETTINGS.
    cboChemName.Visible = True
    ssframe_StEPP.Visible = False
    '---- DATA UNCHANGED AS YET.
    Call frmCompoProp_DirtyStatus_Clear
  End If
  'POPULATE UNIT CONTROLS.
  Call frmCompoProp_PopulateUnits
  'REFRESH DISPLAY.
  Call frmCompoProp_Refresh
  'POPULATE SOURCE OF K AND 1/N SCROLLBOX.
  Call Update_cboSource
End Sub
Private Sub Form_Unload(Cancel As Integer)
  Call unitsys_unregister_all_on_form(Me)
End Sub








Sub frmCompoProp_GenericStatus_Set(fn_Text As String)
  Me.sspanel_Status = fn_Text
End Sub
Sub frmCompoProp_DirtyStatus_Set(newVal As Boolean)
  If (newVal) Then
    frmCompoProp.sspanel_Dirty = "Data Changed"
    frmCompoProp.sspanel_Dirty.ForeColor = QBColor(12)
  Else
    frmCompoProp.sspanel_Dirty = "Unchanged"
    frmCompoProp.sspanel_Dirty.ForeColor = QBColor(0)
  End If
End Sub
Sub frmCompoProp_DirtyStatus_Set_Current()
  Call frmCompoProp_DirtyStatus_Set(frmCompoProp_Is_Dirty)
End Sub
Sub frmCompoProp_DirtyStatus_Throw()
  frmCompoProp_Is_Dirty = True
  Call frmCompoProp_DirtyStatus_Set_Current
End Sub
Sub frmCompoProp_DirtyStatus_Clear()
  frmCompoProp_Is_Dirty = False
  Call frmCompoProp_DirtyStatus_Set_Current
End Sub


Private Sub txtDataComponentProperty_GotFocus(Index As Integer)
Dim Ctl As Control
Set Ctl = txtDataComponentProperty(Index)
Dim StatusMessagePanel As String
  If (Index = 0) Then
    Call Global_GotFocus(Ctl)
  Else
    Call unitsys_control_txtx_gotfocus(Ctl)
  End If
  Select Case Index
    Case 0:
      StatusMessagePanel = "Type in the component name"
    Case 1:
      StatusMessagePanel = "Type in the molecular weight"
    Case 2:
      StatusMessagePanel = "Type in the molar volume at the normal boiling point"
    Case 3:
      StatusMessagePanel = "Type in the boiling point temperature"
    Case 4:
      StatusMessagePanel = "Type in the inlet concentration"
    Case 10:
      StatusMessagePanel = "Type in the liquid density"
    Case 9:
      StatusMessagePanel = "Type in the aqueous solubility"
    Case 7:
      StatusMessagePanel = "Type in the vapor pressure"
    Case 8:
      StatusMessagePanel = "Type in the refractive index"
    Case 11:
      StatusMessagePanel = "Type in the CAS number, with no hyphen characters"
    Case 5:
      StatusMessagePanel = "Type in the Freundlich K value"
    Case 6:
      StatusMessagePanel = "Type in the Freundlich 1/n value"
  End Select
  Call frmCompoProp_GenericStatus_Set(StatusMessagePanel)
End Sub
Private Sub txtDataComponentProperty_KeyPress(Index As Integer, KeyAscii As Integer)
  If (Index = 0) Then
    KeyAscii = Global_TextKeyPress(KeyAscii)
  Else
    KeyAscii = Global_NumericKeyPress(KeyAscii)
  End If
End Sub
Private Sub txtDataComponentProperty_LostFocus(Index As Integer)
Dim NewValue_Okay As Integer
Dim NewValue As Double
Dim Ctl As Control
Set Ctl = txtDataComponentProperty(Index)
Dim Val_Low As Double
Dim Val_High As Double
Dim Raise_Dirty_Flag As Boolean
Dim Too_Small As Integer
  'HANDLE THE COMPONENT NAME TEXTBOX.
  If (Index = 0) Then
    If (Trim$(Ctl.Text) = "") Then
      Ctl.Text = Component(0).Name
      'Call Show_Error("You must enter a non-blank string for the component name.")
      'NOTE: SHOWING THIS ERROR MESSAGE MESSES UP THE
      'SUBSEQUENT GOTFOCUS IF THE USER HITS <Enter> OR <Tab>.
    Else
      If (Trim$(Component(0).Name) <> Trim$(Ctl.Text)) Then
        Component(0).Name = Trim$(Ctl.Text)
        'THROW DIRTY FLAG.
        Call frmCompoProp_DirtyStatus_Throw
      End If
    End If
    Call Global_LostFocus(Ctl)
    Call frmCompoProp_GenericStatus_Set("")
    Exit Sub
  End If
  'NOTE: LOW AND HIGH VALUES IN BASE UNITS.
  Select Case Index
    Case 1: Val_Low = 2#: Val_High = 10000000000#
    'Case 2: Val_Low = 0.01 / 1000#: Val_High = 100000# / 1000#
    Case 2: Val_Low = 0.01: Val_High = 100000#
    Case 3: Val_Low = -273#: Val_High = 1000#
    Case 4: Val_Low = 1E-20: Val_High = 1000#
    Case 10: Val_Low = 0.001: Val_High = 100#
    Case 9: Val_Low = 0.0001: Val_High = 10000000#
    Case 7: Val_Low = 0.01: Val_High = 1000000#
    Case 8: Val_Low = 0.01: Val_High = 100000#
    Case 11: Val_Low = 0#: Val_High = 2000000000#
    Case 5: Val_Low = 0.0001: Val_High = 1000000#
    Case 6: Val_Low = 0.00001: Val_High = 10#
  End Select
  NewValue_Okay = False
  If (unitsys_control_txtx_lostfocus_validate(Ctl, Val_Low, Val_High, NewValue, Raise_Dirty_Flag)) Then
    NewValue_Okay = True
  End If
  Call unitsys_control_txtx_lostfocus(Ctl, NewValue)
  Call frmCompoProp_GenericStatus_Set("")
  If (NewValue_Okay) Then
    If (Raise_Dirty_Flag) Then
      'STORE TO MEMORY.
      Select Case Index
        Case 1:         'MOLECULAR WEIGHT.
          Component(0).MW = NewValue
        Case 2:         'MOLAR VOLUME.
          Component(0).MolarVolume = NewValue
        Case 3:         'BOILING POINT TEMPERATURE.
          Component(0).BP = NewValue
        Case 4:         'INLET CONCENTRATION.
          Component(0).InitialConcentration = NewValue
        Case 10:        'LIQUID DENSITY.
          Component(0).Liquid_Density = NewValue
        Case 9:         'AQUEOUS SOLUBILITY.
          Component(0).Aqueous_Solubility = NewValue
        Case 7:         'VAPOR PRESSURE.
          Component(0).Vapor_Pressure = NewValue
        Case 8:         'REFRACTIVE INDEX.
          Component(0).Refractive_Index = NewValue
        Case 11:        'CAS NUMBER.
          Component(0).CAS = NewValue
        Case 5:         'FREUNDLICH K.
          Component(0).UserEntered_K = NewValue
          Component(0).Use_K = NewValue
        Case 6:         'FREUNDLICH 1/N.
          Component(0).UserEntered_OneOverN = NewValue
          Component(0).Use_OneOverN = NewValue
      End Select
      'RAISE DIRTY FLAG IF NECESSARY.
      If (Raise_Dirty_Flag) Then
        'THROW DIRTY FLAG.
        Call frmCompoProp_DirtyStatus_Throw
        'BASED ON THIS CHANGE, UPDATE FREUNDLICH K IF NECESSARY.
        Call Update_Display_of_KFreundlich(Index)
      End If
      'REFRESH WINDOW.
      Call frmCompoProp_Refresh
    End If
  End If
End Sub


Private Sub txtPropUnits_Click(Index As Integer)
Dim Ctl As Control
Set Ctl = txtPropUnits(Index)
  Call unitsys_control_cbox_click(Ctl)
End Sub
Private Sub txtPropUnits_KeyPress(Index As Integer, KeyAscii As Integer)
  KeyAscii = Global_TextKeyPress(KeyAscii)
End Sub




VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Object = "{F9043C88-F6F2-101A-A3C9-08002B2F49FB}#1.1#0"; "Comdlg32.ocx"
Object = "{042BADC8-5E58-11CE-B610-524153480001}#1.0#0"; "vcf132.ocx"
Begin VB.Form frmExcelCurves 
   Caption         =   "frmExcelCurves"
   ClientHeight    =   6315
   ClientLeft      =   1950
   ClientTop       =   2550
   ClientWidth     =   8880
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MinButton       =   0   'False
   PaletteMode     =   1  'UseZOrder
   ScaleHeight     =   6315
   ScaleWidth      =   8880
   WindowState     =   2  'Maximized
   Begin Threed.SSFrame SSFrame1 
      Height          =   1005
      Left            =   2100
      TabIndex        =   1
      Top             =   4470
      Visible         =   0   'False
      Width           =   2805
      _Version        =   65536
      _ExtentX        =   4948
      _ExtentY        =   1773
      _StockProps     =   14
      Caption         =   "Invisible"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin MSComDlg.CommonDialog CommonDialog1 
         Left            =   330
         Top             =   270
         _ExtentX        =   847
         _ExtentY        =   847
         _Version        =   327681
      End
   End
   Begin VCIF1Lib.F1Book f1book 
      Height          =   4275
      Left            =   60
      OleObjectBlob   =   "ExcelCurves.frx":0000
      TabIndex        =   0
      Top             =   90
      Width           =   6345
   End
   Begin VB.Menu mnuFile 
      Caption         =   "&File"
      Begin VB.Menu mnuFileItem 
         Caption         =   "Save &As ..."
         Index           =   40
      End
      Begin VB.Menu mnuFileItem 
         Caption         =   "-"
         Index           =   49
      End
      Begin VB.Menu mnuFileItem 
         Caption         =   "Page Setup ..."
         Index           =   50
      End
      Begin VB.Menu mnuFileItem 
         Caption         =   "Printer Setup ..."
         Index           =   55
      End
      Begin VB.Menu mnuFileItem 
         Caption         =   "&Print (Current Sheet Only) ..."
         Index           =   60
      End
      Begin VB.Menu mnuFileItem 
         Caption         =   "-"
         Index           =   198
      End
      Begin VB.Menu mnuFileItem 
         Caption         =   "&Close"
         Index           =   199
      End
   End
   Begin VB.Menu mnuEdit 
      Caption         =   "&Edit"
      Begin VB.Menu mnuEditItem 
         Caption         =   "&Copy"
         Index           =   10
      End
   End
End
Attribute VB_Name = "frmExcelCurves"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Dim frmExcelCurves_loading_now As Boolean






Const frmExcelCurves_declarations_end = 0


Sub Do_The_Print_To_F1Book()


Dim f1 As Control
Set f1 = Me.f1book
'Dim sserror As Integer
Dim i As Integer
Dim J As Integer
Dim last_row As Integer
Dim last_col As Integer
  If (CPHSDM_Excel) Then
    '
    '    ----    CPHSDM RESULTS.    ----
    '
    f1.MinCol = 1
    f1.MinRow = 1
    f1.EntryRC(1, 1) = "CPHSDM Results -- Filename = " & Chr$(34) & Trim$(Filename) & Chr$(34)
    f1.EntryRC(3, 1) = "Time"
    f1.EntryRC(3, 2) = "BVT"
    f1.EntryRC(3, 3) = "Usage Rate"
    f1.EntryRC(3, 4) = CPM_Results.Component.Name
    f1.EntryRC(4, 1) = "Minutes"
    f1.EntryRC(4, 2) = "-"
    f1.EntryRC(4, 3) = "m/kg GAC"
    f1.EntryRC(4, 4) = "-"
    For i = 1 To 100
      f1.EntryRC(4 + i, 1) = Trim$(Str$(CPM_Results.T(i)))
      f1.EntryRC(4 + i, 2) = Trim$(Str$(CPM_Results.T(i) * 24# * 3600# * CPM_Results.Bed.Flowrate / CPM_Results.Bed.length / PI / (CPM_Results.Bed.Diameter / 2#) ^ 2))
      f1.EntryRC(4 + i, 3) = Trim$(Str$(CPM_Results.T(i) * 24# * 3600# * CPM_Results.Bed.Flowrate / CPM_Results.Bed.Weight))
      f1.EntryRC(4 + i, 4) = Trim$(Str$(CPM_Results.C_Over_C0(i)))
    Next i
    last_row = 4 + 100
    last_col = 4
    f1.MaxCol = last_col
    f1.MaxRow = last_row
  Else
    '
    '    ----    PSDM RESULTS.    ----
    '
    f1.MinCol = 1
    f1.MinRow = 1
    f1.EntryRC(1, 1) = "PSDM Results -- Filename = " & Chr$(34) & Trim$(Filename) & Chr$(34)
    f1.EntryRC(3, 1) = "Time"
    f1.EntryRC(3, 2) = "BVT"
    f1.EntryRC(3, 3) = "Usage Rate"
    For i = 1 To Results.NComponent
      f1.EntryRC(3, 3 + i) = Trim$(Results.Component(i).Name)
      f1.EntryRC(4, 3 + i) = "-"
    Next i
    f1.EntryRC(4, 1) = "Minutes"
    f1.EntryRC(4, 2) = "-"
    f1.EntryRC(4, 3) = "m/kg GAC"
    For i = 1 To Results.npoints
      f1.EntryRC(4 + i, 1) = Trim$(Str$(Results.T(i)))
      f1.EntryRC(4 + i, 2) = Trim$(Str$(Results.T(i) * 60 * Results.Bed.Flowrate / Results.Bed.length / PI / (Results.Bed.Diameter / 2) ^ 2))
      f1.EntryRC(4 + i, 3) = Trim$(Str$(Results.T(i) * 60 * Results.Bed.Flowrate / Results.Bed.Weight))
      For J = 1 To Results.NComponent
        f1.EntryRC(4 + i, 3 + J) = Trim$(Str$(Results.CP(J, i)))
      Next J
    Next i
    last_row = 4 + Results.npoints
    last_col = 3 + Results.NComponent
    f1.MaxCol = last_col
    f1.MaxRow = last_row
  End If
  'temp = ""
  'For i = 1 To Results.NPoints
  ' temp = Format$(Results.T(i), "0.00")
  ' temp = temp & "       " & Format$(Results.T(i) * 60 * Results.Bed.Flowrate / Results.Bed.Length / Pi / (Results.Bed.Diameter / 2) ^ 2, "0.00")
  ' temp = temp & "       " & Format$(Results.T(i) * 60 * Results.Bed.Flowrate / Results.Bed.Weight, "0.00")
  ' For j = 1 To Results.NComponent
  '   temp = temp & "          " & Format$(Results.CP(j, i), "0.000")
  ' Next j
  ' Print #f, temp
  ' temp = ""
  'Next i
  'Close f
End Sub


Function f1file_saveas(fn_force As String) As Integer
Dim fn_saveas As String
  If (fn_force <> "") Then
    fn_saveas = fn_force
  Else
    'INPUT NEW FILENAME.
    On Error GoTo err_filesaveas
    frmExcelCurves.CommonDialog1.Filter = "All Files (*.*)|*.*|Excel Files (*.xls)|*.xls"
    frmExcelCurves.CommonDialog1.FilterIndex = 2
    frmExcelCurves.CommonDialog1.CancelError = True
    frmExcelCurves.CommonDialog1.flags = _
          cdlOFNOverwritePrompt + _
          cdlOFNPathMustExist
    frmExcelCurves.CommonDialog1.ShowSave
    fn_saveas = Trim$(frmExcelCurves.CommonDialog1.Filename)
    If (fn_saveas = "") Then
      GoTo exit_save_did_not_go_okay
    End If
  End If
  'SAVE THIS FILE.
  Screen.MousePointer = 11
  f1book.Write frmExcelCurves.CommonDialog1.Filename, F1FileExcel4
  'TODO: DETERMINE WHAT VERSIONS OF EXCEL THIS IS COMPATIBLE WITH!
  Screen.MousePointer = 0
exit_save_went_okay:
  'SAVE WENT OKAY.
  f1file_saveas = True
  Exit Function
exit_save_did_not_go_okay:
  'SAVE DID NOT GO OKAY.
  f1file_saveas = False
  Exit Function
err_filesaveas:
  f1file_saveas = False
  Resume exit_save_did_not_go_okay
End Function


Private Sub Form_Activate()
  If (frmExcelCurves_loading_now) Then
    frmExcelCurves_loading_now = False
    Call Form_Resize
  End If
End Sub
Private Sub Form_Load()
Dim msg As String
  If (CPHSDM_Excel) Then
    msg = "Pre-Print of CPHSDM Results"
  Else
    msg = "Pre-Print of PSDM Results"
  End If
  'If (Trim$(NowProj.Filename) = "") Then
  '  msg = msg & "(untitled)"
  'Else
  '  msg = msg & NowProj.Filename
  'End If
  Me.Caption = msg
  Me.Width = 9000
  Me.Height = 7000
  Call CenterOnForm(Me, frmMain)
  Me.WindowState = 2  'maximized
  frmExcelCurves_loading_now = True
  Call Do_The_Print_To_F1Book
End Sub
Private Sub Form_Resize()
Dim XXX As Long
  If (frmExcelCurves_loading_now) Then Exit Sub
  If (Me.WindowState = 1) Then
    'CANNOT RESIZE WHEN MINIMIZED; EXIT OUTTA HERE.
    Exit Sub
  End If
  If (Me.Width < 7000) Then Me.Width = 7000
  If (Me.Height < 3000) Then Me.Height = 3000
  XXX = Me.Width - (Me.Width - Me.ScaleWidth) - 2 * f1book.Left
  If (XXX < 1000) Then
    XXX = 1000
  End If
  f1book.Width = XXX
  XXX = Me.Height - (Me.Height - Me.ScaleHeight) - 2 * f1book.Top
  If (XXX > 1000) Then
    f1book.Height = XXX
  End If
End Sub


Private Sub mnuEditItem_Click(index As Integer)
  Select Case index
    Case 10:    'copy
      f1book.EditCopy
  End Select
End Sub
Private Sub mnuFileItem_Click(index As Integer)
On Error GoTo err_mnuFileItem_Click
  Select Case index
    Case 40:    'save as ...
      Call f1file_saveas("")
    Case 50:    'page setup ...
      f1book.FilePageSetupDlg
    Case 55:    'print setup ...
      f1book.FilePrintSetupDlg
    Case 60:    'print ...
      f1book.FilePrint True
    Case 199:   'close
      Unload Me
  End Select
exit_err_mnuFileItem_Click:
  Exit Sub
err_mnuFileItem_Click:
  'PROBABLY A CANCEL FROM f1book.FilePrint.
  Resume exit_err_mnuFileItem_Click
End Sub


VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmDimensionless 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Dimensionless Groups"
   ClientHeight    =   4530
   ClientLeft      =   915
   ClientTop       =   810
   ClientWidth     =   5685
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   4530
   ScaleWidth      =   5685
   Begin VB.PictureBox Picture1 
      Appearance      =   0  'Flat
      BackColor       =   &H00FFFFFF&
      BorderStyle     =   0  'None
      ForeColor       =   &H80000008&
      Height          =   4035
      Left            =   5640
      Picture         =   "Dimensionless.frx":0000
      ScaleHeight     =   4035
      ScaleWidth      =   9885
      TabIndex        =   19
      Top             =   2520
      Visible         =   0   'False
      Width           =   9885
   End
   Begin Threed.SSFrame SSFrame2 
      Height          =   4365
      Left            =   90
      TabIndex        =   0
      Top             =   90
      Width           =   5475
      _Version        =   65536
      _ExtentX        =   9657
      _ExtentY        =   7699
      _StockProps     =   14
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.TextBox txtDimless 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   6
         Left            =   4080
         Locked          =   -1  'True
         TabIndex        =   7
         Text            =   "txtDimless(6)"
         Top             =   3300
         Width           =   1200
      End
      Begin VB.TextBox txtDimless 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   5
         Left            =   4080
         Locked          =   -1  'True
         TabIndex        =   6
         Text            =   "txtDimless(5)"
         Top             =   2940
         Width           =   1200
      End
      Begin VB.TextBox txtDimless 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   4
         Left            =   4080
         Locked          =   -1  'True
         TabIndex        =   5
         Text            =   "txtDimless(4)"
         Top             =   2580
         Width           =   1200
      End
      Begin VB.TextBox txtDimless 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   3
         Left            =   4080
         Locked          =   -1  'True
         TabIndex        =   4
         Text            =   "txtDimless(3)"
         Top             =   2220
         Width           =   1200
      End
      Begin VB.TextBox txtDimless 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   2
         Left            =   4080
         Locked          =   -1  'True
         TabIndex        =   3
         Text            =   "txtDimless(2)"
         Top             =   1860
         Width           =   1200
      End
      Begin VB.TextBox txtDimless 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   1
         Left            =   4080
         Locked          =   -1  'True
         TabIndex        =   2
         Text            =   "txtDimless(1)"
         Top             =   1500
         Width           =   1200
      End
      Begin VB.TextBox txtDimless 
         Appearance      =   0  'Flat
         BackColor       =   &H00FFFFFF&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   0
         Left            =   4080
         Locked          =   -1  'True
         TabIndex        =   1
         Text            =   "txtDimless(0)"
         Top             =   1140
         Width           =   1200
      End
      Begin Threed.SSFrame SSFrame1 
         Height          =   795
         Left            =   180
         TabIndex        =   8
         Top             =   150
         Width           =   5115
         _Version        =   65536
         _ExtentX        =   9022
         _ExtentY        =   1402
         _StockProps     =   14
         Caption         =   "Select Component:"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Begin VB.ComboBox cboSelectCompo 
            Appearance      =   0  'Flat
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   315
            Left            =   120
            Style           =   2  'Dropdown List
            TabIndex        =   9
            TabStop         =   0   'False
            Top             =   300
            Width           =   4875
         End
      End
      Begin Threed.SSCommand cmdOK 
         Height          =   495
         Left            =   150
         TabIndex        =   10
         TabStop         =   0   'False
         Top             =   3690
         Width           =   2295
         _Version        =   65536
         _ExtentX        =   4048
         _ExtentY        =   873
         _StockProps     =   78
         Caption         =   "&Close"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSCommand cmdDefs 
         Height          =   495
         Left            =   3000
         TabIndex        =   18
         TabStop         =   0   'False
         Top             =   3690
         Visible         =   0   'False
         Width           =   2295
         _Version        =   65536
         _ExtentX        =   4048
         _ExtentY        =   873
         _StockProps     =   78
         Caption         =   "&Definitions ..."
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin VB.Label lblDimless 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Surface Solute Distribution Parameter, Dgs ="
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   6
         Left            =   120
         TabIndex        =   17
         Top             =   3330
         Width           =   3855
      End
      Begin VB.Label lblDimless 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Pore Solute Distribution Parameter, Dgp ="
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   360
         TabIndex        =   16
         Top             =   2970
         Width           =   3615
      End
      Begin VB.Label lblDimless 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Surface Biot Number, Bis ="
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   360
         TabIndex        =   15
         Top             =   2610
         Width           =   3615
      End
      Begin VB.Label lblDimless 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Pore Biot Number, Bip ="
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   360
         TabIndex        =   14
         Top             =   2250
         Width           =   3615
      End
      Begin VB.Label lblDimless 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Pore Diffusivity Modulus, Edp ="
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   360
         TabIndex        =   13
         Top             =   1890
         Width           =   3615
      End
      Begin VB.Label lblDimless 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Surface Diffusivity Modulus, Eds ="
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   360
         TabIndex        =   12
         Top             =   1530
         Width           =   3615
      End
      Begin VB.Label lblDimless 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Stanton number, St ="
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   360
         TabIndex        =   11
         Top             =   1170
         Width           =   3615
      End
   End
End
Attribute VB_Name = "frmDimensionless"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit


Sub populate_cboSelectCompo()
Dim i As Integer
  cboSelectCompo.Clear
  For i = 1 To Number_Component
    cboSelectCompo.AddItem Trim$(Component(i).Name)
  Next i
End Sub


Sub Display_Component(Which As Integer)
Dim N As Integer
  If (Which < 1) Or (Which > Number_Component) Then
    Exit Sub
  End If
  N = Which
  Call AssignTextAndTag(txtDimless(0), NumberToMFBString(ST(N)))
  Call AssignTextAndTag(txtDimless(1), NumberToMFBString(Eds(N)))
  Call AssignTextAndTag(txtDimless(2), NumberToMFBString(Edp(N)))
  Call AssignTextAndTag(txtDimless(3), NumberToMFBString(Bip(N)))
  Call AssignTextAndTag(txtDimless(4), NumberToMFBString(Bis(N)))
  Call AssignTextAndTag(txtDimless(5), NumberToMFBString(Dgp(N)))
  Call AssignTextAndTag(txtDimless(6), NumberToMFBString(Dgs(N)))
  If (Which <= cboSelectCompo.ListCount) Then
    cboSelectCompo.ListIndex = Which - 1
  End If
End Sub


Private Sub cboSelectCompo_Click()
  Call Display_Component(cboSelectCompo.ListIndex + 1)
End Sub


Private Sub cmdDefs_Click()
  'Me.Hide
  'frmDimensionlessDefs.Show
  'Me.Show
End Sub
Private Sub cmdOK_Click()
  Unload Me
End Sub


Private Sub Form_Load()
  'MISC INITS.
  Call CenterOnForm(Me, frmMain)
  Call populate_cboSelectCompo
  Call Display_Component(frmMain.cboSelectCompo.ListIndex + 1)
End Sub


Private Sub txtDimless_GotFocus(Index As Integer)
Dim Ctl As Control
Set Ctl = txtDimless(Index)
  Call Global_GotFocus(Ctl)
End Sub
Private Sub txtDimless_KeyPress(Index As Integer, KeyAscii As Integer)
  KeyAscii = Global_ReadOnlyKeyPress(KeyAscii)
End Sub
Private Sub txtDimless_LostFocus(Index As Integer)
Dim Ctl As Control
Set Ctl = txtDimless(Index)
  Call Global_LostFocus(Ctl)
End Sub


VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmDimensionlessDefs 
   BackColor       =   &H00FFFFFF&
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Dimensionless Groups : Definitions"
   ClientHeight    =   4170
   ClientLeft      =   3510
   ClientTop       =   3225
   ClientWidth     =   10020
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   4170
   ScaleWidth      =   10020
   Begin Threed.SSCommand cmdOK 
      Height          =   765
      Left            =   8400
      TabIndex        =   1
      Top             =   90
      Width           =   1515
      _Version        =   65536
      _ExtentX        =   2672
      _ExtentY        =   1349
      _StockProps     =   78
      Caption         =   "&OK"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin VB.PictureBox Picture1 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   0  'None
      ForeColor       =   &H80000008&
      Height          =   4035
      Left            =   60
      Picture         =   "DimensionlessDefs.frx":0000
      ScaleHeight     =   4035
      ScaleWidth      =   9885
      TabIndex        =   0
      Top             =   60
      Width           =   9885
   End
End
Attribute VB_Name = "frmDimensionlessDefs"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit


Private Sub cmdOK_Click()
  Unload Me
End Sub
VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmEditAdsorber 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Adsorber Database"
   ClientHeight    =   6600
   ClientLeft      =   840
   ClientTop       =   1095
   ClientWidth     =   9135
   ControlBox      =   0   'False
   LinkTopic       =   "Form2"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   6600
   ScaleWidth      =   9135
   Begin Threed.SSFrame SSFrame1 
      Height          =   2415
      Left            =   60
      TabIndex        =   0
      Top             =   60
      Width           =   3735
      _Version        =   65536
      _ExtentX        =   6588
      _ExtentY        =   4260
      _StockProps     =   14
      Caption         =   "Select a Manufacturer:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.ListBox lstManu 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1980
         Left            =   120
         Sorted          =   -1  'True
         TabIndex        =   6
         Top             =   330
         Width           =   3495
      End
   End
   Begin Threed.SSFrame SSFrame2 
      Height          =   3735
      Left            =   60
      TabIndex        =   1
      Top             =   2670
      Width           =   3735
      _Version        =   65536
      _ExtentX        =   6588
      _ExtentY        =   6588
      _StockProps     =   14
      Caption         =   "Select an Adsorber:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.ListBox lstName 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   2955
         Left            =   120
         TabIndex        =   3
         Top             =   660
         Width           =   3495
      End
      Begin Threed.SSOption optPhase 
         Height          =   375
         Index           =   2
         Left            =   2040
         TabIndex        =   4
         TabStop         =   0   'False
         Top             =   210
         Width           =   1215
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "&Gas Phase"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   16.5
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSOption optPhase 
         Height          =   375
         Index           =   1
         Left            =   240
         TabIndex        =   5
         Top             =   210
         Width           =   1575
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "&Liquid Phase"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   16.5
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
   End
   Begin Threed.SSFrame SSFrame4 
      Height          =   4215
      Left            =   3900
      TabIndex        =   2
      Top             =   60
      Width           =   5145
      _Version        =   65536
      _ExtentX        =   9075
      _ExtentY        =   7435
      _StockProps     =   14
      Caption         =   "Adsorber Properties:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Internal Area:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   60
         TabIndex        =   29
         Top             =   285
         Width           =   2055
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00FFFFFF&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "lblData(0)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   2160
         TabIndex        =   28
         Top             =   270
         Width           =   1395
      End
      Begin VB.Label lblUnits 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "(ft)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   3600
         TabIndex        =   27
         Top             =   285
         Width           =   915
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Maximum Capacity:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   60
         TabIndex        =   26
         Top             =   585
         Width           =   2055
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00FFFFFF&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "lblData(1)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   2160
         TabIndex        =   25
         Top             =   570
         Width           =   1395
      End
      Begin VB.Label lblUnits 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "(lbs)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   3600
         TabIndex        =   24
         Top             =   585
         Width           =   915
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Outside Diameter:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   60
         TabIndex        =   23
         Top             =   885
         Width           =   2055
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00FFFFFF&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "lblData(2)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   2160
         TabIndex        =   22
         Top             =   870
         Width           =   1395
      End
      Begin VB.Label lblUnits 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "(feet)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   3600
         TabIndex        =   21
         Top             =   885
         Width           =   915
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Design Pressure:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   60
         TabIndex        =   20
         Top             =   1185
         Width           =   2055
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00FFFFFF&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "lblData(3)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   2160
         TabIndex        =   19
         Top             =   1170
         Width           =   1395
      End
      Begin VB.Label lblUnits 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "(psig)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   3600
         TabIndex        =   18
         Top             =   1185
         Width           =   915
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Design Flow Range:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   60
         TabIndex        =   17
         Top             =   1485
         Width           =   2055
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00FFFFFF&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "lblData(4)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   2160
         TabIndex        =   16
         Top             =   1470
         Width           =   1395
      End
      Begin VB.Label lblUnits 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "(see code)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   3600
         TabIndex        =   15
         Top             =   1485
         Width           =   915
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Default Flow Rate:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   60
         TabIndex        =   14
         Top             =   1785
         Width           =   2055
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00FFFFFF&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "lblData(5)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   2160
         TabIndex        =   13
         Top             =   1770
         Width           =   1395
      End
      Begin VB.Label lblUnits 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "(see code)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   3600
         TabIndex        =   12
         Top             =   1785
         Width           =   915
      End
      Begin VB.Label lblDesc 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Notes:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   6
         Left            =   600
         TabIndex        =   11
         Top             =   2100
         Width           =   1035
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00FFFFFF&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "lblData(6)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   6
         Left            =   600
         TabIndex        =   10
         Top             =   2370
         Width           =   3675
      End
      Begin VB.Label lblUnits 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "(lb/ft)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   7
         Left            =   3600
         TabIndex        =   9
         Top             =   2865
         Width           =   915
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00FFFFFF&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "lblData(7)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   7
         Left            =   2160
         TabIndex        =   8
         Top             =   2850
         Width           =   1395
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Default Bulk Density:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   7
         Left            =   60
         TabIndex        =   7
         Top             =   2865
         Width           =   2055
      End
   End
   Begin Threed.SSCommand cmdOK 
      Height          =   615
      Left            =   3900
      TabIndex        =   30
      Top             =   5790
      Width           =   4035
      _Version        =   65536
      _ExtentX        =   7117
      _ExtentY        =   1085
      _StockProps     =   78
      Caption         =   "&Use These Adsorber Specifications"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdCancel 
      Height          =   615
      Left            =   7920
      TabIndex        =   31
      Top             =   5790
      Width           =   1125
      _Version        =   65536
      _ExtentX        =   1984
      _ExtentY        =   1085
      _StockProps     =   78
      Caption         =   "&Cancel"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin VB.Menu mnuManufacturer 
      Caption         =   "&Manufacturer"
      Begin VB.Menu mnuManufacturerItem 
         Caption         =   "&New"
         Index           =   1
      End
      Begin VB.Menu mnuManufacturerItem 
         Caption         =   "&Edit Current"
         Index           =   2
      End
      Begin VB.Menu mnuManufacturerItem 
         Caption         =   "&Delete Current"
         Index           =   3
      End
   End
   Begin VB.Menu mnuAdsorber 
      Caption         =   "&Adsorber"
      Begin VB.Menu mnuAdsorberItem 
         Caption         =   "&New"
         Index           =   1
      End
      Begin VB.Menu mnuAdsorberItem 
         Caption         =   "&Edit Current"
         Index           =   2
      End
      Begin VB.Menu mnuAdsorberItem 
         Caption         =   "&Delete Current"
         Index           =   3
      End
   End
End
Attribute VB_Name = "frmEditAdsorber"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Dim frmEditAdsorber_Cancelled As Integer
Dim frmEditAdsorber_RunMode As Integer
Const frmEditAdsorber_RunMode_QUERY_DATABASE = 1
Const frmEditAdsorber_RunMode_EDIT_DATABASE = 2

Dim USER_HIT_CANCEL As Boolean
Dim USER_HIT_USE_THESE As Boolean




Const frmEditAdsorber_declarations_end = True


Sub frmEditAdsorber_QueryDatabase( _
    OUTPUT_User_Transferred_Data As Boolean)
  frmEditAdsorber_RunMode = frmEditAdsorber_RunMode_QUERY_DATABASE
  frmEditAdsorber.Show 1
  If (USER_HIT_USE_THESE) Then
    OUTPUT_User_Transferred_Data = True
  Else
    OUTPUT_User_Transferred_Data = False
  End If
End Sub
Sub frmEditAdsorber_EditDatabase()
  frmEditAdsorber_RunMode = frmEditAdsorber_RunMode_EDIT_DATABASE
  frmEditAdsorber.Show 1
End Sub


Private Function adsorber_db_AssignUniqueID() As Integer
Dim this_try As Integer
Dim i As Integer
Dim found As Integer
  Do While (1 = 1)
    this_try = Int(Rnd(1) * 32000) + 1
    found = False
    For i = 1 To adsorber_db_num_manufacturers
      If (CInt(adsorber_db_manufacturers(i).UniqueID) = this_try) Then
        found = True
        Exit For
      End If
    Next i
    If (Not found) Then
      adsorber_db_AssignUniqueID = this_try
      Exit Function
    End If
  Loop
End Function


Private Sub adsorber_db_displayall()
Dim i As Integer
Dim n As Integer
  'POPULATE LISTBOX lstManu:
  lstManu.Clear
  For i = 1 To adsorber_db_num_manufacturers
    lstManu.AddItem adsorber_db_manufacturers(i).Name
    n = lstManu.NewIndex
    lstManu.ItemData(n) = CInt(adsorber_db_manufacturers(i).UniqueID)
  Next i
End Sub


'Load all adsorber DB entries.
Private Sub adsorber_db_loadall()
Dim f As Integer
Dim i As Integer
Dim fn As String
  
  On Error GoTo err_adsorber_db_loadall
  
  'LOAD MANUFACTURERS.
  fn = Database_Path & "\beds2.txt"
  f = FreeFile
  Open fn For Input As #f
  Input #f, adsorber_db_num_manufacturers
  If (adsorber_db_num_manufacturers <> 0) Then
    ReDim adsorber_db_manufacturers(1 To adsorber_db_num_manufacturers)
    For i = 1 To adsorber_db_num_manufacturers
      Input #f, adsorber_db_manufacturers(i).UniqueID, adsorber_db_manufacturers(i).Name
    Next i
  End If
  Close #f

  'LOAD ADSORBERS.
  fn = Database_Path & "\beds1.txt"
  f = FreeFile
  Open fn For Input As #f
  Input #f, adsorber_db_num_adsorbers
  If (adsorber_db_num_adsorbers <> 0) Then
    ReDim adsorber_db_adsorbers(1 To adsorber_db_num_adsorbers)
    For i = 1 To adsorber_db_num_adsorbers
      Input #f, adsorber_db_adsorbers(i).UniqueID_Manufacturer, adsorber_db_adsorbers(i).Phase, adsorber_db_adsorbers(i).PartNumber, adsorber_db_adsorbers(i).InternalArea, adsorber_db_adsorbers(i).MaxCapacity, adsorber_db_adsorbers(i).OutsideDiameter, adsorber_db_adsorbers(i).DesignPressure, adsorber_db_adsorbers(i).DesignFlowRange, adsorber_db_adsorbers(i).DefaultFlowRate, adsorber_db_adsorbers(i).Note
      'MsgBox CStr(adsorber_db_adsorbers(i).PartNumber)
    Next i
  End If
  Close #f
exit_err_adsorber_db_loadall:
  Exit Sub
err_adsorber_db_loadall:
  Call Show_Trapped_Error("Load Adsorber Database")
  Resume exit_err_adsorber_db_loadall
End Sub


'RETURNS:
'  -1 if not found
'  index if found
Private Function adsorber_db_lookup_UniqueID_Manufacturer(search_for As Integer) As Integer
Dim i As Integer
Dim found As Integer
  found = False
  For i = 1 To adsorber_db_num_manufacturers
    If (CInt(adsorber_db_manufacturers(i).UniqueID) = search_for) Then
      found = True
      Exit For
    End If
  Next i
  If (found) Then
    adsorber_db_lookup_UniqueID_Manufacturer = i
  Else
    adsorber_db_lookup_UniqueID_Manufacturer = -1
  End If
End Function


Private Sub adsorber_db_saveall()
Dim f As Integer
Dim i As Integer
Dim fn As String

  On Error GoTo err_adsorber_db_saveall

  'SAVE MANUFACTURERS.
  fn = Database_Path & "\beds2.txt"
  f = FreeFile
  Open fn For Output As #f
  Write #f, adsorber_db_num_manufacturers
  'ReDim adsorber_db_manufacturers(1 To adsorber_db_num_manufacturers)
  For i = 1 To adsorber_db_num_manufacturers
    Write #f, adsorber_db_manufacturers(i).UniqueID, adsorber_db_manufacturers(i).Name
  Next i
  Close #f

  'SAVE ADSORBERS.
  fn = Database_Path & "\beds1.txt"
  f = FreeFile
  Open fn For Output As #f
  Write #f, adsorber_db_num_adsorbers
  'ReDim adsorber_db_adsorbers(1 To adsorber_db_num_adsorbers)
  For i = 1 To adsorber_db_num_adsorbers
    Write #f, adsorber_db_adsorbers(i).UniqueID_Manufacturer, _
        adsorber_db_adsorbers(i).Phase, _
        Trim$(adsorber_db_adsorbers(i).PartNumber), _
        Trim$(adsorber_db_adsorbers(i).InternalArea), _
        Trim$(adsorber_db_adsorbers(i).MaxCapacity), _
        Trim$(adsorber_db_adsorbers(i).OutsideDiameter), _
        Trim$(adsorber_db_adsorbers(i).DesignPressure), _
        Trim$(adsorber_db_adsorbers(i).DesignFlowRange), _
        Trim$(adsorber_db_adsorbers(i).DefaultFlowRate), _
        Trim$(adsorber_db_adsorbers(i).Note)
    'MsgBox CStr(adsorber_db_adsorbers(i).PartNumber)
  Next i
  Close #f

  Call clear_this_record
  lstName.Clear
  Call adsorber_db_loadall
  Call adsorber_db_displayall
exit_err_adsorber_db_saveall:
  Exit Sub
err_adsorber_db_saveall:
  Call Show_Trapped_Error("Save Adsorber Database")
  Resume exit_err_adsorber_db_saveall
End Sub


Private Sub clear_this_record()
Dim i As Integer
  For i = 0 To 6
    lblData(i) = ""
  Next i
End Sub


Private Sub cmdCancel_Click()
  'frmEditAdsorber_Cancelled = True
  USER_HIT_CANCEL = True
  USER_HIT_USE_THESE = False
  Unload Me
End Sub
Private Sub cmdOK_Click()
Dim n As Integer
Dim this_A As Double
Dim this_M As Double
Dim this_rhoB As Double
Dim New_D As Double
Dim new_V As Double
Dim New_L As Double
Dim this_Q As Double
Dim now_phase As Integer
  If (lstName.ListIndex < 0) Or (lstName.ListCount = 0) Then
    Call Show_Error("You must first select an adsorber.")
    Exit Sub
  End If
  n = lstName.ItemData(lstName.ListIndex)
  'CONVERT AREA FROM FT^2 TO M^2
  this_A = CDbl(adsorber_db_adsorbers(n).InternalArea)
  this_A = this_A / 10.7639104167
  'CONVERT MASS FROM LBS TO KG
  this_M = CDbl(adsorber_db_adsorbers(n).MaxCapacity)
  this_M = this_M / 2.20462262185
  'CONVERT BULK DENSITY FROM LBM/FT^3 TO KG/M^3
  this_rhoB = 28#
  this_rhoB = this_rhoB * 0.45359237 / 0.028316846592
  'CALCULATE INTERNAL DIAMETER IN M
  New_D = (4# * this_A / 3.14159) ^ 0.5
  'CALCULATE VOLUME IN M^3
  new_V = this_M / this_rhoB
  'CALCULATE LENGTH IN M
  New_L = new_V / this_A
  'CONVERT DEFAULT FLOW RATE TO M^3/S
  this_Q = CDbl(adsorber_db_adsorbers(n).DefaultFlowRate)
  If (optPhase(1).Value) Then
    now_phase = 1     'LIQUID PHASE
  Else
    now_phase = 2     'GAS PHASE
  End If
  If (now_phase = 1) Then
    'CONVERT FROM GAL/MIN TO M^3/S
    this_Q = this_Q * 0.003785411784 / 60#
  End If
  If (now_phase = 2) Then
    'CONVERT FROM FT^3/MIN TO M^3/S
    this_Q = this_Q * 0.028316846592 / 60#
  End If
  'TRANSFER PARAMETERS BACK TO MAIN SCREEN
  frmEditAdsorber_ReturnParameters.D = New_D
  frmEditAdsorber_ReturnParameters.l = New_L
  frmEditAdsorber_ReturnParameters.Q = this_Q
  frmEditAdsorber_ReturnParameters.M = this_M
  'frmEditAdsorber_Cancelled = False
  USER_HIT_CANCEL = False
  USER_HIT_USE_THESE = True
  Unload Me
End Sub


Private Sub Form_Load()
  'MISC INITS.
  Me.Height = 7290
  Me.Width = 9255
  Call CenterOnForm(Me, frmMain)
  If (frmEditAdsorber_RunMode = frmEditAdsorber_RunMode_QUERY_DATABASE) Then
    cmdOK.Visible = True
    cmdCancel.Visible = True
    lblData(7).Caption = "28.0"
    lblData(7).Visible = True
  Else
    cmdOK.Visible = False
    cmdCancel.Visible = True
    cmdCancel.Caption = "E&xit"
    lblData(7).Visible = False
    lblDesc(7).Visible = False
    lblUnits(7).Visible = False
  End If
  If (Bed.Phase = 0) Then
    optPhase(1).Value = True
    optPhase(2).Value = False
  Else
    optPhase(1).Value = False
    optPhase(2).Value = True
  End If
  Call adsorber_db_loadall
  Call clear_this_record
  Call adsorber_db_displayall
End Sub


Private Sub lstManu_Click()
Dim thismanu As Integer
Dim i As Integer
Dim n As Integer
Dim now_phase As Integer
  Call clear_this_record
  'DISPLAY NAMES FOR THIS MANUFACTURER (IF ANY)
  lstName.Clear
  If (lstManu.ListIndex < 0) Then Exit Sub
  thismanu = lstManu.ItemData(lstManu.ListIndex)
  If (optPhase(1).Value) Then
    now_phase = 1     'LIQUID PHASE
  Else
    now_phase = 2     'GAS PHASE
  End If
  For i = 1 To adsorber_db_num_adsorbers
    If (thismanu = adsorber_db_adsorbers(i).UniqueID_Manufacturer) Then
      If (now_phase = adsorber_db_adsorbers(i).Phase) Then
        lstName.AddItem adsorber_db_adsorbers(i).PartNumber
        n = lstName.NewIndex
        lstName.ItemData(n) = i
      End If
    End If
  Next i
End Sub
Private Sub lstManu_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
  If ((Button And 2) = 2) Then
    Me.PopupMenu mnuManufacturer
  End If
End Sub
Private Sub lstName_Click()
Dim n As Integer
  'DISPLAY ADSORBER PROPERTIES:
  n = lstName.ItemData(lstName.ListIndex)
  lblData(0) = Trim$(adsorber_db_adsorbers(n).InternalArea)
  lblData(1) = Trim$(adsorber_db_adsorbers(n).MaxCapacity)
  lblData(2) = Trim$(adsorber_db_adsorbers(n).OutsideDiameter)
  lblData(3) = Trim$(adsorber_db_adsorbers(n).DesignPressure)
  lblData(4) = Trim$(adsorber_db_adsorbers(n).DesignFlowRange)
  lblData(5) = Trim$(adsorber_db_adsorbers(n).DefaultFlowRate)
  lblData(6) = Trim$(adsorber_db_adsorbers(n).Note)
End Sub
Private Sub lstName_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
  If ((Button And 2) = 2) Then
    Me.PopupMenu mnuAdsorber
  End If
End Sub


Private Sub mnuAdsorberItem_Click(Index As Integer)
Dim n As Integer
Dim i As Integer
Dim response As Integer
Dim Msg As String
Dim n_manu As Integer
Dim now_phase As Integer
Dim USER_HIT_CANCEL As Boolean
  If (lstManu.ListIndex < 0) Or (lstManu.ListCount = 0) Then
    Call Show_Error("You must first select a manufacturer.")
    Exit Sub
  End If
  n_manu = lstManu.ItemData(lstManu.ListIndex)
  n_manu = adsorber_db_lookup_UniqueID_Manufacturer(n_manu)
  If (Index = 2) Or (Index = 3) Then
    If (lstName.ListIndex < 0) Or (lstName.ListCount = 0) Then
      Call Show_Error("You must first select an adsorber.")
      Exit Sub
    End If
    n = lstName.ItemData(lstName.ListIndex)
  End If
  If (optPhase(1).Value) Then
    now_phase = 1     'LIQUID PHASE
  Else
    now_phase = 2     'GAS PHASE
  End If
  Select Case Index
    Case 1:     'new
      Call frmEditAdsorberData.frmEditAdsorberData_AddNew( _
          now_phase, _
          USER_HIT_CANCEL)
      If (Not USER_HIT_CANCEL) Then
        frmEditAdsorberData_Record.UniqueID_Manufacturer = CInt(adsorber_db_manufacturers(n_manu).UniqueID)
        adsorber_db_num_adsorbers = adsorber_db_num_adsorbers + 1
        n = adsorber_db_num_adsorbers
        ReDim Preserve adsorber_db_adsorbers(1 To n)
        adsorber_db_adsorbers(n) = frmEditAdsorberData_Record
        Call adsorber_db_saveall
      End If
    Case 2:     'edit current
      frmEditAdsorberData_Record = adsorber_db_adsorbers(n)
      Call frmEditAdsorberData.frmEditAdsorberData_Edit( _
          adsorber_db_adsorbers(n).Phase, _
          USER_HIT_CANCEL)
      If (Not USER_HIT_CANCEL) Then
        adsorber_db_adsorbers(n) = frmEditAdsorberData_Record
        Call adsorber_db_saveall
      End If
    Case 3:     'delete current
      Msg = "Do you really want to delete adsorber '" & Trim$(adsorber_db_adsorbers(n).PartNumber) & "' ?"
      response = MsgBox(Msg, vbCritical + vbYesNo, App.Title)
      If response = vbNo Then Exit Sub
      'PERFORM DELETION
      For i = n To adsorber_db_num_adsorbers - 1
        adsorber_db_adsorbers(i) = adsorber_db_adsorbers(i + 1)
      Next i
      adsorber_db_num_adsorbers = adsorber_db_num_adsorbers - 1
      'SAVE MANUFACTURER FILE
      Call adsorber_db_saveall
  End Select
End Sub


Private Sub mnuManufacturerItem_Click(Index As Integer)
Dim n As Integer
Dim i As Integer
Dim response As Integer
Dim Msg As String
Dim new_UniqueID As Integer
Dim NewName As String
Dim USER_HIT_CANCEL As Boolean
  If (Index = 2) Or (Index = 3) Then
    If (lstManu.ListIndex < 0) Or (lstManu.ListCount = 0) Then
      Call Show_Error("You must first select a manufacturer.")
      Exit Sub
    End If
    n = lstManu.ItemData(lstManu.ListIndex)
    n = adsorber_db_lookup_UniqueID_Manufacturer(n)
  End If
  Select Case Index
    Case 1:     'new
      NewName = "New Manufacturer"
      Do While (1 = 1)
        NewName = frmNewName.frmNewName_GetName( _
            "Creating New Manufacturer", _
            "Each manufacturer record should have a unique name.", _
            NewName, _
            USER_HIT_CANCEL)
        If (USER_HIT_CANCEL) Then Exit Sub
        NewName = Trim$(NewName)
        If (NewName <> "") Then Exit Do
        Call Show_Error("Manufacturer name must be a non-blank string.")
      Loop
      'ADD THE NEW MANUFACTURER RECORD.
      new_UniqueID = adsorber_db_AssignUniqueID()
      adsorber_db_num_manufacturers = adsorber_db_num_manufacturers + 1
      n = adsorber_db_num_manufacturers
      ReDim Preserve adsorber_db_manufacturers(1 To n)
      adsorber_db_manufacturers(n).Name = Trim$(CStr(NewName))
      adsorber_db_manufacturers(n).UniqueID = Trim$(Str$(new_UniqueID))
      Call adsorber_db_saveall
    Case 2:     'edit current
      'If Number_Of_Manufacturers = 0 Then
      '  MsgBox "There is no manufacturer name to edit.", MB_ICONEXCLAMATION, Application_Name
      '  Exit Sub
      'End If
      NewName = Trim$(lstManu.List(lstManu.ListIndex))
      Do While (1 = 1)
        NewName = frmNewName.frmNewName_GetName( _
            "Editing Existing Manufacturer Name", _
            "Each manufacturer record should have a unique name.", _
            NewName, _
            USER_HIT_CANCEL)
        If (USER_HIT_CANCEL) Then Exit Sub
        NewName = Trim$(NewName)
        If (NewName <> "") Then Exit Do
        Call Show_Error("Manufacturer name must be a non-blank string.")
      Loop
      adsorber_db_manufacturers(n).Name = NewName
      Call adsorber_db_saveall
    Case 3:     'delete current
      Msg = "Do you really want to delete manufacturer '" & Trim$(adsorber_db_manufacturers(n).Name) & "' ?"
      response = MsgBox(Msg, vbCritical + vbYesNo, Application_Name)
      If response = vbNo Then Exit Sub
      'PERFORM DELETION
      For i = n To adsorber_db_num_manufacturers - 1
        adsorber_db_manufacturers(i) = adsorber_db_manufacturers(i + 1)
      Next i
      adsorber_db_num_manufacturers = adsorber_db_num_manufacturers - 1
      'SAVE MANUFACTURER FILE
      Call adsorber_db_saveall
  End Select
End Sub


Private Sub optPhase_Click(Index As Integer, Value As Integer)
  If (optPhase(1).Value) Then
    'LIQUID PHASE
    lblUnits(4).Caption = "(gal/min)"
    lblUnits(5).Caption = "(gal/min)"
  Else
    'GAS PHASE
    lblUnits(4).Caption = "(ft/min)"
    lblUnits(5).Caption = "(ft/min)"
  End If
  If (lstManu.ListCount > 0) Then
    'UPDATE LIST OF NAMES:
    If (lstManu.ListIndex < 0) Then
      lstManu.ListIndex = 0
    End If
    Call lstManu_Click
  End If
End Sub


VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmEditAdsorberData 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Editing an Adsorber"
   ClientHeight    =   5025
   ClientLeft      =   3585
   ClientTop       =   3690
   ClientWidth     =   5085
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   5025
   ScaleWidth      =   5085
   Begin Threed.SSFrame SSFrame1 
      Height          =   795
      Left            =   180
      TabIndex        =   8
      Top             =   90
      Width           =   4755
      _Version        =   65536
      _ExtentX        =   8387
      _ExtentY        =   1402
      _StockProps     =   14
      Caption         =   "Select Phase:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin Threed.SSOption optPhase 
         Height          =   375
         Index           =   1
         Left            =   480
         TabIndex        =   10
         TabStop         =   0   'False
         Top             =   300
         Width           =   1575
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "&Liquid Phase"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   16.5
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSOption optPhase 
         Height          =   375
         Index           =   2
         Left            =   2610
         TabIndex        =   11
         TabStop         =   0   'False
         Top             =   300
         Width           =   1215
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "&Gas Phase"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   16.5
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
   End
   Begin Threed.SSFrame SSFrame2 
      Height          =   3135
      Left            =   180
      TabIndex        =   9
      Top             =   1020
      Width           =   4755
      _Version        =   65536
      _ExtentX        =   8387
      _ExtentY        =   5530
      _StockProps     =   14
      Caption         =   "Adsorber Properties:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.TextBox txtData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   1
         Left            =   2160
         TabIndex        =   2
         Text            =   "txtData(1)"
         Top             =   900
         Width           =   1395
      End
      Begin VB.TextBox txtData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   2
         Left            =   2160
         TabIndex        =   3
         Text            =   "txtData(2)"
         Top             =   1200
         Width           =   1395
      End
      Begin VB.TextBox txtData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   3
         Left            =   2160
         TabIndex        =   4
         Text            =   "txtData(3)"
         Top             =   1500
         Width           =   1395
      End
      Begin VB.TextBox txtData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   4
         Left            =   2160
         TabIndex        =   5
         Text            =   "txtData(4)"
         Top             =   1800
         Width           =   1395
      End
      Begin VB.TextBox txtData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   5
         Left            =   2160
         TabIndex        =   6
         Text            =   "txtData(5)"
         Top             =   2100
         Width           =   1395
      End
      Begin VB.TextBox txtData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   6
         Left            =   600
         TabIndex        =   7
         Text            =   "txtData(6)"
         Top             =   2670
         Width           =   3915
      End
      Begin VB.TextBox txtData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   0
         Left            =   2160
         TabIndex        =   1
         Text            =   "txtData(0)"
         Top             =   600
         Width           =   1395
      End
      Begin VB.TextBox txtData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   7
         Left            =   2160
         TabIndex        =   0
         Text            =   "txtData(7)"
         Top             =   300
         Width           =   2355
      End
      Begin VB.Label lblDesc 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Notes:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   6
         Left            =   600
         TabIndex        =   25
         Top             =   2430
         Width           =   1035
      End
      Begin VB.Label lblUnits 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "(see code)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   3600
         TabIndex        =   24
         Top             =   2130
         Width           =   915
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Default Flow Rate:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   60
         TabIndex        =   23
         Top             =   2130
         Width           =   2055
      End
      Begin VB.Label lblUnits 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "(see code)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   3600
         TabIndex        =   22
         Top             =   1830
         Width           =   915
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Design Flow Range:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   60
         TabIndex        =   21
         Top             =   1830
         Width           =   2055
      End
      Begin VB.Label lblUnits 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "(psig)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   3600
         TabIndex        =   20
         Top             =   1530
         Width           =   915
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Design Pressure:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   60
         TabIndex        =   19
         Top             =   1530
         Width           =   2055
      End
      Begin VB.Label lblUnits 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "(feet)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   3600
         TabIndex        =   18
         Top             =   1230
         Width           =   915
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Outside Diameter:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   60
         TabIndex        =   17
         Top             =   1230
         Width           =   2055
      End
      Begin VB.Label lblUnits 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "(lbs)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   3600
         TabIndex        =   16
         Top             =   930
         Width           =   915
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Maximum Capacity:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   60
         TabIndex        =   15
         Top             =   930
         Width           =   2055
      End
      Begin VB.Label lblUnits 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "(ft)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   3600
         TabIndex        =   14
         Top             =   630
         Width           =   915
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Internal Area:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   60
         TabIndex        =   13
         Top             =   630
         Width           =   2055
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Part Number:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   7
         Left            =   60
         TabIndex        =   12
         Top             =   330
         Width           =   2055
      End
   End
   Begin Threed.SSCommand cmdSave 
      Height          =   495
      Left            =   180
      TabIndex        =   26
      TabStop         =   0   'False
      Top             =   4410
      Width           =   1455
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      Caption         =   "&Save"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdCancel 
      Height          =   495
      Left            =   3480
      TabIndex        =   27
      TabStop         =   0   'False
      Top             =   4410
      Width           =   1455
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      Caption         =   "&Cancel"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
End
Attribute VB_Name = "frmEditAdsorberData"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

'Dim frmEditAdsorber_Cancelled As Integer
'Dim frmEditAdsorber_RunMode As Integer
'Const frmEditAdsorber_RunMode_QUERY_DATABASE = 1
'Const frmEditAdsorber_RunMode_EDIT_DATABASE = 2

'Dim frmEditAdsorberData_Cancelled As Integer
Dim frmEditAdsorberData_RunMode As Integer
Const frmEditAdsorberData_RunMode_NEW = 1
Const frmEditAdsorberData_RunMode_EDIT = 2
Dim frmEditAdsorberData_UsePhase As Integer

Dim USER_HIT_CANCEL As Boolean
Dim USER_HIT_SAVE As Boolean




Const frmEditAdsorberData_declarations_end = True


Sub frmEditAdsorberData_AddNew( _
    INPUT_PHASE As Integer, _
    OUTPUT_USER_HIT_CANCEL As Boolean)
  frmEditAdsorberData_RunMode = frmEditAdsorberData_RunMode_NEW
  frmEditAdsorberData_UsePhase = INPUT_PHASE
  frmEditAdsorberData.Show 1
  If (USER_HIT_CANCEL) Then
    OUTPUT_USER_HIT_CANCEL = True
  Else
    OUTPUT_USER_HIT_CANCEL = False
  End If
End Sub
Sub frmEditAdsorberData_Edit( _
    INPUT_PHASE As Integer, _
    OUTPUT_USER_HIT_CANCEL As Boolean)
  frmEditAdsorberData_RunMode = frmEditAdsorberData_RunMode_EDIT
  frmEditAdsorberData_UsePhase = INPUT_PHASE
  frmEditAdsorberData.Show 1
  If (USER_HIT_CANCEL) Then
    OUTPUT_USER_HIT_CANCEL = True
  Else
    OUTPUT_USER_HIT_CANCEL = False
  End If
End Sub


Sub frmEditAdsorberData_PopulateUnits()
  Call unitsys_register(frmEditAdsorberData, lblDesc(0), _
      txtData(0), Nothing, "", _
      "", "", "", "", 100#, False)
  Call unitsys_register(frmEditAdsorberData, lblDesc(1), _
      txtData(1), Nothing, "", _
      "", "", "", "", 100#, False)
  Call unitsys_register(frmEditAdsorberData, lblDesc(2), _
      txtData(2), Nothing, "", _
      "", "", "", "", 100#, False)
  Call unitsys_register(frmEditAdsorberData, lblDesc(5), _
      txtData(5), Nothing, "", _
      "", "", "", "", 100#, False)
End Sub


Private Sub cmdCancel_Click()
  'frmEditAdsorberData_Cancelled = True
  USER_HIT_CANCEL = True
  USER_HIT_SAVE = False
  Unload Me
End Sub
Private Sub cmdSave_Click()
Dim i As Integer
  For i = 0 To 7
    If (Trim$(txtData(i)) = "") Then
      Beep
      MsgBox "No data item can be set to an empty string; enter a non-empty string or hit Cancel.", vbExclamation, Application_Name
      Exit Sub
    End If
  Next i
  If (optPhase(1).Value) Then
    frmEditAdsorberData_Record.Phase = 1
  Else
    frmEditAdsorberData_Record.Phase = 2
  End If
  frmEditAdsorberData_Record.InternalArea = txtData(0)
  frmEditAdsorberData_Record.MaxCapacity = txtData(1)
  frmEditAdsorberData_Record.OutsideDiameter = txtData(2)
  frmEditAdsorberData_Record.DesignPressure = txtData(3)
  frmEditAdsorberData_Record.DesignFlowRange = txtData(4)
  frmEditAdsorberData_Record.DefaultFlowRate = txtData(5)
  frmEditAdsorberData_Record.Note = txtData(6)
  frmEditAdsorberData_Record.PartNumber = txtData(7)
  'frmEditAdsorberData_Cancelled = False
  USER_HIT_CANCEL = False
  USER_HIT_SAVE = True
  Unload Me
End Sub


Private Sub Form_Load()
Dim now_phase As Integer
Dim i As Integer
  'MISC INITS.
  Me.Height = 5505
  Me.Width = 5205
  Call CenterOnForm(Me, frmEditAdsorber)
  now_phase = frmEditAdsorberData_UsePhase
  If (now_phase = 1) Then
    optPhase(1).Value = True
    optPhase(2).Value = False
  Else
    optPhase(1).Value = False
    optPhase(2).Value = True
  End If
  If (frmEditAdsorberData_RunMode = frmEditAdsorberData_RunMode_NEW) Then
    'CREATE NEW RECORD
    frmEditAdsorberData_Record.PartNumber = "New Adsorber Code"
    frmEditAdsorberData_Record.InternalArea = "1"
    frmEditAdsorberData_Record.MaxCapacity = "1000"
    frmEditAdsorberData_Record.OutsideDiameter = "1"
    frmEditAdsorberData_Record.DesignPressure = "not available"
    frmEditAdsorberData_Record.DesignFlowRange = "1-10"
    frmEditAdsorberData_Record.DefaultFlowRate = "10"
    frmEditAdsorberData_Record.Note = "none"
  End If
  If (frmEditAdsorberData_RunMode = frmEditAdsorberData_RunMode_EDIT) Then
    'MODIFY EXISTING RECORD
'    txtData(0) = Trim$(frmEditAdsorberData_Record.InternalArea)
'    txtData(1) = Trim$(frmEditAdsorberData_Record.MaxCapacity)
'    txtData(2) = Trim$(frmEditAdsorberData_Record.OutsideDiameter)
'    txtData(3) = Trim$(frmEditAdsorberData_Record.DesignPressure)
'    txtData(4) = Trim$(frmEditAdsorberData_Record.DesignFlowRange)
'    txtData(5) = Trim$(frmEditAdsorberData_Record.DefaultFlowRate)
'    txtData(6) = Trim$(frmEditAdsorberData_Record.Note)
'    txtData(7) = Trim$(frmEditAdsorberData_Record.PartNumber)
  End If
  'POPULATE UNIT CONTROLS.
  Call frmEditAdsorberData_PopulateUnits
  'REFRESH DISPLAY.
  Call frmEditAdsorberData_Refresh
End Sub
Private Sub Form_Unload(Cancel As Integer)
  Call unitsys_unregister_all_on_form(Me)
End Sub


Private Sub optPhase_Click(Index As Integer, Value As Integer)
  If (optPhase(1).Value) Then
    'LIQUID PHASE
    lblUnits(4).Caption = "(gal/min)"
    lblUnits(5).Caption = "(gal/min)"
  Else
    'GAS PHASE
    lblUnits(4).Caption = "(ft/min)"
    lblUnits(5).Caption = "(ft/min)"
  End If
End Sub






Private Sub txtData_GotFocus(Index As Integer)
Dim Ctl As Control
Set Ctl = txtData(Index)
  If (Index = 7) Or (Index = 3) Or _
      (Index = 4) Or (Index = 6) Then
    Call Global_GotFocus(Ctl)
  Else
    Call unitsys_control_txtx_gotfocus(Ctl)
  End If
End Sub
Private Sub txtData_KeyPress(Index As Integer, KeyAscii As Integer)
  If (Index = 7) Or (Index = 3) Or _
      (Index = 4) Or (Index = 6) Then
    KeyAscii = Global_TextKeyPress(KeyAscii)
  Else
    KeyAscii = Global_NumericKeyPress(KeyAscii)
  End If
End Sub
Private Sub txtData_LostFocus(Index As Integer)
Dim NewValue_Okay As Integer
Dim NewValue As Double
Dim Ctl As Control
Set Ctl = txtData(Index)
Dim Val_Low As Double
Dim Val_High As Double
Dim Raise_Dirty_Flag As Boolean
Dim Too_Small As Integer
Dim OldValueStr As String
  'HANDLE STRING FIELDS.
  If (Index = 7) Or (Index = 3) Or _
      (Index = 4) Or (Index = 6) Then
    Select Case Index
      Case 7: OldValueStr = Trim$(frmEditAdsorberData_Record.PartNumber)
      Case 3: OldValueStr = Trim$(frmEditAdsorberData_Record.DesignPressure)
      Case 4: OldValueStr = Trim$(frmEditAdsorberData_Record.DesignFlowRange)
      Case 6: OldValueStr = Trim$(frmEditAdsorberData_Record.Note)
    End Select
    If (Trim$(Ctl.Text) = "") Then
      Ctl.Text = OldValueStr
      'Call Show_Error("You must enter a non-blank string for the carbon name.")
      'NOTE: SHOWING THIS ERROR MESSAGE MESSES UP THE
      'SUBSEQUENT GOTFOCUS IF THE USER HITS <Enter> OR <Tab>.
    Else
      If (Trim$(OldValueStr) <> Trim$(Ctl.Text)) Then
        Select Case Index
          Case 7: frmEditAdsorberData_Record.PartNumber = Trim$(Ctl.Text)
          Case 3: frmEditAdsorberData_Record.DesignPressure = Trim$(Ctl.Text)
          Case 4: frmEditAdsorberData_Record.DesignFlowRange = Trim$(Ctl.Text)
          Case 6: frmEditAdsorberData_Record.Note = Trim$(Ctl.Text)
        End Select
        ''THROW DIRTY FLAG.
        'Call DirtyStatus_Throw
      End If
    End If
    Call Global_LostFocus(Ctl)
    'Call GenericStatus_Set("")
    Exit Sub
  End If
  'NOTE: LOW AND HIGH VALUES IN BASE UNITS.
  Select Case Index
    Case 0: Val_Low = 1E-20: Val_High = 1E+20
    Case 1: Val_Low = 1E-20: Val_High = 1E+20
    Case 2: Val_Low = 1E-20: Val_High = 1E+20
    Case 5: Val_Low = 1E-20: Val_High = 1E+20
  End Select
  NewValue_Okay = False
  If (unitsys_control_txtx_lostfocus_validate(Ctl, Val_Low, Val_High, NewValue, Raise_Dirty_Flag)) Then
    NewValue_Okay = True
  End If
  Call unitsys_control_txtx_lostfocus(Ctl, NewValue)
  If (NewValue_Okay) Then
    If (Raise_Dirty_Flag) Then
      'STORE TO MEMORY.
      Select Case Index
        Case 0:         'INTERNAL AREA.
          frmEditAdsorberData_Record.InternalArea = Trim$(Str$(NewValue))
        Case 1:         'MAXIMUM CAPACITY.
          frmEditAdsorberData_Record.MaxCapacity = Trim$(Str$(NewValue))
        Case 2:         'OUTSIDE DIAMETER.
          frmEditAdsorberData_Record.OutsideDiameter = Trim$(Str$(NewValue))
        Case 5:         'DEFAULT FLOW RATE.
          frmEditAdsorberData_Record.DefaultFlowRate = Trim$(Str$(NewValue))
      End Select
      'RAISE DIRTY FLAG IF NECESSARY.
      If (Raise_Dirty_Flag) Then
        ''THROW DIRTY FLAG.
        'Call frmCompoProp_DirtyStatus_Throw
      End If
      'REFRESH WINDOW.
      Call frmEditAdsorberData_Refresh
    End If
  End If
End Sub



VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmEditCarbon 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Adsorbent Database"
   ClientHeight    =   6600
   ClientLeft      =   420
   ClientTop       =   1245
   ClientWidth     =   9480
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   6600
   ScaleWidth      =   9480
   Begin Threed.SSFrame SSFrame1 
      Height          =   2565
      Left            =   180
      TabIndex        =   0
      Top             =   240
      Width           =   3735
      _Version        =   65536
      _ExtentX        =   6588
      _ExtentY        =   4524
      _StockProps     =   14
      Caption         =   "Select a Manufacturer:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.ListBox lstManu 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1980
         Left            =   120
         TabIndex        =   3
         Top             =   390
         Width           =   3495
      End
      Begin VB.Label lblEmpty_lstManu 
         Alignment       =   2  'Center
         Caption         =   "No Manufacturers Available"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   525
         Left            =   120
         TabIndex        =   31
         Top             =   240
         Visible         =   0   'False
         Width           =   3495
      End
   End
   Begin Threed.SSFrame SSFrame2 
      Height          =   4305
      Left            =   4140
      TabIndex        =   1
      Top             =   240
      Width           =   5145
      _Version        =   65536
      _ExtentX        =   9075
      _ExtentY        =   7594
      _StockProps     =   14
      Caption         =   "Adsorbent Properties:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BackStyle       =   0  'Transparent
         Caption         =   "Apparent Density"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   450
         TabIndex        =   29
         Top             =   540
         Width           =   1755
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BackStyle       =   0  'Transparent
         Caption         =   "Particle Radius"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   450
         TabIndex        =   28
         Top             =   900
         Width           =   1755
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BackStyle       =   0  'Transparent
         Caption         =   "Particle Porosity"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   450
         TabIndex        =   27
         Top             =   1260
         Width           =   1755
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "lblData(0)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   2370
         TabIndex        =   26
         Top             =   525
         Width           =   1095
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "lblData(1)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   2370
         TabIndex        =   25
         Top             =   885
         Width           =   1095
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "lblData(2)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   2370
         TabIndex        =   24
         Top             =   1245
         Width           =   1095
      End
      Begin VB.Label lblUnit 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "g/cm3"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   3570
         TabIndex        =   23
         Top             =   540
         Width           =   975
      End
      Begin VB.Label lblUnit 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "cm"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   3570
         TabIndex        =   22
         Top             =   900
         Width           =   975
      End
      Begin VB.Label lblUnit 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "-"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   3570
         TabIndex        =   21
         Top             =   1260
         Width           =   975
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "lblData(3)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   2370
         TabIndex        =   20
         Top             =   1605
         Width           =   2175
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BackStyle       =   0  'Transparent
         Caption         =   "Adsorbent Type"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   450
         TabIndex        =   19
         Top             =   1620
         Width           =   1755
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "lblData(4)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   2370
         TabIndex        =   18
         Top             =   1965
         Width           =   1095
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "lblData(5)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   2370
         TabIndex        =   17
         Top             =   2325
         Width           =   1095
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "lblData(6)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   6
         Left            =   2370
         TabIndex        =   16
         Top             =   2685
         Width           =   1095
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BackStyle       =   0  'Transparent
         Caption         =   "Polanyi W0"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   450
         TabIndex        =   15
         Top             =   1980
         Width           =   1755
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BackStyle       =   0  'Transparent
         Caption         =   "Polanyi B"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   450
         TabIndex        =   14
         Top             =   2340
         Width           =   1755
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BackStyle       =   0  'Transparent
         Caption         =   "Polanyi Exponent"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   6
         Left            =   450
         TabIndex        =   13
         Top             =   2700
         Width           =   1755
      End
      Begin VB.Label lblUnit 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "cm3/g"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   3570
         TabIndex        =   12
         Top             =   1980
         Width           =   975
      End
      Begin VB.Label lblUnit 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "*"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   3570
         TabIndex        =   11
         Top             =   2340
         Width           =   975
      End
      Begin VB.Label lblUnit 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "-"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   6
         Left            =   3570
         TabIndex        =   10
         Top             =   2700
         Width           =   975
      End
      Begin VB.Label lblUnitB 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "* in (mol/cal) ^(Polanyi Exponent)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   1590
         TabIndex        =   9
         Top             =   3180
         Width           =   2925
      End
   End
   Begin Threed.SSFrame SSFrame3 
      Height          =   3285
      Left            =   180
      TabIndex        =   2
      Top             =   3030
      Width           =   3735
      _Version        =   65536
      _ExtentX        =   6588
      _ExtentY        =   5794
      _StockProps     =   14
      Caption         =   "Select an Adsorbent:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.ListBox lstName 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   2370
         Left            =   120
         TabIndex        =   6
         Top             =   720
         Width           =   3495
      End
      Begin Threed.SSOption optPhase 
         Height          =   375
         Index           =   0
         Left            =   240
         TabIndex        =   4
         Top             =   240
         Width           =   1575
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "&Liquid Phase"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   16.5
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSOption optPhase 
         Height          =   375
         Index           =   1
         Left            =   2040
         TabIndex        =   5
         Top             =   240
         Width           =   1215
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "&Gas Phase"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   16.5
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin VB.Label lblEmpty_lstName 
         Alignment       =   2  'Center
         Caption         =   "No Adsorbents Available"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   525
         Left            =   120
         TabIndex        =   30
         Top             =   570
         Visible         =   0   'False
         Width           =   3495
      End
   End
   Begin Threed.SSCommand cmdOK 
      Height          =   615
      Left            =   4140
      TabIndex        =   7
      Top             =   5730
      Width           =   4035
      _Version        =   65536
      _ExtentX        =   7117
      _ExtentY        =   1085
      _StockProps     =   78
      Caption         =   "&Use These Adsorbent Specifications"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdCancel 
      Height          =   615
      Left            =   8160
      TabIndex        =   8
      Top             =   5730
      Width           =   1125
      _Version        =   65536
      _ExtentX        =   1984
      _ExtentY        =   1085
      _StockProps     =   78
      Caption         =   "&Cancel"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin VB.Menu mnuManufacturer 
      Caption         =   "&Manufacturer"
      Begin VB.Menu mnuManufacturerItem 
         Caption         =   "&New"
         Index           =   1
      End
      Begin VB.Menu mnuManufacturerItem 
         Caption         =   "&Edit Current"
         Index           =   2
      End
      Begin VB.Menu mnuManufacturerItem 
         Caption         =   "&Delete Current"
         Index           =   3
      End
   End
   Begin VB.Menu mnuAdsorbent 
      Caption         =   "&Adsorbent"
      Begin VB.Menu mnuAdsorbentItem 
         Caption         =   "&New"
         Index           =   1
      End
      Begin VB.Menu mnuAdsorbentItem 
         Caption         =   "&Edit Current"
         Index           =   2
      End
      Begin VB.Menu mnuAdsorbentItem 
         Caption         =   "&Delete Current"
         Index           =   3
      End
   End
End
Attribute VB_Name = "frmEditCarbon"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Dim FORM_MODE As Integer
Const FORM_MODE_QUERY_DATABASE = 1
Const FORM_MODE_EDIT_DATABASE = 2

Dim USER_HIT_CANCEL As Boolean
Dim USER_HIT_USE_THESE As Boolean

Dim DB_Carbon As Database

Private LocalCarbon_Record As frmEditCarbonData_Record_Type




Const frmEditCarbon_declarations_end = True


Sub frmEditCarbon_QueryDatabase( _
    OUTPUT_User_Transferred_Data As Boolean)
  
  On Error GoTo err_frmEditCarbon_QueryDatabase
  'NOTE: THE FOLLOWING OpenDatabase() COMMAND MUST BE
  'SPECIFIED EXACTLY AS-IS, OR ELSE IT WILL FAIL.
  Set DB_Carbon = _
      ws1.OpenDatabase(fn_DB_Carbon, True, False, _
      ";pwd=" & decrypt_string(Encrypted_User_Password))
  'Set DB_Carbon = ws1.OpenDatabase(fn_DB_Carbon)
  FORM_MODE = FORM_MODE_QUERY_DATABASE
  frmEditCarbon.Show 1
  If (USER_HIT_USE_THESE) Then
    OUTPUT_User_Transferred_Data = True
  Else
    OUTPUT_User_Transferred_Data = False
  End If
  DB_Carbon.Close
  Exit Sub
exit_err_frmEditCarbon_QueryDatabase:
  Exit Sub
err_frmEditCarbon_QueryDatabase:
  Call Show_Trapped_Error("frmEditCarbon_QueryDatabase")
  OUTPUT_User_Transferred_Data = False
  Resume exit_err_frmEditCarbon_QueryDatabase
End Sub
Sub frmEditCarbon_EditDatabase()
  On Error GoTo err_frmEditCarbon_EditDatabase
  'NOTE: THE FOLLOWING OpenDatabase() COMMAND MUST BE
  'SPECIFIED EXACTLY AS-IS, OR ELSE IT WILL FAIL.
  Set DB_Carbon = _
      ws1.OpenDatabase(fn_DB_Carbon, True, False, _
      ";pwd=" & decrypt_string(Encrypted_User_Password))
  'Set DB_Carbon = ws1.OpenDatabase(fn_DB_Carbon)
  FORM_MODE = FORM_MODE_EDIT_DATABASE
  frmEditCarbon.Show 1
  DB_Carbon.Close
  Exit Sub
exit_err_frmEditCarbon_EditDatabase:
  Exit Sub
err_frmEditCarbon_EditDatabase:
  Call Show_Trapped_Error("frmEditCarbon_EditDatabase")
  Resume exit_err_frmEditCarbon_EditDatabase
End Sub


Sub populate_lstManu()
Dim RS1 As Recordset
Dim Current_Criteria As String
Dim SAVE_CURRENT_POSITION As Long
Dim NEW_LISTINDEX As Integer
Dim This_ID As Long
Dim NumRecords As Long
  On Error GoTo err_populate_lstManu
  'SAVE CURRENT POSITION.
  If (lstManu.ListCount > 0) And (lstManu.ListIndex >= 0) Then
    SAVE_CURRENT_POSITION = lstManu.ItemData(lstManu.ListIndex)
  Else
    SAVE_CURRENT_POSITION = -1
  End If
  'SET UP SEARCH CRITERIA.
  Current_Criteria = "select * from [Manufacturers] " & _
      "order by [Name]"
  'START SEARCH.
  Set RS1 = _
      DB_Carbon.OpenRecordset(Current_Criteria)
  On Error Resume Next
  RS1.MoveFirst
  RS1.MoveLast
  RS1.MoveFirst
  NumRecords = RS1.RecordCount
  On Error GoTo err_populate_lstManu
  'POPULATE LISTBOX.
  lstManu.Clear
  If (NumRecords = 0) Then
    'NO RECORDS AVAILABLE.
    lstManu.Visible = False
    lblEmpty_lstManu.Move lstManu.Left, lstManu.Top
    lblEmpty_lstManu.Visible = True
  Else
    'DISPLAY RECORDS.
    lstManu.Visible = True
    lblEmpty_lstManu.Visible = False
    NEW_LISTINDEX = 0
    Do Until RS1.EOF
      lstManu.AddItem Database_Get_String(RS1, "Name")
      This_ID = Database_Get_Long(RS1, "Manufacturer ID")
      lstManu.ItemData(lstManu.NewIndex) = This_ID
      If (SAVE_CURRENT_POSITION <> -1) Then
        If (SAVE_CURRENT_POSITION = This_ID) Then
          NEW_LISTINDEX = lstManu.NewIndex
        End If
      End If
      RS1.MoveNext
    Loop
    If (lstManu.ListCount > 0) Then
      lstManu.ListIndex = NEW_LISTINDEX
    End If
  End If
  'CLOSE DATABASE AND EXIT.
  RS1.Close
  Exit Sub
exit_err_populate_lstManu:
  Exit Sub
err_populate_lstManu:
  Call Show_Trapped_Error("populate_lstManu")
  Resume exit_err_populate_lstManu
End Sub
Sub populate_lstName(THIS_ITEMDATA As Long)
Dim PHASE_CODE As Integer
Dim RS1 As Recordset
Dim Current_Criteria As String
Dim SAVE_CURRENT_POSITION As Long
Dim This_ID As Long
Dim NEW_LISTINDEX As Long
Dim NumRecords As Long
  On Error GoTo err_populate_lstName
  'GET PHASE CODE.
  If (optPhase(0).Value) Then PHASE_CODE = 1
  If (optPhase(1).Value) Then PHASE_CODE = 2
  'SAVE CURRENT POSITION.
  If (lstName.ListCount > 0) And (lstName.ListIndex >= 0) Then
    SAVE_CURRENT_POSITION = lstName.ItemData(lstName.ListIndex)
  Else
    SAVE_CURRENT_POSITION = -1
  End If
  'SET UP SEARCH CRITERIA.
  Current_Criteria = "select * from [Carbon Data] " & _
      "where [Manufacturer ID]=" & _
      Trim$(Str$(THIS_ITEMDATA)) & " and " & _
      "[Phase ID]=" & Trim$(Str$(PHASE_CODE)) & " " & _
      "order by [Name]"
  'START SEARCH.
  Set RS1 = _
      DB_Carbon.OpenRecordset(Current_Criteria)
  On Error Resume Next
  RS1.MoveFirst
  RS1.MoveLast
  RS1.MoveFirst
  NumRecords = RS1.RecordCount
  On Error GoTo err_populate_lstName
  'POPULATE LISTBOX.
  lstName.Clear
  If (NumRecords = 0) Then
    'NO RECORDS AVAILABLE.
    lstName.Visible = False
    lblEmpty_lstName.Move lstName.Left, lstName.Top
    lblEmpty_lstName.Visible = True
  Else
    'DISPLAY RECORDS.
    lstName.Visible = True
    lblEmpty_lstName.Visible = False
    NEW_LISTINDEX = 0
    Do Until RS1.EOF
      lstName.AddItem Database_Get_String(RS1, "Name")
      This_ID = Database_Get_Long(RS1, "ID")
      lstName.ItemData(lstName.NewIndex) = This_ID
      If (SAVE_CURRENT_POSITION <> -1) Then
        If (SAVE_CURRENT_POSITION = This_ID) Then
          NEW_LISTINDEX = lstName.NewIndex
        End If
      End If
      RS1.MoveNext
    Loop
    If (lstName.ListCount > 0) Then
      lstName.ListIndex = NEW_LISTINDEX
    End If
  End If
  'CLOSE DATABASE AND EXIT.
  RS1.Close
  Exit Sub
exit_err_populate_lstName:
  Exit Sub
err_populate_lstName:
  Call Show_Trapped_Error("populate_lstName")
  Resume exit_err_populate_lstName
End Sub
Sub populate_lblData(THIS_ITEMDATA As Long)
Dim RS1 As Recordset
Dim NumRecords As Long
Dim Current_Criteria As String
Dim TempDbl As Double
  On Error GoTo err_populate_lblData
  'SET UP SEARCH CRITERIA.
  Current_Criteria = "select * from [Carbon Data] " & _
      "where [ID]=" & _
      Trim$(Str$(THIS_ITEMDATA)) & " " & _
      "order by [Name]"
  'START SEARCH.
  Set RS1 = _
      DB_Carbon.OpenRecordset(Current_Criteria)
  On Error Resume Next
  RS1.MoveFirst
  RS1.MoveLast
  RS1.MoveFirst
  NumRecords = RS1.RecordCount
  On Error GoTo err_populate_lblData
  'POPULATE LABEL CONTROLS.
  If (NumRecords = 0) Then
    'NO RECORD(S) AVAILABLE; WEIRD PROBLEM.
    'DO NOTHING.
  Else
    'DISPLAY (FIRST) RECORD (THERE SHOULD ONLY BE ONE).
    LocalCarbon_Record.Name = Database_Get_String(RS1, "Name")
    LocalCarbon_Record.AppDen = Database_Get_Double(RS1, "Apparent Density")
        'NOTE: RADIUS IN DATABASE IS STORED IN millimeters;
        'DIVISION BY 10 CONVERTS THIS TO centimers.
    LocalCarbon_Record.ParticleRadius = _
        Database_Get_Double(RS1, "Average Particle Radius") / 10#
    LocalCarbon_Record.ParticlePorosity = Database_Get_Double(RS1, "Porosity")
    LocalCarbon_Record.AdsType = Database_Get_String(RS1, "Type")
    Call AssignCaptionAndTag(lblData(0), LocalCarbon_Record.AppDen)
    Call AssignCaptionAndTag(lblData(1), LocalCarbon_Record.ParticleRadius)
    Call AssignCaptionAndTag(lblData(2), LocalCarbon_Record.ParticlePorosity)
    Call AssignCaptionAndTag(lblData(3), LocalCarbon_Record.AdsType)
    TempDbl = Database_Get_Double(RS1, "W0")
    LocalCarbon_Record.W0 = TempDbl
    If (TempDbl = 0#) Then
      Call AssignCaptionAndTag(lblData(4), "Unavailable")
    Else
      Call AssignCaptionAndTag(lblData(4), TempDbl)
    End If
    TempDbl = Database_Get_Double(RS1, "BB")
    LocalCarbon_Record.BB = TempDbl
    If (TempDbl = 0#) Then
      Call AssignCaptionAndTag(lblData(5), "Unavailable")
    Else
      Call AssignCaptionAndTag(lblData(5), TempDbl)
    End If
    TempDbl = Database_Get_Double(RS1, "Polanyi Exponent")
    LocalCarbon_Record.PolanyiExponent = TempDbl
    If (TempDbl = 0#) Then
      Call AssignCaptionAndTag(lblData(6), "Unavailable")
    Else
      Call AssignCaptionAndTag(lblData(6), TempDbl)
    End If
  End If
  'CLOSE DATABASE AND EXIT.
  RS1.Close
  Exit Sub
exit_err_populate_lblData:
  Exit Sub
err_populate_lblData:
  Call Show_Trapped_Error("populate_lblData")
  Resume exit_err_populate_lblData
End Sub


Private Sub cmdCancel_Click()
  'frmEditAdsorber_Cancelled = True
  USER_HIT_CANCEL = True
  USER_HIT_USE_THESE = False
  Unload Me
End Sub
Private Sub cmdOK_Click()
  If (lstManu.ListIndex < 0) Or (lstManu.ListCount = 0) Then
    Call Show_Error("You must first select a manufacturer.")
    Exit Sub
  End If
  If (lstName.ListIndex < 0) Or (lstName.ListCount = 0) Then
    Call Show_Error("You must first select an adsorbent.")
    Exit Sub
  End If
  If (LocalCarbon_Record.AppDen = 0#) Or _
      (LocalCarbon_Record.ParticlePorosity = 0#) Or _
      (LocalCarbon_Record.ParticleRadius = 0#) Then
    Call Show_Error("You must select an adsorbent with non-zero values " & _
        "for apparent density, particle porosity, and particle radius.")
    Exit Sub
  End If
  'TRANSFER DATA TO CURRENT CARBON RECORD.
  Carbon.Density = LocalCarbon_Record.AppDen
  Carbon.ParticleRadius = LocalCarbon_Record.ParticleRadius / 100#
  Carbon.Porosity = LocalCarbon_Record.ParticlePorosity
  Carbon.ShapeFactor = 1#
  Carbon.W0 = LocalCarbon_Record.W0
  Carbon.BB = LocalCarbon_Record.BB
  Carbon.PolanyiExponent = LocalCarbon_Record.PolanyiExponent
  'EXIT OUT OF HERE.
  USER_HIT_CANCEL = False
  USER_HIT_USE_THESE = True
  Unload Me
End Sub


Private Sub Form_Load()
  'MISC INITS.
  Me.Height = 7290
  Me.Width = 9600
  Call CenterOnForm(Me, frmMain)
  lblUnit(0).Caption = "g/cm"
  lblUnit(4).Caption = "cm/g"
  If (FORM_MODE = FORM_MODE_QUERY_DATABASE) Then
    'QUERY DATABASE MODE.
    cmdOK.Visible = True
    cmdCancel.Visible = True
    cmdCancel.Caption = "&Cancel"
  Else
    'EDIT DATABASE MODE.
    cmdOK.Visible = False
    cmdCancel.Visible = True
    cmdCancel.Caption = "E&xit"
  End If
  If (Bed.Phase = 0) Then
    optPhase(0).Value = True
    optPhase(1).Value = False
  Else
    optPhase(0).Value = False
    optPhase(1).Value = True
  End If
  'RE-POPULATE MANUFACTURER LIST.
  Call populate_lstManu
End Sub


Private Sub lstManu_Click()
Dim THIS_ITEMDATA As Long
  If (lstManu.ListIndex < 0) Or (lstManu.ListCount <= 0) Then
    Exit Sub
  End If
  THIS_ITEMDATA = lstManu.ItemData(lstManu.ListIndex)
  Call populate_lstName(THIS_ITEMDATA)
End Sub
Private Sub lstManu_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
  If ((Button And 2) = 2) Then
    Me.PopupMenu mnuManufacturer
  End If
End Sub
Private Sub lstName_Click()
Dim THIS_ITEMDATA As Long
  If (lstName.ListIndex < 0) Or (lstName.ListCount <= 0) Then
    Exit Sub
  End If
  THIS_ITEMDATA = lstName.ItemData(lstName.ListIndex)
  Call populate_lblData(THIS_ITEMDATA)
End Sub
Private Sub lstName_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
  If ((Button And 2) = 2) Then
    Me.PopupMenu mnuAdsorbent
  End If
End Sub


Private Sub mnuAdsorbentItem_Click(index As Integer)
Dim USER_HIT_CANCEL As Boolean
Dim USER_HIT_SAVE As Boolean
Dim USER_HIT_SAVEASNEW As Boolean
Dim THIS_MANU_ID As Long
Dim THIS_ADS_ID As Long
Dim Current_Criteria As String
Dim RS1 As Recordset
Dim NumRecords As Long
Dim DEFAULT_PHASE_IS_LIQUID As Boolean
Const INDEX_NEW = 1
Const INDEX_EDIT = 2
Const INDEX_DELETE = 3
Dim NewName As String
Dim msg As String
Dim RetVal As Integer
Dim Select_Index As Integer
Dim i As Integer
  On Error GoTo err_mnuAdsorbentItem_Click
  If (lstManu.ListIndex < 0) Or (lstManu.ListCount = 0) Then
    Call Show_Error("You must first select a manufacturer.")
    Exit Sub
  End If
  THIS_MANU_ID = lstManu.ItemData(lstManu.ListIndex)
  If (index = INDEX_EDIT) Or (index = INDEX_DELETE) Then
    If (lstName.ListIndex < 0) Or (lstName.ListCount = 0) Then
      Call Show_Error("You must first select an adsorbent.")
      Exit Sub
    End If
    THIS_ADS_ID = lstName.ItemData(lstName.ListIndex)
    'SET UP SEARCH CRITERIA.
    Current_Criteria = "select * from [Carbon Data] " & _
        "where [ID]=" & _
        Trim$(Str$(THIS_ADS_ID)) & " " & _
        "order by [Name]"
    'START SEARCH.
    Set RS1 = _
        DB_Carbon.OpenRecordset(Current_Criteria)
    On Error Resume Next
    RS1.MoveFirst
    RS1.MoveLast
    RS1.MoveFirst
    NumRecords = RS1.RecordCount
    On Error GoTo err_mnuAdsorbentItem_Click
    'POPULATE LABEL CONTROLS.
    If (NumRecords = 0) Then
      'NO RECORD(S) AVAILABLE; WEIRD PROBLEM.
      'EXIT SUBROUTINE.
      Exit Sub
    End If
      'Call AssignCaptionAndTag(lblData(0), Database_Get_Double(RS1, "Apparent Density"))
      'Call AssignCaptionAndTag(lblData(1), Database_Get_Double(RS1, "Average Particle Radius"))
      'Call AssignCaptionAndTag(lblData(2), Database_Get_Double(RS1, "Porosity"))
      'Call AssignCaptionAndTag(lblData(3), Database_Get_String(RS1, "Type"))
  End If
  Select Case index
    Case INDEX_NEW:     'NEW ADSORBENT.
      'DETERMINE DEFAULT PHASE.
      If (optPhase(0).Value) Then
        DEFAULT_PHASE_IS_LIQUID = True
      Else
        DEFAULT_PHASE_IS_LIQUID = False
      End If
      'ALLOW USER TO ADD NEW RECORD.
      Call frmEditCarbonData.frmEditCarbonData_AddNew( _
          DEFAULT_PHASE_IS_LIQUID, _
          USER_HIT_CANCEL, _
          USER_HIT_SAVE)
      If (USER_HIT_CANCEL) Then Exit Sub
      'ADD THE NEW ADSORBENT RECORD.
      Current_Criteria = "select * from [Carbon Data]"
      Set RS1 = _
          DB_Carbon.OpenRecordset(Current_Criteria)
      RS1.AddNew
      'SET THE MANUFACTURER-ID AND PHASE FIELDS.
      RS1("Manufacturer ID") = THIS_MANU_ID
      If (frmEditCarbonData_Record.PhaseIsLiquid) Then
        RS1("Phase ID") = 1
      Else
        RS1("Phase ID") = 2
      End If
      'THE FIELD [ID] IS AUTOMATICALLY UPDATED.
      RS1("Name") = frmEditCarbonData_Record.Name
      RS1("Type") = frmEditCarbonData_Record.AdsType
      RS1("Apparent Density") = frmEditCarbonData_Record.AppDen
      RS1("Average Particle Radius") = frmEditCarbonData_Record.ParticleRadius
      RS1("Porosity") = frmEditCarbonData_Record.ParticlePorosity
      RS1("W0") = frmEditCarbonData_Record.W0
      RS1("BB") = frmEditCarbonData_Record.BB
      RS1("Polanyi Exponent") = frmEditCarbonData_Record.PolanyiExponent
      THIS_ADS_ID = Database_Get_Long(RS1, "ID")
      RS1.Update
      'CLOSE THE DATABASE.
      RS1.Close
      'UPDATE WINDOW.
      Call lstManu_Click
      'SELECT THE NEW ADSORBENT.
      Select_Index = 0
      For i = 0 To lstName.ListCount - 1
        If (lstName.ItemData(i) = THIS_ADS_ID) Then
          Select_Index = i
          Exit For
        End If
      Next i
      If (lstName.ListCount > 0) Then
        lstName.ListIndex = Select_Index
      End If
    Case INDEX_EDIT:     'EDIT ADSORBENT.
      'TRANSFER DATABASE RECORD FIELDS TO LOCAL MEMORY.
      If (Database_Get_Long(RS1, "Phase ID") = 1) Then
        frmEditCarbonData_Record.PhaseIsLiquid = True
      Else
        frmEditCarbonData_Record.PhaseIsLiquid = False
      End If
      frmEditCarbonData_Record.AppDen = Database_Get_Double(RS1, "Apparent Density")
      frmEditCarbonData_Record.ParticleRadius = Database_Get_Double(RS1, "Average Particle Radius")
      frmEditCarbonData_Record.ParticlePorosity = Database_Get_Double(RS1, "Porosity")
      frmEditCarbonData_Record.W0 = Database_Get_Double(RS1, "W0")
      frmEditCarbonData_Record.BB = Database_Get_Double(RS1, "BB")
      frmEditCarbonData_Record.PolanyiExponent = Database_Get_Double(RS1, "Polanyi Exponent")
      frmEditCarbonData_Record.Name = Database_Get_String(RS1, "Name")
      frmEditCarbonData_Record.AdsType = Database_Get_String(RS1, "Type")
      'ALLOW USER TO EDIT THIS RECORD.
      Call frmEditCarbonData.frmEditCarbonData_Edit( _
          USER_HIT_CANCEL, _
          USER_HIT_SAVE, _
          USER_HIT_SAVEASNEW)
      If (USER_HIT_CANCEL) Then Exit Sub
      'SAVE THE EDITED ADSORBENT RECORD.
      Current_Criteria = "select * from [Carbon Data] " & _
          "where [ID]=" & Trim$(Str$(THIS_ADS_ID))
      Set RS1 = _
          DB_Carbon.OpenRecordset(Current_Criteria)
      'SET THE MANUFACTURER-ID AND PHASE FIELDS.
      If (USER_HIT_SAVE) Then
        'MODIFY EXISTING RECORD.
        RS1.Edit
        'KEEP ORIGINAL [Manufacturer ID] FIELD INTACT.
        'KEEP ORIGINAL [ID] FIELD INTACT.
      End If
      If (USER_HIT_SAVEASNEW) Then
        'GENERATE NEW RECORD.
        RS1.AddNew
        'SAVE [Manufacturer ID] FIELD.
        RS1("Manufacturer ID") = THIS_MANU_ID
        'THE FIELD [ID] IS AUTOMATICALLY CREATED DURING THE .Update COMMAND.
      End If
      If (frmEditCarbonData_Record.PhaseIsLiquid) Then
        RS1("Phase ID") = 1
      Else
        RS1("Phase ID") = 2
      End If
      RS1("Name") = frmEditCarbonData_Record.Name
      RS1("Type") = frmEditCarbonData_Record.AdsType
      RS1("Apparent Density") = frmEditCarbonData_Record.AppDen
      RS1("Average Particle Radius") = frmEditCarbonData_Record.ParticleRadius
      RS1("Porosity") = frmEditCarbonData_Record.ParticlePorosity
      RS1("W0") = frmEditCarbonData_Record.W0
      RS1("BB") = frmEditCarbonData_Record.BB
      RS1("Polanyi Exponent") = frmEditCarbonData_Record.PolanyiExponent
      RS1.Update
      'CLOSE THE DATABASE.
      RS1.Close
      'UPDATE WINDOW.
      Call lstManu_Click
    Case INDEX_DELETE:     'DELETE ADSORBENT.
      NewName = Trim$(lstName.List(lstName.ListIndex))
      msg = "Do you really want to delete adsorbent '" & _
          NewName & "' ?"
      RetVal = MsgBox(msg, vbCritical + vbYesNo, Application_Name)
      If RetVal = vbNo Then Exit Sub
      'PERFORM DELETION.
      Current_Criteria = "select * from [Carbon Data] where " & _
          "[ID] = " & Trim$(Str$(THIS_ADS_ID))
      Set RS1 = _
          DB_Carbon.OpenRecordset(Current_Criteria)
      RS1.Delete
      'CLOSE THE DATABASE.
      RS1.Close
      'UPDATE WINDOW.
      Call lstManu_Click
  End Select
  Exit Sub
exit_err_mnuAdsorbentItem_Click:
  Exit Sub
err_mnuAdsorbentItem_Click:
  Call Show_Trapped_Error("mnuAdsorbentItem_Click")
  Resume exit_err_mnuAdsorbentItem_Click
End Sub
Private Sub mnuManufacturerItem_Click(index As Integer)
Dim THIS_MANU_ID As Long
Dim NewName As String
'Dim USER_HIT_CANCEL As Boolean
Dim Current_Criteria As String
Dim RS1 As Recordset
Dim msg As String
Dim RetVal As Integer
Dim i As Integer
Dim Select_Index As Integer
Dim NumRecords As Integer
  On Error GoTo err_mnuManufacturerItem_Click
  If (index = 2) Or (index = 3) Then
    If (lstManu.ListIndex < 0) Or (lstManu.ListCount = 0) Then
      Call Show_Error("You must first select a manufacturer.")
      Exit Sub
    End If
    THIS_MANU_ID = lstManu.ItemData(lstManu.ListIndex)
  End If
  Select Case index
    Case 1:     'new
      NewName = "New Manufacturer"
      Do While (1 = 1)
        NewName = frmNewName.frmNewName_GetName( _
            "Creating New Manufacturer", _
            "Each manufacturer record should have a unique name.", _
            NewName, _
            USER_HIT_CANCEL)
        If (USER_HIT_CANCEL) Then Exit Sub
        NewName = Trim$(NewName)
        If (NewName <> "") Then Exit Do
        Call Show_Error("Manufacturer name must be a non-blank string.")
      Loop
      'ADD THE NEW MANUFACTURER RECORD.
      Current_Criteria = "select * from [Manufacturers]"
      Set RS1 = _
          DB_Carbon.OpenRecordset(Current_Criteria)
      RS1.AddNew
      'THE FIELD [Manufacturer ID] IS AUTOMATICALLY UPDATED.
      RS1("Name") = NewName
      THIS_MANU_ID = Database_Get_Long(RS1, "Manufacturer ID")
      RS1.Update
      RS1.Close
      'REDISPLAY WINDOW.
      Call populate_lstManu
      'SELECT THE NEW MANUFACTURER.
      Select_Index = 0
      For i = 0 To lstManu.ListCount - 1
        If (lstManu.ItemData(i) = THIS_MANU_ID) Then
          Select_Index = i
          Exit For
        End If
      Next i
      If (lstManu.ListCount > 0) Then
        lstManu.ListIndex = Select_Index
      End If
    Case 2:     'edit current
      NewName = Trim$(lstManu.List(lstManu.ListIndex))
      Do While (1 = 1)
        NewName = frmNewName.frmNewName_GetName( _
            "Editing Existing Manufacturer Name", _
            "Each manufacturer record should have a unique name.", _
            NewName, _
            USER_HIT_CANCEL)
        If (USER_HIT_CANCEL) Then Exit Sub
        NewName = Trim$(NewName)
        If (NewName <> "") Then Exit Do
        Call Show_Error("Manufacturer name must be a non-blank string.")
      Loop
      'EDIT THE MANUFACTURER RECORD.
      Current_Criteria = "select * from [Manufacturers] where " & _
          "[Manufacturer ID] = " & Trim$(Str$(THIS_MANU_ID))
      Set RS1 = _
          DB_Carbon.OpenRecordset(Current_Criteria)
      RS1.Edit
      RS1("Name") = NewName
      RS1.Update
      RS1.Close
      'REDISPLAY WINDOW.
      Call populate_lstManu
    Case 3:     'delete current
      NewName = Trim$(lstManu.List(lstManu.ListIndex))
      msg = "Do you really want to delete manufacturer '" & _
          NewName & "' and all of the corresponding adsorbent " & _
          "records from the database ?"
      RetVal = MsgBox(msg, vbCritical + vbYesNo, Application_Name)
      If RetVal = vbNo Then Exit Sub
      'PERFORM DELETION OF MANUFACTURER RECORD.
      Current_Criteria = "select * from [Manufacturers] where " & _
          "[Manufacturer ID] = " & Trim$(Str$(THIS_MANU_ID))
      Set RS1 = _
          DB_Carbon.OpenRecordset(Current_Criteria)
      RS1.Delete
      RS1.Close
      'PERFORM DELETION OF ADSORBENT RECORDS.
      Current_Criteria = "select * from [Carbon Data] where " & _
          "[Manufacturer ID] = " & Trim$(Str$(THIS_MANU_ID))
      Set RS1 = _
          DB_Carbon.OpenRecordset(Current_Criteria)
      On Error Resume Next
      RS1.MoveFirst
      RS1.MoveLast
      RS1.MoveFirst
      NumRecords = RS1.RecordCount
      On Error GoTo err_mnuManufacturerItem_Click
      If (NumRecords > 0) Then
        Do Until RS1.EOF
          RS1.Delete
          RS1.MoveNext
        Loop
      End If
      RS1.Close
      'REDISPLAY WINDOW.
      Call populate_lstManu
      'DISPLAY TOTAL.
      Call Show_Message("A total of " & Trim$(Str$(NumRecords)) & _
          " adsorbent records were deleted.")
  End Select
  Exit Sub
exit_err_mnuManufacturerItem_Click:
  Exit Sub
err_mnuManufacturerItem_Click:
  Call Show_Trapped_Error("mnuManufacturerItem_Click")
  Resume exit_err_mnuManufacturerItem_Click
End Sub


Private Sub optPhase_Click(index As Integer, Value As Integer)
  Call lstManu_Click
End Sub





VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmEditCarbonData 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Editing an Adsorbent"
   ClientHeight    =   5640
   ClientLeft      =   4185
   ClientTop       =   3045
   ClientWidth     =   4845
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   5640
   ScaleWidth      =   4845
   Begin Threed.SSFrame SSFrame1 
      Height          =   3765
      Left            =   120
      TabIndex        =   8
      Top             =   1020
      Width           =   4605
      _Version        =   65536
      _ExtentX        =   8123
      _ExtentY        =   6641
      _StockProps     =   14
      Caption         =   "Adsorbent Properties:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.TextBox txtData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   7
         Left            =   2010
         TabIndex        =   0
         Text            =   "txtData(7)"
         Top             =   285
         Width           =   2175
      End
      Begin VB.TextBox txtData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   6
         Left            =   2010
         TabIndex        =   7
         Text            =   "txtData(6)"
         Top             =   2805
         Width           =   1095
      End
      Begin VB.TextBox txtData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   5
         Left            =   2010
         TabIndex        =   6
         Text            =   "txtData(5)"
         Top             =   2445
         Width           =   1095
      End
      Begin VB.TextBox txtData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   4
         Left            =   2010
         TabIndex        =   5
         Text            =   "txtData(4)"
         Top             =   2085
         Width           =   1095
      End
      Begin VB.TextBox txtData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   3
         Left            =   2010
         TabIndex        =   4
         Text            =   "txtData(3)"
         Top             =   1725
         Width           =   2175
      End
      Begin VB.TextBox txtData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   2
         Left            =   2010
         TabIndex        =   3
         Text            =   "txtData(2)"
         Top             =   1365
         Width           =   1095
      End
      Begin VB.TextBox txtData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   1
         Left            =   2010
         TabIndex        =   2
         Text            =   "txtData(1)"
         Top             =   1005
         Width           =   1095
      End
      Begin VB.TextBox txtData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   0
         Left            =   2010
         TabIndex        =   1
         Text            =   "txtData(0)"
         Top             =   645
         Width           =   1095
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BackStyle       =   0  'Transparent
         Caption         =   "Name"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   7
         Left            =   90
         TabIndex        =   26
         Top             =   315
         Width           =   1755
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BackStyle       =   0  'Transparent
         Caption         =   "Apparent Density"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   90
         TabIndex        =   22
         Top             =   675
         Width           =   1755
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BackStyle       =   0  'Transparent
         Caption         =   "Particle Radius"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   90
         TabIndex        =   21
         Top             =   1035
         Width           =   1755
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BackStyle       =   0  'Transparent
         Caption         =   "Particle Porosity"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   90
         TabIndex        =   20
         Top             =   1395
         Width           =   1755
      End
      Begin VB.Label lblUnit 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "g/cm3"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   3210
         TabIndex        =   19
         Top             =   675
         Width           =   975
      End
      Begin VB.Label lblUnit 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "cm"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   3210
         TabIndex        =   18
         Top             =   1035
         Width           =   975
      End
      Begin VB.Label lblUnit 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "-"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   3210
         TabIndex        =   17
         Top             =   1395
         Width           =   975
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BackStyle       =   0  'Transparent
         Caption         =   "Adsorbent Type"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   90
         TabIndex        =   16
         Top             =   1755
         Width           =   1755
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BackStyle       =   0  'Transparent
         Caption         =   "Polanyi W0"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   90
         TabIndex        =   15
         Top             =   2115
         Width           =   1755
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BackStyle       =   0  'Transparent
         Caption         =   "Polanyi B"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   90
         TabIndex        =   14
         Top             =   2475
         Width           =   1755
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BackStyle       =   0  'Transparent
         Caption         =   "Polanyi Exponent"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   6
         Left            =   90
         TabIndex        =   13
         Top             =   2835
         Width           =   1755
      End
      Begin VB.Label lblUnit 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "cm3/g"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   3210
         TabIndex        =   12
         Top             =   2115
         Width           =   975
      End
      Begin VB.Label lblUnit 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "*"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   3210
         TabIndex        =   11
         Top             =   2475
         Width           =   975
      End
      Begin VB.Label lblUnit 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "-"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   6
         Left            =   3210
         TabIndex        =   10
         Top             =   2835
         Width           =   975
      End
      Begin VB.Label lblUnitB 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "* in (mol/cal) ^(Polanyi Exponent)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   1230
         TabIndex        =   9
         Top             =   3315
         Width           =   2925
      End
   End
   Begin Threed.SSCommand cmdSaveCancel 
      Height          =   495
      Index           =   1
      Left            =   1260
      TabIndex        =   23
      TabStop         =   0   'False
      Top             =   4980
      Width           =   2295
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      Caption         =   "Save &As New Record"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdSaveCancel 
      Height          =   495
      Index           =   0
      Left            =   120
      TabIndex        =   24
      TabStop         =   0   'False
      Top             =   4980
      Width           =   945
      _Version        =   65536
      _ExtentX        =   1667
      _ExtentY        =   873
      _StockProps     =   78
      Caption         =   "&Save"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdSaveCancel 
      Height          =   495
      Index           =   2
      Left            =   3780
      TabIndex        =   25
      TabStop         =   0   'False
      Top             =   4980
      Width           =   945
      _Version        =   65536
      _ExtentX        =   1667
      _ExtentY        =   873
      _StockProps     =   78
      Caption         =   "&Cancel"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSFrame SSFrame2 
      Height          =   795
      Left            =   120
      TabIndex        =   27
      Top             =   90
      Width           =   4605
      _Version        =   65536
      _ExtentX        =   8123
      _ExtentY        =   1402
      _StockProps     =   14
      Caption         =   "Select Phase:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin Threed.SSOption optPhase 
         Height          =   375
         Index           =   1
         Left            =   480
         TabIndex        =   28
         TabStop         =   0   'False
         Top             =   300
         Width           =   1575
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "&Liquid Phase"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   16.5
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Enabled         =   0   'False
      End
      Begin Threed.SSOption optPhase 
         Height          =   375
         Index           =   2
         Left            =   2610
         TabIndex        =   29
         TabStop         =   0   'False
         Top             =   300
         Width           =   1215
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "&Gas Phase"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   16.5
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Enabled         =   0   'False
      End
   End
End
Attribute VB_Name = "frmEditCarbonData"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Dim FORM_MODE As Integer
Const FORM_MODE_ADDNEW = 1
Const FORM_MODE_EDIT = 2

Dim USER_HIT_CANCEL As Boolean
Dim USER_HIT_SAVE As Boolean
Dim USER_HIT_SAVEASNEW As Boolean

Dim DEFAULT_PHASE_IS_LIQUID As Boolean


Const frmEditCarbonData_declarations_end = True


Sub frmEditCarbonData_AddNew( _
    INPUT_DEFAULT_PHASE_IS_LIQUID As Boolean, _
    OUTPUT_USER_HIT_CANCEL As Boolean, _
    OUTPUT_USER_HIT_SAVE As Boolean)
  DEFAULT_PHASE_IS_LIQUID = INPUT_DEFAULT_PHASE_IS_LIQUID
  FORM_MODE = FORM_MODE_ADDNEW
  frmEditCarbonData.Show 1
  OUTPUT_USER_HIT_CANCEL = USER_HIT_CANCEL
  OUTPUT_USER_HIT_SAVE = USER_HIT_SAVE
End Sub
Sub frmEditCarbonData_Edit( _
    OUTPUT_USER_HIT_CANCEL As Boolean, _
    OUTPUT_USER_HIT_SAVE As Boolean, _
    OUTPUT_USER_HIT_SAVEASNEW As Boolean)
  FORM_MODE = FORM_MODE_EDIT
  frmEditCarbonData.Show 1
  OUTPUT_USER_HIT_CANCEL = USER_HIT_CANCEL
  OUTPUT_USER_HIT_SAVE = USER_HIT_SAVE
  OUTPUT_USER_HIT_SAVEASNEW = USER_HIT_SAVEASNEW
End Sub



Sub frmEditCarbonData_PopulateUnits()
  Call unitsys_register(frmEditCarbonData, lblDesc(0), _
      txtData(0), Nothing, "", _
      "", "", "", "", 100#, False)
  Call unitsys_register(frmEditCarbonData, lblDesc(1), _
      txtData(1), Nothing, "", _
      "", "", "", "", 100#, False)
  Call unitsys_register(frmEditCarbonData, lblDesc(2), _
      txtData(2), Nothing, "", _
      "", "", "", "", 100#, False)
  Call unitsys_register(frmEditCarbonData, lblDesc(4), _
      txtData(4), Nothing, "", _
      "", "", "", "", 100#, False)
  Call unitsys_register(frmEditCarbonData, lblDesc(5), _
      txtData(5), Nothing, "", _
      "", "", "", "", 100#, False)
  Call unitsys_register(frmEditCarbonData, lblDesc(6), _
      txtData(6), Nothing, "", _
      "", "", "", "", 100#, False)
End Sub


Private Sub cmdSaveAs_Click()

End Sub


Private Sub cmdSaveCancel_Click(index As Integer)
  Select Case index
    Case 0:       'SAVE.
      USER_HIT_CANCEL = False
      USER_HIT_SAVE = True
      USER_HIT_SAVEASNEW = False
      Unload Me
      Exit Sub
    Case 1:       'SAVE AS NEW RECORD.
      USER_HIT_CANCEL = False
      USER_HIT_SAVE = False
      USER_HIT_SAVEASNEW = True
      Unload Me
      Exit Sub
    Case 2:       'CANCEL.
      USER_HIT_CANCEL = True
      USER_HIT_SAVE = False
      USER_HIT_SAVEASNEW = False
      Unload Me
      Exit Sub
  End Select
End Sub


Private Sub Form_Load()
  'MISC INITS.
  Me.Height = 6045
  Me.Width = 4995
  Call CenterOnForm(Me, frmEditAdsorber)
  lblUnit(0).Caption = "g/cm"
  lblUnit(4).Caption = "cm/g"
  'STRANGE THINGS CAN HAPPEN IF OPTION BOXES ARE ENABLED
  'BEFORE THE FORM IS LOADED/ACTIVATED.
  optPhase(1).Enabled = True
  optPhase(2).Enabled = True
  If (FORM_MODE = FORM_MODE_EDIT) Then
    'EDIT MODE.
    cmdSaveCancel(0).Visible = True
    cmdSaveCancel(1).Visible = True
    cmdSaveCancel(2).Visible = True
  Else
    'ADD NEW MODE.
    cmdSaveCancel(0).Visible = True
    cmdSaveCancel(1).Visible = False
    cmdSaveCancel(2).Visible = True
    'SET DEFAULTS FOR THE NEW RECORD.
    frmEditCarbonData_Record.Name = "New Adsorbent"
    frmEditCarbonData_Record.AppDen = 1#
    frmEditCarbonData_Record.ParticleRadius = 0.1
    frmEditCarbonData_Record.ParticlePorosity = 1#
    frmEditCarbonData_Record.AdsType = "GAC"
    frmEditCarbonData_Record.W0 = 0#
    frmEditCarbonData_Record.BB = 0#
    frmEditCarbonData_Record.PolanyiExponent = 0#
    If (DEFAULT_PHASE_IS_LIQUID) Then
      frmEditCarbonData_Record.PhaseIsLiquid = True
    Else
      frmEditCarbonData_Record.PhaseIsLiquid = False
    End If
  End If
  If (frmEditCarbonData_Record.PhaseIsLiquid) Then
    optPhase(1).Value = True
    optPhase(2).Value = False
  Else
    optPhase(1).Value = False
    optPhase(2).Value = True
  End If
  'POPULATE UNIT CONTROLS.
  Call frmEditCarbonData_PopulateUnits
  'REFRESH DISPLAY.
  Call frmEditCarbonData_Refresh
End Sub
Private Sub Form_Unload(Cancel As Integer)
  Call unitsys_unregister_all_on_form(Me)
End Sub









Private Sub optPhase_Click(index As Integer, Value As Integer)
  If (index = 1) Then
    frmEditCarbonData_Record.PhaseIsLiquid = True
  Else
    frmEditCarbonData_Record.PhaseIsLiquid = False
  End If
End Sub


Private Sub txtData_GotFocus(index As Integer)
Dim Ctl As Control
Set Ctl = txtData(index)
  If (index = 7) Or (index = 3) Then
    Call Global_GotFocus(Ctl)
  Else
    Call unitsys_control_txtx_gotfocus(Ctl)
  End If
End Sub
Private Sub txtData_KeyPress(index As Integer, KeyAscii As Integer)
  If (index = 7) Or (index = 3) Then
    KeyAscii = Global_TextKeyPress(KeyAscii)
  Else
    KeyAscii = Global_NumericKeyPress(KeyAscii)
  End If
End Sub
Private Sub txtData_LostFocus(index As Integer)
Dim NewValue_Okay As Integer
Dim NewValue As Double
Dim Ctl As Control
Set Ctl = txtData(index)
Dim Val_Low As Double
Dim Val_High As Double
Dim Raise_Dirty_Flag As Boolean
Dim Too_Small As Integer
Dim OldValueStr As String
  'HANDLE STRING FIELDS.
  If (index = 7) Or (index = 3) Then
    Select Case index
      Case 7: OldValueStr = Trim$(frmEditCarbonData_Record.Name)
      Case 3: OldValueStr = Trim$(frmEditCarbonData_Record.AdsType)
    End Select
    If (Trim$(Ctl.Text) = "") Then
      Ctl.Text = OldValueStr
      'Call Show_Error("You must enter a non-blank string for the carbon name.")
      'NOTE: SHOWING THIS ERROR MESSAGE MESSES UP THE
      'SUBSEQUENT GOTFOCUS IF THE USER HITS <Enter> OR <Tab>.
    Else
      If (Trim$(OldValueStr) <> Trim$(Ctl.Text)) Then
        Select Case index
          Case 7: frmEditCarbonData_Record.Name = Trim$(Ctl.Text)
          Case 3: frmEditCarbonData_Record.AdsType = Trim$(Ctl.Text)
        End Select
        ''THROW DIRTY FLAG.
        'Call DirtyStatus_Throw
      End If
    End If
    Call Global_LostFocus(Ctl)
    'Call GenericStatus_Set("")
    Exit Sub
  End If
  'NOTE: LOW AND HIGH VALUES IN BASE UNITS.
  Select Case index
    Case 0: Val_Low = 1E-20: Val_High = 1E+20
    Case 1: Val_Low = 1E-20: Val_High = 1E+20
    Case 2: Val_Low = 1E-20: Val_High = 1E+20
    Case 4: Val_Low = 0#: Val_High = 1E+20
    Case 5: Val_Low = 0#: Val_High = 1E+20
    Case 6: Val_Low = 0#: Val_High = 1E+20
  End Select
  NewValue_Okay = False
  If (unitsys_control_txtx_lostfocus_validate(Ctl, Val_Low, Val_High, NewValue, Raise_Dirty_Flag)) Then
    NewValue_Okay = True
  End If
  Call unitsys_control_txtx_lostfocus(Ctl, NewValue)
  If (NewValue_Okay) Then
    If (Raise_Dirty_Flag) Then
      'STORE TO MEMORY.
      Select Case index
        Case 0:         'APPARENT DENSITY.
          frmEditCarbonData_Record.AppDen = NewValue
        Case 1:         'PARTICLE RADIUS.
          frmEditCarbonData_Record.ParticleRadius = NewValue
        Case 2:         'PARTICLE POROSITY.
          frmEditCarbonData_Record.ParticlePorosity = NewValue
        Case 4:         'POLANYI W0.
          frmEditCarbonData_Record.W0 = NewValue
        Case 5:         'POLANYI BB.
          frmEditCarbonData_Record.BB = NewValue
        Case 6:         'POLANYI EXPONENT.
          frmEditCarbonData_Record.PolanyiExponent = NewValue
      End Select
      'RAISE DIRTY FLAG IF NECESSARY.
      If (Raise_Dirty_Flag) Then
        ''THROW DIRTY FLAG.
        'Call frmCompoProp_DirtyStatus_Throw
      End If
      'REFRESH WINDOW.
      Call frmEditAdsorberData_Refresh
    End If
  End If
End Sub




VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "Threed32.OCX"
Begin VB.Form frmEditIsotherm 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Isotherm Database"
   ClientHeight    =   6315
   ClientLeft      =   1935
   ClientTop       =   1935
   ClientWidth     =   9375
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   6315
   ScaleWidth      =   9375
   Begin Threed.SSFrame fraOne 
      Height          =   6015
      Left            =   120
      TabIndex        =   0
      Top             =   150
      Width           =   4455
      _Version        =   65536
      _ExtentX        =   7858
      _ExtentY        =   10610
      _StockProps     =   14
      Caption         =   "Select a Chemical:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.ListBox lstCompo 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   4320
         Left            =   120
         TabIndex        =   4
         Top             =   660
         Width           =   4215
      End
      Begin Threed.SSOption optSort 
         Height          =   255
         Index           =   0
         Left            =   240
         TabIndex        =   2
         Top             =   270
         Width           =   1695
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "Sort by &Name"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Enabled         =   0   'False
         Value           =   -1  'True
      End
      Begin Threed.SSOption optSort 
         Height          =   255
         Index           =   1
         Left            =   2280
         TabIndex        =   3
         Top             =   270
         Width           =   2055
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "S&ort by CAS number"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Enabled         =   0   'False
      End
      Begin Threed.SSCommand cmdSelect 
         Height          =   315
         Left            =   120
         TabIndex        =   25
         Top             =   5520
         Width           =   4185
         _Version        =   65536
         _ExtentX        =   7382
         _ExtentY        =   556
         _StockProps     =   78
         Caption         =   "Select Chemic&al"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSCommand cmdFind 
         Height          =   315
         Index           =   1
         Left            =   2250
         TabIndex        =   26
         Top             =   5130
         Width           =   2055
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "Find A&gain"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSCommand cmdFind 
         Height          =   315
         Index           =   0
         Left            =   120
         TabIndex        =   27
         Top             =   5130
         Width           =   2055
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "&Find"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin VB.Label lblEmpty_lstCompo 
         Alignment       =   2  'Center
         Caption         =   "No Chemicals Available"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   525
         Left            =   120
         TabIndex        =   24
         Top             =   510
         Visible         =   0   'False
         Width           =   4215
      End
   End
   Begin Threed.SSFrame fraTwo 
      Height          =   6015
      Left            =   4710
      TabIndex        =   1
      Top             =   150
      Width           =   4515
      _Version        =   65536
      _ExtentX        =   7964
      _ExtentY        =   10610
      _StockProps     =   14
      Caption         =   "No Chemical Selected"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.ListBox lstRange 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   2565
         Index           =   1
         Left            =   1860
         TabIndex        =   6
         Top             =   1230
         Width           =   2535
      End
      Begin VB.ListBox lstRange 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   2565
         Index           =   0
         Left            =   120
         TabIndex        =   5
         Top             =   1230
         Width           =   1575
      End
      Begin VB.Label lblPhase 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "lblPhase"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   1740
         TabIndex        =   23
         Top             =   4545
         Width           =   2655
      End
      Begin VB.Label Label5 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "(mg/g)*(L/mg)^(1/n)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   2460
         TabIndex        =   22
         Top             =   330
         Width           =   1800
      End
      Begin VB.Label lblValue 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "lblValue(3)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   120
         TabIndex        =   21
         Top             =   5040
         Width           =   4275
      End
      Begin VB.Label Label4 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Source:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   120
         TabIndex        =   20
         Top             =   4800
         Width           =   1215
      End
      Begin VB.Label lblValue 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "lblValue(2)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   1740
         TabIndex        =   19
         Top             =   3945
         Width           =   2655
      End
      Begin VB.Label Label3 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Carbon Type:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   180
         TabIndex        =   18
         Top             =   3960
         Width           =   1515
      End
      Begin VB.Label Label2 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "pH Range:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   120
         TabIndex        =   17
         Top             =   990
         Width           =   1335
      End
      Begin VB.Label Label1 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Concentration Range (mg/L):"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   1860
         TabIndex        =   16
         Top             =   990
         Width           =   2535
      End
      Begin VB.Label lblText 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "1/n"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   360
         TabIndex        =   15
         Top             =   630
         Width           =   975
      End
      Begin VB.Label lblValue 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "lblValue(1)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   1380
         TabIndex        =   14
         Top             =   615
         Width           =   975
      End
      Begin VB.Label lblValue 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "lblValue(0)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   1380
         TabIndex        =   13
         Top             =   315
         Width           =   975
      End
      Begin VB.Label lblText 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "K"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   360
         TabIndex        =   12
         Top             =   330
         Width           =   975
      End
      Begin VB.Label Label6 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Phase:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   420
         TabIndex        =   11
         Top             =   4560
         Width           =   1215
      End
      Begin VB.Label lblTemperature 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "lblTemperature"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   1740
         TabIndex        =   10
         Top             =   4245
         Width           =   2655
      End
      Begin VB.Label Label7 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Temperature (C):"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   60
         TabIndex        =   9
         Top             =   4260
         Width           =   1635
      End
      Begin VB.Label Label8 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Comments:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   195
         Left            =   120
         TabIndex        =   8
         Top             =   5400
         Width           =   1035
      End
      Begin VB.Label lblComments 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "lblComments"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   120
         TabIndex        =   7
         Top             =   5640
         Width           =   4275
      End
   End
   Begin VB.Menu mnuChemical 
      Caption         =   "C&hemical"
      Begin VB.Menu mnuChemicalItem 
         Caption         =   "&New"
         Index           =   1
      End
      Begin VB.Menu mnuChemicalItem 
         Caption         =   "&Edit Current"
         Index           =   2
      End
      Begin VB.Menu mnuChemicalItem 
         Caption         =   "&Delete Current"
         Index           =   3
      End
   End
   Begin VB.Menu mnuIsotherm 
      Caption         =   "&Isotherm"
      Begin VB.Menu mnuIsothermItem 
         Caption         =   "&New"
         Index           =   1
      End
      Begin VB.Menu mnuIsothermItem 
         Caption         =   "&Edit Current"
         Index           =   2
      End
      Begin VB.Menu mnuIsothermItem 
         Caption         =   "&Delete Current"
         Index           =   3
      End
      Begin VB.Menu mnuIsothermItem 
         Caption         =   "Delete &All"
         Index           =   4
      End
   End
   Begin VB.Menu mnuExit 
      Caption         =   "E&xit"
   End
End
Attribute VB_Name = "frmEditIsotherm"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Dim FORM_MODE As Integer
Const FORM_MODE_EDIT_DATABASE = 2

Dim DB_Isotherm As Database
Dim Find_String As String

Dim HALT_LSTCOMPO As Boolean
Dim HALT_LSTRANGE As Boolean






Const frmEditIsotherm_declarations_end = True


Sub frmEditIsotherm_EditDatabase()
  On Error GoTo err_frmEditIsotherm_EditDatabase
  'NOTE: THE FOLLOWING OpenDatabase() COMMAND MUST BE
  'SPECIFIED EXACTLY AS-IS, OR ELSE IT WILL FAIL.
  Set DB_Isotherm = _
      Ws1.OpenDatabase(fn_DB_Isotherm, True, False, _
      ";pwd=" & decrypt_string(Encrypted_User_Password))
  'Set DB_Isotherm = ws1.OpenDatabase(fn_DB_Isotherm)
  FORM_MODE = FORM_MODE_EDIT_DATABASE
  frmEditIsotherm.Show 1
  DB_Isotherm.Close
  Exit Sub
exit_err_frmEditIsotherm_EditDatabase:
  Exit Sub
err_frmEditIsotherm_EditDatabase:
  Call Show_Trapped_Error("frmEditIsotherm_EditDatabase")
  Resume exit_err_frmEditIsotherm_EditDatabase
End Sub


Sub populate_lstCompo()
Dim Rs1 As Recordset
Dim Current_Criteria As String
Dim SAVE_CURRENT_POSITION As Long
Dim NEW_LISTINDEX As Integer
Dim This_ID As Long
Dim NumRecords As Long
Dim SortCode As String
Dim TempStr As String * 15
Dim Output_Line As String
Dim ThisChemicalName As String
Dim ThisChemicalCAS As String
  On Error GoTo err_populate_lstCompo
  'SAVE CURRENT POSITION.
  If (lstCompo.ListCount > 0) And (lstCompo.ListIndex >= 0) Then
    SAVE_CURRENT_POSITION = lstCompo.ItemData(lstCompo.ListIndex)
  Else
    SAVE_CURRENT_POSITION = -1
  End If
  'SET UP SEARCH CRITERIA.
  If (optSort(0).Value) Then SortCode = "Name, CAS"
  If (optSort(1).Value) Then SortCode = "CAS, Name"
  Current_Criteria = "select * from [Chemicals] " & _
      "order by " & SortCode
  'START SEARCH.
  Set Rs1 = _
      DB_Isotherm.OpenRecordset(Current_Criteria)
  On Error Resume Next
  Rs1.MoveFirst
  Rs1.MoveLast
  Rs1.MoveFirst
  NumRecords = Rs1.RecordCount
  On Error GoTo err_populate_lstCompo
  'POPULATE LISTBOX.
  lstCompo.Clear
  If (NumRecords = 0) Then
    'NO RECORDS AVAILABLE.
    lstCompo.Visible = False
    lblEmpty_lstCompo.Move lstCompo.Left, lstCompo.Top
    lblEmpty_lstCompo.Visible = True
  Else
    'DISPLAY RECORDS.
    lstCompo.Visible = True
    lblEmpty_lstCompo.Visible = False
    NEW_LISTINDEX = 0
    Do Until Rs1.EOF
      This_ID = Database_Get_Long(Rs1, "Compo ID")
      ThisChemicalName = Database_Get_String(Rs1, "Name")
      ThisChemicalCAS = Database_Get_String(Rs1, "CAS")
      TempStr = ThisChemicalCAS
              'THIS STRING IS ENSURED TO BE 15 CHARACTERS LONG.
      Output_Line = _
          TempStr & _
          " " & _
          ThisChemicalName
      lstCompo.AddItem Output_Line
      lstCompo.ItemData(lstCompo.NewIndex) = This_ID
      If (SAVE_CURRENT_POSITION <> -1) Then
        If (SAVE_CURRENT_POSITION = This_ID) Then
          NEW_LISTINDEX = lstCompo.NewIndex
        End If
      End If
      Rs1.MoveNext
    Loop
    If (lstCompo.ListCount > 0) Then
      HALT_LSTCOMPO = True
      lstCompo.ListIndex = NEW_LISTINDEX
      HALT_LSTCOMPO = False
    End If
  End If
  'CLOSE DATABASE AND EXIT.
  Rs1.Close
  Exit Sub
exit_err_populate_lstCompo:
  Exit Sub
err_populate_lstCompo:
  Call Show_Trapped_Error("populate_lstCompo")
  Resume exit_err_populate_lstCompo
End Sub
Sub populate_lstRange(ThisCAS As String, ThisChemical As String)
Dim PHASE_CODE As Integer
Dim Rs1 As Recordset
Dim Current_Criteria As String
Dim SAVE_CURRENT_POSITION As Long
Dim This_ID As Long
Dim NEW_LISTINDEX As Long
Dim NumRecords As Long
Dim PhaseCode As String
Dim ThisCMin As Double
Dim ThisCMax As Double
Dim ThisPHMin As Double
Dim ThisPHMax As Double
Dim ThisDbl As Double
Dim ThisOutput As String
  On Error GoTo err_populate_lstRange
  ''GET PHASE CODE.
  'Select Case Bed.Phase
  '  Case 0: PhaseCode = "Liquid"
  '  Case 1: PhaseCode = "Gas"
  'End Select
  'SAVE CURRENT POSITION.
  If (lstRange(0).ListCount > 0) And (lstRange(0).ListIndex >= 0) Then
    SAVE_CURRENT_POSITION = lstRange(0).ItemData(lstRange(0).ListIndex)
  Else
    SAVE_CURRENT_POSITION = -1
  End If
  'SET UP SEARCH CRITERIA.
  If (Trim$(ThisCAS) = "0") Then ThisCAS = ""
  If (Trim$(ThisCAS) <> "") Then
    Current_Criteria = "select * from Isotherms" & _
        " where [Component Number] = " & Trim$(ThisCAS) & _
        " order by CarbonName, ID"
  Else
    Current_Criteria = "select * from Isotherms" & _
        " where Name = '" & Trim$(ThisChemical) & "'" & _
        " order by CarbonName, ID"
  End If
  'START SEARCH.
  Set Rs1 = _
      DB_Isotherm.OpenRecordset(Current_Criteria)
  On Error Resume Next
  Rs1.MoveFirst
  Rs1.MoveLast
  Rs1.MoveFirst
  NumRecords = Rs1.RecordCount
  On Error GoTo err_populate_lstRange
  'POPULATE LISTBOX.
  lstRange(0).Clear
  lstRange(1).Clear
  If (NumRecords = 0) Then
    'NO RECORDS AVAILABLE.
    fraTwo.Caption = "No Isotherms Available."
  Else
    'DISPLAY RECORDS.
    fraTwo.Caption = Trim$(Str$(NumRecords)) & " " & _
        "Isotherm" & _
        IIf(NumRecords = 1, "", "s") & _
        " Available"
    NEW_LISTINDEX = -1
    Do Until Rs1.EOF
      This_ID = Database_Get_Long(Rs1, "ID")
      ThisCMin = Database_Get_Double(Rs1, "C min")
      ThisCMax = Database_Get_Double(Rs1, "C max")
      ThisPHMin = Database_Get_Double(Rs1, "pH min")
      ThisPHMax = Database_Get_Double(Rs1, "pH max")
      If (ThisPHMin = 0#) And (ThisPHMax = 0#) Then
        ThisOutput = "No pH Range"
      Else
        If (ThisPHMin = 0#) Or (ThisPHMax = 0#) Then
          If (ThisPHMin <> 0#) Then ThisDbl = ThisPHMin
          If (ThisPHMax <> 0#) Then ThisDbl = ThisPHMax
          ThisOutput = Format$(ThisDbl, "0.000")
        Else
          ThisOutput = Format$(ThisPHMin, "0.000") & " - " & _
              Format$(ThisPHMax, "0.000")
        End If
      End If
      lstRange(0).AddItem ThisOutput
      lstRange(0).ItemData(lstRange(0).NewIndex) = This_ID
      If (ThisCMin = 0#) And (ThisCMax = 0#) Then
        ThisOutput = "No Conc. Range"
      Else
        If (ThisCMin = 0#) Or (ThisCMax = 0#) Then
          If (ThisCMin <> 0#) Then ThisDbl = ThisCMin
          If (ThisCMax <> 0#) Then ThisDbl = ThisCMax
          ThisOutput = Format$(ThisDbl, "0.000")
        Else
          ThisOutput = Format$(ThisCMin, "0.000") & " - " & _
              Format$(ThisCMax, "0.000")
        End If
      End If
      lstRange(1).AddItem ThisOutput
      lstRange(1).ItemData(lstRange(1).NewIndex) = This_ID
      If (SAVE_CURRENT_POSITION <> -1) Then
        If (SAVE_CURRENT_POSITION = This_ID) Then
          NEW_LISTINDEX = lstRange(0).NewIndex
        End If
      End If
      Rs1.MoveNext
    Loop
    If (lstRange(0).ListCount > 0) And (NEW_LISTINDEX > -1) Then
      lstRange(0).ListIndex = NEW_LISTINDEX
      lstRange(1).ListIndex = NEW_LISTINDEX
    End If
  End If
  'CLOSE DATABASE AND EXIT.
  Rs1.Close
  Exit Sub
exit_err_populate_lstRange:
  Exit Sub
err_populate_lstRange:
  Call Show_Trapped_Error("populate_lstRange")
  Resume exit_err_populate_lstRange
End Sub
Sub populate_lblValue(This_ID As Long)
Dim Rs1 As Recordset
Dim Current_Criteria As String
Dim NumRecords As Long
  On Error GoTo err_populate_lblValue
  'SET UP SEARCH CRITERIA.
  Current_Criteria = "select * from Isotherms" & _
      " where ID = " & Trim$(Str$(This_ID)) & _
      " order by CarbonName"
  'START SEARCH.
  Set Rs1 = _
      DB_Isotherm.OpenRecordset(Current_Criteria)
  On Error Resume Next
  Rs1.MoveFirst
  Rs1.MoveLast
  Rs1.MoveFirst
  NumRecords = Rs1.RecordCount
  On Error GoTo err_populate_lblValue
  'POPULATE LISTBOX.
  If (NumRecords = 0) Then
    'COULD NOT FIND THAT ISOTHERM (WEIRD PROBLEM).
  Else
    'DISPLAY RECORD.
    Call AssignCaptionAndTag(lblValue(0), Database_Get_Double(Rs1, "K"))
    Call AssignCaptionAndTag(lblValue(1), Database_Get_Double(Rs1, "1/n"))
    Call AssignCaptionAndTag(lblValue(2), Database_Get_String(Rs1, "CarbonName"))
    Call AssignCaptionAndTag(lblTemperature, Database_Get_Double(Rs1, "Tmin"))
    Call AssignCaptionAndTag(lblPhase, Database_Get_String(Rs1, "Phase"))
    Call AssignCaptionAndTag(lblValue(3), Database_Get_String(Rs1, "Source"))
    Call AssignCaptionAndTag(lblComments, Database_Get_String(Rs1, "Comments"))
  End If
  'CLOSE DATABASE AND EXIT.
  Rs1.Close
  Exit Sub
exit_err_populate_lblValue:
  Exit Sub
err_populate_lblValue:
  Call Show_Trapped_Error("populate_lblValue")
  Resume exit_err_populate_lblValue
End Sub


Sub Clear_lblValue()
  lblValue(0) = ""      'ISODB : K.
  lblValue(1) = ""      'ISODB : 1/N.
  lblValue(2) = ""      'ISODB : ADSORBENT TYPE.
  lblTemperature = ""   'ISODB : TEMP.
  lblPhase = ""         'ISODB : PHASE.
  lblValue(3) = ""      'ISODB : SOURCE.
  lblComments = ""      'ISODB : COMMENTS.
End Sub


'Returns:
'- TRUE = Succeeded
'- FALSE = Failed
Function Search_String( _
    j As Integer, _
    ShowErrorMessages As Integer) As Boolean
Dim i As Integer
Dim Res As Integer
  'If (fraIsothermDB.Visible) Then
  '  lstCompo.SetFocus
  'End If
  'For I = J + 1 To lstCompo.ListCount
  For i = j + 1 To lstCompo.ListCount - 1
    Res = InStr(1, lstCompo.List(i), Find_String, 1)
    If (Res > 0) Then
      'NOTE: BY HALTING lstCompo_Click(), THIS ALLOWS THE
      'COMPONENT TO BE SELECTED WITHOUT CLEARING THE ISOTHERM DB
      'VALUES OF K AND 1/N.
      'lstCompo.ListIndex = I
      HALT_LSTCOMPO = True
      Call Do_Select_Component(i)
      HALT_LSTCOMPO = False
      'If (fraIsothermDB.Visible) Then lstCompo.SetFocus
      Search_String = True
      Exit Function
    End If
  Next i
  For i = 0 To j
    Res = InStr(1, lstCompo.List(i), Find_String, 1)
    If (Res > 0) Then
      'NOTE: BY HALTING lstCompo_Click(), THIS ALLOWS THE
      'COMPONENT TO BE SELECTED WITHOUT CLEARING THE ISOTHERM DB
      'VALUES OF K AND 1/N.
      'lstCompo.ListIndex = I
      HALT_LSTCOMPO = True
      Call Do_Select_Component(i)
      HALT_LSTCOMPO = False
      'If (fraIsothermDB.Visible) Then lstCompo.SetFocus
      Search_String = True
      Exit Function
    End If
  Next i
  '----- If not found, show error message: -----
  If (ShowErrorMessages) Then
    Call Show_Error("String Not Found: " & Chr$(34) & _
        Trim$(Find_String) & Chr$(34))
  End If
  Search_String = False
End Function
'Returns:
'- TRUE = Succeeded
'- FALSE = Failed
Function Do_Search_For_Text(ShowErrorMessages As Integer) As Integer
Dim LIST_INDEX As Integer
  LIST_INDEX = lstCompo.ListIndex
  Do_Search_For_Text = Search_String(LIST_INDEX, ShowErrorMessages)
End Function


Private Sub cmdFind_Click(Index As Integer)
Dim NewName As String
Dim USER_HIT_CANCEL As Boolean
  Select Case Index
    Case 0:     'FIND.
      NewName = Find_String
      Do While (1 = 1)
        NewName = frmNewName.frmNewName_GetName( _
            "Search for String", _
            "Enter the string to find:", _
            NewName, _
            USER_HIT_CANCEL)
        If (USER_HIT_CANCEL) Then Exit Sub
        NewName = Trim$(NewName)
        If (NewName <> "") Then Exit Do
        Call Show_Error("You may only enter a non-blank search string.")
      Loop
      Find_String = NewName
      Call Do_Search_For_Text(True)
    Case 1:     'FIND AGAIN.
      Call Do_Search_For_Text(True)
  End Select
End Sub


Private Sub Form_Load()
  'MISC INITS.
  Me.Height = 7000
  Me.Width = 9500
  Call CenterOnForm(Me, frmMain)
  optSort(0).Enabled = True
  optSort(1).Enabled = True
  Find_String = ""
  'RE-POPULATE CHEMICAL LIST.
  Call populate_lstCompo
End Sub


Sub Do_Select_Component(WhichComp As Integer)
''''Dim THIS_ITEMDATA As Long
Dim ThisText As String
Dim ThisCAS As String
Dim ThisChemical As String
  If (WhichComp < 0) Or (lstCompo.ListCount <= 0) Then
    Exit Sub
  End If
  lstCompo.ListIndex = WhichComp
  ''''THIS_ITEMDATA = lstCompo.ItemData(lstCompo.ListIndex)
  'EXTRACT CAS NUMBER AND COMPONENT NAME.
  ThisText = lstCompo.List(WhichComp)
  ThisCAS = Trim$(Left$(ThisText, 15))
  ThisChemical = Trim$(Mid$(ThisText, 16, Len(ThisText) - 15))
  Call populate_lstRange(ThisCAS, ThisChemical)
End Sub

Private Sub lstCompo_Click()
  If (HALT_LSTCOMPO) Then Exit Sub
  HALT_LSTCOMPO = True
  Call Do_Select_Component(lstCompo.ListIndex)
  HALT_LSTCOMPO = False
  'INVALIDATE EXISTING ISOTHERM RECORD LINK (IF ANY).
  'Component(0).IsothermDB_OneOverN = -1#
  'Component(0).IsothermDB_K = -1#
  HALT_LSTRANGE = True
  lstRange(0).ListIndex = -1
  lstRange(1).ListIndex = -1
  HALT_LSTRANGE = False
  'CLEAR EXISTING RECORD DATA.
  Call Clear_lblValue
  'Call frmFreundlich_Refresh
End Sub
Private Sub lstCompo_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
  If ((Button And 2) = 2) Then
    Me.PopupMenu mnuChemical
  End If
End Sub


Private Sub lstRange_Click(Index As Integer)
  If (HALT_LSTRANGE) Then Exit Sub
  HALT_LSTRANGE = True
  'KEEP THE RANGE LISTBOXES IN SYNCH.
  Select Case Index
    Case 0: lstRange(1).ListIndex = lstRange(0).ListIndex
    Case 1: lstRange(0).ListIndex = lstRange(1).ListIndex
  End Select
  ''TRANSFER LINK TO COMPONENT(0) STRUCTURE.
  'Component(0).IsothermDB_Component_Name = Trim$(lstCompo.List(lstCompo.ListIndex))
  'Component(0).IsothermDB_Range_Num = lstRange(0).ListIndex
  'DISPLAY ISOTHERM RECORD.
  Call populate_lblValue(lstRange(0).ItemData(lstRange(0).ListIndex))
  ''THROW DIRTY FLAG.
  'Call frmFreundlich_DirtyStatus_Throw
  ''REFRESH WINDOW.
  'Call frmFreundlich_Refresh
  HALT_LSTRANGE = False
End Sub
Private Sub lstRange_MouseUp(Index As Integer, Button As Integer, Shift As Integer, X As Single, Y As Single)
  If ((Button And 2) = 2) Then
    Me.PopupMenu mnuIsotherm
  End If
End Sub


Private Sub mnuChemicalItem_Click(Index As Integer)
Dim THIS_CHEMICAL_ID As Long
Dim DummyStr1 As String, DummyStr2 As String
Dim DummyBool1 As Boolean, DummyBool2 As Boolean
Dim USER_HIT_CANCEL As Boolean
Dim NewName As String
Dim NewCAS As String
Dim OldName As String
Dim OldCAS As String
'Dim USER_HIT_CANCEL As Boolean
Dim Current_Criteria As String
Dim Rs1 As Recordset
Dim msg As String
Dim RetVal As Integer
Dim i As Integer
Dim Select_Index As Integer
Dim NumRecords As Integer
Dim RecordCount_Chemicals As Integer
Dim RecordCount_Isotherms_CAS As Integer
Dim RecordCount_Isotherms_Name As Integer
  On Error GoTo err_mnuChemicalItem_Click
  If (Index = 2) Or (Index = 3) Then
    If (lstCompo.ListIndex < 0) Or (lstCompo.ListCount = 0) Then
      Call Show_Error("You must first select a chemical.")
      Exit Sub
    End If
    THIS_CHEMICAL_ID = lstCompo.ItemData(lstCompo.ListIndex)
  End If
  Select Case Index
    Case 1:     'new /////////////////////////////////////////////////////////////////////////////////////////////////
      NewName = "New Chemical"
      Do While (1 = 1)
        Call frmEditIsothermCAS.frmEditIsothermCAS_Run( _
            "Creating New Chemical", _
            "New CAS Number", _
            "New Chemical Name", _
            "*", _
            "*", _
            "*", _
            "*", _
            "&Save", _
            USER_HIT_CANCEL, _
            NewCAS, NewName, _
            DummyStr1, DummyStr2, _
            DummyBool1, DummyBool2)
        If (USER_HIT_CANCEL) Then Exit Sub
        NewName = Trim$(NewName)
        NewCAS = Trim$(NewCAS)
        If (NewName <> "") Then Exit Do
        Call Show_Error("The chemical name must be a non-blank string.")
      Loop
      'ADD THE NEW CHEMICAL RECORD.
      Current_Criteria = "select * from [Chemicals]"
      Set Rs1 = _
          DB_Isotherm.OpenRecordset(Current_Criteria)
      Rs1.AddNew
      'THE FIELD [Compo ID] IS AUTOMATICALLY UPDATED.
      Rs1("Name") = NewName
      If (NewCAS <> "") Then
        Rs1("CAS") = NewCAS
      Else
        Rs1("CAS") = Null
      End If
      THIS_CHEMICAL_ID = Database_Get_Long(Rs1, "Compo ID")
      Rs1.Update
      Rs1.Close
      'REDISPLAY WINDOW.
      Call populate_lstCompo
      'SELECT THE NEW MANUFACTURER.
      Select_Index = 0
      For i = 0 To lstCompo.ListCount - 1
        If (lstCompo.ItemData(i) = THIS_CHEMICAL_ID) Then
          Select_Index = i
          Exit For
        End If
      Next i
      If (lstCompo.ListCount > 0) Then
        lstCompo.ListIndex = Select_Index
      End If
    Case 2:     'edit current /////////////////////////////////////////////////////////////////////////////////////////////////
      'START THE EDIT PROCESS.
      Current_Criteria = "select * from [Chemicals] where " & _
          "[Compo ID] = " & Trim$(Str$(THIS_CHEMICAL_ID))
      Set Rs1 = _
          DB_Isotherm.OpenRecordset(Current_Criteria)
      Rs1.Edit
      'DO USER INPUT.
      OldName = Database_Get_String(Rs1, "Name")
      OldCAS = Database_Get_String(Rs1, "CAS")
      NewName = OldName
      NewCAS = OldCAS
      DummyBool1 = True
      DummyBool2 = True
      Do While (1 = 1)
        Call frmEditIsothermCAS.frmEditIsothermCAS_Run( _
            "Editing a Chemical", _
            "^Current CAS Number", _
            "^Current Chemical Name", _
            "New CAS Number", _
            "New Chemical Name", _
            "Modify all isotherms with the same CAS number", _
            "Modify all isotherms with the same chemical name", _
            "&Save", _
            USER_HIT_CANCEL, _
            OldCAS, OldName, _
            NewCAS, NewName, _
            DummyBool1, DummyBool2)
        If (USER_HIT_CANCEL) Then
          Rs1.CancelUpdate
          Exit Sub
        End If
        NewName = Trim$(NewName)
        NewCAS = Trim$(NewCAS)
        If (NewName = "") Then
          Call Show_Error("The chemical name must be a non-blank string.")
        Else
          If (OldCAS = "") And (NewCAS <> "") And (DummyBool1) Then
            Call Show_Error("You cannot automatically assign CAS numbers " & _
                "to all isotherm records currently without CAS numbers.")
          Else
            Exit Do
          End If
        End If
      Loop
      If (NewCAS <> "") Then
        NewCAS = Format$(CLng(Val(NewCAS)), "0")
      End If
      Rs1("Name") = NewName
      If (NewCAS <> "") Then
        Rs1("CAS") = NewCAS
      Else
        Rs1("CAS") = Null
      End If
      Rs1.Update
      Rs1.Close
      RecordCount_Chemicals = 1
      RecordCount_Isotherms_CAS = 0
      RecordCount_Isotherms_Name = 0
      'MODIFY ISOTHERMS WITH SAME CAS#/CHEMICAL NAME.
      If (DummyBool1) Then
        'MODIFY CAS NUMBER IN ISOTHERM RECORDS.
        If (OldCAS <> "") Then
          Current_Criteria = "select * from [Isotherms] where " & _
              "[Component Number] = " & OldCAS
        Else
          Current_Criteria = "select * from [Isotherms] where " & _
              "[Component Number] = Null"
        End If
        Set Rs1 = _
            DB_Isotherm.OpenRecordset(Current_Criteria)
        On Error Resume Next
        Rs1.MoveFirst
        Rs1.MoveLast
        Rs1.MoveFirst
        NumRecords = Rs1.RecordCount
        On Error GoTo err_mnuChemicalItem_Click
        If (NumRecords = 0) Then
          'DO NOTHING.
        Else
          Do Until Rs1.EOF
            Rs1.Edit
            If (NewCAS <> "") Then
              Rs1("Component Number") = NewCAS
            Else
              Rs1("Component Number") = Null
            End If
            Rs1.Update
            RecordCount_Isotherms_CAS = RecordCount_Isotherms_CAS + 1
            Rs1.MoveNext
          Loop
        End If
        Rs1.Close
      End If
      If (DummyBool2) Then
        'MODIFY CHEMICAL NAME IN ISOTHERM RECORDS.
        Current_Criteria = "select * from [Isotherms] where " & _
            "[Name] = " & Chr$(34) & OldName & Chr$(34)
        Set Rs1 = _
            DB_Isotherm.OpenRecordset(Current_Criteria)
        On Error Resume Next
        Rs1.MoveFirst
        Rs1.MoveLast
        Rs1.MoveFirst
        NumRecords = Rs1.RecordCount
        On Error GoTo err_mnuChemicalItem_Click
        If (NumRecords = 0) Then
          'DO NOTHING.
        Else
          Do Until Rs1.EOF
            Rs1.Edit
            Rs1("Name") = NewName
            Rs1.Update
            RecordCount_Isotherms_Name = RecordCount_Isotherms_Name + 1
            Rs1.MoveNext
          Loop
        End If
        Rs1.Close
      End If
      'REDISPLAY WINDOW.
      Call populate_lstCompo
      Call lstCompo_Click
      'DISPLAY SUMMARY.
      Call Show_Message("Modification Summary:" & vbCrLf & vbCrLf & _
          "Total Chemical Records Changed: " & _
          Trim$(Str$(RecordCount_Chemicals)) & _
          vbCrLf & _
          "CAS Number Modified For: " & _
          Trim$(Str$(RecordCount_Isotherms_CAS)) & " Isotherm Record" & _
          IIf(RecordCount_Isotherms_CAS = 1, "", "s") & _
          vbCrLf & _
          "Chemical Name Modified For: " & Trim$(Str$(RecordCount_Isotherms_Name)) & " Isotherm Record" & _
          IIf(RecordCount_Isotherms_Name = 1, "", "s"))
    Case 3:       'delete current /////////////////////////////////////////////////////////////////////////////////////////////////
      'START THE EDIT PROCESS.
      Current_Criteria = "select * from [Chemicals] where " & _
          "[Compo ID] = " & Trim$(Str$(THIS_CHEMICAL_ID))
      Set Rs1 = _
          DB_Isotherm.OpenRecordset(Current_Criteria)
      Rs1.MoveFirst
      'DO USER INPUT.
      NewName = Database_Get_String(Rs1, "Name")
      NewCAS = Database_Get_String(Rs1, "CAS")
      DummyBool1 = True
      DummyBool2 = True
      Do While (1 = 1)
        Call frmEditIsothermCAS.frmEditIsothermCAS_Run( _
            "Deleting a Chemical", _
            "Delete CAS Number", _
            "Delete Chemical Name", _
            "*", _
            "*", _
            "Delete all isotherms with the same CAS number", _
            "Delete all isotherms with the same chemical name", _
            "&Delete", _
            USER_HIT_CANCEL, _
            NewCAS, NewName, _
            DummyStr1, DummyStr2, _
            DummyBool1, DummyBool2)
        If (USER_HIT_CANCEL) Then
          Exit Sub
        End If
        NewName = Trim$(NewName)
        NewCAS = Trim$(NewCAS)
        If (NewName = "") Then
          Call Show_Error("The chemical name must be a non-blank string.")
        Else
          If (NewCAS = "") And (DummyBool1) Then
            Call Show_Error("You cannot automatically delete " & _
                "all isotherm records currently without CAS numbers.")
          Else
            Exit Do
          End If
        End If
      Loop
      If (NewCAS <> "") Then
        NewCAS = Format$(CLng(Val(NewCAS)), "0")
      End If
      If (NewCAS <> "") Then
        Current_Criteria = "select * from [Chemicals] where " & _
            "[Name] = " & Chr$(34) & NewName & Chr$(34) & _
            " and [CAS] = " & NewCAS
      Else
        Current_Criteria = "select * from [Chemicals] where " & _
            "[Name] = " & Chr$(34) & NewName & Chr$(34)
      End If
      Set Rs1 = _
          DB_Isotherm.OpenRecordset(Current_Criteria)
      On Error Resume Next
      Rs1.MoveFirst
      Rs1.MoveLast
      Rs1.MoveFirst
      NumRecords = Rs1.RecordCount
      On Error GoTo err_mnuChemicalItem_Click
      RecordCount_Chemicals = 0
      If (NumRecords = 0) Then
        'DO NOTHING.
      Else
        Do Until Rs1.EOF
          Rs1.Delete
          RecordCount_Chemicals = RecordCount_Chemicals + 1
          Rs1.MoveNext
        Loop
      End If
      Rs1.Close
      RecordCount_Isotherms_CAS = 0
      RecordCount_Isotherms_Name = 0
      'DELETE ISOTHERMS WITH SAME CAS#/CHEMICAL NAME.
      If (DummyBool1) Then
        'DELETE ISOTHERM RECORDS WITH THIS CAS NUMBER.
        If (NewCAS <> "") Then
          Current_Criteria = "select * from [Isotherms] where " & _
              "[Component Number] = " & NewCAS
        Else
          Current_Criteria = "select * from [Isotherms] where " & _
              "[Component Number] = Null"
        End If
        Set Rs1 = _
            DB_Isotherm.OpenRecordset(Current_Criteria)
        On Error Resume Next
        Rs1.MoveFirst
        Rs1.MoveLast
        Rs1.MoveFirst
        NumRecords = Rs1.RecordCount
        On Error GoTo err_mnuChemicalItem_Click
        If (NumRecords = 0) Then
          'DO NOTHING.
        Else
          Do Until Rs1.EOF
            Rs1.Delete
            RecordCount_Isotherms_CAS = RecordCount_Isotherms_CAS + 1
            Rs1.MoveNext
          Loop
        End If
        Rs1.Close
      End If
      If (DummyBool2) Then
        'DELETE ISOTHERM RECORDS WITH THIS CHEMICAL NAME.
        Current_Criteria = "select * from [Isotherms] where " & _
            "[Name] = " & Chr$(34) & NewName & Chr$(34)
        Set Rs1 = _
            DB_Isotherm.OpenRecordset(Current_Criteria)
        On Error Resume Next
        Rs1.MoveFirst
        Rs1.MoveLast
        Rs1.MoveFirst
        NumRecords = Rs1.RecordCount
        On Error GoTo err_mnuChemicalItem_Click
        If (NumRecords = 0) Then
          'DO NOTHING.
        Else
          Do Until Rs1.EOF
            Rs1.Delete
            RecordCount_Isotherms_Name = RecordCount_Isotherms_Name + 1
            Rs1.MoveNext
          Loop
        End If
        Rs1.Close
      End If
      'REDISPLAY WINDOW.
      Call populate_lstCompo
      'DISPLAY SUMMARY.
      Call Show_Message("Modification Summary:" & vbCrLf & vbCrLf & _
          "Total Chemical Records Deleted: " & _
          Trim$(Str$(RecordCount_Chemicals)) & _
          vbCrLf & _
          "Isotherm Records Deleted with Matching CAS Number: " & _
          Trim$(Str$(RecordCount_Isotherms_CAS)) & " Isotherm Record" & _
          IIf(RecordCount_Isotherms_CAS = 1, "", "s") & _
          vbCrLf & _
          "Isotherm Records Deleted with Matching Chemical Name: " & Trim$(Str$(RecordCount_Isotherms_Name)) & " Isotherm Record" & _
          IIf(RecordCount_Isotherms_Name = 1, "", "s"))
  End Select
  Exit Sub
exit_err_mnuChemicalItem_Click:
  Exit Sub
err_mnuChemicalItem_Click:
  Call Show_Trapped_Error("mnuChemicalItem_Click")
  Resume exit_err_mnuChemicalItem_Click

End Sub
Private Sub mnuExit_Click()
  Unload Me
  Exit Sub
End Sub
Private Sub mnuIsothermItem_Click(Index As Integer)
Dim USER_HIT_CANCEL As Boolean
Dim USER_HIT_SAVE As Boolean
Dim USER_HIT_SAVEASNEW As Boolean
Dim THIS_CHEM_ID As Long
Dim THIS_ISOTHERM_ID As Long
Dim Current_Criteria As String
Dim Rs1 As Recordset
Dim NumRecords As Long
Dim DEFAULT_PHASE_IS_LIQUID As Boolean
Const INDEX_NEW = 1
Const INDEX_EDIT = 2
Const INDEX_DELETE = 3
Const INDEX_DELETE_ALL = 4
Dim NewName As String
Dim msg As String
Dim RetVal As Integer
Dim Select_Index As Integer
Dim i As Integer
Dim ThisName As String
Dim ThisCAS As String
Dim DEFAULT_CHEMICALNAME As String
Dim DEFAULT_CHEMICALCAS As String
Dim IsothermCount As Integer
Dim RecordCount_Deleted As Integer
  On Error GoTo err_mnuIsothermItem_Click
  If (lstCompo.ListIndex < 0) Or (lstCompo.ListCount = 0) Then
    Call Show_Error("You must first select a chemical.")
    Exit Sub
  End If
  THIS_CHEM_ID = lstCompo.ItemData(lstCompo.ListIndex)
  'GET CHEMICAL NAME AND CAS FOR THIS CHEMICAL.
  Current_Criteria = "select * from [Chemicals] " & _
        "where [Compo ID]=" & _
        Trim$(Str$(THIS_CHEM_ID)) & " " & _
        "order by [Name]"
  Set Rs1 = _
      DB_Isotherm.OpenRecordset(Current_Criteria)
  On Error Resume Next
  Rs1.MoveFirst
  Rs1.MoveLast
  Rs1.MoveFirst
  NumRecords = Rs1.RecordCount
  On Error GoTo err_mnuIsothermItem_Click
  If (NumRecords = 0) Then
    'NO RECORD(S) AVAILABLE; WEIRD PROBLEM.
    'EXIT SUBROUTINE.
    Exit Sub
  End If
  ThisName = Database_Get_String(Rs1, "Name")
  ThisCAS = Database_Get_String(Rs1, "CAS")
  If (Index = INDEX_EDIT) Or (Index = INDEX_DELETE) Then
    If (lstRange(0).ListIndex < 0) Or (lstRange(0).ListCount = 0) Then
      Call Show_Error("You must first select an isotherm.")
      Exit Sub
    End If
    THIS_ISOTHERM_ID = lstRange(0).ItemData(lstRange(0).ListIndex)
    'POSITION TO CURRENT ISOTHERM RECORD.
    Current_Criteria = "select * from [Isotherms] " & _
        "where [ID]=" & _
        Trim$(Str$(THIS_ISOTHERM_ID)) & " " & _
        "order by [Name]"
    Set Rs1 = _
        DB_Isotherm.OpenRecordset(Current_Criteria)
    On Error Resume Next
    Rs1.MoveFirst
    Rs1.MoveLast
    Rs1.MoveFirst
    NumRecords = Rs1.RecordCount
    On Error GoTo err_mnuIsothermItem_Click
    If (NumRecords = 0) Then
      'NO RECORD(S) AVAILABLE; WEIRD PROBLEM.
      'EXIT SUBROUTINE.
      Exit Sub
    End If
  End If
  Select Case Index
    Case INDEX_NEW:     '//////// NEW ISOTHERM. /////////////////////////////////////////////////////////////////////////////////////
      'DETERMINE DEFAULT PHASE.
      If (Bed.Phase = 0) Then
        DEFAULT_PHASE_IS_LIQUID = True
      Else
        DEFAULT_PHASE_IS_LIQUID = False
      End If
      'ALLOW USER TO ADD NEW RECORD.
      DEFAULT_CHEMICALNAME = ThisName
      DEFAULT_CHEMICALCAS = ThisCAS
      Call frmEditIsothermData.frmEditIsothermData_AddNew( _
          DEFAULT_PHASE_IS_LIQUID, _
          DEFAULT_CHEMICALNAME, _
          DEFAULT_CHEMICALCAS, _
          USER_HIT_CANCEL, _
          USER_HIT_SAVE)
      If (USER_HIT_CANCEL) Then Exit Sub
      'ADD THE NEW ISOTHERM RECORD.
      Current_Criteria = "select * from [Isotherms]"
      Set Rs1 = _
          DB_Isotherm.OpenRecordset(Current_Criteria)
      Rs1.AddNew
      'THE FIELD [ID] IS AUTOMATICALLY UPDATED.
      Rs1("Name") = frmEditIsothermData_Record.Name
      Rs1("K") = frmEditIsothermData_Record.k
      Rs1("1/n") = frmEditIsothermData_Record.OneOverN
      Rs1("C min") = frmEditIsothermData_Record.Cmin
      Rs1("C max") = frmEditIsothermData_Record.Cmax
      Rs1("pH min") = frmEditIsothermData_Record.pHmin
      Rs1("pH max") = frmEditIsothermData_Record.pHmax
      Rs1("Source") = frmEditIsothermData_Record.Source
      Rs1("CarbonName") = frmEditIsothermData_Record.CarbonName
      Rs1("Tmin") = frmEditIsothermData_Record.Tmin
      If (Trim$(frmEditIsothermData_Record.CAS) <> "") Then
        Rs1("Component Number") = CDbl(Val(frmEditIsothermData_Record.CAS))
      Else
        Rs1("Component Number") = Null
      End If
      If (frmEditIsothermData_Record.PhaseIsLiquid) Then
        Rs1("Phase") = "Liquid"
      Else
        Rs1("Phase") = "Gas"
      End If
      Rs1("Comments") = frmEditIsothermData_Record.Comments
      THIS_ISOTHERM_ID = Database_Get_Long(Rs1, "ID")
      Rs1.Update
      'CLOSE THE DATABASE.
      Rs1.Close
      'UPDATE WINDOW.
      Call lstCompo_Click
      'SELECT THE NEW ISOTHERM.
      Select_Index = 0
      For i = 0 To lstRange(0).ListCount - 1
        If (lstRange(0).ItemData(i) = THIS_ISOTHERM_ID) Then
          Select_Index = i
          Exit For
        End If
      Next i
      If (lstRange(0).ListCount > 0) Then
        lstRange(0).ListIndex = Select_Index
      End If
    Case INDEX_EDIT:     '//////// EDIT ISOTHERM. //////////////////////////////////////////////////////////////////////////////////////////////
      'TRANSFER DATABASE RECORD FIELDS TO LOCAL MEMORY.
      If (Database_Get_String(Rs1, "Phase") = "Liquid") Then
        frmEditIsothermData_Record.PhaseIsLiquid = True
      Else
        frmEditIsothermData_Record.PhaseIsLiquid = False
      End If
      frmEditIsothermData_Record.Name = Database_Get_String(Rs1, "Name")
      frmEditIsothermData_Record.k = Database_Get_Double(Rs1, "K")
      frmEditIsothermData_Record.OneOverN = Database_Get_Double(Rs1, "1/n")
      frmEditIsothermData_Record.Cmin = Database_Get_Double(Rs1, "C min")
      frmEditIsothermData_Record.Cmax = Database_Get_Double(Rs1, "C max")
      frmEditIsothermData_Record.pHmin = Database_Get_Double(Rs1, "pH min")
      frmEditIsothermData_Record.pHmax = Database_Get_Double(Rs1, "pH max")
      frmEditIsothermData_Record.Source = Database_Get_String(Rs1, "Source")
      frmEditIsothermData_Record.CarbonName = Database_Get_String(Rs1, "CarbonName")
      frmEditIsothermData_Record.Tmin = Database_Get_Double(Rs1, "Tmin")
      frmEditIsothermData_Record.CAS = Database_Get_String(Rs1, "Component Number")
      frmEditIsothermData_Record.Comments = Database_Get_String(Rs1, "Comments")
      'ALLOW USER TO EDIT THIS RECORD.
      Call frmEditIsothermData.frmEditIsothermData_Edit( _
          USER_HIT_CANCEL, _
          USER_HIT_SAVE, _
          USER_HIT_SAVEASNEW)
      If (USER_HIT_CANCEL) Then Exit Sub
      'SAVE THE EDITED ISOTHERM RECORD.
      Current_Criteria = "select * from [Isotherms] " & _
          "where [ID]=" & Trim$(Str$(THIS_ISOTHERM_ID))
      Set Rs1 = _
          DB_Isotherm.OpenRecordset(Current_Criteria)
      If (USER_HIT_SAVE) Then
        'MODIFY EXISTING RECORD.
        Rs1.Edit
        'KEEP ORIGINAL [ID] FIELD INTACT.
      End If
      If (USER_HIT_SAVEASNEW) Then
        'GENERATE NEW RECORD.
        Rs1.AddNew
        'THE FIELD [ID] IS AUTOMATICALLY CREATED DURING THE .Update COMMAND.
      End If
      Rs1("Name") = frmEditIsothermData_Record.Name
      Rs1("K") = frmEditIsothermData_Record.k
      Rs1("1/n") = frmEditIsothermData_Record.OneOverN
      Rs1("C min") = frmEditIsothermData_Record.Cmin
      Rs1("C max") = frmEditIsothermData_Record.Cmax
      Rs1("pH min") = frmEditIsothermData_Record.pHmin
      Rs1("pH max") = frmEditIsothermData_Record.pHmax
      Rs1("Source") = frmEditIsothermData_Record.Source
      Rs1("CarbonName") = frmEditIsothermData_Record.CarbonName
      Rs1("Tmin") = frmEditIsothermData_Record.Tmin
      If (Trim$(frmEditIsothermData_Record.CAS) <> "") Then
        Rs1("Component Number") = CDbl(Val(frmEditIsothermData_Record.CAS))
      Else
        Rs1("Component Number") = Null
      End If
      If (frmEditIsothermData_Record.PhaseIsLiquid) Then
        Rs1("Phase") = "Liquid"
      Else
        Rs1("Phase") = "Gas"
      End If
      Rs1("Comments") = frmEditIsothermData_Record.Comments
      Rs1.Update
      'CLOSE THE DATABASE.
      Rs1.Close
      'UPDATE WINDOW.
      Call lstCompo_Click
    Case INDEX_DELETE:          '//////// DELETE ISOTHERM. /////////////////////////////////////////////////////////////////////////
      msg = "Isotherm Selected for Deletion:" & vbCrLf & _
          vbCrLf & _
          "    K = " & NumberToMFBString(Database_Get_Double(Rs1, "K")) & vbCrLf & _
          "    1/n = " & NumberToMFBString(Database_Get_Double(Rs1, "1/n")) & vbCrLf & _
          "    Carbon Name = " & Database_Get_String(Rs1, "CarbonName") & vbCrLf & _
          vbCrLf & _
          "Do you really want to delete this isotherm ?"
      RetVal = MsgBox(msg, vbCritical + vbYesNo, Application_Name)
      If RetVal = vbNo Then Exit Sub
      'PERFORM DELETION.
      Current_Criteria = "select * from [Isotherms] where " & _
          "[ID] = " & Trim$(Str$(THIS_ISOTHERM_ID))
      Set Rs1 = _
          DB_Isotherm.OpenRecordset(Current_Criteria)
      Rs1.Delete
      'CLOSE THE DATABASE.
      Rs1.Close
      'UPDATE WINDOW.
      Call lstCompo_Click
    Case INDEX_DELETE_ALL:      '//////// DELETE ALL ISOTHERMS. /////////////////////////////////////////////////////////////////////////
      'DETERMINE ISOTHERM COUNT.
      If (ThisCAS <> "") Then
        Current_Criteria = "select * from [Isotherms] " & _
            "where [Name]=" & Chr$(34) & Trim$(ThisName) & Chr$(34) & _
            " and [Component Number]=" & Trim$(ThisCAS)
      Else
        Current_Criteria = "select * from [Isotherms] " & _
            "where [Name]=" & Chr$(34) & Trim$(ThisName) & Chr$(34) & _
            " and [Component Number]=Null"
      End If
      Set Rs1 = _
          DB_Isotherm.OpenRecordset(Current_Criteria)
      On Error Resume Next
      Rs1.MoveFirst
      Rs1.MoveLast
      Rs1.MoveFirst
      NumRecords = Rs1.RecordCount
      On Error GoTo err_mnuIsothermItem_Click
      If (NumRecords = 0) Then
        'NO RECORD(S) AVAILABLE.
        Call Show_Error("There are no isotherms to delete for this chemical and CAS number.")
        Exit Sub
      Else
        IsothermCount = NumRecords
      End If
      'CHECK WITH USER: "ARE YOU SURE?"
      msg = "Isotherms Selected for Deletion:" & vbCrLf & _
          vbCrLf & _
          "    Chemical Name = " & ThisName & vbCrLf & _
          "    CAS = " & ThisCAS & vbCrLf & _
          vbCrLf & _
          "    Total = " & Trim$(Str$(IsothermCount)) & " Isotherm Record" & _
          IIf(IsothermCount = 1, "", "s") & vbCrLf & vbCrLf & _
          "Do you really want to delete these isotherms ?"
      RetVal = MsgBox(msg, vbCritical + vbYesNo, Application_Name)
      If RetVal = vbNo Then Exit Sub
      'PERFORM DELETION.
      'USE CRITERIA "Current_Criteria" FROM ABOVE.
      Set Rs1 = _
          DB_Isotherm.OpenRecordset(Current_Criteria)
      RecordCount_Deleted = 0
      Do Until Rs1.EOF
        Rs1.Delete
        RecordCount_Deleted = RecordCount_Deleted + 1
        Rs1.MoveNext
      Loop
      'CLOSE THE DATABASE.
      Rs1.Close
      'UPDATE WINDOW.
      Call lstCompo_Click
      'DISPLAY SUMMARY.
      Call Show_Message("Modification Summary:" & vbCrLf & vbCrLf & _
          "Total Isotherm Records Deleted: " & _
          Trim$(Str$(RecordCount_Deleted)))
  End Select
  Exit Sub
exit_err_mnuIsothermItem_Click:
  Exit Sub
err_mnuIsothermItem_Click:
  Call Show_Trapped_Error("mnuIsothermItem_Click")
  Resume exit_err_mnuIsothermItem_Click
End Sub


Private Sub optSort_Click(Index As Integer, Value As Integer)
  Call populate_lstCompo
End Sub



VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmEditIsothermCAS 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "{me.caption}"
   ClientHeight    =   2985
   ClientLeft      =   2085
   ClientTop       =   4650
   ClientWidth     =   7530
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   2985
   ScaleWidth      =   7530
   Begin Threed.SSCheck chkData 
      Height          =   285
      Index           =   0
      Left            =   540
      TabIndex        =   8
      Top             =   1560
      Width           =   6825
      _Version        =   65536
      _ExtentX        =   12039
      _ExtentY        =   503
      _StockProps     =   78
      Caption         =   "chkData(0)"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin VB.TextBox txtData 
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Index           =   3
      Left            =   2880
      TabIndex        =   6
      Text            =   "txtData(3)"
      Top             =   1170
      Width           =   4500
   End
   Begin VB.TextBox txtData 
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Index           =   2
      Left            =   2880
      TabIndex        =   4
      Text            =   "txtData(2)"
      Top             =   810
      Width           =   2385
   End
   Begin VB.TextBox txtData 
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Index           =   1
      Left            =   2880
      TabIndex        =   2
      Text            =   "txtData(1)"
      Top             =   450
      Width           =   4500
   End
   Begin VB.TextBox txtData 
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Index           =   0
      Left            =   2880
      TabIndex        =   0
      Text            =   "txtData(0)"
      Top             =   90
      Width           =   2385
   End
   Begin Threed.SSCheck chkData 
      Height          =   285
      Index           =   1
      Left            =   540
      TabIndex        =   9
      Top             =   1920
      Width           =   6825
      _Version        =   65536
      _ExtentX        =   12039
      _ExtentY        =   503
      _StockProps     =   78
      Caption         =   "chkData(1)"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdSaveCancel 
      Height          =   495
      Index           =   0
      Left            =   120
      TabIndex        =   10
      TabStop         =   0   'False
      Top             =   2370
      Width           =   2000
      _Version        =   65536
      _ExtentX        =   3528
      _ExtentY        =   873
      _StockProps     =   78
      Caption         =   "cmdSaveCancel(0)"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdSaveCancel 
      Height          =   495
      Index           =   1
      Left            =   5880
      TabIndex        =   11
      TabStop         =   0   'False
      Top             =   2370
      Width           =   1500
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   873
      _StockProps     =   78
      Caption         =   "&Cancel"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin VB.Label lblDesc 
      Alignment       =   1  'Right Justify
      Caption         =   "lblDesc(3)"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   225
      Index           =   3
      Left            =   120
      TabIndex        =   7
      Top             =   1200
      Width           =   2715
   End
   Begin VB.Label lblDesc 
      Alignment       =   1  'Right Justify
      Caption         =   "lblDesc(2)"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   225
      Index           =   2
      Left            =   120
      TabIndex        =   5
      Top             =   840
      Width           =   2715
   End
   Begin VB.Label lblDesc 
      Alignment       =   1  'Right Justify
      Caption         =   "lblDesc(1)"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   225
      Index           =   1
      Left            =   120
      TabIndex        =   3
      Top             =   480
      Width           =   2715
   End
   Begin VB.Label lblDesc 
      Alignment       =   1  'Right Justify
      Caption         =   "lblDesc(0)"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   225
      Index           =   0
      Left            =   120
      TabIndex        =   1
      Top             =   120
      Width           =   2715
   End
End
Attribute VB_Name = "frmEditIsothermCAS"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Dim USER_HIT_CANCEL As Boolean
Dim USER_HIT_OK As Boolean


Dim Use_Title As String
Dim Use_TextLabel_1a As String
Dim Use_TextLabel_1b As String
Dim Use_TextLabel_2a As String
Dim Use_TextLabel_2b As String
Dim Use_OptionLabel_1 As String
Dim Use_OptionLabel_2 As String
Dim Use_OK_Caption As String

Dim VarText_1a As String
Dim VarText_1b As String
Dim VarText_2a As String
Dim VarText_2b As String
Dim VarBool_1 As Boolean
Dim VarBool_2 As Boolean


Const frmEditIsothermCAS_declarations_end = True


Public Sub frmEditIsothermCAS_Run( _
    INPUT_Use_Title As String, _
    INPUT_Use_TextLabel_1a As String, _
    INPUT_Use_TextLabel_1b As String, _
    INPUT_Use_TextLabel_2a As String, _
    INPUT_Use_TextLabel_2b As String, _
    INPUT_Use_OptionLabel_1 As String, _
    INPUT_Use_OptionLabel_2 As String, _
    INPUT_Use_OK_Caption As String, _
    OUTPUT_USER_HIT_CANCEL As Boolean, _
    IO_VarText_1a As String, _
    IO_VarText_1b As String, _
    IO_VarText_2a As String, _
    IO_VarText_2b As String, _
    IO_VarBool_1 As Boolean, _
    IO_VarBool_2 As Boolean)
  Use_Title = INPUT_Use_Title
  Use_TextLabel_1a = INPUT_Use_TextLabel_1a
  Use_TextLabel_1b = INPUT_Use_TextLabel_1b
  Use_TextLabel_2a = INPUT_Use_TextLabel_2a
  Use_TextLabel_2b = INPUT_Use_TextLabel_2b
  Use_OptionLabel_1 = INPUT_Use_OptionLabel_1
  Use_OptionLabel_2 = INPUT_Use_OptionLabel_2
  Use_OK_Caption = INPUT_Use_OK_Caption
  VarText_1a = IO_VarText_1a
  VarText_1b = IO_VarText_1b
  VarText_2a = IO_VarText_2a
  VarText_2b = IO_VarText_2b
  VarBool_1 = IO_VarBool_1
  VarBool_2 = IO_VarBool_2
  frmEditIsothermCAS.Show 1
  OUTPUT_USER_HIT_CANCEL = USER_HIT_CANCEL
  If (USER_HIT_OK) Then
    IO_VarText_1a = VarText_1a
    IO_VarText_1b = VarText_1b
    IO_VarText_2a = VarText_2a
    IO_VarText_2b = VarText_2b
    IO_VarBool_1 = VarBool_1
    IO_VarBool_2 = VarBool_2
  End If
End Sub






Private Sub cmdSaveCancel_Click(Index As Integer)
  Select Case Index
    Case 0:     'OK.
      'TRANSFER DATA FROM CONTROLS TO MEMORY.
      VarText_1a = txtData(0).Text
      VarText_1b = txtData(1).Text
      VarText_2a = txtData(2).Text
      VarText_2b = txtData(3).Text
      VarBool_1 = chkData(0).Value
      VarBool_2 = chkData(1).Value
      'EXIT OUT OF HERE.
      USER_HIT_CANCEL = False
      USER_HIT_OK = True
      Unload Me
      Exit Sub
    Case 1:     'CANCEL.
      'EXIT OUT OF HERE.
      USER_HIT_CANCEL = True
      USER_HIT_OK = False
      Unload Me
      Exit Sub
  End Select
End Sub


Private Sub Form_Load()
  'MISC INITS.
  Me.Caption = Use_Title
  cmdSaveCancel(0).Caption = Use_OK_Caption
  If (Left$(Use_TextLabel_1a, 1) = "^") Then
    Use_TextLabel_1a = Right$(Use_TextLabel_1a, Len(Use_TextLabel_1a) - 1)
    txtData(0).Locked = True
    txtData(0).BackColor = QBColor(7)
  End If
  If (Left$(Use_TextLabel_1b, 1) = "^") Then
    Use_TextLabel_1b = Right$(Use_TextLabel_1b, Len(Use_TextLabel_1b) - 1)
    txtData(1).Locked = True
    txtData(1).BackColor = QBColor(7)
  End If
  lblDesc(0).Caption = Use_TextLabel_1a
  lblDesc(1).Caption = Use_TextLabel_1b
  lblDesc(2).Caption = Use_TextLabel_2a
  lblDesc(3).Caption = Use_TextLabel_2b
  chkData(0).Caption = Use_OptionLabel_1
  chkData(1).Caption = Use_OptionLabel_2
  txtData(0).Text = VarText_1a
  txtData(1).Text = VarText_1b
  txtData(2).Text = VarText_2a
  txtData(3).Text = VarText_2b
  chkData(0).Value = VarBool_1
  chkData(1).Value = VarBool_2
  If (lblDesc(2).Caption = "*") Then
    lblDesc(2).Visible = False
    lblDesc(3).Visible = False
    txtData(2).Visible = False
    txtData(3).Visible = False
  End If
  If (chkData(0).Caption = "*") Then
    chkData(0).Visible = False
    chkData(1).Visible = False
  End If
  Me.Height = 3390
  Me.Width = 7650
  Call CenterOnForm(Me, frmEditAdsorber)
End Sub






Private Sub txtData_GotFocus(Index As Integer)
Dim txtCtl As Control
Set txtCtl = txtData(Index)
  If (txtCtl.Locked) Then Exit Sub
  Call Global_GotFocus(txtCtl)
End Sub
Private Sub txtData_KeyPress(Index As Integer, KeyAscii As Integer)
  KeyAscii = Global_TextKeyPress(KeyAscii)
End Sub
Private Sub txtData_LostFocus(Index As Integer)
Dim txtCtl As Control
Set txtCtl = txtData(Index)
  If (txtCtl.Locked) Then Exit Sub
  Call Global_LostFocus(txtCtl)
End Sub



VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmEditIsothermData 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Editing an Isotherm"
   ClientHeight    =   6630
   ClientLeft      =   6285
   ClientTop       =   1980
   ClientWidth     =   7815
   ControlBox      =   0   'False
   LinkTopic       =   "Form2"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   6630
   ScaleWidth      =   7815
   ShowInTaskbar   =   0   'False
   Begin Threed.SSFrame SSFrame1 
      Height          =   735
      Left            =   90
      TabIndex        =   12
      Top             =   3360
      Width           =   7635
      _Version        =   65536
      _ExtentX        =   13467
      _ExtentY        =   1296
      _StockProps     =   14
      Caption         =   "Phase:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin Threed.SSOption optPhase 
         Height          =   255
         Index           =   2
         Left            =   5190
         TabIndex        =   28
         TabStop         =   0   'False
         Top             =   270
         Width           =   2055
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "&Gas"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24.27
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Enabled         =   0   'False
      End
      Begin Threed.SSOption optPhase 
         Height          =   255
         Index           =   1
         Left            =   1470
         TabIndex        =   29
         TabStop         =   0   'False
         Top             =   270
         Width           =   2055
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "&Liquid"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24.27
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Enabled         =   0   'False
      End
   End
   Begin Threed.SSFrame SSFrame2 
      Height          =   765
      Left            =   90
      TabIndex        =   13
      Top             =   4170
      Width           =   7635
      _Version        =   65536
      _ExtentX        =   13467
      _ExtentY        =   1349
      _StockProps     =   14
      Caption         =   "Source:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.TextBox txtData 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   10
         Left            =   1440
         TabIndex        =   10
         Text            =   "txtData(10)"
         Top             =   300
         Width           =   6015
      End
   End
   Begin Threed.SSFrame SSFrame3 
      Height          =   2025
      Left            =   90
      TabIndex        =   14
      Top             =   1260
      Width           =   7635
      _Version        =   65536
      _ExtentX        =   13467
      _ExtentY        =   3572
      _StockProps     =   14
      Caption         =   "Data:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.TextBox txtData 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   0
         Left            =   1740
         TabIndex        =   2
         Text            =   "txtData(0)"
         Top             =   240
         Width           =   1635
      End
      Begin VB.TextBox txtData 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   1
         Left            =   1740
         TabIndex        =   4
         Text            =   "txtData(1)"
         Top             =   600
         Width           =   1635
      End
      Begin VB.TextBox txtData 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   2
         Left            =   1740
         TabIndex        =   6
         Text            =   "txtData(2)"
         Top             =   960
         Width           =   1635
      End
      Begin VB.TextBox txtData 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   3
         Left            =   1740
         TabIndex        =   8
         Text            =   "txtData(3)"
         Top             =   1320
         Width           =   1635
      End
      Begin VB.TextBox txtData 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   4
         Left            =   5280
         TabIndex        =   3
         Text            =   "txtData(4)"
         Top             =   240
         Width           =   1635
      End
      Begin VB.TextBox txtData 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   5
         Left            =   5280
         TabIndex        =   5
         Text            =   "txtData(5)"
         Top             =   600
         Width           =   1635
      End
      Begin VB.TextBox txtData 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   6
         Left            =   5280
         TabIndex        =   7
         Text            =   "txtData(6)"
         Top             =   960
         Width           =   1635
      End
      Begin VB.TextBox txtData 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   7
         Left            =   5280
         TabIndex        =   9
         Text            =   "txtData(7)"
         Top             =   1320
         Width           =   1635
      End
      Begin VB.Label lblData 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "K (*)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   60
         TabIndex        =   27
         Top             =   270
         Width           =   1575
      End
      Begin VB.Label lblData 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "1/n"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   3780
         TabIndex        =   26
         Top             =   270
         Width           =   1335
      End
      Begin VB.Label lblData 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "C min. (mg/L)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   60
         TabIndex        =   25
         Top             =   630
         Width           =   1575
      End
      Begin VB.Label lblData 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "C max. (mg/L)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   3780
         TabIndex        =   24
         Top             =   630
         Width           =   1335
      End
      Begin VB.Label lblData 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "pH min."
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   60
         TabIndex        =   23
         Top             =   990
         Width           =   1575
      End
      Begin VB.Label lblData 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "pH max."
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   6
         Left            =   3840
         TabIndex        =   22
         Top             =   990
         Width           =   1335
      End
      Begin VB.Label lblData 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Temperature (C)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   60
         TabIndex        =   21
         Top             =   1350
         Width           =   1575
      End
      Begin VB.Label lblData 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Carbon type"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   7
         Left            =   3840
         TabIndex        =   20
         Top             =   1350
         Width           =   1335
      End
      Begin VB.Label Label11 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "* K in (mg/g)x(L/mg)^1/n"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   600
         TabIndex        =   19
         Top             =   1710
         Width           =   3435
      End
   End
   Begin Threed.SSFrame SSFrame4 
      Height          =   765
      Left            =   90
      TabIndex        =   15
      Top             =   5010
      Width           =   7635
      _Version        =   65536
      _ExtentX        =   13467
      _ExtentY        =   1349
      _StockProps     =   14
      Caption         =   "Comments:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.TextBox txtData 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   11
         Left            =   1440
         TabIndex        =   11
         Text            =   "txtData(11)"
         Top             =   300
         Width           =   6015
      End
   End
   Begin Threed.SSFrame SSFrame5 
      Height          =   1065
      Left            =   90
      TabIndex        =   16
      Top             =   120
      Width           =   7635
      _Version        =   65536
      _ExtentX        =   13467
      _ExtentY        =   1879
      _StockProps     =   14
      Caption         =   "Chemical:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.TextBox txtData 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   9
         Left            =   1440
         TabIndex        =   1
         Text            =   "txtData(9)"
         Top             =   600
         Width           =   6015
      End
      Begin VB.TextBox txtData 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   8
         Left            =   1440
         TabIndex        =   0
         Text            =   "txtData(8)"
         Top             =   240
         Width           =   3135
      End
      Begin VB.Label Label1 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "CAS Number"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   120
         TabIndex        =   18
         Top             =   270
         Width           =   1215
      End
      Begin VB.Label Label2 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Name"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   300
         TabIndex        =   17
         Top             =   630
         Width           =   1035
      End
   End
   Begin Threed.SSCommand cmdSaveCancel 
      Height          =   495
      Index           =   1
      Left            =   2730
      TabIndex        =   30
      TabStop         =   0   'False
      Top             =   5970
      Width           =   2295
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      Caption         =   "Save &As New Record"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdSaveCancel 
      Height          =   495
      Index           =   0
      Left            =   90
      TabIndex        =   31
      TabStop         =   0   'False
      Top             =   5970
      Width           =   945
      _Version        =   65536
      _ExtentX        =   1667
      _ExtentY        =   873
      _StockProps     =   78
      Caption         =   "&Save"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdSaveCancel 
      Height          =   495
      Index           =   2
      Left            =   6780
      TabIndex        =   32
      TabStop         =   0   'False
      Top             =   5970
      Width           =   945
      _Version        =   65536
      _ExtentX        =   1667
      _ExtentY        =   873
      _StockProps     =   78
      Caption         =   "&Cancel"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
End
Attribute VB_Name = "frmEditIsothermData"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Dim FORM_MODE As Integer
Const FORM_MODE_ADDNEW = 1
Const FORM_MODE_EDIT = 2

Dim USER_HIT_CANCEL As Boolean
Dim USER_HIT_SAVE As Boolean
Dim USER_HIT_SAVEASNEW As Boolean

Dim DEFAULT_PHASE_IS_LIQUID As Boolean
Dim DEFAULT_CHEMICALNAME As String
Dim DEFAULT_CHEMICALCAS As String



Const frmEditIsothermData_declarations_end = True


Sub frmEditIsothermData_AddNew( _
    INPUT_DEFAULT_PHASE_IS_LIQUID As Boolean, _
    INPUT_DEFAULT_CHEMICALNAME As String, _
    INPUT_DEFAULT_CHEMICALCAS As String, _
    OUTPUT_USER_HIT_CANCEL As Boolean, _
    OUTPUT_USER_HIT_SAVE As Boolean)
  DEFAULT_PHASE_IS_LIQUID = INPUT_DEFAULT_PHASE_IS_LIQUID
  DEFAULT_CHEMICALNAME = INPUT_DEFAULT_CHEMICALNAME
  DEFAULT_CHEMICALCAS = INPUT_DEFAULT_CHEMICALCAS
  FORM_MODE = FORM_MODE_ADDNEW
  frmEditIsothermData.Show 1
  OUTPUT_USER_HIT_CANCEL = USER_HIT_CANCEL
  OUTPUT_USER_HIT_SAVE = USER_HIT_SAVE
End Sub
Sub frmEditIsothermData_Edit( _
    OUTPUT_USER_HIT_CANCEL As Boolean, _
    OUTPUT_USER_HIT_SAVE As Boolean, _
    OUTPUT_USER_HIT_SAVEASNEW As Boolean)
  FORM_MODE = FORM_MODE_EDIT
  frmEditIsothermData.Show 1
  OUTPUT_USER_HIT_CANCEL = USER_HIT_CANCEL
  OUTPUT_USER_HIT_SAVE = USER_HIT_SAVE
  OUTPUT_USER_HIT_SAVEASNEW = USER_HIT_SAVEASNEW
End Sub



Sub frmEditIsothermData_PopulateUnits()
  Call unitsys_register(frmEditIsothermData, lblData(0), _
      txtData(0), Nothing, "", _
      "", "", "", "", 100#, False)
  Call unitsys_register(frmEditIsothermData, lblData(1), _
      txtData(1), Nothing, "", _
      "", "", "", "", 100#, False)
  Call unitsys_register(frmEditIsothermData, lblData(2), _
      txtData(2), Nothing, "", _
      "", "", "", "", 100#, False)
  Call unitsys_register(frmEditIsothermData, lblData(3), _
      txtData(3), Nothing, "", _
      "", "", "", "", 100#, False)
  Call unitsys_register(frmEditIsothermData, lblData(4), _
      txtData(4), Nothing, "", _
      "", "", "", "", 100#, False)
  Call unitsys_register(frmEditIsothermData, lblData(5), _
      txtData(5), Nothing, "", _
      "", "", "", "", 100#, False)
  Call unitsys_register(frmEditIsothermData, lblData(6), _
      txtData(6), Nothing, "", _
      "", "", "", "", 100#, False)
End Sub


Private Sub cmdSaveCancel_Click(Index As Integer)
  Select Case Index
    Case 0:       'SAVE.
      USER_HIT_CANCEL = False
      USER_HIT_SAVE = True
      USER_HIT_SAVEASNEW = False
      Unload Me
      Exit Sub
    Case 1:       'SAVE AS NEW RECORD.
      USER_HIT_CANCEL = False
      USER_HIT_SAVE = False
      USER_HIT_SAVEASNEW = True
      Unload Me
      Exit Sub
    Case 2:       'CANCEL.
      USER_HIT_CANCEL = True
      USER_HIT_SAVE = False
      USER_HIT_SAVEASNEW = False
      Unload Me
      Exit Sub
  End Select
End Sub


Private Sub Form_Load()
  'MISC INITS.
  Me.Height = 7035
  Me.Width = 7935
  Call CenterOnForm(Me, frmEditIsotherm)
  'STRANGE THINGS CAN HAPPEN IF OPTION BOXES ARE ENABLED
  'BEFORE THE FORM IS LOADED/ACTIVATED.
  optPhase(1).Enabled = True
  optPhase(2).Enabled = True
  If (FORM_MODE = FORM_MODE_EDIT) Then
    'EDIT MODE.
    cmdSaveCancel(0).Visible = True
    cmdSaveCancel(1).Visible = True
    cmdSaveCancel(2).Visible = True
  Else
    'ADD NEW MODE.
    cmdSaveCancel(0).Visible = True
    cmdSaveCancel(1).Visible = False
    cmdSaveCancel(2).Visible = True
    'SET DEFAULTS FOR THE NEW RECORD.
    frmEditIsothermData_Record.PhaseIsLiquid = DEFAULT_PHASE_IS_LIQUID
    frmEditIsothermData_Record.Name = DEFAULT_CHEMICALNAME
    frmEditIsothermData_Record.CAS = DEFAULT_CHEMICALCAS
    frmEditIsothermData_Record.k = 1#
    frmEditIsothermData_Record.OneOverN = 1#
    frmEditIsothermData_Record.Cmin = 0#
    frmEditIsothermData_Record.Cmax = 0#
    frmEditIsothermData_Record.pHmin = 0#
    frmEditIsothermData_Record.pHmax = 0#
    frmEditIsothermData_Record.Source = "Type Source Here"
    frmEditIsothermData_Record.CarbonName = "Type Carbon Here"
    frmEditIsothermData_Record.Tmin = 25#
    frmEditIsothermData_Record.Comments = ""
  End If
  If (frmEditIsothermData_Record.PhaseIsLiquid) Then
    optPhase(1).Value = True
    optPhase(2).Value = False
  Else
    optPhase(1).Value = False
    optPhase(2).Value = True
  End If
  'POPULATE UNIT CONTROLS.
  Call frmEditIsothermData_PopulateUnits
  'REFRESH DISPLAY.
  Call frmEditIsothermData_Refresh
End Sub
Private Sub Form_Unload(Cancel As Integer)
  Call unitsys_unregister_all_on_form(Me)
End Sub









Private Sub optPhase_Click(Index As Integer, Value As Integer)
  If (Index = 1) Then
    frmEditIsothermData_Record.PhaseIsLiquid = True
  Else
    frmEditIsothermData_Record.PhaseIsLiquid = False
  End If
End Sub


Private Sub txtData_GotFocus(Index As Integer)
Dim Ctl As Control
Set Ctl = txtData(Index)
  If (Index >= 7) And (Index <= 11) Then
    Call Global_GotFocus(Ctl)
  Else
    Call unitsys_control_txtx_gotfocus(Ctl)
  End If
End Sub
Private Sub txtData_KeyPress(Index As Integer, KeyAscii As Integer)
  If (Index >= 7) And (Index <= 11) Then
    If (Index = 8) Then
      KeyAscii = Global_Numeric0123456789KeyPress(KeyAscii)
    Else
      KeyAscii = Global_TextKeyPress(KeyAscii)
    End If
  Else
    KeyAscii = Global_NumericKeyPress(KeyAscii)
  End If
End Sub
Private Sub txtData_LostFocus(Index As Integer)
Dim NewValue_Okay As Integer
Dim NewValue As Double
Dim Ctl As Control
Set Ctl = txtData(Index)
Dim Val_Low As Double
Dim Val_High As Double
Dim Raise_Dirty_Flag As Boolean
Dim Too_Small As Integer
Dim OldValueStr As String
  'HANDLE STRING FIELDS.
  If (Index >= 7) And (Index <= 11) Then
    Select Case Index
      Case 7: OldValueStr = Trim$(frmEditIsothermData_Record.CarbonName)
      Case 8: OldValueStr = Trim$(frmEditIsothermData_Record.CAS)
      Case 9: OldValueStr = Trim$(frmEditIsothermData_Record.Name)
      Case 10: OldValueStr = Trim$(frmEditIsothermData_Record.Source)
      Case 11: OldValueStr = Trim$(frmEditIsothermData_Record.Comments)
    End Select
    'NOTE: ZERO-LENGTH STRINGS FOR 8 AND 11 ARE ALLOWED.
    If (Trim$(Ctl.Text) = "") And _
        (Index <> 8) And (Index <> 11) Then
      Ctl.Text = OldValueStr
      'Call Show_Error("You must enter a non-blank string for the carbon name.")
      'NOTE: SHOWING THIS ERROR MESSAGE MESSES UP THE
      'SUBSEQUENT GOTFOCUS IF THE USER HITS <Enter> OR <Tab>.
    Else
      If (Trim$(OldValueStr) <> Trim$(Ctl.Text)) Then
        Select Case Index
          Case 7: frmEditIsothermData_Record.CarbonName = Trim$(Ctl.Text)
          Case 8: frmEditIsothermData_Record.CAS = Trim$(Ctl.Text)
          Case 9: frmEditIsothermData_Record.Name = Trim$(Ctl.Text)
          Case 10: frmEditIsothermData_Record.Source = Trim$(Ctl.Text)
          Case 11: frmEditIsothermData_Record.Comments = Trim$(Ctl.Text)
        End Select
        ''THROW DIRTY FLAG.
        'Call DirtyStatus_Throw
      End If
    End If
    Call Global_LostFocus(Ctl)
    'Call GenericStatus_Set("")
    Exit Sub
  End If
  'NOTE: LOW AND HIGH VALUES IN BASE UNITS.
  Select Case Index
    Case 0: Val_Low = 1E-20: Val_High = 1E+20
    Case 1: Val_Low = 0#: Val_High = 1E+20
    Case 2: Val_Low = 0#: Val_High = 1E+20
    Case 3: Val_Low = 1E-20: Val_High = 1E+20
    Case 4: Val_Low = 1E-20: Val_High = 1E+20
    Case 5: Val_Low = 0#: Val_High = 1E+20
    Case 6: Val_Low = 0#: Val_High = 1E+20
  End Select
  NewValue_Okay = False
  If (unitsys_control_txtx_lostfocus_validate(Ctl, Val_Low, Val_High, NewValue, Raise_Dirty_Flag)) Then
    NewValue_Okay = True
  End If
  Call unitsys_control_txtx_lostfocus(Ctl, NewValue)
  If (NewValue_Okay) Then
    If (Raise_Dirty_Flag) Then
      'STORE TO MEMORY.
      Select Case Index
        Case 0:         'FREUNDLICH K.
          frmEditIsothermData_Record.k = NewValue
        Case 1:         'MINIMUM CONCENTRATION.
          frmEditIsothermData_Record.Cmin = NewValue
        Case 2:         'MINIMUM pH.
          frmEditIsothermData_Record.pHmin = NewValue
        Case 3:         'TEMPERATURE.
          frmEditIsothermData_Record.Tmin = NewValue
        Case 4:         'FREUNDLICH 1/n.
          frmEditIsothermData_Record.OneOverN = NewValue
        Case 5:         'MAXIMUM CONCENTRATION.
          frmEditIsothermData_Record.Cmax = NewValue
        Case 6:         'MAXIMUM pH.
          frmEditIsothermData_Record.pHmax = NewValue
      End Select
      'RAISE DIRTY FLAG IF NECESSARY.
      If (Raise_Dirty_Flag) Then
        ''THROW DIRTY FLAG.
        'Call frmCompoProp_DirtyStatus_Throw
      End If
      'REFRESH WINDOW.
      Call frmEditIsothermData_Refresh
    End If
  End If
End Sub






VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Object = "{F9043C88-F6F2-101A-A3C9-08002B2F49FB}#1.1#0"; "Comdlg32.ocx"
Object = "{042BADC8-5E58-11CE-B610-524153480001}#1.0#0"; "vcf132.ocx"
Begin VB.Form frmExcelCurves 
   Caption         =   "frmExcelCurves"
   ClientHeight    =   6315
   ClientLeft      =   1950
   ClientTop       =   2550
   ClientWidth     =   8880
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MinButton       =   0   'False
   PaletteMode     =   1  'UseZOrder
   ScaleHeight     =   6315
   ScaleWidth      =   8880
   WindowState     =   2  'Maximized
   Begin Threed.SSFrame SSFrame1 
      Height          =   1005
      Left            =   2100
      TabIndex        =   1
      Top             =   4470
      Visible         =   0   'False
      Width           =   2805
      _Version        =   65536
      _ExtentX        =   4948
      _ExtentY        =   1773
      _StockProps     =   14
      Caption         =   "Invisible"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin MSComDlg.CommonDialog CommonDialog1 
         Left            =   330
         Top             =   270
         _ExtentX        =   847
         _ExtentY        =   847
         _Version        =   327681
      End
   End
   Begin VCIF1Lib.F1Book f1book 
      Height          =   4275
      Left            =   60
      OleObjectBlob   =   "ExcelCurves.frx":0000
      TabIndex        =   0
      Top             =   90
      Width           =   6345
   End
   Begin VB.Menu mnuFile 
      Caption         =   "&File"
      Begin VB.Menu mnuFileItem 
         Caption         =   "Save &As ..."
         Index           =   40
      End
      Begin VB.Menu mnuFileItem 
         Caption         =   "-"
         Index           =   49
      End
      Begin VB.Menu mnuFileItem 
         Caption         =   "Page Setup ..."
         Index           =   50
      End
      Begin VB.Menu mnuFileItem 
         Caption         =   "Printer Setup ..."
         Index           =   55
      End
      Begin VB.Menu mnuFileItem 
         Caption         =   "&Print (Current Sheet Only) ..."
         Index           =   60
      End
      Begin VB.Menu mnuFileItem 
         Caption         =   "-"
         Index           =   198
      End
      Begin VB.Menu mnuFileItem 
         Caption         =   "&Close"
         Index           =   199
      End
   End
   Begin VB.Menu mnuEdit 
      Caption         =   "&Edit"
      Begin VB.Menu mnuEditItem 
         Caption         =   "&Copy"
         Index           =   10
      End
   End
End
Attribute VB_Name = "frmExcelCurves"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Dim frmExcelCurves_loading_now As Boolean






Const frmExcelCurves_declarations_end = 0


Sub Do_The_Print_To_F1Book()


Dim f1 As Control
Set f1 = Me.f1book
'Dim sserror As Integer
Dim i As Integer
Dim J As Integer
Dim last_row As Integer
Dim last_col As Integer
  If (CPHSDM_Excel) Then
    '
    '    ----    CPHSDM RESULTS.    ----
    '
    f1.MinCol = 1
    f1.MinRow = 1
    f1.EntryRC(1, 1) = "CPHSDM Results -- Filename = " & Chr$(34) & Trim$(Filename) & Chr$(34)
    f1.EntryRC(3, 1) = "Time"
    f1.EntryRC(3, 2) = "BVT"
    f1.EntryRC(3, 3) = "Usage Rate"
    f1.EntryRC(3, 4) = CPM_Results.Component.Name
    f1.EntryRC(4, 1) = "Minutes"
    f1.EntryRC(4, 2) = "-"
    f1.EntryRC(4, 3) = "m/kg GAC"
    f1.EntryRC(4, 4) = "-"
    For i = 1 To 100
      f1.EntryRC(4 + i, 1) = Trim$(Str$(CPM_Results.T(i)))
      f1.EntryRC(4 + i, 2) = Trim$(Str$(CPM_Results.T(i) * 24# * 3600# * CPM_Results.Bed.Flowrate / CPM_Results.Bed.length / PI / (CPM_Results.Bed.Diameter / 2#) ^ 2))
      f1.EntryRC(4 + i, 3) = Trim$(Str$(CPM_Results.T(i) * 24# * 3600# * CPM_Results.Bed.Flowrate / CPM_Results.Bed.Weight))
      f1.EntryRC(4 + i, 4) = Trim$(Str$(CPM_Results.C_Over_C0(i)))
    Next i
    last_row = 4 + 100
    last_col = 4
    f1.MaxCol = last_col
    f1.MaxRow = last_row
  Else
    '
    '    ----    PSDM RESULTS.    ----
    '
    f1.MinCol = 1
    f1.MinRow = 1
    f1.EntryRC(1, 1) = "PSDM Results -- Filename = " & Chr$(34) & Trim$(Filename) & Chr$(34)
    f1.EntryRC(3, 1) = "Time"
    f1.EntryRC(3, 2) = "BVT"
    f1.EntryRC(3, 3) = "Usage Rate"
    For i = 1 To Results.NComponent
      f1.EntryRC(3, 3 + i) = Trim$(Results.Component(i).Name)
      f1.EntryRC(4, 3 + i) = "-"
    Next i
    f1.EntryRC(4, 1) = "Minutes"
    f1.EntryRC(4, 2) = "-"
    f1.EntryRC(4, 3) = "m/kg GAC"
    For i = 1 To Results.npoints
      f1.EntryRC(4 + i, 1) = Trim$(Str$(Results.T(i)))
      f1.EntryRC(4 + i, 2) = Trim$(Str$(Results.T(i) * 60 * Results.Bed.Flowrate / Results.Bed.length / PI / (Results.Bed.Diameter / 2) ^ 2))
      f1.EntryRC(4 + i, 3) = Trim$(Str$(Results.T(i) * 60 * Results.Bed.Flowrate / Results.Bed.Weight))
      For J = 1 To Results.NComponent
        f1.EntryRC(4 + i, 3 + J) = Trim$(Str$(Results.CP(J, i)))
      Next J
    Next i
    last_row = 4 + Results.npoints
    last_col = 3 + Results.NComponent
    f1.MaxCol = last_col
    f1.MaxRow = last_row
  End If
  'temp = ""
  'For i = 1 To Results.NPoints
  ' temp = Format$(Results.T(i), "0.00")
  ' temp = temp & "       " & Format$(Results.T(i) * 60 * Results.Bed.Flowrate / Results.Bed.Length / Pi / (Results.Bed.Diameter / 2) ^ 2, "0.00")
  ' temp = temp & "       " & Format$(Results.T(i) * 60 * Results.Bed.Flowrate / Results.Bed.Weight, "0.00")
  ' For j = 1 To Results.NComponent
  '   temp = temp & "          " & Format$(Results.CP(j, i), "0.000")
  ' Next j
  ' Print #f, temp
  ' temp = ""
  'Next i
  'Close f
End Sub


Function f1file_saveas(fn_force As String) As Integer
Dim fn_saveas As String
  If (fn_force <> "") Then
    fn_saveas = fn_force
  Else
    'INPUT NEW FILENAME.
    On Error GoTo err_filesaveas
    frmExcelCurves.CommonDialog1.Filter = "All Files (*.*)|*.*|Excel Files (*.xls)|*.xls"
    frmExcelCurves.CommonDialog1.FilterIndex = 2
    frmExcelCurves.CommonDialog1.CancelError = True
    frmExcelCurves.CommonDialog1.flags = _
          cdlOFNOverwritePrompt + _
          cdlOFNPathMustExist
    frmExcelCurves.CommonDialog1.ShowSave
    fn_saveas = Trim$(frmExcelCurves.CommonDialog1.Filename)
    If (fn_saveas = "") Then
      GoTo exit_save_did_not_go_okay
    End If
  End If
  'SAVE THIS FILE.
  Screen.MousePointer = 11
  f1book.Write frmExcelCurves.CommonDialog1.Filename, F1FileExcel4
  'TODO: DETERMINE WHAT VERSIONS OF EXCEL THIS IS COMPATIBLE WITH!
  Screen.MousePointer = 0
exit_save_went_okay:
  'SAVE WENT OKAY.
  f1file_saveas = True
  Exit Function
exit_save_did_not_go_okay:
  'SAVE DID NOT GO OKAY.
  f1file_saveas = False
  Exit Function
err_filesaveas:
  f1file_saveas = False
  Resume exit_save_did_not_go_okay
End Function


Private Sub Form_Activate()
  If (frmExcelCurves_loading_now) Then
    frmExcelCurves_loading_now = False
    Call Form_Resize
  End If
End Sub
Private Sub Form_Load()
Dim msg As String
  If (CPHSDM_Excel) Then
    msg = "Pre-Print of CPHSDM Results"
  Else
    msg = "Pre-Print of PSDM Results"
  End If
  'If (Trim$(NowProj.Filename) = "") Then
  '  msg = msg & "(untitled)"
  'Else
  '  msg = msg & NowProj.Filename
  'End If
  Me.Caption = msg
  Me.Width = 9000
  Me.Height = 7000
  Call CenterOnForm(Me, frmMain)
  Me.WindowState = 2  'maximized
  frmExcelCurves_loading_now = True
  Call Do_The_Print_To_F1Book
End Sub
Private Sub Form_Resize()
Dim XXX As Long
  If (frmExcelCurves_loading_now) Then Exit Sub
  If (Me.WindowState = 1) Then
    'CANNOT RESIZE WHEN MINIMIZED; EXIT OUTTA HERE.
    Exit Sub
  End If
  If (Me.Width < 7000) Then Me.Width = 7000
  If (Me.Height < 3000) Then Me.Height = 3000
  XXX = Me.Width - (Me.Width - Me.ScaleWidth) - 2 * f1book.Left
  If (XXX < 1000) Then
    XXX = 1000
  End If
  f1book.Width = XXX
  XXX = Me.Height - (Me.Height - Me.ScaleHeight) - 2 * f1book.Top
  If (XXX > 1000) Then
    f1book.Height = XXX
  End If
End Sub


Private Sub mnuEditItem_Click(index As Integer)
  Select Case index
    Case 10:    'copy
      f1book.EditCopy
  End Select
End Sub
Private Sub mnuFileItem_Click(index As Integer)
On Error GoTo err_mnuFileItem_Click
  Select Case index
    Case 40:    'save as ...
      Call f1file_saveas("")
    Case 50:    'page setup ...
      f1book.FilePageSetupDlg
    Case 55:    'print setup ...
      f1book.FilePrintSetupDlg
    Case 60:    'print ...
      f1book.FilePrint True
    Case 199:   'close
      Unload Me
  End Select
exit_err_mnuFileItem_Click:
  Exit Sub
err_mnuFileItem_Click:
  'PROBABLY A CANCEL FROM f1book.FilePrint.
  Resume exit_err_mnuFileItem_Click
End Sub


VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmFileNote 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "File Note"
   ClientHeight    =   4680
   ClientLeft      =   2280
   ClientTop       =   4560
   ClientWidth     =   7485
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   4680
   ScaleWidth      =   7485
   Begin VB.TextBox txtData 
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   12
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   3465
      Left            =   90
      Locked          =   -1  'True
      MaxLength       =   500
      MultiLine       =   -1  'True
      TabIndex        =   0
      Text            =   "FileNote.frx":0000
      Top             =   510
      Width           =   7305
   End
   Begin Threed.SSCommand cmdButton 
      Height          =   495
      Index           =   0
      Left            =   90
      TabIndex        =   2
      TabStop         =   0   'False
      Top             =   4080
      Width           =   945
      _Version        =   65536
      _ExtentX        =   1667
      _ExtentY        =   873
      _StockProps     =   78
      Caption         =   "&Delete"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdButton 
      Height          =   495
      Index           =   1
      Left            =   1020
      TabIndex        =   3
      TabStop         =   0   'False
      Top             =   4080
      Width           =   945
      _Version        =   65536
      _ExtentX        =   1667
      _ExtentY        =   873
      _StockProps     =   78
      Caption         =   "&Edit"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdButton 
      Height          =   495
      Index           =   2
      Left            =   1950
      TabIndex        =   4
      TabStop         =   0   'False
      Top             =   4080
      Width           =   945
      _Version        =   65536
      _ExtentX        =   1667
      _ExtentY        =   873
      _StockProps     =   78
      Caption         =   "&Close"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdButton 
      Height          =   495
      Index           =   3
      Left            =   5100
      TabIndex        =   5
      TabStop         =   0   'False
      Top             =   4080
      Width           =   945
      _Version        =   65536
      _ExtentX        =   1667
      _ExtentY        =   873
      _StockProps     =   78
      Caption         =   "Save"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdButton 
      Height          =   495
      Index           =   4
      Left            =   6030
      TabIndex        =   6
      TabStop         =   0   'False
      Top             =   4080
      Width           =   1365
      _Version        =   65536
      _ExtentX        =   2408
      _ExtentY        =   873
      _StockProps     =   78
      Caption         =   "C&ancel Edit"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdButton 
      Height          =   495
      Index           =   5
      Left            =   3420
      TabIndex        =   7
      TabStop         =   0   'False
      Top             =   4080
      Width           =   1695
      _Version        =   65536
      _ExtentX        =   2990
      _ExtentY        =   873
      _StockProps     =   78
      Caption         =   "Insert Date/Time"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin VB.Label lblInstructions 
      Caption         =   "You may enter up to 500 characters of text.  Line breaks are acceptable."
      Height          =   405
      Left            =   90
      TabIndex        =   1
      Top             =   30
      Width           =   5955
   End
End
Attribute VB_Name = "frmFileNote"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Dim NoteText As String
Dim Rollback_NoteText As String
Dim RaiseDirtyFlag As Boolean
Dim Rollback_RaiseDirtyFlag As Boolean

Dim FORM_MODE As Integer
Const FORM_MODE_VIEW = 1
Const FORM_MODE_EDIT = 2




Const frmFileNote_declarations_end = True


Sub frmFileNote_Run( _
    IO_NoteText As String, _
    O_RaiseDirtyFlag As Boolean)
  NoteText = IO_NoteText
  ''''NoteText = Parser_ReplaceStrings(NoteText, Chr$(255), Chr$(13) & Chr$(10))
  frmFileNote.Show 1
  If (RaiseDirtyFlag) Then
    IO_NoteText = NoteText
    ''''MsgBox NoteText
    ''''IO_NoteText = Parser_ReplaceStrings(IO_NoteText, Chr$(13) & Chr$(10), Chr$(255))
  End If
  O_RaiseDirtyFlag = RaiseDirtyFlag
End Sub


Sub frmFileNote_Refresh()
  Select Case FORM_MODE
    Case FORM_MODE_VIEW:
      cmdButton(0).Enabled = True
      cmdButton(1).Enabled = True
      cmdButton(2).Enabled = True
      cmdButton(3).Enabled = False
      cmdButton(4).Enabled = False
      cmdButton(5).Enabled = False
      txtData.Locked = True
      lblInstructions.Caption = ""
    Case FORM_MODE_EDIT:
      cmdButton(0).Enabled = False
      cmdButton(1).Enabled = False
      cmdButton(2).Enabled = False
      cmdButton(3).Enabled = True
      cmdButton(4).Enabled = True
      cmdButton(5).Enabled = True
      txtData.Locked = False
      lblInstructions.Caption = _
          "You may enter up to 500 characters of text.  " & _
          "Line breaks are acceptable."
  End Select
  txtData.Text = NoteText
End Sub


Private Sub cmdButton_Click(index As Integer)
Dim RetVal As Integer
  Select Case index
    Case 0:   'DELETE.
      RetVal = MsgBox("Are you sure you want to delete this " & _
          "file note ?", vbQuestion + vbYesNo, _
          App.Title & " : Delete File Note ?")
      If (RetVal = vbNo) Then Exit Sub
      NoteText = ""
      RaiseDirtyFlag = True
      Call frmFileNote_Refresh
    Case 1:   'EDIT.
      'STORE OLD VALUE IF USER CANCELS EDIT.
      Rollback_NoteText = NoteText
      Rollback_RaiseDirtyFlag = RaiseDirtyFlag
      FORM_MODE = FORM_MODE_EDIT
      Call frmFileNote_Refresh
    Case 2:   'CLOSE.
      Unload Me
      Exit Sub
    Case 3:   'SAVE.
      FORM_MODE = FORM_MODE_VIEW
      Call frmFileNote_Refresh
''temp
'Open "c:\test.out" For Output As #1
'Dim i As Integer
'For i = 1 To Len(NoteText)
'  Print #1, Asc(Mid$(NoteText, i, 1))
'Next i
'Close #1
    Case 4:   'CANCEL EDIT.
      FORM_MODE = FORM_MODE_VIEW
      NoteText = Rollback_NoteText
      RaiseDirtyFlag = Rollback_RaiseDirtyFlag
      Call frmFileNote_Refresh
    Case 5:   'INSERT DATE/TIME.
      txtData.Text = txtData.Text & Now
      Call txtData_LostFocus
  End Select
End Sub


Private Sub Form_Load()
  'MISC INITS.
  Call CenterOnForm(Me, frmMain)
  FORM_MODE = FORM_MODE_VIEW
  Call frmFileNote_Refresh
  RaiseDirtyFlag = False
End Sub


Private Sub txtData_GotFocus()
Dim Ctl As Control
Set Ctl = txtData
  Call Global_GotFocus(Ctl)
  'FORCE BACKGROUND COLOR BACK TO WHITE.
  Ctl.BackColor = RGB(255, 255, 255)
End Sub
Private Sub txtData_KeyPress(KeyAscii As Integer)
  KeyAscii = Global_MultilineTextKeyPress(KeyAscii)
End Sub
Private Sub txtData_LostFocus()
'Dim NewValue_Okay As Integer
'Dim NewValue As Double
Dim Ctl As Control
Set Ctl = txtData
'Dim Val_Low As Double
'Dim Val_High As Double
'Dim Raise_Dirty_Flag As Boolean
'Dim Too_Small As Integer
Dim OldValueStr As String
  'HANDLE STRING FIELDS.
  OldValueStr = Trim$(NoteText)
  'NOTE: ZERO-LENGTH STRINGS ARE ALLOWED.
  If (Trim$(OldValueStr) <> Trim$(Ctl.Text)) Then
    NoteText = Trim$(Ctl.Text)
    RaiseDirtyFlag = True
  End If
  Call Global_LostFocus(Ctl)
  Call frmFileNote_Refresh
  'Call GenericStatus_Set("")
  Exit Sub
'  End If
'  'NOTE: LOW AND HIGH VALUES IN BASE UNITS.
'  Select Case index
'    Case 0: Val_Low = 1E-20: Val_High = 1E+20
'    Case 1: Val_Low = 0#: Val_High = 1E+20
'    Case 2: Val_Low = 0#: Val_High = 1E+20
'    Case 3: Val_Low = 1E-20: Val_High = 1E+20
'    Case 4: Val_Low = 1E-20: Val_High = 1E+20
'    Case 5: Val_Low = 0#: Val_High = 1E+20
'    Case 6: Val_Low = 0#: Val_High = 1E+20
'  End Select
'  NewValue_Okay = False
'  If (unitsys_control_txtx_lostfocus_validate(Ctl, Val_Low, Val_High, NewValue, Raise_Dirty_Flag)) Then
'    NewValue_Okay = True
'  End If
'  Call unitsys_control_txtx_lostfocus(Ctl, NewValue)
'  If (NewValue_Okay) Then
'    If (Raise_Dirty_Flag) Then
'      'STORE TO MEMORY.
'      Select Case index
'        Case 0:         'FREUNDLICH K.
'          frmEditIsothermData_Record.k = NewValue
'        Case 1:         'MINIMUM CONCENTRATION.
'          frmEditIsothermData_Record.Cmin = NewValue
'        Case 2:         'MINIMUM pH.
'          frmEditIsothermData_Record.pHmin = NewValue
'        Case 3:         'TEMPERATURE.
'          frmEditIsothermData_Record.Tmin = NewValue
'        Case 4:         'FREUNDLICH 1/n.
'          frmEditIsothermData_Record.OneOverN = NewValue
'        Case 5:         'MAXIMUM CONCENTRATION.
'          frmEditIsothermData_Record.Cmax = NewValue
'        Case 6:         'MAXIMUM pH.
'          frmEditIsothermData_Record.pHmax = NewValue
'      End Select
'      'RAISE DIRTY FLAG IF NECESSARY.
'      If (Raise_Dirty_Flag) Then
'        ''THROW DIRTY FLAG.
'        'Call frmCompoProp_DirtyStatus_Throw
'      End If
'      'REFRESH WINDOW.
'      Call frmEditIsothermData_Refresh
'    End If
'  End If
End Sub



VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "Threed32.ocx"
Begin VB.Form frmFluidProps 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "{Fluid} Properties"
   ClientHeight    =   2220
   ClientLeft      =   4230
   ClientTop       =   3480
   ClientWidth     =   5115
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   2220
   ScaleWidth      =   5115
   Begin Threed.SSFrame SSFrame1 
      Height          =   1395
      Left            =   240
      TabIndex        =   4
      Top             =   90
      Width           =   4575
      _Version        =   65536
      _ExtentX        =   8070
      _ExtentY        =   2461
      _StockProps     =   14
      Caption         =   "Density and Viscosity"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin Threed.SSFrame SSFrame2 
         Height          =   1005
         Left            =   120
         TabIndex        =   5
         Top             =   270
         Width           =   1905
         _Version        =   65536
         _ExtentX        =   3360
         _ExtentY        =   1773
         _StockProps     =   14
         Caption         =   "Use correlation for:"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Begin Threed.SSCheck chkCorr 
            Height          =   255
            Index           =   0
            Left            =   150
            TabIndex        =   0
            Top             =   270
            Width           =   1035
            _Version        =   65536
            _ExtentX        =   2646
            _ExtentY        =   1323
            _StockProps     =   78
            Caption         =   "&Density"
            ForeColor       =   -2147483640
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   24
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
         End
         Begin Threed.SSCheck chkCorr 
            Height          =   255
            Index           =   1
            Left            =   150
            TabIndex        =   1
            Top             =   630
            Width           =   1095
            _Version        =   65536
            _ExtentX        =   2646
            _ExtentY        =   1323
            _StockProps     =   78
            Caption         =   "&Viscosity"
            ForeColor       =   -2147483640
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   24
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
         End
      End
      Begin Threed.SSFrame SSFrame3 
         Height          =   1005
         Left            =   2010
         TabIndex        =   6
         Top             =   270
         Width           =   2445
         _Version        =   65536
         _ExtentX        =   4313
         _ExtentY        =   1773
         _StockProps     =   14
         Caption         =   "Values:"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Begin VB.TextBox txtWater 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   288
            Index           =   0
            Left            =   90
            TabIndex        =   2
            Text            =   "txtWater(0)"
            Top             =   270
            Width           =   1365
         End
         Begin VB.TextBox txtWater 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   288
            Index           =   1
            Left            =   90
            TabIndex        =   3
            Text            =   "txtWater(1)"
            Top             =   630
            Width           =   1365
         End
         Begin VB.Label lblUnit 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            BackColor       =   &H80000005&
            BackStyle       =   0  'Transparent
            Caption         =   "lblUnit(0)"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H80000008&
            Height          =   255
            Index           =   0
            Left            =   1620
            TabIndex        =   8
            Top             =   300
            Width           =   735
         End
         Begin VB.Label lblUnit 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            BackColor       =   &H80000005&
            BackStyle       =   0  'Transparent
            Caption         =   "lblUnit(1)"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H80000008&
            Height          =   255
            Index           =   1
            Left            =   1620
            TabIndex        =   7
            Top             =   660
            Width           =   735
         End
      End
   End
   Begin Threed.SSCommand cmdCancelOK 
      Height          =   495
      Index           =   1
      Left            =   240
      TabIndex        =   9
      TabStop         =   0   'False
      Top             =   1590
      Width           =   2295
      _Version        =   65536
      _ExtentX        =   4048
      _ExtentY        =   873
      _StockProps     =   78
      Caption         =   "&OK"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdCancelOK 
      Height          =   495
      Index           =   0
      Left            =   2520
      TabIndex        =   10
      TabStop         =   0   'False
      Top             =   1590
      Width           =   2295
      _Version        =   65536
      _ExtentX        =   4048
      _ExtentY        =   873
      _StockProps     =   78
      Caption         =   "&Cancel"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
End
Attribute VB_Name = "frmFluidProps"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Dim USER_HIT_OK As Boolean
Dim USER_HIT_CANCEL As Boolean

Dim Save_Density As Double
Dim Save_Viscosity As Double
Dim Save_State_Check_Water(1 To 2) As Integer




Const frmFluidProps_declarations_end = True


Sub frmFluidProps_Edit( _
    OUTPUT_Raise_Dirty_Flag As Boolean)
  frmFluidProps.Show 1
  If (USER_HIT_OK) Then
    OUTPUT_Raise_Dirty_Flag = True
  Else
    OUTPUT_Raise_Dirty_Flag = False
  End If
End Sub


Sub frmFluidProps_PopulateUnits()
  Call unitsys_register(frmFluidProps, lblUnit(0), _
      txtWater(0), Nothing, "", _
      "", "", "", "", 100#, False)
  Call unitsys_register(frmFluidProps, lblUnit(1), _
      txtWater(1), Nothing, "", _
      "", "", "", "", 100#, False)
End Sub


Private Sub chkCorr_Click(Index As Integer, Value As Integer)
  'UPDATE MEMORY.
  State_Check_Water(Index + 1) = Value
  'IF TURNED CORRELATION ON, RE-CALCULATE DENSITY/VISCOSITY.
  If (Value) Then
    Select Case Index
      Case 0:     'DENSITY.
        Call Update_FluidDensity(Bed.Temperature, Bed.Pressure, Bed.WaterDensity)
      Case 1:     'VISCOSITY.
        Call Update_FluidViscosity(Bed.Temperature, Bed.WaterViscosity)
    End Select
  End If
  'REFRESH DISPLAY.
  Call frmFluidProps_Refresh
End Sub


Private Sub cmdCancelOK_Click(Index As Integer)
Dim i As Integer
  Select Case Index
    Case 0:     'CANCEL.
      'ROLLBACK TO ORIGINAL VALUES.
      
      'EXIT OUT OF HERE.
      USER_HIT_CANCEL = True
      USER_HIT_OK = False
      Unload Me
      Exit Sub
    Case 1:     'OK.
      'EXIT OUT OF HERE.
      USER_HIT_CANCEL = False
      USER_HIT_OK = True
      Unload Me
      Exit Sub
  End Select
End Sub


Private Sub Form_Load()
  'MISC INITS.
  Me.Height = 2625
  Me.Width = 5235
  Call CenterOnForm(Me, frmMain)
  If (Bed.Phase = 0) Then
    Me.Caption = "Water Properties"
  Else
    Me.Caption = "Air Properties"
  End If
  lblUnit(0).Caption = "g/cm" & Chr$(179)
  lblUnit(1).Caption = "g/cm-s"

'txtWater(2) = Format$(Bed.WaterDensity, "0.000E+00")
'txtWater(3) = Format$(Bed.WaterViscosity, "0.00E+00")
'State_Check_Water(1) = chkCorr(0).Value
'State_Check_Water(2) = chkCorr(1).Value
  
  'SAVE OLD VALUES FOR CANCEL ROLLBACK.
  Save_Density = Bed.WaterDensity
  Save_Viscosity = Bed.WaterViscosity
  Save_State_Check_Water(1) = State_Check_Water(1)
  Save_State_Check_Water(2) = State_Check_Water(2)
  'POPULATE UNIT CONTROLS.
  Call frmFluidProps_PopulateUnits
  'REFRESH DISPLAY.
  Call frmFluidProps_Refresh
End Sub
Private Sub Form_Unload(Cancel As Integer)
  Call unitsys_unregister_all_on_form(Me)
End Sub


Private Sub txtWater_GotFocus(Index As Integer)
Dim Ctl As Control
Set Ctl = txtWater(Index)
  Call unitsys_control_txtx_gotfocus(Ctl)
End Sub
Private Sub txtWater_KeyPress(Index As Integer, KeyAscii As Integer)
  KeyAscii = Global_NumericKeyPress(KeyAscii)
End Sub
Private Sub txtWater_LostFocus(Index As Integer)
Dim NewValue_Okay As Integer
Dim NewValue As Double
Dim Ctl As Control
Set Ctl = txtWater(Index)
Dim Val_Low As Double
Dim Val_High As Double
Dim Raise_Dirty_Flag As Boolean
Dim Too_Small As Integer
  'NOTE: LOW AND HIGH VALUES IN BASE UNITS.
  Select Case Index
    Case 0: Val_Low = 1E-20: Val_High = 1E+20
    Case 1: Val_Low = 1E-20: Val_High = 1E+20
  End Select
  NewValue_Okay = False
  If (unitsys_control_txtx_lostfocus_validate(Ctl, Val_Low, Val_High, NewValue, Raise_Dirty_Flag)) Then
    NewValue_Okay = True
  End If
  Call unitsys_control_txtx_lostfocus(Ctl, NewValue)
  If (NewValue_Okay) Then
    If (Raise_Dirty_Flag) Then
      'STORE TO MEMORY.
      Select Case Index
        Case 0:         'DENSITY.
          Bed.WaterDensity = NewValue
        Case 1:         'VISCOSITY.
          Bed.WaterViscosity = NewValue
      End Select
      'RAISE DIRTY FLAG IF NECESSARY.
      If (Raise_Dirty_Flag) Then
        ''THROW DIRTY FLAG.
        'Call frmCompoProp_DirtyStatus_Throw
      End If
      'REFRESH WINDOW.
      Call frmFluidProps_Refresh
    End If
  End If
End Sub

VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmFouling 
   AutoRedraw      =   -1  'True
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Fouling of GAC"
   ClientHeight    =   6975
   ClientLeft      =   2505
   ClientTop       =   1725
   ClientWidth     =   6495
   ClipControls    =   0   'False
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   6975
   ScaleWidth      =   6495
   Begin Threed.SSFrame fraWater 
      Height          =   1365
      Left            =   120
      TabIndex        =   0
      Top             =   90
      Width           =   6255
      _Version        =   65536
      _ExtentX        =   11033
      _ExtentY        =   2408
      _StockProps     =   14
      Caption         =   "Water Type:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.ComboBox cboType 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Left            =   930
         Style           =   2  'Dropdown List
         TabIndex        =   5
         Top             =   390
         Width           =   4515
      End
      Begin Threed.SSCommand cmdEdit 
         Height          =   375
         Left            =   930
         TabIndex        =   4
         Top             =   810
         Width           =   4515
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "Edit &Water Type Correlations"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
   End
   Begin Threed.SSFrame fraCompo 
      Height          =   4665
      Left            =   120
      TabIndex        =   1
      Top             =   1560
      Width           =   6255
      _Version        =   65536
      _ExtentX        =   11033
      _ExtentY        =   8229
      _StockProps     =   14
      Caption         =   "Chemical Type:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.ComboBox cboCorrel 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   9
         Left            =   3750
         Style           =   2  'Dropdown List
         TabIndex        =   16
         Top             =   3735
         Width           =   2295
      End
      Begin VB.ComboBox cboCorrel 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   8
         Left            =   3750
         Style           =   2  'Dropdown List
         TabIndex        =   15
         Top             =   3375
         Width           =   2295
      End
      Begin VB.ComboBox cboCorrel 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   7
         Left            =   3750
         Style           =   2  'Dropdown List
         TabIndex        =   14
         Top             =   3015
         Width           =   2295
      End
      Begin VB.ComboBox cboCorrel 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   6
         Left            =   3750
         Style           =   2  'Dropdown List
         TabIndex        =   13
         Top             =   2655
         Width           =   2295
      End
      Begin VB.ComboBox cboCorrel 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   5
         Left            =   3750
         Style           =   2  'Dropdown List
         TabIndex        =   12
         Top             =   2295
         Width           =   2295
      End
      Begin VB.ComboBox cboCorrel 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   4
         Left            =   3750
         Style           =   2  'Dropdown List
         TabIndex        =   11
         Top             =   1935
         Width           =   2295
      End
      Begin VB.ComboBox cboCorrel 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   3
         Left            =   3750
         Style           =   2  'Dropdown List
         TabIndex        =   10
         Top             =   1575
         Width           =   2295
      End
      Begin VB.ComboBox cboCorrel 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   2
         Left            =   3750
         Style           =   2  'Dropdown List
         TabIndex        =   9
         Top             =   1215
         Width           =   2295
      End
      Begin VB.ComboBox cboCorrel 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   1
         Left            =   3750
         Style           =   2  'Dropdown List
         TabIndex        =   8
         Top             =   855
         Width           =   2295
      End
      Begin VB.ComboBox cboCorrel 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   0
         Left            =   3750
         Style           =   2  'Dropdown List
         TabIndex        =   7
         Top             =   495
         Width           =   2295
      End
      Begin Threed.SSCommand cmdEditCompo 
         Height          =   375
         Left            =   930
         TabIndex        =   6
         Top             =   4140
         Width           =   4515
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "&Edit Chemical Type Correlations"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSCheck chkUse 
         Height          =   255
         Index           =   0
         Left            =   330
         TabIndex        =   17
         Top             =   540
         Width           =   255
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24.27
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSCheck chkUse 
         Height          =   255
         Index           =   1
         Left            =   330
         TabIndex        =   18
         Top             =   900
         Width           =   255
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24.27
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSCheck chkUse 
         Height          =   255
         Index           =   2
         Left            =   330
         TabIndex        =   19
         Top             =   1260
         Width           =   255
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24.27
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSCheck chkUse 
         Height          =   255
         Index           =   3
         Left            =   330
         TabIndex        =   20
         Top             =   1620
         Width           =   255
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24.27
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSCheck chkUse 
         Height          =   255
         Index           =   4
         Left            =   330
         TabIndex        =   21
         Top             =   1980
         Width           =   255
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24.27
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSCheck chkUse 
         Height          =   255
         Index           =   5
         Left            =   330
         TabIndex        =   22
         Top             =   2340
         Width           =   255
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24.27
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSCheck chkUse 
         Height          =   255
         Index           =   6
         Left            =   330
         TabIndex        =   23
         Top             =   2700
         Width           =   255
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24.27
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSCheck chkUse 
         Height          =   255
         Index           =   7
         Left            =   330
         TabIndex        =   24
         Top             =   3060
         Width           =   255
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24.27
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSCheck chkUse 
         Height          =   255
         Index           =   8
         Left            =   330
         TabIndex        =   25
         Top             =   3420
         Width           =   255
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24.27
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSCheck chkUse 
         Height          =   255
         Index           =   9
         Left            =   330
         TabIndex        =   26
         Top             =   3780
         Width           =   255
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24.27
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin VB.Label Label5 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Apply"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   90
         TabIndex        =   39
         Top             =   240
         Width           =   855
      End
      Begin VB.Label Label4 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Type of correlation used"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   3750
         TabIndex        =   38
         Top             =   240
         Width           =   2295
      End
      Begin VB.Label Label1 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Name"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   990
         TabIndex        =   37
         Top             =   240
         Width           =   2175
      End
      Begin VB.Label lblName 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   9
         Left            =   690
         TabIndex        =   36
         Top             =   3780
         Width           =   2895
      End
      Begin VB.Label lblName 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   8
         Left            =   690
         TabIndex        =   35
         Top             =   3420
         Width           =   2895
      End
      Begin VB.Label lblName 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   7
         Left            =   690
         TabIndex        =   34
         Top             =   3060
         Width           =   2895
      End
      Begin VB.Label lblName 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   6
         Left            =   690
         TabIndex        =   33
         Top             =   2700
         Width           =   2895
      End
      Begin VB.Label lblName 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   690
         TabIndex        =   32
         Top             =   2340
         Width           =   2895
      End
      Begin VB.Label lblName 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   690
         TabIndex        =   31
         Top             =   1980
         Width           =   2895
      End
      Begin VB.Label lblName 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   690
         TabIndex        =   30
         Top             =   1620
         Width           =   2895
      End
      Begin VB.Label lblName 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   690
         TabIndex        =   29
         Top             =   1260
         Width           =   2895
      End
      Begin VB.Label lblName 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   690
         TabIndex        =   28
         Top             =   900
         Width           =   2895
      End
      Begin VB.Label lblName 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   690
         TabIndex        =   27
         Top             =   540
         Width           =   2895
      End
   End
   Begin Threed.SSCommand cmdCancelOK 
      Height          =   495
      Index           =   1
      Left            =   120
      TabIndex        =   2
      TabStop         =   0   'False
      Top             =   6360
      Width           =   2295
      _Version        =   65536
      _ExtentX        =   4048
      _ExtentY        =   873
      _StockProps     =   78
      Caption         =   "&OK"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdCancelOK 
      Height          =   495
      Index           =   0
      Left            =   4080
      TabIndex        =   3
      TabStop         =   0   'False
      Top             =   6360
      Width           =   2295
      _Version        =   65536
      _ExtentX        =   4048
      _ExtentY        =   873
      _StockProps     =   78
      Caption         =   "&Cancel"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
End
Attribute VB_Name = "frmFouling"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
Option Base 1


Sub Populate_cboType()
Dim i As Integer
  i = False
  Call Load_Correlations_Water(i)
  If i Then Number_Water_Correlations = 0
  cboType.Clear
  For i = 1 To Number_Water_Correlations
    cboType.AddItem Trim$(Correlations_For_Water(i).Name)
  Next i
  'If (DemoMode) Then
  '  cboType.ListIndex = 0
  'Else
    If Number_Water_Correlations > 0 Then cboType.ListIndex = Set_Number_Correlation_Water() - 1
  'End If
End Sub
Sub Populate_cboCorrel()
Dim i As Integer
Dim j As Integer
  i = False
  Call Load_Correlation_Compounds(i)
  If i Then Number_Correlations_Compounds = 0
  For i = 0 To Number_Component - 1
    cboCorrel(i).Visible = True
    cboCorrel(i).Clear
    For j = 1 To Number_Correlations_Compounds
      cboCorrel(i).AddItem Trim$(Correlations_For_Classes(j).Name)
    Next j
    'If (DemoMode) Then
    '  ' Set it to Halogenated Alkenes
    '  If (0 = StrComp(lblName(i).Caption, "trichloroethylene", 1)) Then cboCorrel(i).ListIndex = 1
    '  ' Set it to Aromatics
    '  If (0 = StrComp(lblName(i).Caption, "benzene", 1)) Then cboCorrel(i).ListIndex = 3
    '  ' Set it to Aromatics
    '  If (0 = StrComp(lblName(i).Caption, "1,2-dichlorobenzene", 1)) Then cboCorrel(i).ListIndex = 3
    'Else
      cboCorrel(i).ListIndex = (Set_Number_Correlation(i + 1) - 1)
    'End If
    chkUse(i).Visible = True
    chkUse(i) = Component(i + 1).K_Reduction
    lblName(i).Visible = True
    lblName(i) = Trim$(Component(i + 1).Name)
  Next i
End Sub


Private Sub cboCorrel_Click(Index As Integer)
'If (DemoMode) Then
'    ' Set it to Halogenated Alkenes
'    If (0 = StrComp(Trim$(lblName(index).Caption), "trichloroethylene", 1)) Then cboCorrel(index).ListIndex = 1
'    ' Set it to Aromatics
'    If (0 = StrComp(Trim$(lblName(index).Caption), "benzene", 1)) Then cboCorrel(index).ListIndex = 3
'    ' Set it to Aromatics
'    If (0 = StrComp(Trim$(lblName(index).Caption), "1,2-dichlorobenzene", 1)) Then cboCorrel(index).ListIndex = 3
'End If
End Sub


Private Sub cboType_Click()
Dim msg$
Static old_index%
'  If (DemoMode) Then
'    If (0 = StrComp(Trim$(cboType.Text), "Organic Free Water", 1)) Then
'      old_index% = 0
'      Exit Sub
'    End If
'    If (0 = StrComp(Trim$(cboType.Text), "Groundwater from the city of Karlsruhe, Germany", 1)) Then
'      old_index% = 3
'      Exit Sub
'    End If
'    msg$ = "            " + cboType.Text + NL + NL
'    msg$ = msg$ + "Is not a valid Water Type in the Demonstration version."
'    MsgBox msg$
'    cboType.ListIndex = old_index%
'  End If
End Sub


Private Sub chkUse_Click(Index As Integer, Value As Integer)
Dim Is_Invalid As Boolean
  'DE-APPLY CORRELATION IF USER HAS NOT PROPERLY
  'SELECTED A CORRELATION.
  If (chkUse(Index) = True) Then
    Is_Invalid = False
    If (cboCorrel(Index).ListIndex < 0) Then
      Is_Invalid = True
    Else
      If (cboCorrel(Index).List(cboCorrel(Index).ListIndex) = "") Then
        Is_Invalid = True
      End If
    End If
    If (Is_Invalid) Then
      Call Show_Error("You must select a correlation " & _
          "type before you can apply fouling for this chemical.")
      chkUse(Index) = False
      Exit Sub
    End If
  End If
End Sub


Private Sub cmdCancelOK_Click(Index As Integer)
Dim i As Integer
Dim msg$
Dim IsInvalid As Boolean
  Select Case Index
    Case 0:   'CANCEL.
      Unload Me
    Case 1:   'OK.
      IsInvalid = True
      If (cboType.ListIndex >= 0) Then
        If (cboType.ListCount >= 1) Then
          If (Trim$(cboType.List(cboType.ListIndex)) <> "") Then
            IsInvalid = False
          End If
        End If
      End If
      If (IsInvalid) Then
        Call Show_Error("You must first select a water correlation type.")
        Exit Sub
      End If
'      If (DemoMode) Then
'        If (0 = StrComp(Trim$(cboType.Text), "Organic Free Water")) Then GoTo DEMO_00_CONTINUE
'        If (0 = StrComp(Trim$(cboType.Text), "Groundwater from the city of Karlsruhe, Germany", 1)) Then GoTo DEMO_00_CONTINUE
'        msg$ = "In Demonstration version you can only use two types of water:" + NL + NL
'        msg$ = msg$ + Chr$(9) + "- Organic Free Water" + NL
'        msg$ = msg$ + Chr$(9) + "- Groundwater from the city of Karlsruhe, Germany" + NL
'        MsgBox msg$
'        Exit Sub
'      End If
'DEMO_00_CONTINUE:
      For i = 1 To Number_Component
        If cboCorrel(i - 1).ListIndex > -1 Then
          Component(i).Correlation.Name = Trim$(cboCorrel(i - 1).List(cboCorrel(i - 1).ListIndex))
          Component(i).K_Reduction = chkUse(i - 1)
          Component(i).Correlation.Coeff(1) = Correlations_For_Classes(cboCorrel(i - 1).ListIndex + 1).Coeff(1)
          Component(i).Correlation.Coeff(2) = Correlations_For_Classes(cboCorrel(i - 1).ListIndex + 1).Coeff(2)
        Else
          Component(i).K_Reduction = False
        End If
      Next i
      If cboType.ListIndex = -1 Then cboType.ListIndex = 0
      Bed.Water_Correlation.Name = Correlations_For_Water(cboType.ListIndex + 1).Name
      For i = 1 To 4
        Bed.Water_Correlation.Coeff(i) = Correlations_For_Water(cboType.ListIndex + 1).Coeff(i)
      Next i
      Unload Me
  End Select
End Sub


Private Sub cmdEdit_Click()
  Call frmFoulingWaterDatabase.frmFoulingWaterDatabase_Edit
  Call Populate_cboType
End Sub
Private Sub cmdEditCompo_Click()
  Call frmFoulingCompoundDatabase.frmFoulingCompoundDatabase_Edit
  Call Populate_cboCorrel
End Sub


Private Sub Form_Load()
Dim i As Integer
Dim j As Integer
  'If (DemoMode) Then
  '  cmdEdit.Enabled = False
  '  cmdEditCompo.Enabled = False
  'End If
  'Me.HelpContextID = Hlp_Fouling_of
  Call Populate_cboType
  
  Call Populate_cboCorrel
  
  For i = Number_Component To Number_Compo_Max - 1
    chkUse(i).Visible = False
    lblName(i).Visible = False
    cboCorrel(i).Visible = False
  Next i
  
  cmdEditCompo.Top = lblName(Number_Component - 1).Top + lblName(Number_Component - 1).Height + Screen.TwipsPerPixelY * 10
  fraCompo.Height = cmdEditCompo.Top + cmdEditCompo.Height + Screen.TwipsPerPixelY * 10
  cmdCancelOK(1).Top = fraCompo.Top + fraCompo.Height + Screen.TwipsPerPixelY * 10
  cmdCancelOK(0).Top = fraCompo.Top + fraCompo.Height + Screen.TwipsPerPixelY * 10
  Height = cmdCancelOK(1).Top + cmdCancelOK(1).Height + Screen.TwipsPerPixelY * 35
  cmdEditCompo.Left = (fraCompo.Width - cmdEditCompo.Width) / 2
  cmdEdit.Left = (fraWater.Width - cmdEdit.Width) / 2
  cboType.Left = (fraWater.Width - cboType.Width) / 2
  Me.Top = Screen.Height / 2 - Height / 2
  Me.Left = Screen.Width / 2 - Width / 2
  Call CenterOnForm(Me, frmMain)
End Sub


Private Sub Load_Correlation_Compounds(flag As Integer)
Dim f As Integer, n As Integer, i As Integer
  On Error GoTo Error_In_Reading_Corr
  f = FreeFile
  Open Database_Path & "\corr_com.txt" For Input As f
  Input #f, n
  If n > Max_Number_Correlation_Compo Then
    flag = True
    Close (f)
    Call Show_Error("Too many correlations in the file.")
    Exit Sub
  End If
  For i = 1 To n
  Input #f, Correlations_For_Classes(i).Name, Correlations_For_Classes(i).Coeff(1), Correlations_For_Classes(i).Coeff(2)
  Next i
  Close (f)
  Number_Correlations_Compounds = n
  flag = False
  Exit Sub
Error_In_Reading_Corr:
  Call Show_Error("Error while reading the file containing correlations.")
  flag = True
  Resume Exit_Corr_Compound
Exit_Corr_Compound:
End Sub
Private Sub Load_Correlations_Water(flag As Integer)
Dim f As Integer, n As Integer, i As Integer
  On Error GoTo Error_In_Reading_WCorr
  f = FreeFile
  Open Database_Path & "\water_co.txt" For Input As f
  Input #f, n
  If n > Max_Number_Water_Correlations Then
    flag = True
    Close (f)
    Call Show_Error("Too many correlations in the file.")
    Exit Sub
  End If
  For i = 1 To n
    Input #f, Correlations_For_Water(i).Name, Correlations_For_Water(i).Coeff(1), Correlations_For_Water(i).Coeff(2), Correlations_For_Water(i).Coeff(3), Correlations_For_Water(i).Coeff(4)
  Next i
  Close (f)
  Number_Water_Correlations = n
  flag = False
  Exit Sub
Error_In_Reading_WCorr:
  Call Show_Error("Error while reading the file containing correlations.")
  flag = True
  Close (f)
  Resume Exit_Corr_Water
Exit_Corr_Water:
End Sub
Private Function Set_Number_Correlation(i As Integer) As Integer
Dim ST As String, j As Integer
  ST = Component(i).Correlation.Name
  For j = 1 To Number_Correlations_Compounds
    If Trim$(ST) = Trim$(Correlations_For_Classes(j).Name) Then
      Set_Number_Correlation = j
      Exit Function
    Else
      Set_Number_Correlation = 0
    End If
  Next j
End Function
Private Function Set_Number_Correlation_Water() As Integer
Dim ST As String, j As Integer
  ST = Bed.Water_Correlation.Name
  For j = 1 To Number_Water_Correlations
    If Trim$(ST) = Trim$(Correlations_For_Water(j).Name) Then
      Set_Number_Correlation_Water = j
      Exit Function
    Else
      Set_Number_Correlation_Water = 0
    End If
  Next j
End Function


VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmFoulingCompoundDatabase 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Water Fouling Compound Correlation Database"
   ClientHeight    =   5715
   ClientLeft      =   2790
   ClientTop       =   1965
   ClientWidth     =   5730
   ControlBox      =   0   'False
   LinkTopic       =   "Form2"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   5715
   ScaleWidth      =   5730
   Begin Threed.SSFrame SSFrame1 
      Height          =   2775
      Left            =   120
      TabIndex        =   0
      Top             =   90
      Width           =   5475
      _Version        =   65536
      _ExtentX        =   9657
      _ExtentY        =   4895
      _StockProps     =   14
      Caption         =   "Select a Chemical Type:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.ListBox lstCorrelations 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   2370
         Left            =   120
         TabIndex        =   2
         Top             =   300
         Width           =   5235
      End
   End
   Begin Threed.SSFrame SSFrame2 
      Height          =   2025
      Left            =   120
      TabIndex        =   1
      Top             =   2940
      Width           =   5475
      _Version        =   65536
      _ExtentX        =   9657
      _ExtentY        =   3572
      _StockProps     =   14
      Caption         =   "Empirical Constants for:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.TextBox txtName 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Left            =   150
         TabIndex        =   5
         Text            =   "txtName"
         Top             =   270
         Width           =   5205
      End
      Begin VB.TextBox txtCoeff 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   288
         Index           =   2
         Left            =   2340
         TabIndex        =   4
         Text            =   "txtCoeff(2)"
         Top             =   1110
         Width           =   1212
      End
      Begin VB.TextBox txtCoeff 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   288
         Index           =   1
         Left            =   2340
         TabIndex        =   3
         Text            =   "txtCoeff(1)"
         Top             =   690
         Width           =   1212
      End
      Begin Threed.SSCommand cmdRecord 
         Height          =   375
         Index           =   0
         Left            =   120
         TabIndex        =   13
         TabStop         =   0   'False
         Top             =   1500
         Width           =   975
         _Version        =   65536
         _ExtentX        =   1720
         _ExtentY        =   661
         _StockProps     =   78
         Caption         =   "&New"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSCommand cmdRecord 
         Height          =   375
         Index           =   1
         Left            =   1080
         TabIndex        =   14
         TabStop         =   0   'False
         Top             =   1500
         Width           =   975
         _Version        =   65536
         _ExtentX        =   1720
         _ExtentY        =   661
         _StockProps     =   78
         Caption         =   "&Edit"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSCommand cmdRecord 
         Height          =   375
         Index           =   2
         Left            =   2040
         TabIndex        =   15
         TabStop         =   0   'False
         Top             =   1500
         Width           =   975
         _Version        =   65536
         _ExtentX        =   1720
         _ExtentY        =   661
         _StockProps     =   78
         Caption         =   "&Delete"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSCommand cmdRecord 
         Height          =   375
         Index           =   3
         Left            =   3000
         TabIndex        =   16
         TabStop         =   0   'False
         Top             =   1500
         Width           =   975
         _Version        =   65536
         _ExtentX        =   1720
         _ExtentY        =   661
         _StockProps     =   78
         Caption         =   "&Save"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSCommand cmdRecord 
         Height          =   375
         Index           =   4
         Left            =   3960
         TabIndex        =   17
         TabStop         =   0   'False
         Top             =   1500
         Width           =   1395
         _Version        =   65536
         _ExtentX        =   2461
         _ExtentY        =   661
         _StockProps     =   78
         Caption         =   "Cancel Edit"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin VB.Label lblName 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "lblName"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   150
         TabIndex        =   10
         Top             =   270
         Width           =   5115
      End
      Begin VB.Label lblCoeff2 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   2340
         TabIndex        =   9
         Top             =   1110
         Width           =   1215
      End
      Begin VB.Label lblCoeff1 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   2340
         TabIndex        =   8
         Top             =   690
         Width           =   1215
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "A1"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   1260
         TabIndex        =   7
         Top             =   720
         Width           =   975
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "A2"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   1260
         TabIndex        =   6
         Top             =   1140
         Width           =   975
      End
   End
   Begin Threed.SSCommand cmdCancelOK 
      Height          =   495
      Index           =   1
      Left            =   120
      TabIndex        =   11
      TabStop         =   0   'False
      ToolTipText     =   "Click here to save any changes you have made to this database"
      Top             =   5100
      Width           =   2295
      _Version        =   65536
      _ExtentX        =   4048
      _ExtentY        =   873
      _StockProps     =   78
      Caption         =   "&OK"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdCancelOK 
      Height          =   495
      Index           =   0
      Left            =   3300
      TabIndex        =   12
      TabStop         =   0   'False
      ToolTipText     =   "Click here to abandon any changes you have made to this database"
      Top             =   5100
      Width           =   2295
      _Version        =   65536
      _ExtentX        =   4048
      _ExtentY        =   873
      _StockProps     =   78
      Caption         =   "&Cancel"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
End
Attribute VB_Name = "frmFoulingCompoundDatabase"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Dim Local_Correlation(Max_Number_Correlation_Compo) As Correlation_Compound_Type

Dim FORM_MODE As Integer
Const FORM_MODE_VIEW = 1
Const FORM_MODE_EDIT = 2
Const FORM_MODE_ADDNEW = 3

Dim HALT_LSTCORRELATIONS As Boolean

'//////// COMMUNICATIONS WITH frmFoulingCompoundDatabase: /////////////////////////////////////////////////
Private Type frmFoulingCompoundDatabase_Record_Type
  A1 As Double
  A2 As Double
  Name As String
End Type
Dim Local_Record As frmFoulingCompoundDatabase_Record_Type






Const frmFoulingCompoundDatabase_declarations_end = True



Sub frmFoulingCompoundDatabase_Edit()
  frmFoulingCompoundDatabase.Show 1
End Sub


Sub Populate_lstCorrelations()
Dim SAVE_INDEX As Integer
Dim i As Integer
  If (lstCorrelations.ListIndex >= 0) Then
    SAVE_INDEX = lstCorrelations.ListIndex
  Else
    SAVE_INDEX = 0
  End If
  HALT_LSTCORRELATIONS = True
  lstCorrelations.Clear
  For i = 1 To Number_Correlations_Compounds
    lstCorrelations.AddItem Local_Correlation(i).Name
  Next i
  HALT_LSTCORRELATIONS = False
  If (SAVE_INDEX > lstCorrelations.ListCount - 1) Then
    SAVE_INDEX = lstCorrelations.ListCount - 1
  End If
  If (SAVE_INDEX >= 0) And (SAVE_INDEX <= lstCorrelations.ListCount - 1) Then
    lstCorrelations.ListIndex = SAVE_INDEX
  End If
End Sub
Sub frmFoulingCompoundDatabase_Repopulate_Values()
Dim frm As Form
Set frm = frmFoulingCompoundDatabase
  'DISPLAY CURRENT VALUES FOR UNIT CONTROLS.
  Call unitsys_set_number_in_base_units( _
      frm.txtCoeff(1), Local_Record.A1)
  Call unitsys_set_number_in_base_units( _
      frm.txtCoeff(2), Local_Record.A2)
  'TEXT DATA.
  frm.txtName = Trim$(Local_Record.Name)
End Sub
Sub frmFoulingCompoundDatabase_Refresh()
Dim frm As Form
Set frm = frmFoulingCompoundDatabase
Dim TextLocked As Boolean
  'REPOPULATE VALUES.
  Call frmFoulingCompoundDatabase_Repopulate_Values
  'LOCK/UNLOCK TEXTBOXES AND LISTBOX.
  TextLocked = (FORM_MODE = FORM_MODE_VIEW)
  txtCoeff(1).Locked = TextLocked
  txtCoeff(2).Locked = TextLocked
  txtName.Locked = TextLocked
  lstCorrelations.Enabled = TextLocked
  'DISABLE/ENABLE BUTTONS.
  Select Case FORM_MODE
    Case FORM_MODE_VIEW:
      If frm.lstCorrelations.ListCount = 0 Then
        frm.cmdRecord(0).Enabled = True       'NEW.
        frm.cmdRecord(1).Enabled = False      'EDIT.
        frm.cmdRecord(2).Enabled = False      'DELETE.
      Else
        If frm.lstCorrelations.ListCount >= Max_Number_Correlation_Compo Then
          frm.cmdRecord(0).Enabled = False    'NEW.
          frm.cmdRecord(1).Enabled = True     'EDIT.
          frm.cmdRecord(2).Enabled = True     'DELETE.
        Else
          frm.cmdRecord(0).Enabled = True     'NEW.
          frm.cmdRecord(1).Enabled = True     'EDIT.
          frm.cmdRecord(2).Enabled = True     'DELETE.
        End If
      End If
      frm.cmdRecord(3).Enabled = False        'SAVE.
      frm.cmdRecord(4).Enabled = False        'CANCEL EDIT.
      frm.cmdCancelOK(0).Enabled = True       'CANCEL.
      frm.cmdCancelOK(1).Enabled = True       'OK.
    Case FORM_MODE_EDIT, FORM_MODE_ADDNEW:
      frm.cmdRecord(0).Enabled = False        'NEW.
      frm.cmdRecord(1).Enabled = False        'EDIT.
      frm.cmdRecord(2).Enabled = False        'DELETE.
      frm.cmdRecord(3).Enabled = True         'SAVE.
      frm.cmdRecord(4).Enabled = True         'CANCEL EDIT.
      frm.cmdCancelOK(0).Enabled = False      'CANCEL.
      frm.cmdCancelOK(1).Enabled = False      'OK.
  End Select
End Sub
Sub frmFoulingCompoundDatabase_PopulateUnits()
  Call unitsys_register(frmFoulingCompoundDatabase, lblDesc(1), _
      txtCoeff(1), Nothing, "", _
      "", "", "", "", 100#, False)
  Call unitsys_register(frmFoulingCompoundDatabase, lblDesc(2), _
      txtCoeff(2), Nothing, "", _
      "", "", "", "", 100#, False)
End Sub


Private Sub Load_Compound_Correlations(flag As Integer)
Dim f As Integer, n As Integer, i As Integer
On Error GoTo Error_In_Reading_Corr
  f = FreeFile
  Open Database_Path & "\corr_com.txt" For Input As f
  Input #f, n
  If n > Max_Number_Correlation_Compo Then
    flag = True
    Close (f)
    Call Show_Error("Too many correlations in the file.")
    Exit Sub
  End If
  For i = 1 To n
  Input #f, Local_Correlation(i).Name, _
      Local_Correlation(i).Coeff(1), _
      Local_Correlation(i).Coeff(2)
  Next i
  Close (f)
  Number_Correlations_Compounds = n
  flag = False
  Exit Sub
Error_In_Reading_Corr:
  Call Show_Error("Error while reading the file containing correlations.")
  flag = True
  Resume Exit_Corr_Compound
Exit_Corr_Compound:
End Sub
Sub Store_Compound_Correlations()
Dim f As Integer
Dim i As Integer
  On Error GoTo Error_In_Writing_File
  f = FreeFile
  Open Database_Path & "\corr_com.txt" For Output As f
  Write #f, Number_Correlations_Compounds
  For i = 1 To Number_Correlations_Compounds
  Write #f, Local_Correlation(i).Name, _
      Local_Correlation(i).Coeff(1), _
      Local_Correlation(i).Coeff(2)
  Next i
  Close (f)
  Exit Sub
Error_In_Writing_File:
  Call Show_Error("Error writing to file.")
  Close (f)
  Resume Exit_Here
Exit_Here:
End Sub
Sub Load_Local_Record(RecNum As Integer)
  Local_Record.Name = _
    Local_Correlation(RecNum).Name
  Local_Record.A1 = _
    Local_Correlation(RecNum).Coeff(1)
  Local_Record.A2 = _
    Local_Correlation(RecNum).Coeff(2)
End Sub
Sub Store_Local_Record(RecNum As Integer)
  Local_Correlation(RecNum).Name = _
    Local_Record.Name
  Local_Correlation(RecNum).Coeff(1) = _
    Local_Record.A1
  Local_Correlation(RecNum).Coeff(2) = _
    Local_Record.A2
End Sub


Private Sub cmdCancelOK_Click(Index As Integer)
Dim i As Integer
Dim resp As Integer, f As Integer, k As Integer, j As Integer
Dim RetVal As Integer
  Select Case Index
    Case 0:   'CANCEL.
      RetVal = MsgBox("Are you sure you want to exit without " & _
        "saving the database ?", vbQuestion + vbYesNo, _
        App.Title & " : Exit Without Saving Database ?")
      If (RetVal = vbNo) Then Exit Sub
      Call Load_Compound_Correlations(i)
      If i Then Exit Sub
      Unload Me
    Case 1:   'OK.
      RetVal = MsgBox("Are you sure you want to " & _
        "save the database ?", vbQuestion + vbYesNo, _
        App.Title & " : Save Database ?")
      If (RetVal = vbNo) Then Exit Sub
      Call Store_Compound_Correlations
      Unload Me
      Exit Sub
  End Select
End Sub


Private Sub cmdRecord_Click(Index As Integer)
Dim RetVal As Integer
Dim New_Rec_Index As Integer
Dim Del_Rec_Index As Integer
Dim Edit_Rec_Index As Integer
Dim i As Integer
  Select Case Index
    Case 0:   'NEW. ///////////////////////////////////////////////////////////////////////
      If (FORM_MODE <> FORM_MODE_VIEW) Then Exit Sub
      If (lstCorrelations.ListCount >= Max_Number_Correlation_Compo) Then
        Exit Sub
      End If
      FORM_MODE = FORM_MODE_ADDNEW
      'SET DEFAULT SETTINGS FOR NEW RECORD.
      Local_Record.Name = "New Compound Correlation"
      Local_Record.A1 = 1#
      Local_Record.A2 = 0#
      'REFRESH WINDOW.
      Call frmFoulingCompoundDatabase_Refresh
    Case 1:   'EDIT. //////////////////////////////////////////////////////////////////////
      If (FORM_MODE <> FORM_MODE_VIEW) Then Exit Sub
      Edit_Rec_Index = lstCorrelations.ListIndex + 1
      If (Edit_Rec_Index < 1) Or (Edit_Rec_Index > Number_Correlations_Compounds) Then
        Call Show_Error("You must first select a correlation.")
        Exit Sub
      End If
      FORM_MODE = FORM_MODE_EDIT
      'REFRESH WINDOW.
      Call frmFoulingCompoundDatabase_Refresh
    Case 2:   'DELETE. ////////////////////////////////////////////////////////////////////
      If (FORM_MODE <> FORM_MODE_VIEW) Then Exit Sub
      Del_Rec_Index = lstCorrelations.ListIndex + 1
      If (Del_Rec_Index < 1) Or (Del_Rec_Index > Number_Correlations_Compounds) Then
        Call Show_Error("You must first select a correlation.")
        Exit Sub
      End If
      For i = Del_Rec_Index To Number_Correlations_Compounds - 1
        Local_Correlation(i) = Local_Correlation(i + 1)
      Next i
      Number_Correlations_Compounds = Number_Correlations_Compounds - 1
      'REPOPULATE LISTBOX.
      Call Populate_lstCorrelations
      'REFRESH WINDOW.
      Call frmFoulingCompoundDatabase_Refresh
    Case 3:   'SAVE. //////////////////////////////////////////////////////////////////////
      If (FORM_MODE = FORM_MODE_VIEW) Then Exit Sub
      Select Case FORM_MODE
        Case FORM_MODE_EDIT:
          Call Store_Local_Record(lstCorrelations.ListIndex + 1)
        Case FORM_MODE_ADDNEW:
          Number_Correlations_Compounds = Number_Correlations_Compounds + 1
          New_Rec_Index = Number_Correlations_Compounds
          Call Store_Local_Record(New_Rec_Index)
      End Select
      FORM_MODE = FORM_MODE_VIEW
      'REPOPULATE LISTBOX.
      Call Populate_lstCorrelations
      lstCorrelations.ListIndex = lstCorrelations.ListCount - 1
      'REFRESH WINDOW.
      Call frmFoulingCompoundDatabase_Refresh
    Case 4:   'CANCEL EDIT. ///////////////////////////////////////////////////////////////
      If (FORM_MODE = FORM_MODE_VIEW) Then Exit Sub
      FORM_MODE = FORM_MODE_VIEW
      'REPOPULATE LISTBOX.
      Call Populate_lstCorrelations
      'REFRESH WINDOW.
      Call frmFoulingCompoundDatabase_Refresh
  End Select
End Sub


Private Sub Form_Load()
Dim i As Integer, j As Integer
  Call CenterOnForm(Me, frmFouling)
  i = False
  Call Load_Compound_Correlations(i)
  If i Then Number_Correlations_Compounds = 0
  Call Populate_lstCorrelations
  If (Number_Correlations_Compounds >= 1) Then
    Call Load_Local_Record(1)
  End If
  FORM_MODE = FORM_MODE_VIEW
  'POPULATE UNIT CONTROLS.
  Call frmFoulingCompoundDatabase_PopulateUnits
  'REFRESH WINDOW.
  Call frmFoulingCompoundDatabase_Refresh
End Sub
Private Sub Form_Unload(Cancel As Integer)
  Call unitsys_unregister_all_on_form(Me)
End Sub


Private Sub lstCorrelations_Click()
Dim ThisIndex As Integer
  If (HALT_LSTCORRELATIONS) Then Exit Sub
  ThisIndex = lstCorrelations.ListIndex + 1
  If (ThisIndex <= lstCorrelations.ListCount) Then
    Call Load_Local_Record(lstCorrelations.ListIndex + 1)
  End If
  'REFRESH WINDOW.
  Call frmFoulingCompoundDatabase_Refresh
End Sub


Private Sub txtCoeff_GotFocus(Index As Integer)
Dim Ctl As Control
Set Ctl = txtCoeff(Index)
  Call unitsys_control_txtx_gotfocus(Ctl)
End Sub
Private Sub txtCoeff_KeyPress(Index As Integer, KeyAscii As Integer)
  KeyAscii = Global_NumericKeyPress(KeyAscii)
End Sub
Private Sub txtCoeff_LostFocus(Index As Integer)
Dim NewValue_Okay As Integer
Dim NewValue As Double
Dim Ctl As Control
Set Ctl = txtCoeff(Index)
Dim Val_Low As Double
Dim Val_High As Double
Dim Raise_Dirty_Flag As Boolean
Dim Too_Small As Integer
  'NOTE: LOW AND HIGH VALUES IN BASE UNITS.
  Select Case Index
    Case 1: Val_Low = -1E+20: Val_High = 1E+20
    Case 2: Val_Low = -1E+20: Val_High = 1E+20
  End Select
  NewValue_Okay = False
  If (unitsys_control_txtx_lostfocus_validate(Ctl, Val_Low, Val_High, NewValue, Raise_Dirty_Flag)) Then
    NewValue_Okay = True
  End If
  Call unitsys_control_txtx_lostfocus(Ctl, NewValue)
  If (NewValue_Okay) Then
    If (Raise_Dirty_Flag) Then
      'STORE TO MEMORY.
      Select Case Index
        Case 1: Local_Record.A1 = NewValue
        Case 2: Local_Record.A2 = NewValue
      End Select
      'RAISE DIRTY FLAG IF NECESSARY.
      If (Raise_Dirty_Flag) Then
        ''THROW DIRTY FLAG.
        'Call frmCompoProp_DirtyStatus_Throw
      End If
      'REFRESH WINDOW.
      Call frmFoulingCompoundDatabase_Refresh
    End If
  End If
End Sub


Private Sub txtName_GotFocus()
Dim Ctl As Control
Set Ctl = txtName
  Call Global_GotFocus(Ctl)
End Sub
Private Sub txtName_KeyPress(KeyAscii As Integer)
  KeyAscii = Global_TextKeyPress(KeyAscii)
End Sub
Private Sub txtName_LostFocus()
Dim Ctl As Control
Set Ctl = txtName
Dim OldValueStr As String
  'HANDLE STRING FIELDS.
  OldValueStr = Trim$(Local_Record.Name)
  If (Trim$(Ctl.Text) = "") Then
    Ctl.Text = OldValueStr
    'Call Show_Error("You must enter a non-blank string for the carbon name.")
    'NOTE: SHOWING THIS ERROR MESSAGE MESSES UP THE
    'SUBSEQUENT GOTFOCUS IF THE USER HITS <Enter> OR <Tab>.
  Else
    If (Trim$(OldValueStr) <> Trim$(Ctl.Text)) Then
      Local_Record.Name = Trim$(Ctl.Text)
      ''THROW DIRTY FLAG.
      'Call DirtyStatus_Throw
    End If
  End If
  Call Global_LostFocus(Ctl)
  'Call GenericStatus_Set("")
End Sub




VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmFoulingWaterDatabase 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Water Fouling Correlation Database"
   ClientHeight    =   6435
   ClientLeft      =   1710
   ClientTop       =   2655
   ClientWidth     =   5760
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   6435
   ScaleWidth      =   5760
   Begin Threed.SSFrame SSFrame1 
      Height          =   2625
      Left            =   120
      TabIndex        =   0
      Top             =   120
      Width           =   5475
      _Version        =   65536
      _ExtentX        =   9657
      _ExtentY        =   4630
      _StockProps     =   14
      Caption         =   "Select a Water Type:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.ListBox lstCorrelations 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   2175
         Left            =   120
         TabIndex        =   2
         TabStop         =   0   'False
         Top             =   270
         Width           =   5235
      End
   End
   Begin Threed.SSFrame SSFrame2 
      Height          =   2835
      Left            =   120
      TabIndex        =   1
      Top             =   2850
      Width           =   5475
      _Version        =   65536
      _ExtentX        =   9657
      _ExtentY        =   5001
      _StockProps     =   14
      Caption         =   "Empirical Kinetic Constants for:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.TextBox txtCoeff 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   4
         Left            =   1980
         TabIndex        =   10
         Text            =   "txtCoeff(4)"
         Top             =   1800
         Width           =   1455
      End
      Begin VB.TextBox txtCoeff 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   3
         Left            =   1980
         TabIndex        =   9
         Text            =   "txtCoeff(3)"
         Top             =   1440
         Width           =   1455
      End
      Begin VB.TextBox txtCoeff 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   2
         Left            =   1980
         TabIndex        =   8
         Text            =   "txtCoeff(2)"
         Top             =   1080
         Width           =   1455
      End
      Begin VB.TextBox txtCoeff 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   1
         Left            =   1980
         TabIndex        =   7
         Text            =   "txtCoeff(1)"
         Top             =   720
         Width           =   1455
      End
      Begin Threed.SSCommand cmdRecord 
         Height          =   375
         Index           =   0
         Left            =   120
         TabIndex        =   4
         TabStop         =   0   'False
         Top             =   2310
         Width           =   975
         _Version        =   65536
         _ExtentX        =   1720
         _ExtentY        =   661
         _StockProps     =   78
         Caption         =   "&New"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSCommand cmdRecord 
         Height          =   375
         Index           =   1
         Left            =   1080
         TabIndex        =   5
         TabStop         =   0   'False
         Top             =   2310
         Width           =   975
         _Version        =   65536
         _ExtentX        =   1720
         _ExtentY        =   661
         _StockProps     =   78
         Caption         =   "&Edit"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSCommand cmdRecord 
         Height          =   375
         Index           =   2
         Left            =   2040
         TabIndex        =   6
         TabStop         =   0   'False
         Top             =   2310
         Width           =   975
         _Version        =   65536
         _ExtentX        =   1720
         _ExtentY        =   661
         _StockProps     =   78
         Caption         =   "&Delete"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin VB.TextBox txtName 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Left            =   120
         TabIndex        =   3
         Text            =   "txtName"
         Top             =   300
         Width           =   5235
      End
      Begin Threed.SSCommand cmdRecord 
         Height          =   375
         Index           =   3
         Left            =   3000
         TabIndex        =   21
         TabStop         =   0   'False
         Top             =   2310
         Width           =   975
         _Version        =   65536
         _ExtentX        =   1720
         _ExtentY        =   661
         _StockProps     =   78
         Caption         =   "&Save"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSCommand cmdRecord 
         Height          =   375
         Index           =   4
         Left            =   3960
         TabIndex        =   22
         TabStop         =   0   'False
         Top             =   2310
         Width           =   1395
         _Version        =   65536
         _ExtentX        =   2461
         _ExtentY        =   661
         _StockProps     =   78
         Caption         =   "Cancel Edit"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "K1"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   720
         TabIndex        =   18
         Top             =   750
         Width           =   1155
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "K2"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   720
         TabIndex        =   17
         Top             =   1110
         Width           =   1155
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "K3"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   720
         TabIndex        =   16
         Top             =   1470
         Width           =   1155
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "K4"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   720
         TabIndex        =   15
         Top             =   1830
         Width           =   1155
      End
      Begin VB.Label lblUnit 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "-"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   3600
         TabIndex        =   14
         Top             =   750
         Width           =   600
      End
      Begin VB.Label lblUnit 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "1/min"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   3600
         TabIndex        =   13
         Top             =   1110
         Width           =   600
      End
      Begin VB.Label lblUnit 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "-"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   3600
         TabIndex        =   12
         Top             =   1470
         Width           =   600
      End
      Begin VB.Label lblUnit 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "1/min"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   3600
         TabIndex        =   11
         Top             =   1830
         Width           =   600
      End
   End
   Begin Threed.SSCommand cmdCancelOK 
      Height          =   495
      Index           =   1
      Left            =   120
      TabIndex        =   19
      TabStop         =   0   'False
      ToolTipText     =   "Click here to save any changes you have made to this database"
      Top             =   5820
      Width           =   2295
      _Version        =   65536
      _ExtentX        =   4048
      _ExtentY        =   873
      _StockProps     =   78
      Caption         =   "&OK"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdCancelOK 
      Height          =   495
      Index           =   0
      Left            =   3300
      TabIndex        =   20
      TabStop         =   0   'False
      ToolTipText     =   "Click here to abandon any changes you have made to this database"
      Top             =   5820
      Width           =   2295
      _Version        =   65536
      _ExtentX        =   4048
      _ExtentY        =   873
      _StockProps     =   78
      Caption         =   "&Cancel"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
End
Attribute VB_Name = "frmFoulingWaterDatabase"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
'Dim New_Correlation As Integer

Dim FORM_MODE As Integer
Const FORM_MODE_VIEW = 1
Const FORM_MODE_EDIT = 2
Const FORM_MODE_ADDNEW = 3

Dim HALT_LSTCORRELATIONS As Boolean

'//////// COMMUNICATIONS WITH frmFoulingWaterDatabase: /////////////////////////////////////////////////
Private Type frmFoulingWaterDatabase_Record_Type
  K1 As Double
  K2 As Double
  K3 As Double
  K4 As Double
  Name As String
End Type
Dim Local_Record As frmFoulingWaterDatabase_Record_Type






Const frmFoulingWaterDatabase_declarations_end = True



Sub frmFoulingWaterDatabase_Edit()
  frmFoulingWaterDatabase.Show 1
End Sub


Sub Populate_lstCorrelations()
Dim SAVE_INDEX As Integer
Dim i As Integer
  If (lstCorrelations.ListIndex >= 0) Then
    SAVE_INDEX = lstCorrelations.ListIndex
  Else
    SAVE_INDEX = 0
  End If
  HALT_LSTCORRELATIONS = True
  lstCorrelations.Clear
  For i = 1 To Number_Water_Correlations
    lstCorrelations.AddItem Correlations_For_Water(i).Name
  Next i
  HALT_LSTCORRELATIONS = False
  If (SAVE_INDEX > lstCorrelations.ListCount - 1) Then
    SAVE_INDEX = lstCorrelations.ListCount - 1
  End If
  If (SAVE_INDEX >= 0) And (SAVE_INDEX <= lstCorrelations.ListCount - 1) Then
    lstCorrelations.ListIndex = SAVE_INDEX
  End If
End Sub
Sub frmFoulingWaterDatabase_Repopulate_Values()
Dim frm As Form
Set frm = frmFoulingWaterDatabase
  'DISPLAY CURRENT VALUES FOR UNIT CONTROLS.
  Call unitsys_set_number_in_base_units( _
      frm.txtCoeff(1), Local_Record.K1)
  Call unitsys_set_number_in_base_units( _
      frm.txtCoeff(2), Local_Record.K2)
  Call unitsys_set_number_in_base_units( _
      frm.txtCoeff(3), Local_Record.K3)
  Call unitsys_set_number_in_base_units( _
      frm.txtCoeff(4), Local_Record.K4)
  'TEXT DATA.
  frm.txtName = Trim$(Local_Record.Name)
End Sub
Sub frmFoulingWaterDatabase_Refresh()
Dim frm As Form
Set frm = frmFoulingWaterDatabase
Dim TextLocked As Boolean
  'REPOPULATE VALUES.
  Call frmFoulingWaterDatabase_Repopulate_Values
  'LOCK/UNLOCK TEXTBOXES AND LISTBOX.
  TextLocked = (FORM_MODE = FORM_MODE_VIEW)
  txtCoeff(1).Locked = TextLocked
  txtCoeff(2).Locked = TextLocked
  txtCoeff(3).Locked = TextLocked
  txtCoeff(4).Locked = TextLocked
  txtName.Locked = TextLocked
  lstCorrelations.Enabled = TextLocked
  'DISABLE/ENABLE BUTTONS.
  Select Case FORM_MODE
    Case FORM_MODE_VIEW:
      If frm.lstCorrelations.ListCount = 0 Then
        frm.cmdRecord(0).Enabled = True       'NEW.
        frm.cmdRecord(1).Enabled = False      'EDIT.
        frm.cmdRecord(2).Enabled = False      'DELETE.
      Else
        If frm.lstCorrelations.ListCount >= Max_Number_Water_Correlations Then
          frm.cmdRecord(0).Enabled = False    'NEW.
          frm.cmdRecord(1).Enabled = True     'EDIT.
          frm.cmdRecord(2).Enabled = True     'DELETE.
        Else
          frm.cmdRecord(0).Enabled = True     'NEW.
          frm.cmdRecord(1).Enabled = True     'EDIT.
          frm.cmdRecord(2).Enabled = True     'DELETE.
        End If
      End If
      frm.cmdRecord(3).Enabled = False        'SAVE.
      frm.cmdRecord(4).Enabled = False        'CANCEL EDIT.
      frm.cmdCancelOK(0).Enabled = True       'CANCEL.
      frm.cmdCancelOK(1).Enabled = True       'OK.
    Case FORM_MODE_EDIT, FORM_MODE_ADDNEW:
      frm.cmdRecord(0).Enabled = False        'NEW.
      frm.cmdRecord(1).Enabled = False        'EDIT.
      frm.cmdRecord(2).Enabled = False        'DELETE.
      frm.cmdRecord(3).Enabled = True         'SAVE.
      frm.cmdRecord(4).Enabled = True         'CANCEL EDIT.
      frm.cmdCancelOK(0).Enabled = False      'CANCEL.
      frm.cmdCancelOK(1).Enabled = False      'OK.
  End Select
End Sub
Sub frmFoulingWaterDatabase_PopulateUnits()
  Call unitsys_register(frmFoulingWaterDatabase, lblDesc(1), _
      txtCoeff(1), Nothing, "", _
      "", "", "", "", 100#, False)
  Call unitsys_register(frmFoulingWaterDatabase, lblDesc(2), _
      txtCoeff(2), Nothing, "", _
      "", "", "", "", 100#, False)
  Call unitsys_register(frmFoulingWaterDatabase, lblDesc(3), _
      txtCoeff(3), Nothing, "", _
      "", "", "", "", 100#, False)
  Call unitsys_register(frmFoulingWaterDatabase, lblDesc(4), _
      txtCoeff(4), Nothing, "", _
      "", "", "", "", 100#, False)
End Sub


Private Sub Load_Water_Correlations(flag As Integer)
Dim f As Integer, n As Integer, i As Integer
On Error GoTo Error_In_Reading_Corr
  f = FreeFile
  Open Database_Path & "\water_co.txt" For Input As f
  Input #f, n
  If n > Max_Number_Water_Correlations Then
    flag = True
    Close (f)
    Call Show_Error("Too many correlations in the file.")
    Exit Sub
  End If
  For i = 1 To n
  Input #f, Correlations_For_Water(i).Name, _
      Correlations_For_Water(i).Coeff(1), _
      Correlations_For_Water(i).Coeff(2), _
      Correlations_For_Water(i).Coeff(3), _
      Correlations_For_Water(i).Coeff(4)
  Next i
  Close (f)
  Number_Water_Correlations = n
  flag = False
  Exit Sub
Error_In_Reading_Corr:
  Call Show_Error("Error while reading the file containing correlations.")
  flag = True
  Resume Exit_Corr_Compound
Exit_Corr_Compound:
End Sub
Sub Store_Water_Correlations()
Dim f As Integer
Dim i As Integer
  On Error GoTo Error_In_Writing_File
  f = FreeFile
  Open Database_Path & "\water_co.txt" For Output As f
  Write #f, Number_Water_Correlations
  For i = 1 To Number_Water_Correlations
  Write #f, Correlations_For_Water(i).Name, _
      Correlations_For_Water(i).Coeff(1), _
      Correlations_For_Water(i).Coeff(2), _
      Correlations_For_Water(i).Coeff(3), _
      Correlations_For_Water(i).Coeff(4)
  Next i
  Close (f)
  Exit Sub
Error_In_Writing_File:
  Call Show_Error("Error writing to file.")
  Close (f)
  Resume Exit_Here
Exit_Here:
End Sub
Sub Load_Local_Record(RecNum As Integer)
  Local_Record.Name = _
    Correlations_For_Water(RecNum).Name
  Local_Record.K1 = _
    Correlations_For_Water(RecNum).Coeff(1)
  Local_Record.K2 = _
    Correlations_For_Water(RecNum).Coeff(2)
  Local_Record.K3 = _
    Correlations_For_Water(RecNum).Coeff(3)
  Local_Record.K4 = _
    Correlations_For_Water(RecNum).Coeff(4)
End Sub
Sub Store_Local_Record(RecNum As Integer)
  Correlations_For_Water(RecNum).Name = _
    Local_Record.Name
  Correlations_For_Water(RecNum).Coeff(1) = _
    Local_Record.K1
  Correlations_For_Water(RecNum).Coeff(2) = _
    Local_Record.K2
  Correlations_For_Water(RecNum).Coeff(3) = _
    Local_Record.K3
  Correlations_For_Water(RecNum).Coeff(4) = _
    Local_Record.K4
End Sub


Private Sub cmdCancelOK_Click(Index As Integer)
Dim i As Integer
Dim resp As Integer, f As Integer, k As Integer, j As Integer
Dim RetVal As Integer
  Select Case Index
    Case 0:   'CANCEL.
      RetVal = MsgBox("Are you sure you want to exit without " & _
        "saving the database ?", vbQuestion + vbYesNo, _
        App.Title & " : Exit Without Saving Database ?")
      If (RetVal = vbNo) Then Exit Sub
      Call Load_Water_Correlations(i)
      If i Then Exit Sub
      Unload Me
    Case 1:   'OK.
      RetVal = MsgBox("Are you sure you want to " & _
        "save the database ?", vbQuestion + vbYesNo, _
        App.Title & " : Save Database ?")
      If (RetVal = vbNo) Then Exit Sub
      Call Store_Water_Correlations
      Unload Me
      Exit Sub
  End Select
End Sub


Private Sub cmdRecord_Click(Index As Integer)
Dim RetVal As Integer
Dim New_Rec_Index As Integer
Dim Del_Rec_Index As Integer
Dim Edit_Rec_Index As Integer
Dim i As Integer
  Select Case Index
    Case 0:   'NEW. ///////////////////////////////////////////////////////////////////////
      If (FORM_MODE <> FORM_MODE_VIEW) Then Exit Sub
      If (lstCorrelations.ListCount >= Max_Number_Water_Correlations) Then
        Exit Sub
      End If
      FORM_MODE = FORM_MODE_ADDNEW
      'SET DEFAULT SETTINGS FOR NEW RECORD.
      Local_Record.Name = "New Water Correlation"
      Local_Record.K1 = 1#
      Local_Record.K2 = 0#
      Local_Record.K3 = 0#
      Local_Record.K4 = 0#
      'REFRESH WINDOW.
      Call frmFoulingWaterDatabase_Refresh
    Case 1:   'EDIT. //////////////////////////////////////////////////////////////////////
      If (FORM_MODE <> FORM_MODE_VIEW) Then Exit Sub
      Edit_Rec_Index = lstCorrelations.ListIndex + 1
      If (Edit_Rec_Index < 1) Or (Edit_Rec_Index > Number_Water_Correlations) Then
        Call Show_Error("You must first select a correlation.")
        Exit Sub
      End If
      FORM_MODE = FORM_MODE_EDIT
      'REFRESH WINDOW.
      Call frmFoulingWaterDatabase_Refresh
    Case 2:   'DELETE. ////////////////////////////////////////////////////////////////////
      If (FORM_MODE <> FORM_MODE_VIEW) Then Exit Sub
      Del_Rec_Index = lstCorrelations.ListIndex + 1
      If (Del_Rec_Index < 1) Or (Del_Rec_Index > Number_Water_Correlations) Then
        Call Show_Error("You must first select a correlation.")
        Exit Sub
      End If
      For i = Del_Rec_Index To Number_Water_Correlations - 1
        Correlations_For_Water(i) = Correlations_For_Water(i + 1)
      Next i
      Number_Water_Correlations = Number_Water_Correlations - 1
      'REPOPULATE LISTBOX.
      Call Populate_lstCorrelations
      'REFRESH WINDOW.
      Call frmFoulingWaterDatabase_Refresh
    Case 3:   'SAVE. //////////////////////////////////////////////////////////////////////
      If (FORM_MODE = FORM_MODE_VIEW) Then Exit Sub
      Select Case FORM_MODE
        Case FORM_MODE_EDIT:
          Call Store_Local_Record(lstCorrelations.ListIndex + 1)
        Case FORM_MODE_ADDNEW:
          Number_Water_Correlations = Number_Water_Correlations + 1
          New_Rec_Index = Number_Water_Correlations
          Call Store_Local_Record(New_Rec_Index)
      End Select
      FORM_MODE = FORM_MODE_VIEW
      'REPOPULATE LISTBOX.
      Call Populate_lstCorrelations
      lstCorrelations.ListIndex = lstCorrelations.ListCount - 1
      'REFRESH WINDOW.
      Call frmFoulingWaterDatabase_Refresh
    Case 4:   'CANCEL EDIT. ///////////////////////////////////////////////////////////////
      If (FORM_MODE = FORM_MODE_VIEW) Then Exit Sub
      'RetVal = MsgBox("Do you want to exit without " & _
      '  "saving the edited data ?", vbQuestion + vbYesNo, _
      '  App.Title)
      'If (RetVal = vbNo) Then Exit Sub
      FORM_MODE = FORM_MODE_VIEW
      'REPOPULATE LISTBOX.
      Call Populate_lstCorrelations
      'REFRESH WINDOW.
      Call frmFoulingWaterDatabase_Refresh
  End Select
End Sub


Private Sub Form_Load()
Dim i As Integer, j As Integer
  Call CenterOnForm(Me, frmFouling)
  i = False
  Call Load_Water_Correlations(i)
  If i Then Number_Water_Correlations = 0
  Call Populate_lstCorrelations
  If (Number_Water_Correlations >= 1) Then
    Call Load_Local_Record(1)
  End If
  FORM_MODE = FORM_MODE_VIEW
  'POPULATE UNIT CONTROLS.
  Call frmFoulingWaterDatabase_PopulateUnits
  'REFRESH WINDOW.
  Call frmFoulingWaterDatabase_Refresh
End Sub
Private Sub Form_Unload(Cancel As Integer)
  Call unitsys_unregister_all_on_form(Me)
End Sub


Private Sub lstCorrelations_Click()
Dim ThisIndex As Integer
  If (HALT_LSTCORRELATIONS) Then Exit Sub
  ThisIndex = lstCorrelations.ListIndex + 1
  If (ThisIndex <= lstCorrelations.ListCount) Then
    Call Load_Local_Record(lstCorrelations.ListIndex + 1)
  End If
  'REFRESH WINDOW.
  Call frmFoulingWaterDatabase_Refresh
End Sub


Private Sub txtCoeff_GotFocus(Index As Integer)
Dim Ctl As Control
Set Ctl = txtCoeff(Index)
  Call unitsys_control_txtx_gotfocus(Ctl)
End Sub
Private Sub txtCoeff_KeyPress(Index As Integer, KeyAscii As Integer)
  KeyAscii = Global_NumericKeyPress(KeyAscii)
End Sub
Private Sub txtCoeff_LostFocus(Index As Integer)
Dim NewValue_Okay As Integer
Dim NewValue As Double
Dim Ctl As Control
Set Ctl = txtCoeff(Index)
Dim Val_Low As Double
Dim Val_High As Double
Dim Raise_Dirty_Flag As Boolean
Dim Too_Small As Integer
  'NOTE: LOW AND HIGH VALUES IN BASE UNITS.
  Select Case Index
    Case 1: Val_Low = 1E-20: Val_High = 1E+20
    Case 2: Val_Low = -1E+20: Val_High = 1E+20
    Case 3: Val_Low = -1E+20: Val_High = 1E+20
    Case 4: Val_Low = -1E+20: Val_High = 1E+20
  End Select
  NewValue_Okay = False
  If (unitsys_control_txtx_lostfocus_validate(Ctl, Val_Low, Val_High, NewValue, Raise_Dirty_Flag)) Then
    NewValue_Okay = True
  End If
  Call unitsys_control_txtx_lostfocus(Ctl, NewValue)
  If (NewValue_Okay) Then
    If (Raise_Dirty_Flag) Then
      'STORE TO MEMORY.
      Select Case Index
        Case 1: Local_Record.K1 = NewValue
        Case 2: Local_Record.K2 = NewValue
        Case 3: Local_Record.K3 = NewValue
        Case 4: Local_Record.K4 = NewValue
      End Select
      'RAISE DIRTY FLAG IF NECESSARY.
      If (Raise_Dirty_Flag) Then
        ''THROW DIRTY FLAG.
        'Call frmCompoProp_DirtyStatus_Throw
      End If
      'REFRESH WINDOW.
      Call frmFoulingWaterDatabase_Refresh
    End If
  End If
End Sub


Private Sub txtName_GotFocus()
Dim Ctl As Control
Set Ctl = txtName
  Call Global_GotFocus(Ctl)
End Sub
Private Sub txtName_KeyPress(KeyAscii As Integer)
  KeyAscii = Global_TextKeyPress(KeyAscii)
End Sub
Private Sub txtName_LostFocus()
Dim Ctl As Control
Set Ctl = txtName
Dim OldValueStr As String
  'HANDLE STRING FIELDS.
  OldValueStr = Trim$(Local_Record.Name)
  'NOTE: ZERO-LENGTH STRINGS FOR 8 AND 11 ARE ALLOWED.
  If (Trim$(Ctl.Text) = "") Then
    Ctl.Text = OldValueStr
    'Call Show_Error("You must enter a non-blank string for the carbon name.")
    'NOTE: SHOWING THIS ERROR MESSAGE MESSES UP THE
    'SUBSEQUENT GOTFOCUS IF THE USER HITS <Enter> OR <Tab>.
  Else
    If (Trim$(OldValueStr) <> Trim$(Ctl.Text)) Then
      Local_Record.Name = Trim$(Ctl.Text)
      ''THROW DIRTY FLAG.
      'Call DirtyStatus_Throw
    End If
  End If
  Call Global_LostFocus(Ctl)
  'Call GenericStatus_Set("")
End Sub


VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmFreundlich 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Freundlich Isotherm Parameters for {ComponentName}"
   ClientHeight    =   8820
   ClientLeft      =   3750
   ClientTop       =   810
   ClientWidth     =   9465
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   8820
   ScaleWidth      =   9465
   Begin VB.OptionButton Option1 
      Caption         =   "Option1"
      Height          =   525
      Left            =   6240
      TabIndex        =   70
      Top             =   7620
      Visible         =   0   'False
      Width           =   1245
   End
   Begin Threed.SSFrame fraUserInput 
      Height          =   735
      Left            =   660
      TabIndex        =   60
      Top             =   7530
      Width           =   4575
      _Version        =   65536
      _ExtentX        =   8070
      _ExtentY        =   1296
      _StockProps     =   14
      Caption         =   "User Input"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.TextBox UserK 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         Height          =   285
         Left            =   1860
         TabIndex        =   62
         Text            =   "UserK"
         Top             =   270
         Width           =   975
      End
      Begin VB.TextBox UserOneOverN 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         Height          =   285
         Left            =   600
         TabIndex        =   61
         Text            =   "UserOneOverN"
         Top             =   270
         Width           =   975
      End
      Begin VB.Label lblText 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "K"
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   1500
         TabIndex        =   65
         Top             =   300
         Width           =   315
      End
      Begin VB.Label lblText 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "1/n"
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   120
         TabIndex        =   64
         Top             =   300
         Width           =   375
      End
      Begin VB.Label Label5 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "(mg/g)*(L/mg)^(1/n)"
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   2880
         TabIndex        =   63
         Top             =   300
         Width           =   1575
      End
   End
   Begin Threed.SSFrame fraSource 
      Height          =   1305
      Left            =   90
      TabIndex        =   0
      Top             =   60
      Width           =   9255
      _Version        =   65536
      _ExtentX        =   16325
      _ExtentY        =   2302
      _StockProps     =   14
      Caption         =   "Source of K and 1/n:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin Threed.SSOption optFreundlichSource 
         Height          =   255
         Index           =   2
         Left            =   120
         TabIndex        =   1
         Top             =   900
         Width           =   3100
         _Version        =   65536
         _ExtentX        =   5468
         _ExtentY        =   450
         _StockProps     =   78
         Caption         =   "U&ser Input"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Enabled         =   0   'False
      End
      Begin Threed.SSOption optFreundlichSource 
         Height          =   255
         Index           =   1
         Left            =   120
         TabIndex        =   2
         Top             =   600
         Width           =   3100
         _Version        =   65536
         _ExtentX        =   5468
         _ExtentY        =   450
         _StockProps     =   78
         Caption         =   "Isotherm Parameter &Estimation"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Enabled         =   0   'False
      End
      Begin Threed.SSOption optFreundlichSource 
         Height          =   255
         Index           =   0
         Left            =   120
         TabIndex        =   3
         Top             =   300
         Width           =   3100
         _Version        =   65536
         _ExtentX        =   5468
         _ExtentY        =   450
         _StockProps     =   78
         Caption         =   "Isotherm &Database"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Enabled         =   0   'False
      End
      Begin Threed.SSCommand cmdCancelOK 
         Height          =   495
         Index           =   1
         Left            =   7530
         TabIndex        =   58
         TabStop         =   0   'False
         ToolTipText     =   "Click here to save the changes you have made to the Freundlich parameters on this window"
         Top             =   690
         Width           =   1545
         _Version        =   65536
         _ExtentX        =   2725
         _ExtentY        =   873
         _StockProps     =   78
         Caption         =   "&OK"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSCommand cmdCancelOK 
         Height          =   495
         Index           =   0
         Left            =   7530
         TabIndex        =   59
         TabStop         =   0   'False
         ToolTipText     =   "Click here to abandon any changes you have made to the Freundlich parameters on this window"
         Top             =   210
         Width           =   1545
         _Version        =   65536
         _ExtentX        =   2725
         _ExtentY        =   873
         _StockProps     =   78
         Caption         =   "&Cancel"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSPanel sspanel_Warning 
         Height          =   1095
         Left            =   3330
         TabIndex        =   66
         Top             =   150
         Width           =   4065
         _Version        =   65536
         _ExtentX        =   7170
         _ExtentY        =   1931
         _StockProps     =   15
         BackColor       =   12632256
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Begin VB.Label lblWarning 
            Alignment       =   2  'Center
            Caption         =   "lblWarning"
            ForeColor       =   &H000000FF&
            Height          =   915
            Left            =   120
            TabIndex        =   67
            Top             =   90
            Width           =   3825
         End
      End
   End
   Begin Threed.SSFrame fraIPES 
      Height          =   2505
      Left            =   90
      TabIndex        =   4
      Top             =   1440
      Width           =   9255
      _Version        =   65536
      _ExtentX        =   16325
      _ExtentY        =   4419
      _StockProps     =   14
      Caption         =   "Isotherm Parameter Estimation (IPE)"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.ComboBox cboMethod 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Left            =   90
         Style           =   2  'Dropdown List
         TabIndex        =   6
         Top             =   795
         Width           =   4095
      End
      Begin Threed.SSCommand cmdCalculate 
         Height          =   375
         Left            =   4470
         TabIndex        =   5
         Top             =   1680
         Width           =   4695
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "&Perform IPE Calculations"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSFrame fraPolanyi 
         Height          =   1425
         Left            =   4470
         TabIndex        =   13
         Top             =   180
         Width           =   4695
         _Version        =   65536
         _ExtentX        =   8281
         _ExtentY        =   2514
         _StockProps     =   14
         Caption         =   "Polanyi Parameters"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Begin VB.TextBox txtInput 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            BackColor       =   &H8000000F&
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   285
            Index           =   13
            Left            =   1920
            Locked          =   -1  'True
            TabIndex        =   17
            Text            =   "txtInput(13)"
            Top             =   240
            Width           =   2655
         End
         Begin VB.TextBox txtInput 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            BackColor       =   &H8000000F&
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   285
            Index           =   0
            Left            =   3480
            Locked          =   -1  'True
            TabIndex        =   16
            Text            =   "txtInput(0)"
            Top             =   540
            Width           =   1095
         End
         Begin VB.TextBox txtInput 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            BackColor       =   &H8000000F&
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   285
            Index           =   1
            Left            =   3480
            Locked          =   -1  'True
            TabIndex        =   15
            Text            =   "txtInput(1)"
            Top             =   780
            Width           =   1095
         End
         Begin VB.TextBox txtInput 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            BackColor       =   &H8000000F&
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   285
            Index           =   10
            Left            =   3480
            Locked          =   -1  'True
            TabIndex        =   14
            Text            =   "txtInput(10)"
            Top             =   1020
            Width           =   1095
         End
         Begin Threed.SSCommand cmdEditPolanyi 
            Height          =   375
            Left            =   120
            TabIndex        =   68
            Top             =   900
            Width           =   1575
            _Version        =   65536
            _ExtentX        =   2778
            _ExtentY        =   661
            _StockProps     =   78
            Caption         =   "Edi&t Parameters"
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
         End
         Begin VB.Label Label10 
            Alignment       =   1  'Right Justify
            Appearance      =   0  'Flat
            BackColor       =   &H80000005&
            BackStyle       =   0  'Transparent
            Caption         =   "Adsorbent:"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H80000008&
            Height          =   195
            Left            =   900
            TabIndex        =   21
            Top             =   270
            Width           =   975
         End
         Begin VB.Label lblInput 
            Alignment       =   1  'Right Justify
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            Caption         =   "W0 (cm3/g)"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H80000008&
            Height          =   255
            Index           =   0
            Left            =   1890
            TabIndex        =   20
            Top             =   570
            Width           =   1515
         End
         Begin VB.Label lblInput 
            Alignment       =   1  'Right Justify
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            Caption         =   "BB (mol/cal)^GM"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H80000008&
            Height          =   255
            Index           =   1
            Left            =   1830
            TabIndex        =   19
            Top             =   810
            Width           =   1575
         End
         Begin VB.Label lblInput 
            Alignment       =   1  'Right Justify
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            Caption         =   "GM"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H80000008&
            Height          =   255
            Index           =   4
            Left            =   1830
            TabIndex        =   18
            Top             =   1050
            Width           =   1575
         End
      End
      Begin Threed.SSFrame fraAdditional 
         Height          =   945
         Left            =   90
         TabIndex        =   22
         Top             =   1440
         Width           =   3705
         _Version        =   65536
         _ExtentX        =   6535
         _ExtentY        =   1667
         _StockProps     =   14
         Caption         =   "Additional Parameters"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Begin VB.TextBox txtInput 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   285
            Index           =   12
            Left            =   2460
            TabIndex        =   24
            Text            =   "txtInput(12)"
            Top             =   570
            Width           =   1095
         End
         Begin VB.TextBox txtInput 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   285
            Index           =   11
            Left            =   2460
            TabIndex        =   23
            Text            =   "txtInput(11)"
            Top             =   270
            Width           =   1095
         End
         Begin VB.Label lblInput 
            Alignment       =   1  'Right Justify
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            Caption         =   "No. of regression points:"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H80000008&
            Height          =   255
            Index           =   6
            Left            =   120
            TabIndex        =   26
            Top             =   600
            Width           =   2175
         End
         Begin VB.Label lblInput 
            Alignment       =   1  'Right Justify
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            Caption         =   "Order of magnitude:"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H80000008&
            Height          =   255
            Index           =   5
            Left            =   240
            TabIndex        =   25
            Top             =   300
            Width           =   2055
         End
      End
      Begin VB.Label lblText 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "K"
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   5970
         TabIndex        =   12
         Top             =   2145
         Width           =   315
      End
      Begin VB.Label lblValue 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BorderStyle     =   1  'Fixed Single
         Caption         =   "lblValue(5)"
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   6330
         TabIndex        =   11
         Top             =   2130
         Width           =   975
      End
      Begin VB.Label lblValue 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BorderStyle     =   1  'Fixed Single
         Caption         =   "lblValue(4)"
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   5010
         TabIndex        =   10
         Top             =   2130
         Width           =   975
      End
      Begin VB.Label lblText 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "1/n"
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   4560
         TabIndex        =   9
         Top             =   2145
         Width           =   375
      End
      Begin VB.Label Label5 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "(mg/g)*(L/mg)^(1/n)"
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   7350
         TabIndex        =   8
         Top             =   2145
         Width           =   1755
      End
      Begin VB.Label lblEstimationMethod 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Estimation Method:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   90
         TabIndex        =   7
         Top             =   570
         Width           =   1875
      End
   End
   Begin Threed.SSPanel sspanel_StatusBar 
      Align           =   2  'Align Bottom
      Height          =   405
      Left            =   0
      TabIndex        =   55
      Top             =   8415
      Width           =   9465
      _Version        =   65536
      _ExtentX        =   16695
      _ExtentY        =   714
      _StockProps     =   15
      ForeColor       =   -2147483640
      BackColor       =   12632256
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin Threed.SSPanel sspanel_Dirty 
         Height          =   285
         Left            =   60
         TabIndex        =   56
         Top             =   60
         Width           =   2115
         _Version        =   65536
         _ExtentX        =   3731
         _ExtentY        =   503
         _StockProps     =   15
         Caption         =   "sspanel_Dirty"
         ForeColor       =   -2147483640
         BackColor       =   12632256
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelOuter      =   1
      End
      Begin Threed.SSPanel sspanel_Status 
         Height          =   285
         Left            =   2220
         TabIndex        =   57
         Top             =   60
         Width           =   7200
         _Version        =   65536
         _ExtentX        =   12700
         _ExtentY        =   503
         _StockProps     =   15
         Caption         =   "sspanel_Status"
         ForeColor       =   -2147483640
         BackColor       =   12632256
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelOuter      =   1
      End
   End
   Begin Threed.SSFrame fraIsothermDB 
      Height          =   4245
      Left            =   90
      TabIndex        =   27
      Top             =   3240
      Width           =   9255
      _Version        =   65536
      _ExtentX        =   16325
      _ExtentY        =   7488
      _StockProps     =   14
      Caption         =   "{What} Phase Isotherm Database"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin Threed.SSFrame fraTwo 
         Height          =   3825
         Left            =   4410
         TabIndex        =   35
         Top             =   300
         Width           =   4635
         _Version        =   65536
         _ExtentX        =   8176
         _ExtentY        =   6747
         _StockProps     =   14
         Caption         =   "{X} {What}-Phase isotherm(s) for {chemical_name}"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Begin VB.ListBox lstRange 
            Appearance      =   0  'Flat
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   1590
            Index           =   0
            Left            =   210
            TabIndex        =   37
            Top             =   900
            Width           =   1695
         End
         Begin VB.ListBox lstRange 
            Appearance      =   0  'Flat
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   1590
            Index           =   1
            Left            =   2130
            TabIndex        =   36
            Top             =   900
            Width           =   2415
         End
         Begin VB.Label lblText 
            Alignment       =   1  'Right Justify
            Appearance      =   0  'Flat
            BackColor       =   &H80000005&
            BackStyle       =   0  'Transparent
            Caption         =   "K"
            ForeColor       =   &H80000008&
            Height          =   255
            Index           =   0
            Left            =   1470
            TabIndex        =   54
            Top             =   330
            Width           =   315
         End
         Begin VB.Label lblValue 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            BorderStyle     =   1  'Fixed Single
            Caption         =   "lblValue(0)"
            ForeColor       =   &H80000008&
            Height          =   255
            Index           =   0
            Left            =   1830
            TabIndex        =   53
            Top             =   315
            Width           =   975
         End
         Begin VB.Label lblValue 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            BorderStyle     =   1  'Fixed Single
            Caption         =   "lblValue(1)"
            ForeColor       =   &H80000008&
            Height          =   255
            Index           =   1
            Left            =   510
            TabIndex        =   52
            Top             =   315
            Width           =   975
         End
         Begin VB.Label lblText 
            Alignment       =   1  'Right Justify
            Appearance      =   0  'Flat
            BackColor       =   &H80000005&
            BackStyle       =   0  'Transparent
            Caption         =   "1/n"
            ForeColor       =   &H80000008&
            Height          =   255
            Index           =   1
            Left            =   60
            TabIndex        =   51
            Top             =   330
            Width           =   375
         End
         Begin VB.Label Label1 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            Caption         =   "Conc. Range (mg/L):"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H80000008&
            Height          =   255
            Left            =   2130
            TabIndex        =   50
            Top             =   690
            Width           =   2415
         End
         Begin VB.Label Label2 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            Caption         =   "pH Range:"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H80000008&
            Height          =   255
            Left            =   210
            TabIndex        =   49
            Top             =   690
            Width           =   1695
         End
         Begin VB.Label Label3 
            Alignment       =   1  'Right Justify
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            Caption         =   "Adsorbent Type:"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H80000008&
            Height          =   225
            Left            =   180
            TabIndex        =   48
            Top             =   2715
            Width           =   1515
         End
         Begin VB.Label lblValue 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            BorderStyle     =   1  'Fixed Single
            Caption         =   "lblValue(2)"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H80000008&
            Height          =   255
            Index           =   2
            Left            =   1770
            TabIndex        =   47
            Top             =   2700
            Width           =   2775
         End
         Begin VB.Label Label4 
            Alignment       =   1  'Right Justify
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            Caption         =   "Source:"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H80000008&
            Height          =   255
            Left            =   90
            TabIndex        =   46
            Top             =   3255
            Width           =   795
         End
         Begin VB.Label lblValue 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            BorderStyle     =   1  'Fixed Single
            Caption         =   "lblValue(3)"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H80000008&
            Height          =   255
            Index           =   3
            Left            =   930
            TabIndex        =   45
            Top             =   3240
            Width           =   3615
         End
         Begin VB.Label Label5 
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            Caption         =   "(mg/g)*(L/mg)^(1/n)"
            ForeColor       =   &H80000008&
            Height          =   255
            Index           =   0
            Left            =   2850
            TabIndex        =   44
            Top             =   330
            Width           =   1755
         End
         Begin VB.Label lblPhase 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            BorderStyle     =   1  'Fixed Single
            Caption         =   "lblPhase"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H80000008&
            Height          =   255
            Left            =   3510
            TabIndex        =   43
            Top             =   2940
            Width           =   1035
         End
         Begin VB.Label Label7 
            Alignment       =   1  'Right Justify
            Appearance      =   0  'Flat
            BackColor       =   &H80000005&
            BackStyle       =   0  'Transparent
            Caption         =   "Temperature (C):"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H80000008&
            Height          =   195
            Left            =   180
            TabIndex        =   42
            Top             =   2955
            Width           =   1515
         End
         Begin VB.Label lblTemperature 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            BorderStyle     =   1  'Fixed Single
            Caption         =   "lblTemperature"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H80000008&
            Height          =   255
            Left            =   1770
            TabIndex        =   41
            Top             =   2940
            Width           =   975
         End
         Begin VB.Label Label8 
            Alignment       =   1  'Right Justify
            Appearance      =   0  'Flat
            BackColor       =   &H80000005&
            BackStyle       =   0  'Transparent
            Caption         =   "Phase:"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H80000008&
            Height          =   195
            Left            =   2790
            TabIndex        =   40
            Top             =   2955
            Width           =   675
         End
         Begin VB.Label lblComments 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            BorderStyle     =   1  'Fixed Single
            Caption         =   "lblComments"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H80000008&
            Height          =   255
            Left            =   930
            TabIndex        =   39
            Top             =   3480
            Width           =   3615
         End
         Begin VB.Label Label9 
            Alignment       =   1  'Right Justify
            Appearance      =   0  'Flat
            BackColor       =   &H80000005&
            BackStyle       =   0  'Transparent
            Caption         =   "Comment:"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H80000008&
            Height          =   195
            Left            =   -150
            TabIndex        =   38
            Top             =   3495
            Width           =   1035
         End
         Begin VB.Line Line2 
            X1              =   30
            X2              =   4590
            Y1              =   630
            Y2              =   630
         End
      End
      Begin Threed.SSFrame fraOne 
         Height          =   3825
         Left            =   90
         TabIndex        =   28
         Top             =   300
         Width           =   4335
         _Version        =   65536
         _ExtentX        =   7646
         _ExtentY        =   6747
         _StockProps     =   14
         Caption         =   "Select a component:"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Begin VB.ListBox lstCompo 
            Appearance      =   0  'Flat
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   2370
            Left            =   120
            TabIndex        =   33
            Top             =   360
            Width           =   4095
         End
         Begin VB.ComboBox cboSortMethod 
            Appearance      =   0  'Flat
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   315
            Left            =   2880
            Style           =   2  'Dropdown List
            TabIndex        =   29
            Top             =   3420
            Width           =   1335
         End
         Begin Threed.SSCommand cmdSelect 
            Height          =   315
            Left            =   120
            TabIndex        =   30
            Top             =   3090
            Width           =   4095
            _Version        =   65536
            _ExtentX        =   2646
            _ExtentY        =   1323
            _StockProps     =   78
            Caption         =   "Select Chemic&al"
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
         End
         Begin Threed.SSCommand cmdFind 
            Height          =   315
            Index           =   1
            Left            =   2160
            TabIndex        =   31
            Top             =   2760
            Width           =   2055
            _Version        =   65536
            _ExtentX        =   2646
            _ExtentY        =   1323
            _StockProps     =   78
            Caption         =   "Find A&gain"
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
         End
         Begin Threed.SSCommand cmdFind 
            Height          =   315
            Index           =   0
            Left            =   120
            TabIndex        =   32
            Top             =   2760
            Width           =   2055
            _Version        =   65536
            _ExtentX        =   2646
            _ExtentY        =   1323
            _StockProps     =   78
            Caption         =   "&Find"
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
         End
         Begin VB.Label lblEmpty_lstCompo 
            Alignment       =   2  'Center
            Caption         =   "No Components Available"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   525
            Left            =   120
            TabIndex        =   69
            Top             =   210
            Visible         =   0   'False
            Width           =   4095
         End
         Begin VB.Label lblInput 
            Alignment       =   1  'Right Justify
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            Caption         =   "Sorting Method:"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H80000008&
            Height          =   255
            Index           =   8
            Left            =   1140
            TabIndex        =   34
            Top             =   3480
            Width           =   1695
         End
      End
   End
End
Attribute VB_Name = "frmFreundlich"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit


'Dim FORM_MODE As Integer
'Const FORM_MODE_ADDNEW = 1
'Const FORM_MODE_EDIT = 2
Dim USER_HIT_CANCEL As Boolean
Dim USER_HIT_OK As Boolean
Dim frmFreundlich_Is_Dirty As Boolean
Dim ActivatedYet As Boolean

Dim HALT_OPTFREUNDLICHSOURCE As Boolean
Dim HALT_LSTCOMPO As Boolean
Dim HALT_LSTRANGE As Boolean
Dim HALT_CBOMETHOD As Boolean
Const CBOSORTMETHOD_NAME = 1
Const CBOSORTMETHOD_CAS = 2

Dim SaveOldComponent As ComponentPropertyType
  
Dim DB_Isotherm As Database
Dim Find_String As String




Const frmFreundlich_declarations_end = True


Sub frmFreundlich_Run( _
    OUTPUT_Raise_Dirty_Flag As Boolean)
  On Error GoTo err_frmFreundlich_Run
  'NOTE: THE FOLLOWING OpenDatabase() COMMAND MUST BE
  'SPECIFIED EXACTLY AS-IS, OR ELSE IT WILL FAIL.
  Set DB_Isotherm = _
      ws1.OpenDatabase(fn_DB_Isotherm, True, False, _
      ";pwd=" & decrypt_string(Encrypted_User_Password))
  'Set DB_Isotherm = ws1.OpenDatabase(fn_DB_Isotherm)
  frmFreundlich.Show 1
  If (USER_HIT_OK) Then
    OUTPUT_Raise_Dirty_Flag = True
  Else
    OUTPUT_Raise_Dirty_Flag = False
  End If
  DB_Isotherm.Close
  Exit Sub
exit_err_frmFreundlich_Run:
  Exit Sub
err_frmFreundlich_Run:
  Call Show_Trapped_Error("frmFreundlich_Run")
  OUTPUT_Raise_Dirty_Flag = False
  Resume exit_err_frmFreundlich_Run
End Sub


Sub frmFreundlich_GenericStatus_Set(fn_Text As String)
  Me.sspanel_Status = fn_Text
End Sub
Sub frmFreundlich_DirtyStatus_Set(newVal As Boolean)
  If (newVal) Then
    Me.sspanel_Dirty = "Data Changed"
    Me.sspanel_Dirty.ForeColor = QBColor(12)
  Else
    Me.sspanel_Dirty = "Unchanged"
    Me.sspanel_Dirty.ForeColor = QBColor(0)
  End If
End Sub
Sub frmFreundlich_DirtyStatus_Set_Current()
  Call frmFreundlich_DirtyStatus_Set(frmFreundlich_Is_Dirty)
End Sub
Sub frmFreundlich_DirtyStatus_Throw()
  frmFreundlich_Is_Dirty = True
  Call frmFreundlich_DirtyStatus_Set_Current
End Sub
Sub frmFreundlich_DirtyStatus_Clear()
  frmFreundlich_Is_Dirty = False
  Call frmFreundlich_DirtyStatus_Set_Current
End Sub


Sub populate_lstCompo()
Dim RS1 As Recordset
Dim Current_Criteria As String
Dim SAVE_CURRENT_POSITION As Long
Dim NEW_LISTINDEX As Integer
Dim This_ID As Long
Dim NumRecords As Long
Dim TempStr As String * 15
Dim Output_Line As String
Dim PhaseCode As String
Dim SortCode As String
Dim ThisChemicalName As String
Dim ThisChemicalCAS As String
Dim LastChemicalName As String
Dim LastChemicalCAS As String
  HALT_LSTCOMPO = True
  On Error GoTo err_populate_lstCompo
  'SAVE CURRENT POSITION.
  If (lstCompo.ListCount > 0) And (lstCompo.ListIndex >= 0) Then
    SAVE_CURRENT_POSITION = lstCompo.ItemData(lstCompo.ListIndex)
  Else
    SAVE_CURRENT_POSITION = -1
  End If
  'SET UP SEARCH CRITERIA.
  Select Case Bed.Phase
    Case 0: PhaseCode = "Liquid"
    Case 1: PhaseCode = "Gas"
  End Select
  Select Case cboSortMethod.ItemData(cboSortMethod.ListIndex)
    Case CBOSORTMETHOD_NAME: SortCode = "Name, [Component Number]"
    Case CBOSORTMETHOD_CAS: SortCode = "[Component Number], Name"
  End Select
  'Current_Criteria = "select * from [Chemicals] " & _
  '    "order by [Name]"
  Current_Criteria = "select * from Isotherms" & _
      " where Phase = '" & PhaseCode & "'" & _
      " order by " & SortCode
  'START SEARCH.
  Set RS1 = _
      DB_Isotherm.OpenRecordset(Current_Criteria)
  On Error Resume Next
  RS1.MoveFirst
  RS1.MoveLast
  RS1.MoveFirst
  NumRecords = RS1.RecordCount
  On Error GoTo err_populate_lstCompo
  'POPULATE LISTBOX.
  lstCompo.Clear
  If (NumRecords = 0) Then
    'NO RECORDS AVAILABLE.
    lstCompo.Visible = False
    lblEmpty_lstCompo.Move lstCompo.Left, lstCompo.Top
    lblEmpty_lstCompo.Visible = True
  Else
    'DISPLAY RECORDS.
    lstCompo.Visible = True
    lblEmpty_lstCompo.Visible = False
    NEW_LISTINDEX = -1
    LastChemicalName = "n/a yet"
    LastChemicalCAS = "n/a yet"
    Do Until RS1.EOF
      ThisChemicalName = Database_Get_String(RS1, "Name")
      ThisChemicalCAS = Database_Get_String(RS1, "Component Number")
      If ((ThisChemicalName <> LastChemicalName) Or _
          (ThisChemicalCAS <> LastChemicalCAS)) Then
        'THIS "IF" STATEMENT EXISTS IN ORDER TO ELIMINATE DUPLICATE
        'CHEMICALS FROM THE LIST.  THIS CODE DEPENDS COMPLETELY
        'ON THE FACT THAT THE LIST IS SORTED !
        LastChemicalCAS = ThisChemicalCAS
        LastChemicalName = ThisChemicalName
        TempStr = ThisChemicalCAS
                'THIS STRING IS ENSURED TO BE 15 CHARACTERS LONG.
        Output_Line = _
            TempStr & _
            " " & _
            ThisChemicalName
        lstCompo.AddItem Output_Line
        This_ID = Database_Get_Long(RS1, "ID")
        lstCompo.ItemData(lstCompo.NewIndex) = This_ID
        If (SAVE_CURRENT_POSITION <> -1) Then
          If (SAVE_CURRENT_POSITION = This_ID) Then
            NEW_LISTINDEX = lstCompo.NewIndex
          End If
        End If
      End If
      RS1.MoveNext
    Loop
    If (lstCompo.ListCount > 0) And (NEW_LISTINDEX > -1) Then
      HALT_LSTCOMPO = True
      lstCompo.ListIndex = NEW_LISTINDEX
      HALT_LSTCOMPO = False
    End If
  End If
  'CLOSE DATABASE AND EXIT.
  RS1.Close
  HALT_LSTCOMPO = False
  Exit Sub
exit_err_populate_lstCompo:
  HALT_LSTCOMPO = False
  Exit Sub
err_populate_lstCompo:
  Call Show_Trapped_Error("populate_lstCompo")
  Resume exit_err_populate_lstCompo
End Sub
Sub populate_lstRange(ThisCAS As String, ThisChemical As String)
Dim PHASE_CODE As Integer
Dim RS1 As Recordset
Dim Current_Criteria As String
Dim SAVE_CURRENT_POSITION As Long
Dim This_ID As Long
Dim NEW_LISTINDEX As Long
Dim NumRecords As Long
Dim PhaseCode As String
Dim ThisCMin As Double
Dim ThisCMax As Double
Dim ThisPHMin As Double
Dim ThisPHMax As Double
Dim ThisDbl As Double
Dim ThisOutput As String
  On Error GoTo err_populate_lstRange
  'GET PHASE CODE.
  Select Case Bed.Phase
    Case 0: PhaseCode = "Liquid"
    Case 1: PhaseCode = "Gas"
  End Select
  'SAVE CURRENT POSITION.
  If (lstRange(0).ListCount > 0) And (lstRange(0).ListIndex >= 0) Then
    SAVE_CURRENT_POSITION = lstRange(0).ItemData(lstRange(0).ListIndex)
  Else
    SAVE_CURRENT_POSITION = -1
  End If
  'SET UP SEARCH CRITERIA.
  If (Trim$(ThisCAS) = "0") Then ThisCAS = ""
  If (Trim$(ThisCAS) <> "") Then
    Current_Criteria = "select * from Isotherms" & _
        " where Phase = '" & PhaseCode & "'" & _
        " and [Component Number] = " & Trim$(ThisCAS) & _
        " order by CarbonName"
  Else
    Current_Criteria = "select * from Isotherms" & _
        " where Phase = '" & PhaseCode & "'" & _
        " and Name = '" & Trim$(ThisChemical) & "'" & _
        " order by CarbonName"
  End If
  'START SEARCH.
  Set RS1 = _
      DB_Isotherm.OpenRecordset(Current_Criteria)
  On Error Resume Next
  RS1.MoveFirst
  RS1.MoveLast
  RS1.MoveFirst
  NumRecords = RS1.RecordCount
  On Error GoTo err_populate_lstRange
  'POPULATE LISTBOX.
  lstRange(0).Clear
  lstRange(1).Clear
  If (NumRecords = 0) Then
    'NO RECORDS AVAILABLE.
    fraTwo.Caption = "No Isotherms Available."
  Else
    'DISPLAY RECORDS.
    fraTwo.Caption = Trim$(Str$(NumRecords)) & " " & _
        PhaseCode & " Phase Isotherm" & _
        IIf(NumRecords = 1, "", "s") & _
        " Available"
    NEW_LISTINDEX = -1
    Do Until RS1.EOF
      This_ID = Database_Get_Long(RS1, "ID")
      ThisCMin = Database_Get_Double(RS1, "C min")
      ThisCMax = Database_Get_Double(RS1, "C max")
      ThisPHMin = Database_Get_Double(RS1, "pH min")
      ThisPHMax = Database_Get_Double(RS1, "pH max")
      If (ThisPHMin = 0#) And (ThisPHMax = 0#) Then
        ThisOutput = "No pH Range"
      Else
        If (ThisPHMin = 0#) Or (ThisPHMax = 0#) Then
          If (ThisPHMin <> 0#) Then ThisDbl = ThisPHMin
          If (ThisPHMax <> 0#) Then ThisDbl = ThisPHMax
          ThisOutput = Format$(ThisDbl, "0.000")
        Else
          ThisOutput = Format$(ThisPHMin, "0.000") & " - " & _
              Format$(ThisPHMax, "0.000")
        End If
      End If
      lstRange(0).AddItem ThisOutput
      lstRange(0).ItemData(lstRange(0).NewIndex) = This_ID
      If (ThisCMin = 0#) And (ThisCMax = 0#) Then
        ThisOutput = "No Conc. Range"
      Else
        If (ThisCMin = 0#) Or (ThisCMax = 0#) Then
          If (ThisCMin <> 0#) Then ThisDbl = ThisCMin
          If (ThisCMax <> 0#) Then ThisDbl = ThisCMax
          ThisOutput = Format$(ThisDbl, "0.000")
        Else
          ThisOutput = Format$(ThisCMin, "0.000") & " - " & _
              Format$(ThisCMax, "0.000")
        End If
      End If
      lstRange(1).AddItem ThisOutput
      lstRange(1).ItemData(lstRange(1).NewIndex) = This_ID
      If (SAVE_CURRENT_POSITION <> -1) Then
        If (SAVE_CURRENT_POSITION = This_ID) Then
          NEW_LISTINDEX = lstRange(0).NewIndex
        End If
      End If
      RS1.MoveNext
    Loop
    If (lstRange(0).ListCount > 0) And (NEW_LISTINDEX > -1) Then
      lstRange(0).ListIndex = NEW_LISTINDEX
      lstRange(1).ListIndex = NEW_LISTINDEX
    End If
  End If
  'CLOSE DATABASE AND EXIT.
  RS1.Close
  Exit Sub
exit_err_populate_lstRange:
  Exit Sub
err_populate_lstRange:
  Call Show_Trapped_Error("populate_lstRange")
  Resume exit_err_populate_lstRange
End Sub
Sub populate_lblValue(This_ID As Long)
Dim RS1 As Recordset
Dim Current_Criteria As String
Dim NumRecords As Long
  On Error GoTo err_populate_lblValue
  'SET UP SEARCH CRITERIA.
  Current_Criteria = "select * from Isotherms" & _
      " where ID = " & Trim$(Str$(This_ID)) & _
      " order by CarbonName"
  'START SEARCH.
  Set RS1 = _
      DB_Isotherm.OpenRecordset(Current_Criteria)
  On Error Resume Next
  RS1.MoveFirst
  RS1.MoveLast
  RS1.MoveFirst
  NumRecords = RS1.RecordCount
  On Error GoTo err_populate_lblValue
  'POPULATE LISTBOX.
  If (NumRecords = 0) Then
    'COULD NOT FIND THAT ISOTHERM (WEIRD PROBLEM).
  Else
    'DISPLAY RECORD.
    Call AssignCaptionAndTag(lblValue(2), Database_Get_String(RS1, "CarbonName"))
    Call AssignCaptionAndTag(lblTemperature, Database_Get_Double(RS1, "Tmin"))
    Call AssignCaptionAndTag(lblPhase, Database_Get_String(RS1, "Phase"))
    Call AssignCaptionAndTag(lblValue(3), Database_Get_String(RS1, "Source"))
    Call AssignCaptionAndTag(lblComments, Database_Get_String(RS1, "Comments"))
    Component(0).IsothermDB_OneOverN = Database_Get_Double(RS1, "1/n")
    Component(0).IsothermDB_K = Database_Get_Double(RS1, "K")
  End If
  'CLOSE DATABASE AND EXIT.
  RS1.Close
  Exit Sub
exit_err_populate_lblValue:
  Exit Sub
err_populate_lblValue:
  Call Show_Trapped_Error("populate_lblValue")
  Resume exit_err_populate_lblValue
End Sub


Sub Clear_lblValue()
  lblValue(0) = ""      'ISODB : K.
  lblValue(1) = ""      'ISODB : 1/N.
  lblValue(2) = ""      'ISODB : ADSORBENT TYPE.
  lblTemperature = ""   'ISODB : TEMP.
  lblPhase = ""         'ISODB : PHASE.
  lblValue(3) = ""      'ISODB : SOURCE.
  lblComments = ""      'ISODB : COMMENTS.
End Sub


'Returns:
'- TRUE = Succeeded
'- FALSE = Failed
Function Search_String( _
    J As Integer, _
    ShowErrorMessages As Integer) As Boolean
Dim i As Integer
Dim Res As Integer
  'If (fraIsothermDB.Visible) Then
  '  lstCompo.SetFocus
  'End If
  'For I = J + 1 To lstCompo.ListCount
  For i = J + 1 To lstCompo.ListCount - 1
    Res = InStr(1, lstCompo.List(i), Find_String, 1)
    If (Res > 0) Then
      'NOTE: BY HALTING lstCompo_Click(), THIS ALLOWS THE
      'COMPONENT TO BE SELECTED WITHOUT CLEARING THE ISOTHERM DB
      'VALUES OF K AND 1/N.
      'lstCompo.ListIndex = I
      HALT_LSTCOMPO = True
      Call Do_Select_Component(i)
      HALT_LSTCOMPO = False
      'If (fraIsothermDB.Visible) Then lstCompo.SetFocus
      Search_String = True
      Exit Function
    End If
  Next i
  For i = 0 To J
    Res = InStr(1, lstCompo.List(i), Find_String, 1)
    If (Res > 0) Then
      'NOTE: BY HALTING lstCompo_Click(), THIS ALLOWS THE
      'COMPONENT TO BE SELECTED WITHOUT CLEARING THE ISOTHERM DB
      'VALUES OF K AND 1/N.
      'lstCompo.ListIndex = I
      HALT_LSTCOMPO = True
      Call Do_Select_Component(i)
      HALT_LSTCOMPO = False
      'If (fraIsothermDB.Visible) Then lstCompo.SetFocus
      Search_String = True
      Exit Function
    End If
  Next i
  '----- If not found, show error message: -----
  If (ShowErrorMessages) Then
    Call Show_Error("String Not Found: " & Chr$(34) & _
        Trim$(Find_String) & Chr$(34))
  End If
  Search_String = False
End Function
'Returns:
'- TRUE = Succeeded
'- FALSE = Failed
Function Do_Search_For_Text(ShowErrorMessages As Integer) As Integer
Dim LIST_INDEX As Integer
  LIST_INDEX = lstCompo.ListIndex
  Do_Search_For_Text = Search_String(LIST_INDEX, ShowErrorMessages)
End Function


Sub Populate_cboSortMethod()
  cboSortMethod.Clear
  cboSortMethod.AddItem "By Name"
  cboSortMethod.ItemData(cboSortMethod.NewIndex) = CBOSORTMETHOD_NAME
  cboSortMethod.AddItem "By CAS"
  cboSortMethod.ItemData(cboSortMethod.NewIndex) = CBOSORTMETHOD_CAS
  cboSortMethod.ListIndex = 0
End Sub
Sub Populate_cboMethod()
Dim NewTag As Integer
Dim i As Integer
  HALT_CBOMETHOD = True
'xaxaxa (12/10/97)
  Select Case Bed.Phase
    Case 0
      ' ***** Phase = Water *****
      'lblInput(3).Visible = False
      'txtInput(3).Visible = False
      cboMethod.Clear
      cboMethod.AddItem "3 - Parameter Polanyi Isotherm Correlation"
      cboMethod.ItemData(cboMethod.NewIndex) = IPESMETHOD_LIQ_3PARAM
      cboMethod.AddItem "D-R Uniform Adsorbate"
      cboMethod.ItemData(cboMethod.NewIndex) = IPESMETHOD_LIQ_DRUNIFORM
      'cboMethod.AddItem "D-R Non-Uniform Adsorbate"
    Case 1
      ' ***** Phase = Air *****
      'lblInput(3).Visible = True
      'txtInput(3).Visible = True
      cboMethod.Clear
      cboMethod.AddItem "D-R based on Spreading Pressure Eval."
      cboMethod.ItemData(cboMethod.NewIndex) = IPESMETHOD_GAS_DRSPREADINGP
      'EJO 12/16/97 -- This correlation killed off today.
      'cboMethod.AddItem "D-R Isotherm Correlation for RH < 50%"
      'If (check_internal_to_mtu()) Then
      '  cboMethod.AddItem "D-R based on Spreading Pressure Eval. (MTU only)"
      'End If
      'cboMethod.AddItem "Calgon BPL"
      'cboMethod.AddItem "D-R based on Spreading Pressure Evaluation"
      'EJO 8/5/97 -- These two correlations were killed off!
  End Select
  'PERFORM LOOKUP FOR CURRENT METHOD.
  '[NEW AS OF 8/28/98.]
  NewTag = 0
  For i = 0 To cboMethod.ListCount - 1
    If (Component(0).IPES_EstimationMethod = _
        cboMethod.ItemData(i)) Then
      NewTag = i
      Exit For
    End If
  Next i
  cboMethod.ListIndex = NewTag
  HALT_CBOMETHOD = False
End Sub
Sub frmFreundlich_PopulateUnits()
  Call unitsys_register(frmFreundlich, lblInput(5), _
      txtInput(11), Nothing, "", _
      "", "", "", "", 100#, False)
  Call unitsys_register(frmFreundlich, lblInput(6), _
      txtInput(12), Nothing, "", _
      "", "", "", "", 100#, False)
  Call unitsys_register(frmFreundlich, lblText(5), _
      UserOneOverN, Nothing, "", _
      "", "", "", "", 100#, False)
  Call unitsys_register(frmFreundlich, lblText(4), _
      UserK, Nothing, "", _
      "", "", "", "", 100#, False)
End Sub


Private Sub cboMethod_Click()
Dim OldValue As Integer
Dim NewValue As Integer
  If (HALT_CBOMETHOD) Then Exit Sub
  OldValue = Component(0).IPES_EstimationMethod
  NewValue = cboMethod.ItemData(cboMethod.ListIndex)
  If (OldValue <> NewValue) Then
    Component(0).IPES_EstimationMethod = NewValue
    'THROW DIRTY FLAG.
    Call frmFreundlich_DirtyStatus_Throw
  End If
End Sub


Private Sub cboSortMethod_Click()
  Call populate_lstCompo
End Sub


Private Sub cmdCalculate_Click()
Dim WhichModule As Integer
Dim INPUT_NL As Integer
Dim INPUT_OMAG As Double
Dim Raise_Dirty_Flag As Boolean
  'CHECK FOR ZERO VALUES OF POLANYI PARAMETERS.
  If (Carbon.W0 = 0#) Or (Carbon.BB = 0#) Or (Carbon.PolanyiExponent = 0#) Then
    Call Show_Error("The Polanyi parameters have not been properly " & _
        "specified.  To properly specify the Polanyi parameters, you must " & _
        "enter a non-zero value for each of the following parameters: " & _
        "W0, BB, and GM (Polanyi Exponent).  " & _
        "Click on the button marked Edit Parameters to " & _
        "make these changes.")
    Exit Sub
  End If
  Select Case cboMethod.ItemData(cboMethod.ListIndex)
    Case IPESMETHOD_LIQ_3PARAM:
      WhichModule = 1
    Case IPESMETHOD_GAS_DRSPREADINGP:
      WhichModule = 4
    Case IPESMETHOD_LIQ_DRUNIFORM:
      WhichModule = 5
    Case Else:
      Call Show_Error("IPE calculation code #" & _
          Trim$(Str$(cboMethod.ItemData(cboMethod.ListIndex))) & _
          " is invalid.  Select another method.")
      Exit Sub
  End Select
  INPUT_NL = CInt(Component(0).IPES_NumRegressionPts)
  INPUT_OMAG = CDbl(Component(0).IPES_OrderOfMagnitude)
  Call ModelIPE_Go(WhichModule, _
      INPUT_NL, INPUT_OMAG, Raise_Dirty_Flag)
  If (Raise_Dirty_Flag) Then
    'THROW DIRTY FLAG.
    Call frmFreundlich_DirtyStatus_Throw
  End If
  'REFRESH WINDOW.
  Call frmFreundlich_Refresh
End Sub


Private Sub cmdCancelOK_Click(index As Integer)
Dim WhichSelected As Integer
  Select Case index
    Case 0:     'CANCEL.
      'ROLLBACK TO ORIGINAL COMPONENT DATA.
      Component(0) = SaveOldComponent
      'EXIT OUT OF HERE.
      USER_HIT_CANCEL = True
      USER_HIT_OK = False
      Unload Me
      Exit Sub
    Case 1:     'OK.
      'VERIFY THAT NEW K AND 1/N SOURCE IS VALID.
      If (optFreundlichSource(0)) Then WhichSelected = 0
      If (optFreundlichSource(1)) Then WhichSelected = 1
      If (optFreundlichSource(2)) Then WhichSelected = 2
      Select Case WhichSelected
        Case 0:
          If (Left$(optFreundlichSource(0).Caption, 1) = "(") Then
            'FORCE SOURCE TO USER-INPUT.
            Call Show_Error("Unable to validate isotherm " & _
              "database as source of K and 1/n: reverting " & _
              "to user-input as source of K and 1/n.")
            Component(0).Source_KandOneOverN = KNSOURCE_USERINPUT
          End If
        Case 1:
          If (Left$(optFreundlichSource(1).Caption, 1) = "(") Then
            'FORCE SOURCE TO USER-INPUT.
            Call Show_Error("Unable to validate IPES as " & _
              "source of K and 1/n: reverting to user-input " & _
              "as source of K and 1/n.")
            Component(0).Source_KandOneOverN = KNSOURCE_USERINPUT
          End If
        Case 2:
          'DO NOTHING!
      End Select
      'TRANSFER K AND 1/N DATA TO "USED" VARIABLES IN COMPONENT STRUCTURE.
      Select Case Component(0).Source_KandOneOverN
        Case KNSOURCE_ISOTHERMDB
          'ISOTHERM DATABASE.
          Component(0).Use_OneOverN = Component(0).IsothermDB_OneOverN
          Component(0).Use_K = Component(0).IsothermDB_K
        Case KNSOURCE_IPES
          'IPE CALCULATION.
          Component(0).Use_OneOverN = Component(0).IPESResult_OneOverN
          Component(0).Use_K = Component(0).IPESResult_K
        Case KNSOURCE_USERINPUT
          'USER INPUT.
          Component(0).Use_OneOverN = Component(0).UserEntered_OneOverN
          Component(0).Use_K = Component(0).UserEntered_K
      End Select
      'EXIT OUT OF HERE.
      USER_HIT_CANCEL = False
      USER_HIT_OK = True
      Unload Me
      Exit Sub
  End Select
End Sub


Private Sub cmdEditPolanyi_Click()
Dim Raise_Dirty_Flag As Boolean
  Call frmPolanyi.frmPolanyi_Edit(Me, Raise_Dirty_Flag)
  If (Raise_Dirty_Flag) Then
    'DO NOT THROW FREUNDLICH DIRTY FLAG; THROW MAIN DIRTY FLAG.
    'REASON: THE POLANYI PARAMETERS ARE _NOT_ SPECIFIC
    'TO THIS COMPONENT; THEY ARE SPECIFIC TO THE CARBON.
    '---------------------------------
    ''THROW DIRTY FLAG.
    'Call frmFreundlich_DirtyStatus_Throw
    'THROW (MAIN) DIRTY FLAG.
    Call DirtyStatus_Throw
  End If
End Sub


Private Sub cmdFind_Click(index As Integer)
Dim NewName As String
Dim USER_HIT_CANCEL As Boolean
  Select Case index
    Case 0:     'FIND.
      NewName = Find_String
      Do While (1 = 1)
        NewName = frmNewName.frmNewName_GetName( _
            "Search for String", _
            "Enter the string to find:", _
            NewName, _
            USER_HIT_CANCEL)
        If (USER_HIT_CANCEL) Then Exit Sub
        NewName = Trim$(NewName)
        If (NewName <> "") Then Exit Do
        Call Show_Error("You may only enter a non-blank search string.")
      Loop
      Find_String = NewName
      Call Do_Search_For_Text(True)
    Case 1:     'FIND AGAIN.
      Call Do_Search_For_Text(True)
  End Select
End Sub


Private Sub cmdSelect_Click()
  Call lstCompo_Click
End Sub


Private Sub Form_Activate()
Dim No_IsothermDBData As Boolean
  If (Not ActivatedYet) Then
    ActivatedYet = True
    'RE-POPULATE COMPONENT LIST FROM ISOTHERM DATABASE.
    Call populate_lstCompo
    'SETUP SOURCE OF K AND 1/N.
    ''''Debug.Print "xxxx1 " & Now
    HALT_OPTFREUNDLICHSOURCE = True
    Select Case Component(0).Source_KandOneOverN
      Case KNSOURCE_ISOTHERMDB: optFreundlichSource(0).Value = True
      Case KNSOURCE_IPES: optFreundlichSource(1).Value = True
      Case KNSOURCE_USERINPUT: optFreundlichSource(2).Value = True
    End Select
    HALT_OPTFREUNDLICHSOURCE = False
    '
    'OUTLINE OF SEARCHES:
    '====================
    '1.) If user has already selected an isotherm from the DB,
    '    select that one on-screen, along with their selected
    '    pH/conc. range.
    '2.) Otherwise, if they have a CAS# for this component,
    '    search for the CAS#.  If found, select it on-screen.
    '3.) If the above two criteria fail, search for an exact
    '    match on the component name.  If found, select
    '    it on-screen.
    '
    'SEARCH #1:
    '==========
    No_IsothermDBData = True
    If (Trim$(Component(0).IsothermDB_Component_Name) <> "") Then
      '----- Find the selected component: -----
      Find_String = Trim$(Component(0).IsothermDB_Component_Name)
      If (Do_Search_For_Text(False) = True) Then
        'SEARCH SUCEEDED; SELECT THIS ISOTHERM.
        'NOTE: BY HALTING lstCompo_Click(), THE COMPOUND CAN
        'BE SELECTED WITHOUT CLEARING THE ISOTHERM DB VALUES
        'OF K AND 1/N.
        'Call cmdSelect_Click
        HALT_LSTCOMPO = True
        Call Do_Select_Component(lstCompo.ListIndex)
        HALT_LSTCOMPO = False
        If (Component(0).IsothermDB_K <> -1#) And _
            (Component(0).IsothermDB_OneOverN <> -1#) Then
          '----- Find the selected pH/conc. range:
          If (Component(0).IsothermDB_Range_Num <> -1) Then
            'JUST BEING PARANOID ABOUT DATABASE CHANGES.
            If (Component(0).IsothermDB_Range_Num <= lstRange(0).ListCount - 1) Then
              HALT_LSTRANGE = True
              lstRange(0).ListIndex = Component(0).IsothermDB_Range_Num
              lstRange(1).ListIndex = Component(0).IsothermDB_Range_Num
              HALT_LSTRANGE = False
              'Call lstRange_Click(0)
              Call populate_lblValue(lstRange(0).ItemData(lstRange(0).ListIndex))
              No_IsothermDBData = False
            Else
              HALT_LSTRANGE = True
              lstRange(0).ListIndex = 0
              lstRange(1).ListIndex = 0
              HALT_LSTRANGE = False
              'Call lstRange_Click(0)
              Call populate_lblValue(lstRange(0).ItemData(lstRange(0).ListIndex))
              No_IsothermDBData = False
            End If
          End If
        End If
      End If
    End If
    '
    'SEARCH #2:
    '==========
    If (No_IsothermDBData) Then
      If (Component(0).CAS <> 0) Then
        Find_String = Trim$(Str$(Component(0).CAS)) & "   "
        If (Do_Search_For_Text(False) = True) Then
          'SEARCH SUCEEDED; SELECT THIS ISOTHERM.
          Call cmdSelect_Click
          No_IsothermDBData = False
        End If
      End If
    End If
    '
    'SEARCH #3:
    '==========
    If (No_IsothermDBData) Then
      Find_String = "   " & Trim$(Component(0).Name)
      If (Do_Search_For_Text(False) = True) Then
        'SEARCH SUCEEDED; SELECT THIS ISOTHERM.
        Call cmdSelect_Click
        No_IsothermDBData = False
      End If
    End If
    ''
    ''NONE OF THE ABOVE SUCCEEDED; K AND 1/N UNSPECIFIED SO FAR.
    ''
    'If (No_IsothermDBData) Then
    '  Component(0).IsothermDB_K = -1#
    '  Component(0).IsothermDB_OneOverN = -1#
    'End If
    '
    'SOME OF THE SELECTIONS ABOVE MAY HAVE SET THE DIRTY FLAG.
    'THIS CODE CLEARS IT.
    '
    Call frmFreundlich_DirtyStatus_Clear
    'REFRESH DISPLAY.
    Call frmFreundlich_Refresh
    optFreundlichSource(0).Enabled = True
    optFreundlichSource(1).Enabled = True
    optFreundlichSource(2).Enabled = True
    '
    'CLEAR HOURGLASS MOUSE POINTER.
    '
    Screen.MousePointer = 0
  End If
End Sub
Private Sub Form_Load()
  'SAVE OLD COMPONENT FOR CANCEL ROLLBACK.
  SaveOldComponent = Component(0)
  'MISC INITS.
  ActivatedYet = False
  Me.Height = 7200
  Me.Width = 9585
  Call CenterOnForm(Me, frmMain)
  Find_String = ""
  lblWarning.Caption = ""
  Call Populate_cboMethod
  Call Populate_cboSortMethod
  Me.Caption = "Freundlich Isotherm Parameters for " & Trim$(Component(0).Name)
  If (Bed.Phase = 0) Then
    fraIsothermDB.Caption = "Liquid Phase Isotherm Database"
    lblEstimationMethod.Caption = "Liquid Phase Estimation Method:"
  Else
    fraIsothermDB.Caption = "Gas Phase Isotherm Database"
    lblEstimationMethod.Caption = "Gas Phase Estimation Method:"
  End If
  Call Clear_lblValue
  Call frmFreundlich_DirtyStatus_Clear
  Call frmFreundlich_GenericStatus_Set("")
  'POPULATE UNIT CONTROLS.
  Call frmFreundlich_PopulateUnits
End Sub
Private Sub Form_Unload(Cancel As Integer)
  Call unitsys_unregister_all_on_form(Me)
End Sub


Sub Do_Select_Component(WhichComp As Integer)
''''Dim THIS_ITEMDATA As Long
Dim ThisText As String
Dim ThisCAS As String
Dim ThisChemical As String
  If (WhichComp < 0) Or (lstCompo.ListCount <= 0) Then
    Exit Sub
  End If
  lstCompo.ListIndex = WhichComp
  ''''THIS_ITEMDATA = lstCompo.ItemData(lstCompo.ListIndex)
  'EXTRACT CAS NUMBER AND COMPONENT NAME.
  ThisText = lstCompo.List(WhichComp)
  ThisCAS = Trim$(Left$(ThisText, 15))
  ThisChemical = Trim$(Mid$(ThisText, 16, Len(ThisText) - 15))
  Call populate_lstRange(ThisCAS, ThisChemical)
End Sub
Private Sub lstCompo_Click()
  If (HALT_LSTCOMPO) Then Exit Sub
  HALT_LSTCOMPO = True
  Call Do_Select_Component(lstCompo.ListIndex)
  HALT_LSTCOMPO = False
  'CLEAR EXISTING RECORD DATA.
  Call Clear_lblValue
  'INVALIDATE EXISTING ISOTHERM RECORD LINK (IF ANY).
  Component(0).IsothermDB_OneOverN = -1#
  Component(0).IsothermDB_K = -1#
  HALT_LSTRANGE = True
  lstRange(0).ListIndex = -1
  lstRange(1).ListIndex = -1
  HALT_LSTRANGE = False
  Call frmFreundlich_Refresh
End Sub


Private Sub lstRange_Click(index As Integer)
  If (HALT_LSTRANGE) Then Exit Sub
  HALT_LSTRANGE = True
  'KEEP THE RANGE LISTBOXES IN SYNCH.
  Select Case index
    Case 0: lstRange(1).ListIndex = lstRange(0).ListIndex
    Case 1: lstRange(0).ListIndex = lstRange(1).ListIndex
  End Select
  'TRANSFER LINK TO COMPONENT(0) STRUCTURE.
  Component(0).IsothermDB_Component_Name = Trim$(lstCompo.List(lstCompo.ListIndex))
  Component(0).IsothermDB_Range_Num = lstRange(0).ListIndex
  'DISPLAY ISOTHERM RECORD.
  Call populate_lblValue(lstRange(0).ItemData(lstRange(0).ListIndex))
  'THROW DIRTY FLAG.
  Call frmFreundlich_DirtyStatus_Throw
  'REFRESH WINDOW.
  Call frmFreundlich_Refresh
  HALT_LSTRANGE = False
End Sub


Private Sub optFreundlichSource_Click(index As Integer, Value As Integer)
Dim KandOneOverN_Enabled As Integer
Dim X As Integer
Dim temp As String
Dim WhichSelected As Integer
  If (HALT_OPTFREUNDLICHSOURCE) Then Exit Sub
  'DETERMINE WHICH OPTION WAS SELECTED.
  If (optFreundlichSource(0)) Then WhichSelected = 0
  If (optFreundlichSource(1)) Then WhichSelected = 1
  If (optFreundlichSource(2)) Then WhichSelected = 2
'Debug.Print "optFreundlichSource_Click; WhichSelected = " & _
Trim$(Str$(WhichSelected))
  'TRANSFER K AND 1/N TO "USED" VARIABLES IN COMPONENT STRUCTURE.
  Select Case WhichSelected
    Case 0
      Component(0).Source_KandOneOverN = KNSOURCE_ISOTHERMDB
      Component(0).Use_K = Component(0).IsothermDB_K
      Component(0).Use_OneOverN = Component(0).IsothermDB_OneOverN
      KandOneOverN_Enabled = False
    Case 1
      Component(0).Source_KandOneOverN = KNSOURCE_IPES
      Component(0).Use_K = Component(0).IPESResult_K
      Component(0).Use_OneOverN = Component(0).IPESResult_OneOverN
      KandOneOverN_Enabled = False
    Case 2
      Component(0).Source_KandOneOverN = KNSOURCE_USERINPUT
      Component(0).Use_K = Component(0).UserEntered_K
      Component(0).Use_OneOverN = Component(0).UserEntered_OneOverN
      KandOneOverN_Enabled = True
  End Select
  'REFRESH WINDOW.
  Call frmFreundlich_Refresh
End Sub



Private Sub UCtl_GotFocus(Ctl As Control)
Dim StatusMessagePanel As String
Dim CtlIndex As Integer
  Call unitsys_control_txtx_gotfocus(Ctl)
  CtlIndex = 0
  On Error Resume Next
  CtlIndex = Ctl.index
  On Error GoTo 0
  If (Trim$(UCase$(Ctl.Name)) = Trim$(UCase$("txtInput"))) And _
      (CtlIndex = 11) Then
    StatusMessagePanel = "Type in the order of magnitude"
  ElseIf (Trim$(UCase$(Ctl.Name)) = Trim$(UCase$("txtInput"))) And _
      (CtlIndex = 12) Then
    StatusMessagePanel = "Type in the number of regression points"
  ElseIf (Trim$(UCase$(Ctl.Name)) = Trim$(UCase$("UserOneOverN"))) Then
    StatusMessagePanel = "Type in the user-input Freundlich K value"
  ElseIf (Trim$(UCase$(Ctl.Name)) = Trim$(UCase$("UserK"))) Then
    StatusMessagePanel = "Type in the user-input Freundlich 1/n value"
  Else
    'NOT RECOGNIZED -- DO NOTHING.
  End If
  Call frmFreundlich_GenericStatus_Set(StatusMessagePanel)
End Sub
Sub UCtl_LostFocus(Ctl As Control)
Dim NewValue_Okay As Integer
Dim NewValue As Double
Dim Val_Low As Double
Dim Val_High As Double
Dim Raise_Dirty_Flag As Boolean
Dim CtlIndex As Integer
  'NOTE: LOW AND HIGH VALUES IN BASE UNITS.
  CtlIndex = 0
  On Error Resume Next
  CtlIndex = Ctl.index
  On Error GoTo 0
  If (Trim$(UCase$(Ctl.Name)) = Trim$(UCase$("txtInput"))) And _
      (CtlIndex = 11) Then
    Val_Low = 1#: Val_High = 10#
  ElseIf (Trim$(UCase$(Ctl.Name)) = Trim$(UCase$("txtInput"))) And _
      (CtlIndex = 12) Then
    Val_Low = 1#: Val_High = 10000#
  ElseIf (Trim$(UCase$(Ctl.Name)) = Trim$(UCase$("UserOneOverN"))) Then
    Val_Low = 1E-40: Val_High = 1E+40
  ElseIf (Trim$(UCase$(Ctl.Name)) = Trim$(UCase$("UserK"))) Then
    Val_Low = 1E-40: Val_High = 1E+40
  Else
    'NOT RECOGNIZED -- DO NOTHING.
  End If
  NewValue_Okay = False
  If (unitsys_control_txtx_lostfocus_validate(Ctl, Val_Low, Val_High, NewValue, Raise_Dirty_Flag)) Then
    NewValue_Okay = True
  End If
  Call unitsys_control_txtx_lostfocus(Ctl, NewValue)
  Call frmFreundlich_GenericStatus_Set("")
  If (NewValue_Okay) Then
    If (Raise_Dirty_Flag) Then
      'STORE TO MEMORY.
      If (Trim$(UCase$(Ctl.Name)) = Trim$(UCase$("txtInput"))) And _
          (CtlIndex = 11) Then
        Component(0).IPES_OrderOfMagnitude = NewValue
      ElseIf (Trim$(UCase$(Ctl.Name)) = Trim$(UCase$("txtInput"))) And _
          (CtlIndex = 12) Then
        Component(0).IPES_NumRegressionPts = CInt(NewValue)
      ElseIf (Trim$(UCase$(Ctl.Name)) = Trim$(UCase$("UserOneOverN"))) Then
        Component(0).UserEntered_OneOverN = NewValue
      ElseIf (Trim$(UCase$(Ctl.Name)) = Trim$(UCase$("UserK"))) Then
        Component(0).UserEntered_K = NewValue
      Else
        'NOT RECOGNIZED -- DO NOTHING.
      End If
      'RAISE DIRTY FLAG IF NECESSARY.
      If (Raise_Dirty_Flag) Then
        'THROW DIRTY FLAG.
        Call frmFreundlich_DirtyStatus_Throw
      End If
      'REFRESH WINDOW.
      Call frmFreundlich_Refresh
    End If
  End If
End Sub


Private Sub txtInput_GotFocus(index As Integer)
  Dim Ctl As Control: Set Ctl = txtInput(index): Call UCtl_GotFocus(Ctl)
End Sub
Private Sub txtInput_KeyPress(index As Integer, KeyAscii As Integer)
  KeyAscii = Global_NumericKeyPress(KeyAscii)
End Sub
Private Sub txtInput_LostFocus(index As Integer)
  Dim Ctl As Control: Set Ctl = txtInput(index): Call UCtl_LostFocus(Ctl)
End Sub

Private Sub UserK_GotFocus()
  Dim Ctl As Control: Set Ctl = UserK: Call UCtl_GotFocus(Ctl)
End Sub
Private Sub UserK_KeyPress(KeyAscii As Integer)
  KeyAscii = Global_NumericKeyPress(KeyAscii)
End Sub
Private Sub UserK_LostFocus()
  Dim Ctl As Control: Set Ctl = UserK: Call UCtl_LostFocus(Ctl)
End Sub

Private Sub UserOneOverN_GotFocus()
  Dim Ctl As Control: Set Ctl = UserOneOverN: Call UCtl_GotFocus(Ctl)
End Sub
Private Sub UserOneOverN_KeyPress(KeyAscii As Integer)
  KeyAscii = Global_NumericKeyPress(KeyAscii)
End Sub
Private Sub UserOneOverN_LostFocus()
  Dim Ctl As Control: Set Ctl = UserOneOverN: Call UCtl_LostFocus(Ctl)
End Sub




VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmAbout2 
   Appearance      =   0  'Flat
   BackColor       =   &H00C0C0C0&
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Technical Support Provided By:"
   ClientHeight    =   2970
   ClientLeft      =   2295
   ClientTop       =   6795
   ClientWidth     =   5325
   BeginProperty Font 
      Name            =   "MS Sans Serif"
      Size            =   8.25
      Charset         =   0
      Weight          =   700
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   ForeColor       =   &H80000008&
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   PaletteMode     =   1  'UseZOrder
   ScaleHeight     =   2970
   ScaleWidth      =   5325
   Begin Threed.SSPanel pnl_title 
      Height          =   2205
      Index           =   3
      Left            =   60
      TabIndex        =   2
      Top             =   240
      Width           =   5205
      _Version        =   65536
      _ExtentX        =   9181
      _ExtentY        =   3889
      _StockProps     =   15
      Caption         =   "pnl_title(3)"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   12
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin VB.CommandButton cmdOK 
      Appearance      =   0  'Flat
      Cancel          =   -1  'True
      Caption         =   "&OK"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   345
      Left            =   3900
      TabIndex        =   1
      Top             =   2550
      Width           =   1365
   End
   Begin VB.PictureBox pnl_titleX 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      ForeColor       =   &H00400040&
      Height          =   735
      Index           =   5
      Left            =   1020
      ScaleHeight     =   705
      ScaleWidth      =   5175
      TabIndex        =   0
      Top             =   3300
      Visible         =   0   'False
      Width           =   5200
   End
End
Attribute VB_Name = "frmAbout2"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False


Private Sub cmdOK_Click()
  Unload Me
End Sub

Private Sub Form_Load()
Dim msg As String

Call CenterOnForm(Me, frmMain)
'Move frmpfpsdm.Left + (frmpfpsdm.Width / 2) - (Me.Width / 2), frmpfpsdm.Top + (frmpfpsdm.Height / 2) - (Me.Height / 2)

msg = "David R. Hokanson" & Chr$(13)
msg = msg & "David W. Hand" & Chr$(13)
msg = msg & "John C. Crittenden" & Chr$(13)
msg = msg & "Tony N. Rogers" & Chr$(13)
msg = msg & "Fr" & Chr$(233) & "d" & Chr$(233) & "ric Gobin" & Chr$(13)
msg = msg & "Eric J. Oman"
pnl_title(3).Caption = msg
pnl_title(3).BackColor = &HC0C0C0
pnl_title(3).ForeColor = &H0&
'pnl_title(3).Caption = " Model and Software:      Fr" & Chr$(233) & "d" & Chr$(233) & "ric Gobin     Eric J. Oman" & Chr$(13) & " Development   :      Tony N. Rogers"

'pnl_title(5).Caption = " Programing Support:     Richard J. Hossli" & Chr$(13) & "                                   Jason E. Mclean"
'pnl_title(5).BackColor = &HC0C0C0
'pnl_title(5).ForeColor = &H0&

''''picmtu(0).Picture = LoadPicture(app.Path & "\mtu_logo.bmp")
End Sub

VERSION 5.00
Begin VB.Form frmGoAway 
   Appearance      =   0  'Flat
   BackColor       =   &H00FFFFFF&
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "{Caller-Defined Caption}"
   ClientHeight    =   3210
   ClientLeft      =   2115
   ClientTop       =   3945
   ClientWidth     =   7290
   ControlBox      =   0   'False
   BeginProperty Font 
      Name            =   "MS Sans Serif"
      Size            =   8.25
      Charset         =   0
      Weight          =   700
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   ForeColor       =   &H80000008&
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   MinButton       =   0   'False
   PaletteMode     =   1  'UseZOrder
   ScaleHeight     =   3210
   ScaleWidth      =   7290
   Begin VB.CheckBox chkDisplay 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      Caption         =   "{Caller-Defined Text}"
      ForeColor       =   &H80000008&
      Height          =   375
      Left            =   240
      TabIndex        =   4
      Top             =   2700
      Width           =   5415
   End
   Begin VB.PictureBox Picture1 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      ForeColor       =   &H80000008&
      Height          =   435
      Left            =   6960
      ScaleHeight     =   405
      ScaleWidth      =   825
      TabIndex        =   3
      Top             =   -60
      Visible         =   0   'False
      Width           =   855
   End
   Begin VB.Frame Frame1 
      Appearance      =   0  'Flat
      BackColor       =   &H00FFFFFF&
      ForeColor       =   &H80000008&
      Height          =   2415
      Left            =   180
      TabIndex        =   1
      Top             =   120
      Width           =   6915
      Begin VB.Label Label1 
         Appearance      =   0  'Flat
         BackColor       =   &H00FFFFFF&
         Caption         =   "{Caller-Defined Text}"
         ForeColor       =   &H80000008&
         Height          =   2175
         Left            =   120
         TabIndex        =   2
         Top             =   180
         Width           =   6615
      End
   End
   Begin VB.CommandButton cmdOK 
      Appearance      =   0  'Flat
      Caption         =   "&OK"
      Height          =   495
      Left            =   5880
      TabIndex        =   0
      Top             =   2640
      Width           =   1215
   End
End
Attribute VB_Name = "frmGoAway"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Dim frmGoAway_ParentForm As Form
Dim frmGoAway_Caption As String
Dim frmGoAway_Text As String
Dim frmGoAway_CheckText As String
Dim frmGoAway_CheckValue As Integer





Const frmGoAway_declarations_end = True


Public Sub frmGoAway_Run( _
    INPUT_frmGoAway_ParentForm As Form, _
    INPUT_frmGoAway_Caption As String, _
    INPUT_frmGoAway_Text As String, _
    INPUT_frmGoAway_CheckText As String, _
    INPUTOUTPUT_frmGoAway_CheckValue As Integer)
  Set frmGoAway_ParentForm = INPUT_frmGoAway_ParentForm
  frmGoAway_Caption = INPUT_frmGoAway_Caption
  frmGoAway_Text = INPUT_frmGoAway_Text
  frmGoAway_CheckText = INPUT_frmGoAway_CheckText
  frmGoAway_CheckValue = INPUTOUTPUT_frmGoAway_CheckValue
  frmGoAway.Show 1
  INPUTOUTPUT_frmGoAway_CheckValue = frmGoAway_CheckValue
End Sub


Private Sub cmdOK_Click()
  If (chkDisplay.Value = True) Then
    frmGoAway_CheckValue = 1
  Else
    frmGoAway_CheckValue = 0
  End If
  Unload Me
End Sub
Private Sub Form_Load()
Dim ht As Double
  Me.Height = 3615
  Me.Width = 7410
  Me.Caption = frmGoAway_Caption
  Label1.Caption = frmGoAway_Text
  chkDisplay.Caption = frmGoAway_CheckText
  If (frmGoAway_CheckValue = 1) Then
    chkDisplay.Value = True
  Else
    chkDisplay.Value = False
  End If
  Call CenterOnForm(Me, frmGoAway_ParentForm)
  ht = Picture1.TextHeight(frmGoAway_Text)
  Label1.Height = ht * 1.05
  Frame1.Height = ht * 1.2
End Sub
Private Sub Form_Unload(Cancel As Integer)
  'contam_prop_form.SetFocus
End Sub

VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "Threed32.OCX"
Begin VB.Form frmInputParamsPSDMInRoom 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Parameters for PSDM-in-Room Model"
   ClientHeight    =   6120
   ClientLeft      =   3600
   ClientTop       =   1875
   ClientWidth     =   7020
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   6120
   ScaleWidth      =   7020
   ShowInTaskbar   =   0   'False
   Begin Threed.SSFrame SSFrame1 
      Height          =   1515
      Left            =   90
      TabIndex        =   5
      Top             =   90
      Width           =   6795
      _Version        =   65536
      _ExtentX        =   11986
      _ExtentY        =   2672
      _StockProps     =   14
      Caption         =   "Main Set of Room Properties:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.ComboBox cboUnits 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   0
         Left            =   5250
         Style           =   2  'Dropdown List
         TabIndex        =   8
         TabStop         =   0   'False
         Top             =   240
         Width           =   1275
      End
      Begin VB.TextBox txtData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   288
         Index           =   0
         Left            =   3990
         TabIndex        =   0
         Text            =   "txtData(0)"
         Top             =   270
         Width           =   1212
      End
      Begin VB.ComboBox cboUnits 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Index           =   1
         Left            =   5250
         Style           =   2  'Dropdown List
         TabIndex        =   7
         TabStop         =   0   'False
         Top             =   630
         Width           =   1275
      End
      Begin VB.TextBox txtData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   288
         Index           =   1
         Left            =   3990
         TabIndex        =   1
         Text            =   "txtData(1)"
         Top             =   660
         Width           =   1212
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Volume of Room"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   -30
         TabIndex        =   13
         Top             =   300
         Width           =   3885
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Volumetric Flow Rate of Air Through Room"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   -30
         TabIndex        =   12
         Top             =   690
         Width           =   3885
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Air Change Rate"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   -30
         TabIndex        =   11
         Top             =   1080
         Width           =   3885
      End
      Begin VB.Label lblAirRate 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BackStyle       =   0  'Transparent
         Caption         =   "lblAirRate"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   3990
         TabIndex        =   10
         Top             =   1080
         Width           =   1215
      End
      Begin VB.Label lblAirRateUnits 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BackStyle       =   0  'Transparent
         Caption         =   "hour^(-1)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   5250
         TabIndex        =   9
         Top             =   1080
         Width           =   1275
      End
   End
   Begin Threed.SSFrame SSFrame2 
      Height          =   3225
      Left            =   90
      TabIndex        =   6
      Top             =   1710
      Width           =   6795
      _Version        =   65536
      _ExtentX        =   11986
      _ExtentY        =   5689
      _StockProps     =   14
      Caption         =   "Contaminant Properties:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin Threed.SSFrame ssframe_ContaminantProps 
         Height          =   2205
         Left            =   180
         TabIndex        =   16
         Top             =   780
         Width           =   6465
         _Version        =   65536
         _ExtentX        =   11404
         _ExtentY        =   3889
         _StockProps     =   14
         Caption         =   "Properties of {ContaminantName}:"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Begin VB.ComboBox cboUnits 
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   315
            Index           =   2
            Left            =   5070
            Style           =   2  'Dropdown List
            TabIndex        =   19
            TabStop         =   0   'False
            Top             =   330
            Width           =   1275
         End
         Begin VB.TextBox txtData 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   288
            Index           =   2
            Left            =   3810
            TabIndex        =   2
            Text            =   "txtData(2)"
            Top             =   360
            Width           =   1212
         End
         Begin VB.ComboBox cboUnits 
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   315
            Index           =   3
            Left            =   5070
            Style           =   2  'Dropdown List
            TabIndex        =   18
            TabStop         =   0   'False
            Top             =   720
            Width           =   1275
         End
         Begin VB.TextBox txtData 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   288
            Index           =   3
            Left            =   3810
            TabIndex        =   3
            Text            =   "txtData(3)"
            Top             =   750
            Width           =   1212
         End
         Begin VB.TextBox txtData 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   288
            Index           =   4
            Left            =   3810
            TabIndex        =   4
            Text            =   "txtData(4)"
            Top             =   1500
            Width           =   1212
         End
         Begin VB.ComboBox cboUnits 
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   315
            Index           =   4
            Left            =   5070
            Style           =   2  'Dropdown List
            TabIndex        =   17
            TabStop         =   0   'False
            Top             =   1470
            Width           =   1275
         End
         Begin VB.Label lblDesc 
            Alignment       =   1  'Right Justify
            Appearance      =   0  'Flat
            BackColor       =   &H80000005&
            BackStyle       =   0  'Transparent
            Caption         =   "Concentration in Influent Stream To Room"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H80000008&
            Height          =   255
            Index           =   2
            Left            =   -30
            TabIndex        =   25
            Top             =   390
            Width           =   3765
         End
         Begin VB.Label lblDesc 
            Alignment       =   1  'Right Justify
            Appearance      =   0  'Flat
            BackColor       =   &H80000005&
            BackStyle       =   0  'Transparent
            Caption         =   "Mass Emission Rate Within Room"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H80000008&
            Height          =   255
            Index           =   3
            Left            =   -30
            TabIndex        =   24
            Top             =   780
            Width           =   3765
         End
         Begin VB.Label lblSSValueUnits 
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            BackStyle       =   0  'Transparent
            Caption         =   "{u}g/L"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H80000008&
            Height          =   255
            Left            =   5070
            TabIndex        =   23
            Top             =   1170
            Width           =   1275
         End
         Begin VB.Label lblSSValue 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            BackStyle       =   0  'Transparent
            Caption         =   "lblSSValue"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H80000008&
            Height          =   255
            Left            =   3810
            TabIndex        =   22
            Top             =   1170
            Width           =   1215
         End
         Begin VB.Label lblDesc 
            Alignment       =   1  'Right Justify
            Appearance      =   0  'Flat
            BackColor       =   &H80000005&
            BackStyle       =   0  'Transparent
            Caption         =   "Steady State Conc. at Saturation (Cr,ss)"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H80000008&
            Height          =   255
            Index           =   5
            Left            =   -150
            TabIndex        =   21
            Top             =   1170
            Width           =   3885
         End
         Begin VB.Label lblDesc 
            Alignment       =   1  'Right Justify
            Appearance      =   0  'Flat
            BackColor       =   &H80000005&
            BackStyle       =   0  'Transparent
            Caption         =   "Concentration in Room at Time = Zero"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H80000008&
            Height          =   255
            Index           =   6
            Left            =   -30
            TabIndex        =   20
            Top             =   1530
            Width           =   3765
         End
      End
      Begin VB.ComboBox cboChemical 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Left            =   3300
         Style           =   2  'Dropdown List
         TabIndex        =   14
         TabStop         =   0   'False
         Top             =   300
         Width           =   3345
      End
      Begin VB.Label lblDesc_cboChemical 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Select Contaminant Name:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   720
         TabIndex        =   15
         Top             =   360
         Width           =   2505
      End
   End
   Begin Threed.SSCommand cmdCancelOK 
      Height          =   495
      Index           =   1
      Left            =   2550
      TabIndex        =   26
      TabStop         =   0   'False
      ToolTipText     =   "Click here to save the changes you have made to the parameters on this window"
      Top             =   5100
      Width           =   2175
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      Caption         =   "&OK"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdCancelOK 
      Height          =   495
      Index           =   0
      Left            =   4710
      TabIndex        =   27
      TabStop         =   0   'False
      ToolTipText     =   "Click here to abandon any changes you have made to the parameters on this window"
      Top             =   5100
      Width           =   2175
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      Caption         =   "&Cancel"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSPanel SSPanel2 
      Align           =   2  'Align Bottom
      Height          =   405
      Left            =   0
      TabIndex        =   28
      Top             =   5715
      Width           =   7020
      _Version        =   65536
      _ExtentX        =   12382
      _ExtentY        =   714
      _StockProps     =   15
      ForeColor       =   -2147483640
      BackColor       =   12632256
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin Threed.SSPanel sspanel_Dirty 
         Height          =   285
         Left            =   60
         TabIndex        =   29
         Top             =   60
         Width           =   2115
         _Version        =   65536
         _ExtentX        =   3731
         _ExtentY        =   503
         _StockProps     =   15
         Caption         =   "sspanel_Dirty"
         ForeColor       =   -2147483640
         BackColor       =   12632256
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelOuter      =   1
      End
      Begin Threed.SSPanel sspanel_Status 
         Height          =   285
         Left            =   2220
         TabIndex        =   30
         Top             =   60
         Width           =   4720
         _Version        =   65536
         _ExtentX        =   8326
         _ExtentY        =   503
         _StockProps     =   15
         Caption         =   "sspanel_Status"
         ForeColor       =   -2147483640
         BackColor       =   12632256
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelOuter      =   1
      End
   End
End
Attribute VB_Name = "frmInputParamsPSDMInRoom"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Dim TempData As RoomParam_Type
Dim NOW_CONTAMINANT As Integer

Dim USER_HIT_CANCEL As Boolean
Dim USER_HIT_OK As Boolean
Dim Temp_RP As RoomParam_Type

Dim frmInputParamsPSDMInRoom_Is_Dirty As Boolean
Dim HALT_cboChemical As Boolean






Const frmInputParamsPSDMInRoom_declarations_end = True


Sub frmInputParamsPSDMInRoom_Edit( _
    OUTPUT_Raise_Dirty_Flag As Boolean)
  Temp_RP = RoomParams
  If (Temp_RP.COUNT_CONTAMINANT <> Number_Component) Then
    Temp_RP.COUNT_CONTAMINANT = Number_Component
  End If
  frmInputParamsPSDMInRoom.Show 1
  If (USER_HIT_OK) Then
    OUTPUT_Raise_Dirty_Flag = True
    RoomParams = Temp_RP
  Else
    OUTPUT_Raise_Dirty_Flag = False
  End If
End Sub


Sub frmInputParamsPSDMInRoom_PopulateUnits()
Dim Frm As Form
Set Frm = frmInputParamsPSDMInRoom
  'MAIN BLOCK OF UNITS.
  Call unitsys_register(Frm, lblDesc(0), _
      txtData(0), cboUnits(0), "volume", _
      Temp_RP.ROOM_VOL_Units, "m", "", "", 100#, True)
  Call unitsys_register(Frm, lblDesc(1), _
      txtData(1), cboUnits(1), "flow_volumetric", _
      Temp_RP.ROOM_FLOWRATE_Units, "m/s", "", "", 100#, True)
  Call unitsys_register(Frm, lblDesc(2), _
      txtData(2), cboUnits(2), "concentration", _
      Temp_RP.ROOM_C0_Units, "mg/L", "", "", 100#, True)
  Call unitsys_register(Frm, lblDesc(3), _
      txtData(3), cboUnits(3), "mass_emission_rate", _
      Temp_RP.ROOM_EMIT_Units, "g/s", "", "", 100#, True)
  Call unitsys_register(Frm, lblDesc(4), _
      txtData(4), cboUnits(4), "concentration", _
      Temp_RP.INITIAL_ROOM_CONC_Units, "mg/L", "", "", 100#, True)
End Sub
Sub Store_Unit_Settings()
  Temp_RP.ROOM_VOL_Units = unitsys_get_units(cboUnits(0))
  Temp_RP.ROOM_FLOWRATE_Units = unitsys_get_units(cboUnits(1))
  Temp_RP.ROOM_C0_Units = unitsys_get_units(cboUnits(2))
  Temp_RP.ROOM_EMIT_Units = unitsys_get_units(cboUnits(3))
  Temp_RP.INITIAL_ROOM_CONC_Units = unitsys_get_units(cboUnits(4))
End Sub


Sub Do_Refresh()
  Call frmInputParamsPSDMInRoom_Refresh(Temp_RP, NOW_CONTAMINANT)
End Sub


Private Sub populate_cboChemical()
Dim i As Integer
Dim Ctl As Control
Set Ctl = cboChemical
  HALT_cboChemical = True
  Ctl.Clear
  If (frmMain.cboSelectCompo.ListCount > 0) Then
    For i = 1 To frmMain.cboSelectCompo.ListCount
      Ctl.AddItem Trim$(frmMain.cboSelectCompo.List(i - 1))
    Next
    Ctl.ListIndex = 0
  End If
  HALT_cboChemical = False
End Sub


Sub frmInputParamsPSDMInRoom_GenericStatus_Set(fn_Text As String)
  Me.sspanel_Status = fn_Text
End Sub
Sub frmInputParamsPSDMInRoom_DirtyStatus_Set(newVal As Boolean)
Dim Frm As Form
Set Frm = frmInputParamsPSDMInRoom
  If (newVal) Then
    Frm.sspanel_Dirty = "Data Changed"
    Frm.sspanel_Dirty.ForeColor = QBColor(12)
  Else
    Frm.sspanel_Dirty = "Unchanged"
    Frm.sspanel_Dirty.ForeColor = QBColor(0)
  End If
End Sub
Sub frmInputParamsPSDMInRoom_DirtyStatus_Set_Current()
  Call frmInputParamsPSDMInRoom_DirtyStatus_Set( _
      frmInputParamsPSDMInRoom_Is_Dirty)
End Sub
Sub frmInputParamsPSDMInRoom_DirtyStatus_Throw()
  frmInputParamsPSDMInRoom_Is_Dirty = True
  Call frmInputParamsPSDMInRoom_DirtyStatus_Set_Current
End Sub
Sub frmInputParamsPSDMInRoom_DirtyStatus_Clear()
  frmInputParamsPSDMInRoom_Is_Dirty = False
  Call frmInputParamsPSDMInRoom_DirtyStatus_Set_Current
End Sub


Private Sub cboChemical_Click()
  If (HALT_cboChemical) Then Exit Sub
  NOW_CONTAMINANT = cboChemical.ListIndex + 1
  Call Do_Refresh
End Sub


Private Sub cboUnits_Click(Index As Integer)
Dim Ctl As Control
Set Ctl = cboUnits(Index)
  Call unitsys_control_cbox_click(Ctl)
End Sub
Private Sub cboUnits_KeyPress(Index As Integer, KeyAscii As Integer)
  KeyAscii = Global_TextKeyPress(KeyAscii)
End Sub


Private Sub cmdCancelOK_Click(Index As Integer)
Dim i As Integer
  Select Case Index
    Case 0:     'CANCEL.
      'If (frmCompoProp_Query_Unload() = False) Then
      '  'THE CANCEL WAS CANCELLED.
      '  Exit Sub
      'End If
      USER_HIT_CANCEL = True
      USER_HIT_OK = False
      Unload Me
      Exit Sub
    Case 1:     'OK.
      'STORE ALL UNIT SETTINGS.
      Call Store_Unit_Settings
      'EXIT OUT OF HERE.
      USER_HIT_CANCEL = False
      USER_HIT_OK = True
      Unload Me
      Exit Sub
  End Select
End Sub


Private Sub Form_Load()
  'MISC INITS.
  HALT_cboChemical = False
  Call CenterOnForm(Me, frmMain)
  lblSSValueUnits.Caption = Chr$(181) & "g/L"
  NOW_CONTAMINANT = 1
  Call populate_cboChemical
  'POPULATE UNIT CONTROLS.
  Call frmInputParamsPSDMInRoom_PopulateUnits
  'REFRESH WINDOW.
  Call Do_Refresh
  'DATA UNCHANGED AS YET.
  Call frmInputParamsPSDMInRoom_DirtyStatus_Clear
End Sub
Private Sub Form_Unload(Cancel As Integer)
  Call unitsys_unregister_all_on_form(Me)
End Sub


Private Sub txtData_GotFocus(Index As Integer)
Dim Ctl As Control
Set Ctl = txtData(Index)
Dim StatusMessagePanel As String
  'If (Index = 0) Then
  '  Call Global_GotFocus(Ctl)
  'Else
    Call unitsys_control_txtx_gotfocus(Ctl)
  'End If
  Select Case Index
    Case 0:
      StatusMessagePanel = "Type in the volume of the room"
    Case 1:
      StatusMessagePanel = "Type in the volumetric flow rate of air"
    Case 2:
      StatusMessagePanel = "Type in the influent concentration to the room"
    Case 3:
      StatusMessagePanel = "Type in the mass emission rate within the room"
    Case 4:
      StatusMessagePanel = "Type in the concentration at time = zero"
  End Select
  Call frmInputParamsPSDMInRoom_GenericStatus_Set(StatusMessagePanel)
End Sub
Private Sub txtData_KeyPress(Index As Integer, KeyAscii As Integer)
  'If (Index = 0) Then
  '  KeyAscii = Global_TextKeyPress(KeyAscii)
  'Else
    KeyAscii = Global_NumericKeyPress(KeyAscii)
  'End If
End Sub
Private Sub txtData_LostFocus(Index As Integer)
Dim NewValue_Okay As Integer
Dim NewValue As Double
Dim Ctl As Control
Set Ctl = txtData(Index)
Dim Val_Low As Double
Dim Val_High As Double
Dim Raise_Dirty_Flag As Boolean
Dim Too_Small As Integer
'  'HANDLE THE COMPONENT NAME TEXTBOX.
'  If (Index = 0) Then
'    If (Trim$(Ctl.Text) = "") Then
'      Ctl.Text = Component(0).Name
'      'Call Show_Error("You must enter a non-blank string for the component name.")
'      'NOTE: SHOWING THIS ERROR MESSAGE MESSES UP THE
'      'SUBSEQUENT GOTFOCUS IF THE USER HITS <Enter> OR <Tab>.
'    Else
'      If (Trim$(Component(0).Name) <> Trim$(Ctl.Text)) Then
'        Component(0).Name = Trim$(Ctl.Text)
'        'THROW DIRTY FLAG.
'        Call frmCompoProp_DirtyStatus_Throw
'      End If
'    End If
'    Call Global_LostFocus(Ctl)
'    Call frmCompoProp_GenericStatus_Set("")
'    Exit Sub
'  End If
  'NOTE: LOW AND HIGH VALUES IN BASE UNITS.
  Select Case Index
    Case 0: Val_Low = 1E-20: Val_High = 1E+20
    Case 1: Val_Low = 0#: Val_High = 1E+20
    Case 2: Val_Low = 0#: Val_High = 1E+20
    Case 3: Val_Low = 0#: Val_High = 1E+20
    Case 4: Val_Low = 0#: Val_High = 1E+20
  End Select
  NewValue_Okay = False
  If (unitsys_control_txtx_lostfocus_validate(Ctl, Val_Low, Val_High, NewValue, Raise_Dirty_Flag)) Then
    NewValue_Okay = True
  End If
  Call unitsys_control_txtx_lostfocus(Ctl, NewValue)
  Call frmInputParamsPSDMInRoom_GenericStatus_Set("")
  If (NewValue_Okay) Then
    If (Raise_Dirty_Flag) Then
      'STORE TO MEMORY.
      Select Case Index
        Case 0: Temp_RP.ROOM_VOL = NewValue
        Case 1: Temp_RP.ROOM_FLOWRATE = NewValue
        Case 2: Temp_RP.ROOM_C0(NOW_CONTAMINANT) = NewValue
        Case 3: Temp_RP.ROOM_EMIT(NOW_CONTAMINANT) = NewValue
        Case 4: Temp_RP.INITIAL_ROOM_CONC(NOW_CONTAMINANT) = NewValue
      End Select
      'RAISE DIRTY FLAG AND RECALCULATE IF NECESSARY.
      If (Raise_Dirty_Flag) Then
        'THROW DIRTY FLAG.
        Call frmInputParamsPSDMInRoom_DirtyStatus_Throw
        Call RoomParam_Recalculate(Temp_RP)
      End If
      'REFRESH WINDOW.
      Call Do_Refresh
    End If
  End If
End Sub

VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "Threed32.OCX"
Begin VB.Form frmKinetic 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Kinetic Parameters"
   ClientHeight    =   6045
   ClientLeft      =   450
   ClientTop       =   2310
   ClientWidth     =   8415
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   6045
   ScaleWidth      =   8415
   ShowInTaskbar   =   0   'False
   Begin Threed.SSCheck chkTortuosity_Corr 
      Height          =   285
      Left            =   1560
      TabIndex        =   43
      Top             =   4590
      Width           =   4875
      _Version        =   65536
      _ExtentX        =   8599
      _ExtentY        =   503
      _StockProps     =   78
      Caption         =   "Use Pore Diffusion Correlation for &Tortuosity"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSFrame SSFrame1 
      Height          =   2325
      Left            =   8550
      TabIndex        =   24
      Top             =   1320
      Visible         =   0   'False
      Width           =   3495
      _Version        =   65536
      _ExtentX        =   6165
      _ExtentY        =   4101
      _StockProps     =   14
      Caption         =   "Unused -- Invisible"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin Threed.SSOption optKF_old 
         Height          =   255
         Index           =   0
         Left            =   1680
         TabIndex        =   31
         TabStop         =   0   'False
         Top             =   1560
         Width           =   255
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSOption optKF_old 
         Height          =   255
         Index           =   1
         Left            =   1680
         TabIndex        =   32
         TabStop         =   0   'False
         Top             =   1920
         Width           =   255
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSOption optDS_old 
         Height          =   255
         Index           =   0
         Left            =   2220
         TabIndex        =   33
         TabStop         =   0   'False
         Top             =   1500
         Width           =   255
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSOption optDS_old 
         Height          =   255
         Index           =   1
         Left            =   2220
         TabIndex        =   34
         TabStop         =   0   'False
         Top             =   1860
         Width           =   255
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSOption optDP_old 
         Height          =   255
         Index           =   0
         Left            =   2670
         TabIndex        =   35
         TabStop         =   0   'False
         Top             =   1530
         Width           =   255
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSOption optDP_old 
         Height          =   255
         Index           =   1
         Left            =   2670
         TabIndex        =   36
         TabStop         =   0   'False
         Top             =   1890
         Width           =   255
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin VB.Label lblDP_OLD 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         ForeColor       =   &H80000008&
         Height          =   285
         Left            =   540
         TabIndex        =   27
         Top             =   810
         Width           =   1095
      End
      Begin VB.Label lblDS_OLD 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         ForeColor       =   &H80000008&
         Height          =   285
         Left            =   600
         TabIndex        =   26
         Top             =   690
         Width           =   1095
      End
      Begin VB.Label lblKF_OLD 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         ForeColor       =   &H80000008&
         Height          =   285
         Left            =   360
         TabIndex        =   25
         Top             =   420
         Width           =   1215
      End
   End
   Begin Threed.SSFrame fraKP 
      Height          =   2925
      Index           =   2
      Left            =   5640
      TabIndex        =   14
      Top             =   330
      Width           =   2055
      _Version        =   65536
      _ExtentX        =   3625
      _ExtentY        =   5159
      _StockProps     =   14
      Caption         =   "Pore Diffusion"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Alignment       =   2
      Begin VB.OptionButton optDP 
         Enabled         =   0   'False
         Height          =   255
         Index           =   1
         Left            =   210
         TabIndex        =   42
         TabStop         =   0   'False
         Top             =   930
         Width           =   255
      End
      Begin VB.OptionButton optDP 
         Enabled         =   0   'False
         Height          =   255
         Index           =   0
         Left            =   210
         TabIndex        =   41
         TabStop         =   0   'False
         Top             =   570
         Width           =   255
      End
      Begin VB.TextBox lblDP 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   288
         Left            =   600
         Locked          =   -1  'True
         TabIndex        =   23
         TabStop         =   0   'False
         Top             =   930
         Width           =   1212
      End
      Begin VB.TextBox txtDP 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   288
         Left            =   600
         TabIndex        =   2
         Top             =   570
         Width           =   1215
      End
      Begin VB.Label lblUnit 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "cm2/s"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   480
         TabIndex        =   20
         Top             =   210
         Width           =   1095
      End
      Begin VB.Label lblCorrelationDP 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Wilke-Lee Modification of the Hirschfelder - Bird - Spotz method"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   1455
         Left            =   120
         TabIndex        =   19
         Top             =   1320
         Width           =   1815
      End
   End
   Begin Threed.SSFrame fraKP 
      Height          =   2925
      Index           =   1
      Left            =   3600
      TabIndex        =   13
      Top             =   330
      Width           =   2055
      _Version        =   65536
      _ExtentX        =   3625
      _ExtentY        =   5159
      _StockProps     =   14
      Caption         =   "Surface Diffusion"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Alignment       =   2
      Begin VB.OptionButton optDS 
         Enabled         =   0   'False
         Height          =   255
         Index           =   1
         Left            =   210
         TabIndex        =   40
         TabStop         =   0   'False
         Top             =   930
         Width           =   255
      End
      Begin VB.OptionButton optDS 
         Enabled         =   0   'False
         Height          =   255
         Index           =   0
         Left            =   210
         TabIndex        =   39
         TabStop         =   0   'False
         Top             =   570
         Width           =   255
      End
      Begin VB.TextBox lblDS 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   288
         Left            =   600
         Locked          =   -1  'True
         TabIndex        =   22
         TabStop         =   0   'False
         Top             =   930
         Width           =   1212
      End
      Begin VB.TextBox txtDS 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   288
         Left            =   600
         TabIndex        =   1
         Top             =   570
         Width           =   1215
      End
      Begin VB.Label lblUnit 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "cm2/s"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   480
         TabIndex        =   18
         Top             =   210
         Width           =   1095
      End
      Begin VB.Label lblCorrelationDS 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Wilke-Lee Modification of the Hirschfelder - Bird - Spotz method"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   1455
         Left            =   120
         TabIndex        =   17
         Top             =   1320
         Width           =   1815
      End
   End
   Begin Threed.SSFrame fraKP 
      Height          =   2925
      Index           =   0
      Left            =   1560
      TabIndex        =   12
      Top             =   330
      Width           =   2055
      _Version        =   65536
      _ExtentX        =   3625
      _ExtentY        =   5159
      _StockProps     =   14
      Caption         =   "Film Diffusion"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Alignment       =   2
      Begin VB.OptionButton optKF 
         Enabled         =   0   'False
         Height          =   255
         Index           =   1
         Left            =   210
         TabIndex        =   38
         TabStop         =   0   'False
         Top             =   930
         Width           =   255
      End
      Begin VB.OptionButton optKF 
         Enabled         =   0   'False
         Height          =   255
         Index           =   0
         Left            =   210
         TabIndex        =   37
         TabStop         =   0   'False
         Top             =   570
         Width           =   255
      End
      Begin VB.TextBox txtKF 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   288
         Left            =   600
         TabIndex        =   0
         Top             =   570
         Width           =   1212
      End
      Begin VB.TextBox lblKF 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   288
         Left            =   600
         Locked          =   -1  'True
         TabIndex        =   21
         TabStop         =   0   'False
         Top             =   930
         Width           =   1212
      End
      Begin VB.Label lblUnit 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "cm/s"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   480
         TabIndex        =   16
         Top             =   210
         Width           =   1095
      End
      Begin VB.Label lblCorrelationKF 
         Appearance      =   0  'Flat
         BackColor       =   &H8000000B&
         BackStyle       =   0  'Transparent
         Caption         =   "Wilke-Lee Modification of the Hirschfelder - Bird - Spotz method"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   1485
         Left            =   120
         TabIndex        =   15
         Top             =   1320
         Width           =   1815
      End
   End
   Begin VB.TextBox txtSPDFR 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   288
      Left            =   1560
      TabIndex        =   3
      Top             =   3480
      Width           =   1095
   End
   Begin VB.TextBox txtTort 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   288
      Left            =   1560
      TabIndex        =   4
      Text            =   "txtTort"
      Top             =   3840
      Width           =   1095
   End
   Begin Threed.SSCommand cmdCancelOK 
      Height          =   495
      Index           =   1
      Left            =   1530
      TabIndex        =   10
      TabStop         =   0   'False
      ToolTipText     =   "Click here to save the changes you have made to the kinetic parameters on this window"
      Top             =   5010
      Width           =   2175
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      Caption         =   "&OK"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdCancelOK 
      Height          =   495
      Index           =   0
      Left            =   3690
      TabIndex        =   11
      TabStop         =   0   'False
      ToolTipText     =   "Click here to abandon any changes you have made to the kinetic parameters on this window"
      Top             =   5010
      Width           =   2175
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      Caption         =   "&Cancel"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSPanel SSPanel2 
      Align           =   2  'Align Bottom
      Height          =   405
      Left            =   0
      TabIndex        =   28
      Top             =   5640
      Width           =   8415
      _Version        =   65536
      _ExtentX        =   14843
      _ExtentY        =   714
      _StockProps     =   15
      ForeColor       =   -2147483640
      BackColor       =   12632256
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin Threed.SSPanel sspanel_Dirty 
         Height          =   285
         Left            =   60
         TabIndex        =   29
         Top             =   60
         Width           =   2115
         _Version        =   65536
         _ExtentX        =   3731
         _ExtentY        =   503
         _StockProps     =   15
         Caption         =   "sspanel_Dirty"
         ForeColor       =   -2147483640
         BackColor       =   12632256
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelOuter      =   1
      End
      Begin Threed.SSPanel sspanel_Status 
         Height          =   285
         Left            =   2220
         TabIndex        =   30
         Top             =   60
         Width           =   6520
         _Version        =   65536
         _ExtentX        =   11501
         _ExtentY        =   503
         _StockProps     =   15
         Caption         =   "sspanel_Status"
         ForeColor       =   -2147483640
         BackColor       =   12632256
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelOuter      =   1
      End
   End
   Begin VB.Label Label1 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Correlation"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   1
      Left            =   360
      TabIndex        =   9
      Top             =   1290
      Width           =   1095
   End
   Begin VB.Label Label1 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "User Input"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   0
      Left            =   360
      TabIndex        =   8
      Top             =   930
      Width           =   1095
   End
   Begin VB.Label lblSPDFR 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Surface To Pore Diffusion Flux Ratio (SPDFR)"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Left            =   2700
      TabIndex        =   7
      Top             =   3540
      Width           =   4215
   End
   Begin VB.Label lblTort 
      Appearance      =   0  'Flat
      BackColor       =   &H00C0C0C0&
      BackStyle       =   0  'Transparent
      Caption         =   "Tortuosity"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Left            =   2700
      TabIndex        =   6
      Top             =   3900
      Width           =   1095
   End
   Begin VB.Label lblTortCorrelation 
      Appearance      =   0  'Flat
      BackColor       =   &H00C0C0C0&
      BackStyle       =   0  'Transparent
      Caption         =   "Leave this label alone!"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   555
      Left            =   1560
      TabIndex        =   5
      Top             =   4140
      Width           =   5775
   End
End
Attribute VB_Name = "frmKinetic"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Dim USER_HIT_CANCEL As Boolean
Dim USER_HIT_OK As Boolean
Dim frmKinetic_Is_Dirty As Boolean

Dim SaveOldComponent As ComponentPropertyType




Const frmKinetic_declarations_end = True


Sub frmKinetic_Run( _
    OUTPUT_Raise_Dirty_Flag As Boolean)
  frmKinetic.Show 1
  If (USER_HIT_OK) Then
    OUTPUT_Raise_Dirty_Flag = True
  Else
    OUTPUT_Raise_Dirty_Flag = False
  End If
End Sub


Sub frmKinetic_GenericStatus_Set(fn_Text As String)
  Me.sspanel_Status = fn_Text
End Sub
Sub frmKinetic_DirtyStatus_Set(newVal As Boolean)
  If (newVal) Then
    frmKinetic.sspanel_Dirty = "Data Changed"
    frmKinetic.sspanel_Dirty.ForeColor = QBColor(12)
  Else
    frmKinetic.sspanel_Dirty = "Unchanged"
    frmKinetic.sspanel_Dirty.ForeColor = QBColor(0)
  End If
End Sub
Sub frmKinetic_DirtyStatus_Set_Current()
  Call frmKinetic_DirtyStatus_Set(frmKinetic_Is_Dirty)
End Sub
Sub frmKinetic_DirtyStatus_Throw()
  frmKinetic_Is_Dirty = True
  Call frmKinetic_DirtyStatus_Set_Current
End Sub
Sub frmKinetic_DirtyStatus_Clear()
  frmKinetic_Is_Dirty = False
  Call frmKinetic_DirtyStatus_Set_Current
End Sub


Sub frmKinetic_PopulateUnits()
  Call unitsys_register(frmKinetic, lblSPDFR, _
      txtKF, Nothing, "", _
      "", "", "", "", 100#, False)
  Call unitsys_register(frmKinetic, lblSPDFR, _
      txtDS, Nothing, "", _
      "", "", "", "", 100#, False)
  Call unitsys_register(frmKinetic, lblSPDFR, _
      txtDP, Nothing, "", _
      "", "", "", "", 100#, False)
  Call unitsys_register(frmKinetic, lblSPDFR, _
      txtSPDFR, Nothing, "", _
      "", "", "", "", 100#, False)
  Call unitsys_register(frmKinetic, lblTort, _
      txtTort, Nothing, "", _
      "", "", "", "", 100#, False)
End Sub


Sub Update_Ds_and_Dp_Editability()
  If (Component(0).Use_Tortuosity_Correlation) Then
    '---- Tortuosity(time) correlation is ON!
    txtTort.Enabled = False
    '---- De-enable Ds user-input
    optDS(0).Enabled = False
    optDS(0).Value = False
    optDS(1).Value = True
    Component(0).Corr(2) = True
    '---- De-enable Dp user-input
    optDP(0).Enabled = False
    optDP(0).Value = False
    optDP(1).Value = True
    Component(0).Corr(3) = True
  Else
    '---- Tortuosity(time) correlation is OFF!
    txtTort.Enabled = True
    '---- Enable Ds user-input
    optDS(0).Enabled = True
    '---- Enable Dp user-input
    optDP(0).Enabled = True
  End If
End Sub
Sub Update_Tortuosity_Display()
Dim T As Double
  If (Component(0).Use_Tortuosity_Correlation) Then
    '---- Tortuosity(time) correlation is ON!
    T = Tortuosity(0)
    txtTort = Format_It(T, 3)
    ''''chkTortuosity_Corr.Value = True
    txtTort.Enabled = False
    'lblTortCorrelation.Caption = "For t<=70 days, tortuosity = 1;" & Chr$(13) & Chr$(10) & "For t>70 days, tortuosity = 0.334 + 0.00000661*(t,minutes)"
    lblTortCorrelation.Caption = "For t<=70 days, tortuosity = 1;" & Chr$(13) & Chr$(10) & "For t>70 days, tortuosity = 0.334 + 0.009518*(t,days)"
    lblTortCorrelation.Visible = True
    lblTortCorrelation.Left = txtTort.Left
    lblTortCorrelation.Top = txtTort.Top
    txtTort.Visible = False
    lblTort.Visible = False
    Call frmKinetic_Refresh
        'THIS REDISPLAYS txtTort.
  Else
    '---- Tortuosity(time) correlation is OFF!
    T = Component(0).Tortuosity
    Call frmKinetic_Repopulate_Values     'THIS REDISPLAYS txtTort.
    'txtTort = Format_It(T, 3)
    ''''chkTortuosity_Corr.Value = False
    txtTort.Enabled = True
    lblTortCorrelation.Visible = False
    txtTort.Visible = True
    lblTort.Visible = True
  End If
End Sub


Private Sub chkTortuosity_Corr_Click(Value As Integer)
  If (Value = True) Then
    '---- Turn tortuosity(time) correlation ON!
    Component(0).Use_Tortuosity_Correlation = True
    Component(0).Constant_Tortuosity = False
    'frmprint!chkSelect(4).Enabled = True
    '---- Update SPDFR to 1.000e-30!
    Component(0).SPDFR = 1E-30
    'txtSPDFR.Text = "1.000E-30"
    'txtSPDFR = Format_It(Component(0).SPDFR, 3)
    Call frmKinetic_Refresh
        'THIS REDISPLAYS txtSPDFR AND lblKF,lblDS,lblDP.
    '---- LOCK SPDFR.
    txtSPDFR.Locked = True
  Else
    '---- Turn tortuosity(time) correlation OFF!
    Component(0).Use_Tortuosity_Correlation = False
    Component(0).Constant_Tortuosity = False
    'frmprint!chkSelect(4).Enabled = False
    '---- UNLOCK SPDFR.
    txtSPDFR.Locked = False
  End If
  'lblDS = Format$(Ds(0), "0.00E+00")
  Call Update_Ds_and_Dp_Editability
  Call Update_Tortuosity_Display
  'THROW DIRTY FLAG.
  Call frmKinetic_DirtyStatus_Throw
  'REFRESH WINDOW.
  Call frmKinetic_Refresh
End Sub


Private Sub cmdCancelOK_Click(Index As Integer)
  Select Case Index
    Case 0:     'CANCEL.
      'ROLLBACK TO ORIGINAL COMPONENT DATA.
      Component(0) = SaveOldComponent
      'EXIT OUT OF HERE.
      USER_HIT_CANCEL = True
      USER_HIT_OK = False
      Unload Me
      Exit Sub
    Case 1:     'OK.
      'SAVE USER/CORRELATION SELECTION OPTIONBOXES.
      Component(0).Corr(1) = optKF(1).Value
      Component(0).Corr(2) = optDS(1).Value
      Component(0).Corr(3) = optDP(1).Value
      'SAVE USER INPUT FOR KF/DS/DP/SPDFR.
      Component(0).KP_User_Input(1) = CDbl(txtKF)
      Component(0).KP_User_Input(2) = CDbl(txtDS)
      Component(0).KP_User_Input(3) = CDbl(txtDP)
      Component(0).SPDFR = CDbl(txtSPDFR)
      'SAVE CURRENT VALUES FOR KF/DS/DP.
      If optKF(0).Value = True Then
        Component(0).kf = CDbl(txtKF)
      Else
        Component(0).kf = kf(0)
      End If
      If optDS(0).Value = True Then
        Component(0).Ds = CDbl(txtDS)
      Else
        Component(0).Ds = Ds(0)
      End If
      If optDP(0).Value = True Then
        Component(0).Dp = CDbl(txtDP)
      Else
        Component(0).Dp = Dp(0)
      End If
      'SAVE CURRENT VALUE FOR TORTUOSITY AND CORRELATION SETTINGS.
      If (chkTortuosity_Corr.Value) Then
        Component(0).Use_Tortuosity_Correlation = True
        Component(0).Constant_Tortuosity = False
        Component(0).Tortuosity = 1
      Else
        Component(0).Use_Tortuosity_Correlation = False
        Component(0).Constant_Tortuosity = False
        Component(0).Tortuosity = txtTort   'iffy conversion here!
      End If
      'EXIT OUT OF HERE.
      USER_HIT_CANCEL = False
      USER_HIT_OK = True
      Unload Me
      Exit Sub
  End Select
End Sub


Private Sub Form_Load()
Dim i As Integer
  'MISC INITS.
  Me.Height = 6450
  Me.Width = 8535
  Call CenterOnForm(Me, frmCompoProp)
  Me.Caption = "Kinetic Parameters for " & Trim$(Component(0).Name)
  lblUnit(1) = "cm" & Chr$(178) & "/s"
  lblUnit(2) = "cm" & Chr$(178) & "/s"
  'TORTUOSITY CORRELATION DISPLAY.
  lblTortCorrelation.Visible = False
  If (Component(0).Use_Tortuosity_Correlation) Then
    chkTortuosity_Corr.Value = True
  Else
    chkTortuosity_Corr.Value = False
  End If
  'DISPLAY USER/CORRELATION SELECTION OPTIONBOXES.
  optKF(0).Value = Not (Component(0).Corr(1))
  optKF(1).Value = Component(0).Corr(1)
  optDS(0).Value = Not (Component(0).Corr(2))
  optDS(1).Value = Component(0).Corr(2)
  optDP(0).Value = Not (Component(0).Corr(3))
  optDP(1).Value = Component(0).Corr(3)
  For i = 0 To 1
    optKF(i).Enabled = True
    optDS(i).Enabled = True
    optDP(i).Enabled = True
  Next i
  'SAVE OLD COMPONENT FOR CANCEL ROLLBACK.
  SaveOldComponent = Component(0)
  'POPULATE UNIT CONTROLS.
  Call frmKinetic_PopulateUnits
  'DATA UNCHANGED AS YET.
  Call frmKinetic_DirtyStatus_Clear
  Call frmKinetic_GenericStatus_Set("")
  'REFRESH DISPLAY.
  Call frmKinetic_Refresh
End Sub
Private Sub Form_Unload(Cancel As Integer)
  Call unitsys_unregister_all_on_form(Me)
End Sub




Private Sub UCtl_GotFocus(Ctl As Control)
Dim StatusMessagePanel As String
  Call unitsys_control_txtx_gotfocus(Ctl)
  If (Trim$(UCase$(Ctl.Name)) = Trim$(UCase$("txtKF"))) Then
    StatusMessagePanel = "Type in the user-input film diffusion coefficient"
  ElseIf (Trim$(UCase$(Ctl.Name)) = Trim$(UCase$("txtDS"))) Then
    StatusMessagePanel = "Type in the user-input surface diffusion coefficient"
  ElseIf (Trim$(UCase$(Ctl.Name)) = Trim$(UCase$("txtDP"))) Then
    StatusMessagePanel = "Type in the user-input pore diffusion coefficient"
  ElseIf (Trim$(UCase$(Ctl.Name)) = Trim$(UCase$("txtSPDFR"))) Then
    StatusMessagePanel = "Type in the user-input surface-to-pore diffusion flux ratio"
  ElseIf (Trim$(UCase$(Ctl.Name)) = Trim$(UCase$("txtTort"))) Then
    StatusMessagePanel = "Type in the user-input tortuosity"
  Else
    'NOT RECOGNIZED -- DO NOTHING.
  End If
  Call frmKinetic_GenericStatus_Set(StatusMessagePanel)
End Sub
Sub UCtl_LostFocus(Ctl As Control)
Dim NewValue_Okay As Integer
Dim NewValue As Double
Dim Val_Low As Double
Dim Val_High As Double
Dim Raise_Dirty_Flag As Boolean
  'NOTE: LOW AND HIGH VALUES IN BASE UNITS.
  If (Trim$(UCase$(Ctl.Name)) = Trim$(UCase$("txtKF"))) Then
    Val_Low = 1E-40: Val_High = 1E+40
  ElseIf (Trim$(UCase$(Ctl.Name)) = Trim$(UCase$("txtDS"))) Then
    Val_Low = 1E-40: Val_High = 1E+40
  ElseIf (Trim$(UCase$(Ctl.Name)) = Trim$(UCase$("txtDP"))) Then
    Val_Low = 1E-40: Val_High = 1E+40
  ElseIf (Trim$(UCase$(Ctl.Name)) = Trim$(UCase$("txtSPDFR"))) Then
    Val_Low = 1E-40: Val_High = 1E+40
  ElseIf (Trim$(UCase$(Ctl.Name)) = Trim$(UCase$("txtTort"))) Then
    Val_Low = 1E-40: Val_High = 1E+40
  Else
    'NOT RECOGNIZED -- DO NOTHING.
  End If
  NewValue_Okay = False
  If (unitsys_control_txtx_lostfocus_validate(Ctl, Val_Low, Val_High, NewValue, Raise_Dirty_Flag)) Then
    NewValue_Okay = True
  End If
  Call unitsys_control_txtx_lostfocus(Ctl, NewValue)
  Call frmKinetic_GenericStatus_Set("")
  If (NewValue_Okay) Then
    If (Raise_Dirty_Flag) Then
      'STORE TO MEMORY.
      If (Trim$(UCase$(Ctl.Name)) = Trim$(UCase$("txtKF"))) Then
        Component(0).KP_User_Input(1) = NewValue
      ElseIf (Trim$(UCase$(Ctl.Name)) = Trim$(UCase$("txtDS"))) Then
        Component(0).KP_User_Input(2) = NewValue
      ElseIf (Trim$(UCase$(Ctl.Name)) = Trim$(UCase$("txtDP"))) Then
        Component(0).KP_User_Input(3) = NewValue
      ElseIf (Trim$(UCase$(Ctl.Name)) = Trim$(UCase$("txtSPDFR"))) Then
        Component(0).SPDFR = NewValue
      ElseIf (Trim$(UCase$(Ctl.Name)) = Trim$(UCase$("txtTort"))) Then
        Component(0).Tortuosity = NewValue
      Else
        'NOT RECOGNIZED -- DO NOTHING.
      End If
      'RAISE DIRTY FLAG IF NECESSARY.
      If (Raise_Dirty_Flag) Then
        'THROW DIRTY FLAG.
        Call frmKinetic_DirtyStatus_Throw
      End If
      'REFRESH WINDOW.
      Call frmKinetic_Refresh
    End If
  End If
End Sub


Private Sub optDP_Click(Index As Integer)
  'THROW DIRTY FLAG.
  Call frmKinetic_DirtyStatus_Throw
  'REFRESH WINDOW.
  Call frmKinetic_Refresh
End Sub
Private Sub optDS_Click(Index As Integer)
  'THROW DIRTY FLAG.
  Call frmKinetic_DirtyStatus_Throw
  'REFRESH WINDOW.
  Call frmKinetic_Refresh
End Sub
Private Sub optKF_Click(Index As Integer)
  'THROW DIRTY FLAG.
  Call frmKinetic_DirtyStatus_Throw
  'REFRESH WINDOW.
  Call frmKinetic_Refresh
End Sub


Private Sub txtDP_GotFocus()
  Dim Ctl As Control: Set Ctl = txtDP: Call UCtl_GotFocus(Ctl)
End Sub
Private Sub txtDP_KeyPress(KeyAscii As Integer)
  KeyAscii = Global_NumericKeyPress(KeyAscii)
End Sub
Private Sub txtDP_LostFocus()
  Dim Ctl As Control: Set Ctl = txtDP: Call UCtl_LostFocus(Ctl)
End Sub

Private Sub txtDS_GotFocus()
  Dim Ctl As Control: Set Ctl = txtDS: Call UCtl_GotFocus(Ctl)
End Sub
Private Sub txtDS_KeyPress(KeyAscii As Integer)
  KeyAscii = Global_NumericKeyPress(KeyAscii)
End Sub
Private Sub txtDS_LostFocus()
  Dim Ctl As Control: Set Ctl = txtDS: Call UCtl_LostFocus(Ctl)
End Sub

Private Sub txtKF_GotFocus()
  Dim Ctl As Control: Set Ctl = txtKF: Call UCtl_GotFocus(Ctl)
End Sub
Private Sub txtKF_KeyPress(KeyAscii As Integer)
  KeyAscii = Global_NumericKeyPress(KeyAscii)
End Sub
Private Sub txtKF_LostFocus()
  Dim Ctl As Control: Set Ctl = txtKF: Call UCtl_LostFocus(Ctl)
End Sub

Private Sub txtSPDFR_GotFocus()
  Dim Ctl As Control: Set Ctl = txtSPDFR: Call UCtl_GotFocus(Ctl)
End Sub
Private Sub txtSPDFR_KeyPress(KeyAscii As Integer)
  KeyAscii = Global_NumericKeyPress(KeyAscii)
End Sub
Private Sub txtSPDFR_LostFocus()
  Dim Ctl As Control: Set Ctl = txtSPDFR: Call UCtl_LostFocus(Ctl)
End Sub

Private Sub txtTort_GotFocus()
  Dim Ctl As Control: Set Ctl = txtTort: Call UCtl_GotFocus(Ctl)
End Sub
Private Sub txtTort_KeyPress(KeyAscii As Integer)
  KeyAscii = Global_NumericKeyPress(KeyAscii)
End Sub
Private Sub txtTort_LostFocus()
  Dim Ctl As Control: Set Ctl = txtTort: Call UCtl_LostFocus(Ctl)
End Sub



VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "Threed32.ocx"
Object = "{B16553C3-06DB-101B-85B2-0000C009BE81}#1.0#0"; "Spin32.ocx"
Object = "{F9043C88-F6F2-101A-A3C9-08002B2F49FB}#1.2#0"; "Comdlg32.ocx"
Begin VB.Form frmMain 
   Appearance      =   0  'Flat
   BackColor       =   &H00C0C0C0&
   BorderStyle     =   1  'Fixed Single
   Caption         =   "AdDesignS"
   ClientHeight    =   6915
   ClientLeft      =   2100
   ClientTop       =   2145
   ClientWidth     =   9555
   BeginProperty Font 
      Name            =   "MS Sans Serif"
      Size            =   8.25
      Charset         =   0
      Weight          =   700
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   ForeColor       =   &H80000008&
   Icon            =   "Main.frx":0000
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   PaletteMode     =   1  'UseZOrder
   ScaleHeight     =   461
   ScaleMode       =   3  'Pixel
   ScaleWidth      =   637
   Begin Threed.SSFrame ssframe_Adsorbent 
      Height          =   2895
      Left            =   4710
      TabIndex        =   43
      Top             =   3540
      Width           =   4605
      _Version        =   65536
      _ExtentX        =   8123
      _ExtentY        =   5106
      _StockProps     =   14
      Caption         =   "Adsorbent Properties:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.CommandButton cmdViewDimensionless 
         Appearance      =   0  'Flat
         Caption         =   "D&imensionless Groups"
         Height          =   315
         Left            =   120
         TabIndex        =   84
         TabStop         =   0   'False
         Top             =   2310
         Width           =   2167
      End
      Begin VB.TextBox txtCarbon 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         Height          =   285
         Index           =   0
         Left            =   2040
         TabIndex        =   13
         Text            =   "Test"
         Top             =   630
         Width           =   2415
      End
      Begin VB.ComboBox txtCarbonUnits 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Height          =   315
         Index           =   2
         Left            =   3300
         Style           =   2  'Dropdown List
         TabIndex        =   83
         TabStop         =   0   'False
         Top             =   1260
         Width           =   1200
      End
      Begin VB.ComboBox txtCarbonUnits 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Height          =   315
         Index           =   1
         Left            =   3300
         Style           =   2  'Dropdown List
         TabIndex        =   82
         TabStop         =   0   'False
         Top             =   930
         Width           =   1200
      End
      Begin VB.TextBox txtCarbon 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         Height          =   285
         Index           =   3
         Left            =   2040
         TabIndex        =   16
         Text            =   "Test"
         Top             =   1620
         Width           =   1215
      End
      Begin VB.TextBox txtCarbon 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         Height          =   285
         Index           =   2
         Left            =   2040
         TabIndex        =   15
         Text            =   "Test"
         Top             =   1290
         Width           =   1215
      End
      Begin VB.TextBox txtCarbon 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         Height          =   285
         Index           =   1
         Left            =   2040
         TabIndex        =   14
         Text            =   "Test"
         Top             =   960
         Width           =   1215
      End
      Begin VB.CommandButton cmdCarbon 
         Appearance      =   0  'Flat
         Caption         =   "Adsorbe&nt Database"
         Height          =   315
         Left            =   120
         TabIndex        =   81
         TabStop         =   0   'False
         Top             =   270
         Width           =   4335
      End
      Begin VB.CommandButton cmdpolanyi 
         Appearance      =   0  'Flat
         Caption         =   "Polan&yi Parameters"
         Height          =   315
         Left            =   2340
         TabIndex        =   80
         TabStop         =   0   'False
         Top             =   2310
         Width           =   2115
      End
      Begin VB.TextBox txtCarbon 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         Height          =   285
         Index           =   4
         Left            =   2040
         TabIndex        =   17
         Text            =   "Test"
         Top             =   1950
         Width           =   1215
      End
      Begin VB.Label lblMiscUnits 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "-"
         ForeColor       =   &H80000008&
         Height          =   315
         Index           =   0
         Left            =   3300
         TabIndex        =   91
         Top             =   1650
         Width           =   1200
      End
      Begin VB.Label lblCarbon 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BackStyle       =   0  'Transparent
         Caption         =   "Porosity"
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   240
         TabIndex        =   90
         Top             =   1650
         Width           =   1695
      End
      Begin VB.Label lblCarbon 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BackStyle       =   0  'Transparent
         Caption         =   "Particle Radius"
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   240
         TabIndex        =   89
         Top             =   1320
         Width           =   1695
      End
      Begin VB.Label lblCarbon 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BackStyle       =   0  'Transparent
         Caption         =   "Apparent Density"
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   240
         TabIndex        =   88
         Top             =   990
         Width           =   1695
      End
      Begin VB.Label lblCarbon 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BackStyle       =   0  'Transparent
         Caption         =   "Name"
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   240
         TabIndex        =   87
         Top             =   660
         Width           =   1695
      End
      Begin VB.Label lblCarbon 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BackStyle       =   0  'Transparent
         Caption         =   "Particle Shape Factor"
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   60
         TabIndex        =   86
         Top             =   1980
         Width           =   1875
      End
      Begin VB.Label lblMiscUnits 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "-"
         ForeColor       =   &H80000008&
         Height          =   315
         Index           =   1
         Left            =   3300
         TabIndex        =   85
         Top             =   1980
         Width           =   1200
      End
   End
   Begin Threed.SSFrame ssframe_FixedBed 
      Height          =   3435
      Left            =   4710
      TabIndex        =   42
      Top             =   60
      Width           =   4605
      _Version        =   65536
      _ExtentX        =   8123
      _ExtentY        =   6059
      _StockProps     =   14
      Caption         =   "Fixed Bed Properties:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.CommandButton cmdNote 
         Height          =   675
         Index           =   0
         Left            =   120
         Picture         =   "Main.frx":030A
         Style           =   1  'Graphical
         TabIndex        =   93
         Top             =   1500
         Width           =   555
      End
      Begin VB.CommandButton cmdNote 
         Height          =   675
         Index           =   1
         Left            =   240
         Picture         =   "Main.frx":074C
         Style           =   1  'Graphical
         TabIndex        =   94
         Top             =   1560
         Width           =   555
      End
      Begin VB.ComboBox txtBedUnits 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Height          =   315
         Index           =   4
         Left            =   3300
         Style           =   2  'Dropdown List
         TabIndex        =   62
         TabStop         =   0   'False
         Top             =   1830
         Width           =   1200
      End
      Begin VB.ComboBox txtBedUnits 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Height          =   315
         Index           =   3
         Left            =   3300
         Style           =   2  'Dropdown List
         TabIndex        =   61
         TabStop         =   0   'False
         Top             =   1530
         Width           =   1200
      End
      Begin VB.ComboBox txtBedUnits 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Height          =   315
         Index           =   2
         Left            =   3300
         Style           =   2  'Dropdown List
         TabIndex        =   60
         TabStop         =   0   'False
         Top             =   1230
         Width           =   1200
      End
      Begin VB.ComboBox txtBedUnits 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Height          =   315
         Index           =   1
         Left            =   3300
         Style           =   2  'Dropdown List
         TabIndex        =   59
         TabStop         =   0   'False
         Top             =   930
         Width           =   1200
      End
      Begin VB.ComboBox txtBedUnits 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Height          =   315
         Index           =   0
         Left            =   3300
         Style           =   2  'Dropdown List
         TabIndex        =   58
         TabStop         =   0   'False
         Top             =   630
         Width           =   1200
      End
      Begin VB.TextBox txtBedValue 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         Height          =   288
         HelpContextID   =   20
         Index           =   0
         Left            =   2040
         TabIndex        =   8
         Text            =   "Test"
         Top             =   660
         Width           =   1215
      End
      Begin VB.TextBox txtBedValue 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         Height          =   288
         HelpContextID   =   20
         Index           =   1
         Left            =   2040
         TabIndex        =   9
         Text            =   "Test"
         Top             =   960
         Width           =   1215
      End
      Begin VB.TextBox txtBedValue 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         Height          =   288
         HelpContextID   =   20
         Index           =   2
         Left            =   2040
         TabIndex        =   10
         Text            =   "Test"
         Top             =   1260
         Width           =   1215
      End
      Begin VB.TextBox txtBedValue 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         Height          =   288
         HelpContextID   =   20
         Index           =   3
         Left            =   2040
         TabIndex        =   11
         Text            =   "Test"
         Top             =   1560
         Width           =   1215
      End
      Begin VB.TextBox txtBedValue 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         Height          =   288
         HelpContextID   =   20
         Index           =   4
         Left            =   2040
         TabIndex        =   12
         Text            =   "Test"
         Top             =   1860
         Width           =   1215
      End
      Begin VB.CommandButton cmdAdsorberDB 
         Appearance      =   0  'Flat
         Caption         =   "Adsor&ber Database"
         Height          =   315
         Left            =   120
         TabIndex        =   57
         TabStop         =   0   'False
         Top             =   270
         Width           =   4335
      End
      Begin VB.Label lblBed 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BackStyle       =   0  'Transparent
         Caption         =   "Bed Length"
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   240
         TabIndex        =   79
         Top             =   690
         Width           =   1695
      End
      Begin VB.Label lblBed 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BackStyle       =   0  'Transparent
         Caption         =   "Bed Diameter"
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   240
         TabIndex        =   78
         Top             =   990
         Width           =   1695
      End
      Begin VB.Label lblBed 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BackStyle       =   0  'Transparent
         Caption         =   "Bed Mass"
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   360
         TabIndex        =   77
         Top             =   1290
         Width           =   1575
      End
      Begin VB.Label lblBed 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BackStyle       =   0  'Transparent
         Caption         =   "Flowrate"
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   240
         TabIndex        =   76
         Top             =   1590
         Width           =   1695
      End
      Begin VB.Label lblBed 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BackStyle       =   0  'Transparent
         Caption         =   "EBCT"
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   240
         TabIndex        =   75
         Top             =   1890
         Width           =   1710
      End
      Begin VB.Label lblBedDensityDisplay 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "Test"
         ForeColor       =   &H00808080&
         Height          =   285
         Left            =   2040
         TabIndex        =   74
         Top             =   2175
         Width           =   1215
      End
      Begin VB.Label lblBed 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BackStyle       =   0  'Transparent
         Caption         =   "Bed Density"
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   240
         TabIndex        =   73
         Top             =   2190
         Width           =   1710
      End
      Begin VB.Label lblMiscUnits 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "(g/mL)"
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   3300
         TabIndex        =   72
         Top             =   2190
         Width           =   1200
      End
      Begin VB.Label lblporosity 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "Test"
         ForeColor       =   &H00808080&
         Height          =   285
         Left            =   2040
         TabIndex        =   71
         Top             =   2490
         Width           =   1215
      End
      Begin VB.Label lblInterstitialVelocity 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "Test"
         ForeColor       =   &H00808080&
         Height          =   285
         Left            =   2040
         TabIndex        =   70
         Top             =   3090
         Width           =   1215
      End
      Begin VB.Label lblSuperficialVelocity 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "Test"
         ForeColor       =   &H00808080&
         Height          =   285
         Left            =   2040
         TabIndex        =   69
         Top             =   2790
         Width           =   1215
      End
      Begin VB.Label lblMiscUnits 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "(m/hr)"
         ForeColor       =   &H80000008&
         Height          =   220
         Index           =   3
         Left            =   3300
         TabIndex        =   68
         Top             =   3105
         Width           =   1200
      End
      Begin VB.Label lblMiscUnits 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "(m/hr)"
         ForeColor       =   &H80000008&
         Height          =   315
         Index           =   4
         Left            =   3300
         TabIndex        =   67
         Top             =   2805
         Width           =   1200
      End
      Begin VB.Label lblMiscUnits 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "-"
         ForeColor       =   &H80000008&
         Height          =   315
         Index           =   5
         Left            =   3300
         TabIndex        =   66
         Top             =   2505
         Width           =   1200
      End
      Begin VB.Label lblBed 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BackStyle       =   0  'Transparent
         Caption         =   "Interstitial Velocity"
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   7
         Left            =   240
         TabIndex        =   65
         Top             =   3105
         Width           =   1710
      End
      Begin VB.Label lblBed 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BackStyle       =   0  'Transparent
         Caption         =   "Superficial Velocity"
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   8
         Left            =   240
         TabIndex        =   64
         Top             =   2805
         Width           =   1710
      End
      Begin VB.Label lblBed 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BackStyle       =   0  'Transparent
         Caption         =   "Bed Porosity"
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   9
         Left            =   240
         TabIndex        =   63
         Top             =   2505
         Width           =   1710
      End
   End
   Begin Threed.SSFrame ssframe_PSDM 
      Height          =   3195
      Left            =   120
      TabIndex        =   41
      Top             =   3240
      Width           =   4605
      _Version        =   65536
      _ExtentX        =   8123
      _ExtentY        =   5636
      _StockProps     =   14
      Caption         =   "Simulation Parameters for PSDM Only:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.CommandButton cmdParamsPSDMInRoom 
         Appearance      =   0  'Flat
         Caption         =   "Edit Parameters for PSDM In Room Model"
         Height          =   315
         Left            =   150
         TabIndex        =   95
         TabStop         =   0   'False
         Top             =   2820
         Width           =   4305
      End
      Begin VB.TextBox txtTime 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         Height          =   285
         Index           =   0
         Left            =   2100
         TabIndex        =   2
         Text            =   "txtTime"
         Top             =   300
         Width           =   1215
      End
      Begin VB.TextBox txtTime 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         Height          =   285
         Index           =   1
         Left            =   2100
         TabIndex        =   3
         Text            =   "txtTime"
         Top             =   660
         Width           =   1215
      End
      Begin VB.TextBox txtTime 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         Height          =   285
         Index           =   2
         Left            =   2100
         TabIndex        =   4
         Text            =   "txtTime"
         Top             =   1020
         Width           =   1215
      End
      Begin VB.TextBox txtNumberOfBeds 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         Height          =   285
         Left            =   2880
         TabIndex        =   5
         Text            =   "Test"
         Top             =   1380
         Width           =   735
      End
      Begin VB.ComboBox txtTimeUnits 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Height          =   315
         Index           =   0
         Left            =   3360
         Style           =   2  'Dropdown List
         TabIndex        =   46
         TabStop         =   0   'False
         Top             =   270
         Width           =   1035
      End
      Begin VB.ComboBox txtTimeUnits 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Height          =   315
         Index           =   1
         Left            =   3360
         Style           =   2  'Dropdown List
         TabIndex        =   45
         TabStop         =   0   'False
         Top             =   630
         Width           =   1035
      End
      Begin VB.ComboBox txtTimeUnits 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Height          =   315
         Index           =   2
         Left            =   3360
         Style           =   2  'Dropdown List
         TabIndex        =   44
         TabStop         =   0   'False
         Top             =   990
         Width           =   1035
      End
      Begin Threed.SSFrame Frame3D2 
         Height          =   1065
         Left            =   120
         TabIndex        =   47
         Top             =   1680
         Width           =   4335
         _Version        =   65536
         _ExtentX        =   7646
         _ExtentY        =   1879
         _StockProps     =   14
         Caption         =   "Number of Collocation Points:"
         ForeColor       =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ShadowColor     =   1
         Begin VB.TextBox txtNPoint 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            Height          =   285
            Index           =   0
            Left            =   2760
            TabIndex        =   6
            Text            =   "Test"
            Top             =   300
            Width           =   735
         End
         Begin VB.TextBox txtNPoint 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            Height          =   285
            Index           =   1
            Left            =   2760
            TabIndex        =   7
            Text            =   "Test"
            Top             =   660
            Width           =   735
         End
         Begin Spin.SpinButton spnPoint 
            Height          =   285
            Index           =   1
            Left            =   3480
            TabIndex        =   48
            Top             =   660
            Width           =   255
            _Version        =   65536
            _ExtentX        =   2646
            _ExtentY        =   1323
            _StockProps     =   73
         End
         Begin Spin.SpinButton spnPoint 
            Height          =   285
            Index           =   0
            Left            =   3480
            TabIndex        =   49
            Top             =   300
            Width           =   255
            _Version        =   65536
            _ExtentX        =   2646
            _ExtentY        =   1323
            _StockProps     =   73
         End
         Begin VB.Label lblText 
            Alignment       =   1  'Right Justify
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            Caption         =   "Axial Direction"
            ForeColor       =   &H80000008&
            Height          =   255
            Index           =   0
            Left            =   540
            TabIndex        =   51
            Top             =   330
            Width           =   1875
         End
         Begin VB.Label lblText 
            Alignment       =   1  'Right Justify
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            Caption         =   "Radial Direction"
            ForeColor       =   &H80000008&
            Height          =   255
            Index           =   1
            Left            =   540
            TabIndex        =   50
            Top             =   690
            Width           =   1875
         End
      End
      Begin Spin.SpinButton spnNumberOfBeds 
         Height          =   285
         Left            =   3600
         TabIndex        =   52
         Top             =   1380
         Width           =   255
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   73
      End
      Begin VB.Label lblTime 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Total Run Time"
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   180
         TabIndex        =   56
         Top             =   330
         Width           =   1875
      End
      Begin VB.Label lblTime 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "First Point Displayed"
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   180
         TabIndex        =   55
         Top             =   690
         Width           =   1875
      End
      Begin VB.Label lblTime 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Time Step"
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   180
         TabIndex        =   54
         Top             =   1050
         Width           =   1875
      End
      Begin VB.Label lblAxialElementsDesc 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Number of Axial Elements"
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   240
         TabIndex        =   53
         Top             =   1410
         Width           =   2475
      End
   End
   Begin Threed.SSFrame ssframe_Component 
      Height          =   2145
      Left            =   120
      TabIndex        =   35
      Top             =   1050
      Width           =   4605
      _Version        =   65536
      _ExtentX        =   8123
      _ExtentY        =   3784
      _StockProps     =   14
      Caption         =   "Component Properties:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.CommandButton cmdADEComponent 
         Appearance      =   0  'Flat
         Caption         =   "&Edit Properties"
         Height          =   315
         HelpContextID   =   20
         Index           =   2
         Left            =   2820
         TabIndex        =   40
         TabStop         =   0   'False
         Top             =   1710
         Width           =   1515
      End
      Begin VB.CommandButton cmdADEComponent 
         Appearance      =   0  'Flat
         Caption         =   "De&lete"
         Height          =   315
         HelpContextID   =   20
         Index           =   1
         Left            =   1800
         TabIndex        =   39
         TabStop         =   0   'False
         Top             =   1710
         Width           =   975
      End
      Begin VB.CommandButton cmdADEComponent 
         Appearance      =   0  'Flat
         Caption         =   "&Add"
         Height          =   315
         HelpContextID   =   20
         Index           =   0
         Left            =   240
         TabIndex        =   38
         TabStop         =   0   'False
         Top             =   1710
         Width           =   1035
      End
      Begin VB.ListBox lstComponents 
         Height          =   1035
         HelpContextID   =   20
         Left            =   120
         MultiSelect     =   1  'Simple
         TabIndex        =   37
         TabStop         =   0   'False
         Top             =   270
         Width           =   4335
      End
      Begin VB.ComboBox cboSelectCompo 
         Appearance      =   0  'Flat
         Height          =   315
         Left            =   240
         Style           =   2  'Dropdown List
         TabIndex        =   36
         TabStop         =   0   'False
         Top             =   1350
         Width           =   4095
      End
   End
   Begin Threed.SSFrame ssframe_Water 
      Height          =   945
      Left            =   120
      TabIndex        =   29
      Top             =   60
      Width           =   4605
      _Version        =   65536
      _ExtentX        =   8123
      _ExtentY        =   1667
      _StockProps     =   14
      Caption         =   "Water Properties:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.CommandButton cmdWaterCorrelations 
         Appearance      =   0  'Flat
         Caption         =   "Correlations"
         Height          =   615
         Left            =   2940
         TabIndex        =   30
         TabStop         =   0   'False
         Top             =   240
         Width           =   1515
      End
      Begin VB.TextBox txtWater 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         Height          =   288
         HelpContextID   =   20
         Index           =   1
         Left            =   1260
         TabIndex        =   0
         Text            =   "txtWater(1)"
         Top             =   270
         Width           =   1092
      End
      Begin VB.TextBox txtWater 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         Height          =   288
         HelpContextID   =   20
         Index           =   0
         Left            =   1260
         TabIndex        =   1
         Text            =   "txtWater(0)"
         Top             =   575
         Width           =   1092
      End
      Begin VB.Label lblWater 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Pressure"
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   30
         TabIndex        =   34
         Top             =   300
         Width           =   1125
      End
      Begin VB.Label lblWater 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Temperature"
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   30
         TabIndex        =   33
         Top             =   600
         Width           =   1125
      End
      Begin VB.Label lblWaterUnit 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "lblWaterUnit(1)"
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   2400
         TabIndex        =   32
         Top             =   300
         Width           =   495
      End
      Begin VB.Label lblWaterUnit 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "lblWaterUnit(0)"
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   2400
         TabIndex        =   31
         Top             =   600
         Width           =   495
      End
   End
   Begin Threed.SSFrame SSFrame2 
      Height          =   3765
      Left            =   10770
      TabIndex        =   21
      Top             =   1710
      Visible         =   0   'False
      Width           =   4425
      _Version        =   65536
      _ExtentX        =   7805
      _ExtentY        =   6641
      _StockProps     =   14
      Caption         =   "Old -- Invisible"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.ComboBox Combo1 
         Height          =   315
         Left            =   2580
         Style           =   2  'Dropdown List
         TabIndex        =   28
         Top             =   1410
         Width           =   1245
      End
      Begin Threed.SSFrame SSFrame1 
         Height          =   3015
         Left            =   240
         TabIndex        =   22
         Top             =   300
         Width           =   2115
         _Version        =   65536
         _ExtentX        =   3731
         _ExtentY        =   5318
         _StockProps     =   14
         Caption         =   "SSFrame1"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Begin VB.ListBox List1 
            Height          =   450
            Left            =   330
            TabIndex        =   25
            Top             =   2370
            Width           =   1245
         End
         Begin VB.CommandButton Command1 
            Caption         =   "Command1"
            Height          =   525
            Left            =   330
            TabIndex        =   24
            Top             =   510
            Width           =   1245
         End
         Begin VB.TextBox Text1 
            Height          =   525
            Left            =   300
            TabIndex        =   23
            Text            =   "Text1"
            Top             =   1080
            Width           =   1245
         End
         Begin VB.Label Label1 
            Caption         =   "Label1"
            Height          =   525
            Left            =   330
            TabIndex        =   26
            Top             =   1710
            Width           =   1245
         End
      End
      Begin Spin.SpinButton SpinButton1 
         Height          =   765
         Left            =   2520
         TabIndex        =   27
         Top             =   480
         Width           =   825
         _Version        =   65536
         _ExtentX        =   1455
         _ExtentY        =   1349
         _StockProps     =   73
         ForeColor       =   -2147483630
         BackColor       =   -2147483633
      End
   End
   Begin Threed.SSPanel SSPanel2 
      Align           =   2  'Align Bottom
      Height          =   405
      Left            =   0
      TabIndex        =   18
      Top             =   6510
      Width           =   9555
      _Version        =   65536
      _ExtentX        =   16854
      _ExtentY        =   714
      _StockProps     =   15
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin Threed.SSPanel sspanel_Dirty 
         Height          =   285
         Left            =   60
         TabIndex        =   19
         Top             =   60
         Width           =   2115
         _Version        =   65536
         _ExtentX        =   3731
         _ExtentY        =   503
         _StockProps     =   15
         Caption         =   "sspanel_Dirty"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelOuter      =   1
      End
      Begin Threed.SSPanel sspanel_Status 
         Height          =   285
         Left            =   2220
         TabIndex        =   20
         Top             =   60
         Width           =   7185
         _Version        =   65536
         _ExtentX        =   12674
         _ExtentY        =   503
         _StockProps     =   15
         Caption         =   "sspanel_Status"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelOuter      =   1
      End
   End
   Begin Threed.SSFrame SSFrame4 
      Height          =   1035
      Left            =   9750
      TabIndex        =   92
      Top             =   270
      Visible         =   0   'False
      Width           =   3015
      _Version        =   65536
      _ExtentX        =   5318
      _ExtentY        =   1826
      _StockProps     =   14
      Caption         =   "Used -- Invisible"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin MSComDlg.CommonDialog CommonDialog1 
         Left            =   240
         Top             =   240
         _ExtentX        =   847
         _ExtentY        =   847
         _Version        =   393216
      End
   End
   Begin VB.Menu mnuFile 
      Caption         =   "&File"
      Begin VB.Menu mnuFileItem 
         Caption         =   "&New"
         Index           =   0
         Shortcut        =   ^N
      End
      Begin VB.Menu mnuFileItem 
         Caption         =   "&Open ..."
         Index           =   1
         Shortcut        =   ^O
      End
      Begin VB.Menu mnuFileItem 
         Caption         =   "&Save"
         Index           =   2
         Shortcut        =   ^S
      End
      Begin VB.Menu mnuFileItem 
         Caption         =   "Save &As ..."
         Index           =   3
      End
      Begin VB.Menu mnuFileItem 
         Caption         =   "-"
         Index           =   5
      End
      Begin VB.Menu mnuFileItem 
         Caption         =   "Select P&rinter"
         Index           =   6
      End
      Begin VB.Menu mnuFileItem 
         Caption         =   "&Print ..."
         Index           =   7
         Begin VB.Menu mnuPrintSubItem 
            Caption         =   "To &Printer"
            Index           =   0
         End
         Begin VB.Menu mnuPrintSubItem 
            Caption         =   "To a &File"
            Index           =   1
         End
      End
      Begin VB.Menu mnuFileItem 
         Caption         =   "-"
         Index           =   190
      End
      Begin VB.Menu mnuFileItem 
         Caption         =   "&1 Old File #1"
         Index           =   191
         Visible         =   0   'False
      End
      Begin VB.Menu mnuFileItem 
         Caption         =   "&2 Old File #2"
         Index           =   192
         Visible         =   0   'False
      End
      Begin VB.Menu mnuFileItem 
         Caption         =   "&3 Old File #3"
         Index           =   193
         Visible         =   0   'False
      End
      Begin VB.Menu mnuFileItem 
         Caption         =   "&4 Old File #4"
         Index           =   194
         Visible         =   0   'False
      End
      Begin VB.Menu mnuFileItem 
         Caption         =   "-"
         Index           =   199
         Visible         =   0   'False
      End
      Begin VB.Menu mnuFileItem 
         Caption         =   "E&xit"
         Index           =   200
      End
   End
   Begin VB.Menu mnuPhase 
      Caption         =   "&Phase"
      Begin VB.Menu mnuPhaseItem 
         Caption         =   "&Liquid Phase"
         Checked         =   -1  'True
         Index           =   0
      End
      Begin VB.Menu mnuPhaseItem 
         Caption         =   "&Gas Phase"
         Index           =   1
      End
   End
   Begin VB.Menu mnuRun 
      Caption         =   "&Run"
      Begin VB.Menu mnuRunItem 
         Caption         =   "&PSDM"
         Index           =   0
         Shortcut        =   +{F3}
      End
      Begin VB.Menu mnuRunItem 
         Caption         =   "&CPHSDM"
         Index           =   1
         Shortcut        =   +{F4}
      End
      Begin VB.Menu mnuRunItem 
         Caption         =   "&ECM"
         Index           =   2
         Shortcut        =   +{F5}
      End
      Begin VB.Menu mnuRunItem 
         Caption         =   "PSDM in &Room"
         Index           =   10
      End
   End
   Begin VB.Menu mnuDisplay 
      Caption         =   "Re&sults"
      Begin VB.Menu mnuResultsItem 
         Caption         =   "&PSDM Results"
         Index           =   0
         Shortcut        =   {F3}
      End
      Begin VB.Menu mnuResultsItem 
         Caption         =   "&CPHSDM Results"
         Index           =   1
         Shortcut        =   {F4}
      End
      Begin VB.Menu mnuResultsItem 
         Caption         =   "&ECM Results"
         Index           =   2
         Shortcut        =   {F5}
      End
      Begin VB.Menu mnuResultsItem 
         Caption         =   "Compare PSDM Results to &Data"
         Index           =   3
         Shortcut        =   {F6}
      End
      Begin VB.Menu mnuResultsItem 
         Caption         =   "Compare CPHSDM Results to D&ata"
         Index           =   4
         Shortcut        =   {F7}
      End
      Begin VB.Menu mnuResultsItem 
         Caption         =   "PSDM in &Room Results"
         Index           =   10
         Visible         =   0   'False
      End
   End
   Begin VB.Menu mnuOptions 
      Caption         =   "&Options"
      Begin VB.Menu mnuOptionsItem 
         Caption         =   "&Fouling of GAC"
         Index           =   0
      End
      Begin VB.Menu mnuOptionsItem 
         Caption         =   "&Influent concentrations"
         Index           =   1
      End
      Begin VB.Menu mnuOptionsItem 
         Caption         =   "&Effluent concentrations"
         Index           =   2
      End
   End
   Begin VB.Menu mnuDatabase 
      Caption         =   "&Databases"
      Begin VB.Menu mnuDatabasesItem 
         Caption         =   "&Adsorbent Database"
         Index           =   0
      End
      Begin VB.Menu mnuDatabasesItem 
         Caption         =   "&Isotherm Database"
         Index           =   1
      End
      Begin VB.Menu mnuDatabasesItem 
         Caption         =   "A&dsorber Database"
         Index           =   2
      End
   End
   Begin VB.Menu mnuHelp 
      Caption         =   "&Help"
      Begin VB.Menu mnuHelpItem 
         Caption         =   "&Search ... (INVISIBLE)"
         Enabled         =   0   'False
         Index           =   0
         Visible         =   0   'False
      End
      Begin VB.Menu mnuHelpItem 
         Caption         =   "&How to use Help ... (INVISIBLE)"
         Enabled         =   0   'False
         Index           =   1
         Visible         =   0   'False
      End
      Begin VB.Menu mnuHelpItem 
         Caption         =   "&Online Help ..."
         Enabled         =   0   'False
         Index           =   10
      End
      Begin VB.Menu mnuHelpItem 
         Caption         =   "Online Manual ..."
         Index           =   20
      End
      Begin VB.Menu mnuHelpItem 
         Caption         =   "-"
         Index           =   30
      End
      Begin VB.Menu mnuHelpItem 
         Caption         =   "View Version History ..."
         Index           =   80
      End
      Begin VB.Menu mnuHelpItem 
         Caption         =   "View Disclaimer ..."
         Index           =   85
      End
      Begin VB.Menu mnuHelpItem 
         Caption         =   "&Technical Assistance Provided By ..."
         Index           =   90
      End
      Begin VB.Menu mnuHelpItem 
         Caption         =   "-"
         Index           =   98
      End
      Begin VB.Menu mnuHelpItem 
         Caption         =   "&About ..."
         Index           =   99
      End
   End
   Begin VB.Menu mnuOther 
      Caption         =   "Other"
      Index           =   5
      Visible         =   0   'False
      Begin VB.Menu mnuOtherItem 
         Caption         =   "&Technical Help"
         Index           =   1
      End
   End
   Begin VB.Menu mnuMTU 
      Caption         =   "&MTU Internal"
      Begin VB.Menu mnuMTUItem 
         Caption         =   "&Create alternate input file"
         Index           =   10
      End
      Begin VB.Menu mnuMTUItem 
         Caption         =   "&Keep temporary model files"
         Index           =   40
      End
      Begin VB.Menu mnuMTUItem 
         Caption         =   "&Make menu invisible"
         Index           =   50
      End
      Begin VB.Menu mnuMTUItem 
         Caption         =   "&Read me"
         Index           =   199
      End
   End
   Begin VB.Menu mnuUnused 
      Caption         =   "Unused"
      Visible         =   0   'False
      Begin VB.Menu mnuBatch 
         Caption         =   "&Batch Files"
      End
      Begin VB.Menu mnuBatchItem 
         Caption         =   "&PSDM"
         Index           =   0
         Visible         =   0   'False
      End
   End
End
Attribute VB_Name = "frmMain"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit






Const frmMain_declarations_end = True


Sub Avoid_Weird_Focus_Problem()
  Call unitsys_control_MostRecent_Force_lostfocus
  frmMain.lstComponents.SetFocus
End Sub


Sub Populate_frmMain_Units()
'  'Fixed Bed Properties:
'  Call Populate_Length_Units(txtBedUnits(0), LENGTH_M)
'  Call Populate_Length_Units(txtBedUnits(1), LENGTH_M)
'  Call Populate_Mass_Units(txtBedUnits(2), MASS_KG)
'  Call Populate_Flowrate_Units(txtBedUnits(3), FLOW_M3_per_S)
'  Call Populate_Time_Units(txtBedUnits(4), TIME_MIN)
'  'time properties
'  Call Populate_Time_Units(txttimeunits(0), TIME_D)
'  Call Populate_Time_Units(txttimeunits(1), TIME_D)
'  Call Populate_Time_Units(txttimeunits(2), TIME_D)
'  'Adsorbent Properties:
'  Call Populate_Density_Units(txtCarbonUnits(1), APPARENT_DENSITY_G_per_ML)
'  Call Populate_Length_Units(txtCarbonUnits(2), LENGTH_M)

  'WATER/AIR PROPERTIES.
  Call unitsys_register(frmMain, lblWater(1), txtWater(1), Nothing, "", _
      "", "", "", "", 100#, False)
  Call unitsys_register(frmMain, lblWater(0), txtWater(0), Nothing, "", _
      "", "", "", "", 100#, False)
  'PSDM PARAMETERS.
  Call unitsys_register(frmMain, lblTime(0), txtTime(0), txtTimeUnits(0), "time", _
      "d", "min", "", "", 100#, True)
  Call unitsys_register(frmMain, lblTime(1), txtTime(1), txtTimeUnits(1), "time", _
      "d", "min", "", "", 100#, True)
  Call unitsys_register(frmMain, lblTime(2), txtTime(2), txtTimeUnits(2), "time", _
      "d", "min", "", "", 100#, True)
  Call unitsys_register(frmMain, lblAxialElementsDesc, txtNumberOfBeds, Nothing, "", _
      "", "", "0", "0", 100#, False)
  Call unitsys_register(frmMain, lblText(0), txtNPoint(0), Nothing, "", _
      "", "", "0", "0", 100#, False)
  Call unitsys_register(frmMain, lblText(1), txtNPoint(1), Nothing, "", _
      "", "", "0", "0", 100#, False)
  'BED PROPERTIES.
  Call unitsys_register(frmMain, lblBed(0), txtBedValue(0), txtBedUnits(0), "length", _
      "m", "m", "", "", 100#, True)
  Call unitsys_register(frmMain, lblBed(1), txtBedValue(1), txtBedUnits(1), "length", _
      "m", "m", "", "", 100#, True)
  Call unitsys_register(frmMain, lblBed(2), txtBedValue(2), txtBedUnits(2), "mass", _
      "kg", "kg", "", "", 100#, True)
  Call unitsys_register(frmMain, lblBed(3), txtBedValue(3), txtBedUnits(3), "flow_volumetric", _
      "m/s", "m/s", "", "", 100#, True)
  Call unitsys_register(frmMain, lblBed(4), txtBedValue(4), txtBedUnits(4), "time", _
      "s", "s", "", "", 100#, True)
  'ADSORBENT PROPERTIES.
  Call unitsys_register(frmMain, lblCarbon(1), txtCarbon(1), txtCarbonUnits(1), "density", _
      "g/mL", "g/mL", "", "", 100#, True)
  Call unitsys_register(frmMain, lblCarbon(2), txtCarbon(2), txtCarbonUnits(2), "length", _
      "m", "m", "", "", 100#, True)
  Call unitsys_register(frmMain, lblCarbon(3), txtCarbon(3), Nothing, "", _
      "", "", "", "", 100#, False)
  Call unitsys_register(frmMain, lblCarbon(4), txtCarbon(4), Nothing, "", _
      "", "", "", "", 100#, False)
End Sub


Private Sub cmdADEComponent_Click(Index As Integer)
Dim Raise_Dirty_Flag As Boolean
Dim temp As String
Dim RetVal As Integer
Dim N As Integer
Dim i As Integer
Dim j As Integer
  Select Case Index
    Case 0:   'ADD.
      Call frmCompoProp.frmCompoProp_Add(Raise_Dirty_Flag)
      If (Raise_Dirty_Flag) Then
        'RAISE DIRTY FLAG.
        Call DirtyStatus_Throw
      End If
    Case 1:   'DELETE.
      If (cboSelectCompo.ListIndex = -1) Or _
          (cboSelectCompo.ListIndex > Number_Component - 1) Then
        Call Show_Error("You must first select a component.")
        Exit Sub
      End If
      temp = Trim$(cboSelectCompo.List(cboSelectCompo.ListIndex))
      RetVal = MsgBox("Do you really want to delete component '" & _
          temp & "' ?", vbQuestion + vbYesNo, _
          App.Title & " : Delete Component ?")
      If RetVal = vbNo Then Exit Sub
      N = cboSelectCompo.ListIndex + 1
      '
      ' DELETE COMPONENT FROM MAIN COMPONENT PROPERTIES DATA AREA.
      '
      For i = N To Number_Component - 1
        Component(i) = Component(i + 1)
        For j = 1 To 400
          C_Influent(i, j) = C_Influent(i + 1, j)
          C_Data_Points(i, j) = C_Data_Points(i + 1, j)
        Next j
      Next i
      Number_Component = Number_Component - 1
      '
      ' DELETE COMPONENT FROM ROOM PROPERTIES DATA AREA.
      '
      For i = N To RoomParams.COUNT_CONTAMINANT - 1
        RoomParams.ROOM_C0(i) = RoomParams.ROOM_C0(i + 1)
        RoomParams.ROOM_EMIT(i) = RoomParams.ROOM_EMIT(i + 1)
      Next i
      RoomParams.COUNT_CONTAMINANT = RoomParams.COUNT_CONTAMINANT - 1
      '
      ' RAISE DIRTY FLAG AND REFRESH MAIN WINDOW.
      '
      Call DirtyStatus_Throw
      Call frmMain_Refresh
    Case 2:   'EDIT.
      If (cboSelectCompo.ListIndex = -1) Or _
          (cboSelectCompo.ListIndex > Number_Component - 1) Then
        Call Show_Error("You must first select a component.")
        Exit Sub
      End If
      Call frmCompoProp.frmCompoProp_Edit( _
          Raise_Dirty_Flag, _
          cboSelectCompo.ListIndex + 1)
      If (Raise_Dirty_Flag) Then
        'RAISE DIRTY FLAG.
        Call DirtyStatus_Throw
      End If
  End Select
End Sub
Private Sub cmdAdsorberDB_Click()
Dim User_Transferred_Data As Boolean
Dim New_L As Double
Dim New_D As Double
Dim New_M As Double
Dim New_Q As Double
  Call frmEditAdsorber.frmEditAdsorber_QueryDatabase( _
      User_Transferred_Data)
  If (Not User_Transferred_Data) Then Exit Sub
  'TRANSFER DATA TO MAIN WINDOW.
  ''SET L,D,M,Q UNITS TO M, M, KG, and M^3/S RESPECTIVELY
  'txtBedUnits(0).ListIndex = 0
  'txtBedUnits(1).ListIndex = 0
  'txtBedUnits(2).ListIndex = 0
  'txtBedUnits(3).ListIndex = 0
  'TRANSFER PARAMETERS BACK TO MAIN SCREEN
  New_L = frmEditAdsorber_ReturnParameters.L
  New_D = frmEditAdsorber_ReturnParameters.D
  New_M = frmEditAdsorber_ReturnParameters.M
  New_Q = frmEditAdsorber_ReturnParameters.Q
  'txtBedValue(0).Text = Format_It(New_L, 3)
  'txtBedValue(1).Text = Format_It(New_D, 3)
  'txtBedValue(2).Text = Format_It(New_M, 2)
  'txtBedValue(3).Text = Format_It(New_Q, 3)
  Bed.length = New_L
  Bed.Diameter = New_D
  Bed.Weight = New_M
  Bed.Flowrate = New_Q
  'RAISE DIRTY FLAG.
  Call DirtyStatus_Throw
  'UPDATE WINDOW DISPLAY.
  Call frmMain_Refresh
  ''UPDATE SOME BED PROPERTY DISPLAYS:
  'Call Update_Bed_Density_Display
  'Call Update_Several_Bed_Properties(3)
End Sub
Private Sub cmdCarbon_Click()
Dim User_Transferred_Data As Boolean
  Call frmEditCarbon.frmEditCarbon_QueryDatabase( _
      User_Transferred_Data)
  If (Not User_Transferred_Data) Then Exit Sub
  '
  '    DATA WAS ALREADY TRANSFERRED IN THE SUB-WINDOW.
  '    NO FURTHER DATA TRANSFER IS REQUIRED.
  '    ONLY THE DIRTY FLAG AND THE WINDOW DISPLAY
  '    UPDATE NEED BE PERFORMED (SEE BELOW).
  '
  'RAISE DIRTY FLAG.
  Call DirtyStatus_Throw
  'UPDATE WINDOW DISPLAY.
  Call frmMain_Refresh
End Sub
Private Sub cmdNote_Click(Index As Integer)
Dim Temp_FileNote As String
Dim RaiseDirtyFlag As Boolean
  Temp_FileNote = FileNote
  Call frmFileNote.frmFileNote_Run( _
     Temp_FileNote, _
     RaiseDirtyFlag)
  If (RaiseDirtyFlag) Then
    FileNote = Temp_FileNote
    'THROW DIRTY FLAG.
    Call DirtyStatus_Throw
    'REFRESH WINDOW.
    Call frmMain_Refresh
  End If
End Sub
Private Sub cmdParamsPSDMInRoom_Click()
Dim Raise_Dirty_Flag As Boolean
  Call frmInputParamsPSDMInRoom. _
      frmInputParamsPSDMInRoom_Edit(Raise_Dirty_Flag)
  If (Raise_Dirty_Flag) Then
    'THROW DIRTY FLAG.
    Call DirtyStatus_Throw
  End If
End Sub
Private Sub cmdpolanyi_Click()
Dim Raise_Dirty_Flag As Boolean
  Call frmPolanyi.frmPolanyi_Edit(Me, Raise_Dirty_Flag)
  If (Raise_Dirty_Flag) Then
    'THROW DIRTY FLAG.
    Call DirtyStatus_Throw
  End If
End Sub
Private Sub cmdViewDimensionless_Click()
  frmDimensionless.Show 1
End Sub
Private Sub cmdWaterCorrelations_Click()
Dim Raise_Dirty_Flag As Boolean
  Call frmFluidProps.frmFluidProps_Edit(Raise_Dirty_Flag)
  If (Raise_Dirty_Flag) Then
    'THROW DIRTY FLAG.
    Call DirtyStatus_Throw
  End If
End Sub


Private Sub Form_Load()
Dim is_internal_mtu As Boolean
  '
  ' MISC INITS.
  '
  sspanel_Dirty.Caption = ""
  sspanel_Status.Caption = ""
  Me.Caption = "AdDesignS"
  Me.Width = 9600
  Me.Height = 7600
  Call CenterOnScreen(Me)
  CommonDialog1.Filename = App.Path & "\examples\*.dat"
  lblWaterUnit(0).Caption = "C"
  lblWaterUnit(1).Caption = "atm"
  cmdNote(1).Move cmdNote(0).Left, cmdNote(0).Top
  cmdNote(0).Visible = False
  cmdNote(1).Visible = False
  '
  ' PSDM IN ROOM INITS.
  '
  If (Distribute_PSDMInRoom = False) Then
    Activate_PSDMInRoom = False
  Else
    If (FileExists(App.Path & "\PSDMROOM.DAT") = True) Then
      Activate_PSDMInRoom = True
    Else
      Activate_PSDMInRoom = False
    End If
  End If
  mnuRunItem(10).Visible = Activate_PSDMInRoom
  ''''mnuResultsItem(10).Visible = Activate_PSDMInRoom
  cmdParamsPSDMInRoom.Visible = Activate_PSDMInRoom
  '
  ' CHECK FOR FILE THAT INDICATES THIS IS INTERNAL TO MTU:
  '
  is_internal_mtu = False
  If (check_internal_to_mtu()) Then is_internal_mtu = True
  mnuMTU.Visible = is_internal_mtu
  '
  ' POPULATE UNITS INTO SCROLLBOX CONTROLS.
  '
  Call Populate_frmMain_Units
  '
  ' CREATE A NEW FILE IN MEMORY.
  '
  Call file_new
  '
  ' POPULATE LAST-FEW-FILES LIST.
  '
  Call OldFileList_Populate( _
      1, _
      frmMain.mnuFileItem(199), _
      frmMain.mnuFileItem(191), _
      frmMain.mnuFileItem(192), _
      frmMain.mnuFileItem(193), _
      frmMain.mnuFileItem(194))
End Sub
Private Sub Form_QueryUnload(Cancel As Integer, UnloadMode As Integer)
  If (file_query_unload() = False) Then
    Cancel = True
  End If
End Sub
Private Sub Form_Unload(Cancel As Integer)
  Call frmMain_Close_All_Windows
  Call unitsys_unregister_all_on_form(Me)
End Sub


Private Sub lstComponents_Click()
Dim i As Integer
  'Debug.Print "lstComponents_Click"
  'For i = 0 To lstComponents.ListCount - 1
  '  Debug.Print "lst.selected(" & Trim$(Str$(i)) & ") = " & _
  '      Trim$(Str$(lstComponents.Selected(i)))
  'Next i
  For i = 0 To lstComponents.ListCount - 1
    Component(i + 1).Is_Selected_On_List = (lstComponents.Selected(i))
  Next i
End Sub


Private Sub mnuDatabasesItem_Click(Index As Integer)
  Select Case Index
    Case 0:         'ADSORBENT DB.
      Call frmEditCarbon.frmEditCarbon_EditDatabase
    Case 1:         'ISOTHERM DB.
      Call frmEditIsotherm.frmEditIsotherm_EditDatabase
    Case 2:         'ADSORBER DB.
      Call frmEditAdsorber.frmEditAdsorber_EditDatabase
  End Select
End Sub
Private Sub mnuFileItem_Click(Index As Integer)
  Select Case Index
    Case 0:      'New
      If (file_query_unload()) Then
        Call Avoid_Weird_Focus_Problem
        Call file_new
      End If
    Case 1:      'Open ...
      If (file_query_unload()) Then
        Call Avoid_Weird_Focus_Problem
        Call File_OpenAs("")
      End If
    Case 2:      'Save
      If (Filename = "") Then
        Call Avoid_Weird_Focus_Problem
        Call File_SaveAs("")
      Else
        Call Avoid_Weird_Focus_Problem
        Call File_SaveAs(Filename)
      End If
    Case 3:      'Save As ...
      Call Avoid_Weird_Focus_Problem
      Call File_SaveAs("")
    Case 6:       'Select Printer ...
      CommonDialog1.ShowPrinter
    'Case 85:      'Print ...
    '  frmPrint.Show 1
    Case 191 To 194:      'Last-few-files list
      If (file_query_unload()) Then
        If (mnuFileItem(Index).Visible) Then
          Call File_OpenAs(OldFiles(1, Index - 190))
        End If
      End If
    Case 200:     'Exit
      'NOTE: MDIForm_QueryUnload() TAKES CAKE OF THIS.
      'If we do it here, _two_ message boxes will pop up
      'when the user has data which needs saving !
      'If (file_query_unload()) Then
      '  Unload Me
      'End If
      Unload Me
  End Select
End Sub
Private Sub mnuHelpItem_Click(Index As Integer)
Dim fn_This As String
  Select Case Index
    Case 10:      'ONLINE HELP.
      'NOTE: We currently do NOT have the resources to
      'create an online help file for AdDesignS (1/7/98)
      'therefore no online help is available.
      Call Show_Message("Online help is currently unavailable.  " & _
          "Please refer to the printed manual or the Acrobat-format ADS.PDF file.")
      Exit Sub
      'Call LaunchFile_General("", MAIN_APP_PATH & "\help\ads.hlp")
    Case 20:      'ONLINE MANUAL.
      fn_This = MAIN_APP_PATH & "\help\ads.pdf"
      If (FileExists(fn_This) = False) Then
        Call Show_Message("The file `" & fn_This & "` is missing.")
        Exit Sub
      End If
      Call LaunchFile_General("", fn_This)
    Case 80:
      fn_This = App.Path & "\dbase\readme.txt"
      If (FileExists(fn_This) = False) Then
        Call Show_Message("The file `" & fn_This & "` is missing.")
        Exit Sub
      End If
      Call Launch_Notepad(fn_This)
    Case 85:    'VIEW DISCLAIMER.
      'SHOW THE DISCLAIMER WINDOW.
      splash_mode = 101
      splash_button_pressed = 0
      frmSplash.Show 1
    Case 90:    'TECH ASSISTANCE.
      frmAbout2.Show 1
    Case 99:    'ABOUT.
      frmAbout.Show 1
  End Select
End Sub
Private Sub mnuMTUItem_Click(Index As Integer)
  Select Case Index
    Case 40:    'KEEP TEMPORARY MODEL FILES.
      mnuMTUItem(40).Checked = Not mnuMTUItem(40).Checked
  End Select
End Sub
Private Sub mnuOptionsItem_Click(Index As Integer)
Dim msg As String
Dim i As Integer
Dim j As Integer
  Select Case Index
    Case 0:       'FOULING.
      frmFouling.Show 1
    Case 1:       'INFLUENT CONCENTRATIONS.
      '---- Options--Influent Concentrations
      '-- Setup global variables to make the call
      frmConcentrations_caption = "Influent Concentrations"
      frmConcentrations_Cunits = "mg/L"
      frmConcentrations_Tunits = "days"
      frmConcentrations_TimeOrderImportant = True
      frmConcentrations_NumPoints = Number_Influent_Points
      frmConcentrations_NumConcs = Number_Component
      For i = 1 To frmConcentrations_NumPoints
        frmConcentrations_Times(i) = T_Influent(i)
        For j = 1 To frmConcentrations_NumConcs
          frmConcentrations_Concs(j, i) = C_Influent(j, i)
        Next j
      Next i
      '-- Make the call
      frmVarConcentrations.Show 1
      '-- Reinitialize Last-Few-Files list after frmConcentrations is done
      'xaxaxaNC
      'Call LastFewFiles_InitializeList(LASTFEW_WHICHAPP_ADSIM, LASTFEW_ADSIM_frmPFPSDM)
      ''''Call LastFewFiles_InitializeList(LASTFEW_WHICHAPP_ADDESIGNS, LASTFEW_ADDESIGNS_frmPFPSDM)
      If (Not frmConcentrations_cancelled) Then
        Number_Influent_Points = frmConcentrations_NumPoints
        Number_Component = frmConcentrations_NumConcs
        For i = 1 To frmConcentrations_NumPoints
          T_Influent(i) = frmConcentrations_Times(i)
          For j = 1 To frmConcentrations_NumConcs
            C_Influent(j, i) = frmConcentrations_Concs(j, i)
          Next j
        Next i
      End If
    Case 2:       'EFFLUENT CONCENTRATIONS.
      '---- Options--Effluent Concentrations
      '-- Setup global variables to make the call
      frmConcentrations_caption = "Effluent Concentrations"
      frmConcentrations_Cunits = "C/C0"
      frmConcentrations_Tunits = "days"
      frmConcentrations_TimeOrderImportant = False
      frmConcentrations_NumPoints = NData_Points
      frmConcentrations_NumConcs = Number_Component
      For i = 1 To frmConcentrations_NumPoints
        frmConcentrations_Times(i) = T_Data_Points(i) * 24# * 60#
        For j = 1 To frmConcentrations_NumConcs
          frmConcentrations_Concs(j, i) = C_Data_Points(j, i)
        Next j
      Next i
      '-- Make the call
      frmVarConcentrations.Show 1
      '-- Reinitialize Last-Few-Files list after frmConcentrations is done
      'xaxaxaNC
      'Call LastFewFiles_InitializeList(LASTFEW_WHICHAPP_ADSIM, LASTFEW_ADSIM_frmPFPSDM)
      ''''Call LastFewFiles_InitializeList(LASTFEW_WHICHAPP_ADDESIGNS, LASTFEW_ADDESIGNS_frmPFPSDM)
      If (Not frmConcentrations_cancelled) Then
        NData_Points = frmConcentrations_NumPoints
        If NData_Points > 0 And mnuResultsItem(1).Enabled = True Then
          mnuResultsItem(4).Enabled = True
        End If
        If NData_Points > 0 And mnuResultsItem(0).Enabled = True Then
          mnuResultsItem(3).Enabled = True
        End If
        Number_Component = frmConcentrations_NumConcs
        For i = 1 To frmConcentrations_NumPoints
          T_Data_Points(i) = frmConcentrations_Times(i) / 24# / 60#
          For j = 1 To frmConcentrations_NumConcs
            C_Data_Points(j, i) = frmConcentrations_Concs(j, i)
          Next j
        Next i
      End If
  End Select
End Sub
Private Sub mnuPhaseItem_Click(Index As Integer)
Dim OldBedPhase As Integer
  OldBedPhase = Bed.Phase
  Select Case Index
    Case 0:     'LIQUID PHASE.
      Call chem_phase(0)
    Case 1:     'GAS PHASE.
      Call chem_phase(1)
  End Select
  If (Bed.Phase <> OldBedPhase) Then
    'THROW DIRTY FLAG AND REFRESH WINDOW.
    Call DirtyStatus_Throw
    Call frmMain_Refresh
  End If
End Sub
Private Sub mnuPrintSubItem_Click(Index As Integer)
  Select Case Index
    Case 0:     'PRINT-TO-PRINTER.
      Print_To_Printer = True
      frmPrintInputs.Show 1
    Case 1:     'PRINT-TO-FILE.
      Print_To_Printer = False
      frmPrintInputs.Show 1
  End Select
End Sub
Private Sub mnuResultsItem_Click(Index As Integer)
  Select Case Index
    Case 0:     'PSDM.
      frmModelPSDMResults.Show 1
    Case 1:     'CPHSDM.
      frmModelCPHSDMResults.Show 1
    Case 2:     'ECM.
      frmModelECMResults.Show 1
    Case 3:
      frmCompareData_WhichSet = frmCompareData_WhichSet_PSDM
      frmCompareData_caption = "Comparison of PSDM Results with Effluent Data"
      frmModelDataComparison.Show 1
    Case 4:
      frmCompareData_WhichSet = frmCompareData_WhichSet_CPHSDM
      frmCompareData_caption = "Comparison of CPHSDM Results with Effluent Data"
      frmModelDataComparison.Show 1
  End Select
End Sub
Private Sub mnuRunItem_Click(Index As Integer)
Dim i As Integer
Dim j As Integer
Dim Num_K_Reduction As Integer
  Select Case Index
    Case 0:      'PSDM.
      If (Prepare_To_Run_PSDM() = False) Then
        Exit Sub
      End If
      'RUN THE MODEL.
      Call ModelPSDM_Go
    Case 10:      'PSDM in Room.
      If (Prepare_To_Run_PSDM_In_Room() = False) Then
        Exit Sub
      End If
      'RUN THE MODEL.
      Call ModelPSDMInRoom_Go
    Case 1:      'CPHSDM.
      '---- Make sure # fouling components is = 0.
      Num_K_Reduction = 0
      For i = 0 To lstComponents.ListCount - 1
        If (lstComponents.Selected(i)) Then
          If (Component(i + 1).K_Reduction) Then
            Num_K_Reduction = Num_K_Reduction + 1
          End If
        End If
      Next i
      If (Num_K_Reduction > 0) Then
        Call Show_Message( _
            "Warning: There are currently " & Trim$(Str$(Num_K_Reduction)) & _
            " components specified with fouling correlations.  The CPHSDM model " & _
            "does not use the fouling correlations and will ignore them.")
      End If
      Call AllModels_Verify_Selected_Components(MODELTYPE_CPHSDM)
      If (Number_Component_CPM = 0) Then
        Exit Sub   'ERROR MESSAGE HANDLED IN AllModels_... SUBROUTINE.
      End If
      'RUN THE MODEL.
      Call ModelCPHSDM_Go
    Case 2:      'ECM.
      '---- Make sure # fouling components is = 0.
      Num_K_Reduction = 0
      For i = 0 To lstComponents.ListCount - 1
        If (lstComponents.Selected(i)) Then
          If (Component(i + 1).K_Reduction) Then
            Num_K_Reduction = Num_K_Reduction + 1
          End If
        End If
      Next i
      If (Num_K_Reduction > 0) Then
        Call Show_Message( _
            "Warning: There are currently " & Trim$(Str$(Num_K_Reduction)) & _
            " components specified with fouling correlations.  The ECM model " & _
            "does not use the fouling correlations and will ignore them.")
      End If
      Call AllModels_Verify_Selected_Components(MODELTYPE_ECM)
      If (Number_Component_ECM = 0) Then
        Exit Sub   'ERROR MESSAGE HANDLED IN AllModels_... SUBROUTINE.
      End If
      For i = 1 To Number_Component_ECM
        For j = i + 1 To Number_Component_ECM
          If (Trim$(Component(Component_Index_ECM(i)).Name) = _
              Trim$(Component(Component_Index_ECM(j)).Name)) Then
            Call Show_Error( _
                "Components " & Format$(Component_Index_ECM(i), "0") & _
                " and " & Format$(Component_Index_ECM(j), "0") & _
                " have the same name." & vbCrLf & _
                "Please change one before running the ECM.")
            Exit Sub
          End If
        Next j
      Next i
      'RUN THE MODEL.
      Call ModelECM_Go
  End Select
End Sub


Private Sub spnNumberOfBeds_SpinDown()
  If (Bed.NumberOfBeds > 1) Then
    Bed.NumberOfBeds = Bed.NumberOfBeds - 1
    'THROW DIRTY FLAG AND REFRESH WINDOW.
    Call DirtyStatus_Throw
    Call frmMain_Refresh
  End If
End Sub
Private Sub spnNumberOfBeds_SpinUp()
  If (Bed.NumberOfBeds < Maximum_Beds_In_Series) Then
    Bed.NumberOfBeds = Bed.NumberOfBeds + 1
    'THROW DIRTY FLAG AND REFRESH WINDOW.
    Call DirtyStatus_Throw
    Call frmMain_Refresh
  End If
End Sub


Private Sub spnPoint_SpinDown(Index As Integer)
  Select Case Index
    Case 0:     'AXIAL POINTS.
      If (MC > 1) Then
        MC = MC - 1
        'THROW DIRTY FLAG AND REFRESH WINDOW.
        Call DirtyStatus_Throw
        Call frmMain_Refresh
      End If
    Case 1:     'RADIAL POINTS.
      If (NC > 1) Then
        NC = NC - 1
        'THROW DIRTY FLAG AND REFRESH WINDOW.
        Call DirtyStatus_Throw
        Call frmMain_Refresh
      End If
  End Select
End Sub
Private Sub spnPoint_SpinUp(Index As Integer)
  Select Case Index
    Case 0:     'AXIAL POINTS.
      If (MC < Max_Axial_Collocation) Then
        MC = MC + 1
        'THROW DIRTY FLAG AND REFRESH WINDOW.
        Call DirtyStatus_Throw
        Call frmMain_Refresh
      End If
    Case 1:     'RADIAL POINTS.
      If (NC < Max_Radial_Collocation) Then
        NC = NC + 1
        'THROW DIRTY FLAG AND REFRESH WINDOW.
        Call DirtyStatus_Throw
        Call frmMain_Refresh
      End If
  End Select
End Sub


Private Sub txtBedUnits_Click(Index As Integer)
Dim Ctl As Control
Set Ctl = txtBedUnits(Index)
  Call unitsys_control_cbox_click(Ctl)
End Sub
Private Sub txtBedUnits_KeyPress(Index As Integer, KeyAscii As Integer)
  KeyAscii = Global_TextKeyPress(KeyAscii)
End Sub


Private Sub txtBedValue_GotFocus(Index As Integer)
Dim Ctl As Control
Set Ctl = txtBedValue(Index)
Dim StatusMessagePanel As String
  Call unitsys_control_txtx_gotfocus(Ctl)
  Select Case Index
    Case 0
      StatusMessagePanel = "Type in the bed diameter"
    Case 1
      StatusMessagePanel = "Type in the bed length"
    Case 2
      StatusMessagePanel = "Type in the mass of adsorbent in the bed"
    Case 3
      StatusMessagePanel = "Type in the inlet flowrate"
    Case 4
      StatusMessagePanel = "Type in the Empty Bed Contact Time (EBCT)"
  End Select
  Call GenericStatus_Set(StatusMessagePanel)
End Sub
Private Sub txtBedValue_KeyPress(Index As Integer, KeyAscii As Integer)
  KeyAscii = Global_NumericKeyPress(KeyAscii)
End Sub
Private Sub txtBedValue_LostFocus(Index As Integer)
Dim NewValue_Okay As Integer
Dim NewValue As Double
Dim Ctl As Control
Set Ctl = txtBedValue(Index)
Dim Val_Low As Double
Dim Val_High As Double
Dim Raise_Dirty_Flag As Boolean
Dim Too_Small As Integer
  'NOTE: LOW AND HIGH VALUES IN BASE UNITS
  If (Index = 4) Then
    Val_Low = 1E-20 * 60#
    Val_High = 1E+20 * 60#
  Else
    Val_Low = 1E-20
    Val_High = 1E+20
  End If
  NewValue_Okay = False
  If (unitsys_control_txtx_lostfocus_validate(Ctl, Val_Low, Val_High, NewValue, Raise_Dirty_Flag)) Then
    NewValue_Okay = True
  End If
  Call unitsys_control_txtx_lostfocus(Ctl, NewValue)
  Call GenericStatus_Set("")
  If (NewValue_Okay) Then
    If (Raise_Dirty_Flag) Then
      'STORE TO MEMORY.
      Select Case Index
        Case 0:     'BED LENGTH.
          Call Check_Length(NewValue, Too_Small)
          Raise_Dirty_Flag = False
          If Not (Too_Small) Then
            Bed.length = NewValue
            Raise_Dirty_Flag = True
          End If
          'Call Update_Display
          Call Update_KP_Values
          'Call Update_Bed_Density_Display
          'Call Update_Several_Bed_Properties(1)
        Case 1:     'BED DIAMETER.
          Call Check_Diameter(NewValue, Too_Small)
          Raise_Dirty_Flag = False
          If Not (Too_Small) Then
            Bed.Diameter = NewValue
            Raise_Dirty_Flag = True
          End If
          'Call Update_Display
          Call Update_KP_Values
          'Call Update_Bed_Density_Display
          'Call Update_Several_Bed_Properties(3)
        Case 2:     'BED MASS.
          Call Check_Weight(NewValue, Too_Small)
          Raise_Dirty_Flag = False
          If Not (Too_Small) Then
            Bed.Weight = NewValue
            Raise_Dirty_Flag = True
          End If
          ''Call Update_Display
          Call Update_KP_Values
          'Call Update_Bed_Density_Display
          'Call Update_Several_Bed_Properties(1)
        Case 3:     'BED FLOW RATE.
          Bed.Flowrate = NewValue
          ''Call Update_Display       'Updates display of flowrate and EBCT.
          Call Update_KP_Values
          'Call Update_Several_Bed_Properties(2)
        Case 4:     'BED EBCT.
          Bed.Flowrate = Bed.length * PI * Bed.Diameter * Bed.Diameter / 4# / NewValue         'EBCT in sec
          ''Call Update_Display       'Updates display of flowrate and EBCT.
          Call Update_KP_Values
          'Call Update_Several_Bed_Properties(2)
      End Select
      If (Raise_Dirty_Flag) Then
        'THROW DIRTY FLAG.
        Call DirtyStatus_Throw
      End If
      'REFRESH WINDOW.
      Call frmMain_Refresh
    End If
  End If
End Sub


Private Sub txtCarbon_GotFocus(Index As Integer)
Dim Ctl As Control
Set Ctl = txtCarbon(Index)
Dim StatusMessagePanel As String
  If (Index = 0) Then
    Call Global_GotFocus(Ctl)
  Else
    Call unitsys_control_txtx_gotfocus(Ctl)
  End If
  Select Case Index
    Case 0
      StatusMessagePanel = "Type in the adsorbent name"
    Case 1
      StatusMessagePanel = "Type in the adsorbent density (that includes pore volume)"
    Case 2
      StatusMessagePanel = "Type in the average particle radius"
    Case 3
      StatusMessagePanel = "Type in the particle porosity"
    Case 4
      StatusMessagePanel = "Type in the particle shape factor (spheres=1.0)"
'    Case 4
'      StatusMessagePanel = " Type in the particle tortuosity"
  End Select
  Call GenericStatus_Set(StatusMessagePanel)
End Sub
Private Sub txtCarbon_KeyPress(Index As Integer, KeyAscii As Integer)
  If (Index = 0) Then
    KeyAscii = Global_TextKeyPress(KeyAscii)
  Else
    KeyAscii = Global_NumericKeyPress(KeyAscii)
  End If
End Sub
Private Sub txtCarbon_LostFocus(Index As Integer)
Dim NewValue_Okay As Integer
Dim NewValue As Double
Dim Ctl As Control
Set Ctl = txtCarbon(Index)
Dim Val_Low As Double
Dim Val_High As Double
Dim Raise_Dirty_Flag As Boolean
Dim Too_Small As Integer
  'HANDLE THE CARBON NAME TEXTBOX.
  If (Index = 0) Then
    If (Trim$(Ctl.Text) = "") Then
      Ctl.Text = Carbon.Name
      'Call Show_Error("You must enter a non-blank string for the carbon name.")
      'NOTE: SHOWING THIS ERROR MESSAGE MESSES UP THE
      'SUBSEQUENT GOTFOCUS IF THE USER HITS <Enter> OR <Tab>.
    Else
      If (Trim$(Carbon.Name) <> Trim$(Ctl.Text)) Then
        Carbon.Name = Trim$(Ctl.Text)
        'THROW DIRTY FLAG.
        Call DirtyStatus_Throw
      End If
    End If
    Call Global_LostFocus(Ctl)
    Call GenericStatus_Set("")
    Exit Sub
  End If
  'NOTE: LOW AND HIGH VALUES IN BASE UNITS
  Val_Low = 1E-20
  Val_High = 1E+20
  NewValue_Okay = False
  If (unitsys_control_txtx_lostfocus_validate(Ctl, Val_Low, Val_High, NewValue, Raise_Dirty_Flag)) Then
    NewValue_Okay = True
  End If
  Call unitsys_control_txtx_lostfocus(Ctl, NewValue)
  Call GenericStatus_Set("")
  If (NewValue_Okay) Then
    If (Raise_Dirty_Flag) Then
      'STORE TO MEMORY.
      Select Case Index
        Case 1:     'APPARENT DENSITY.
          Call Check_Density(NewValue, Too_Small)
          Raise_Dirty_Flag = False
          If Not (Too_Small) Then
            Carbon.Density = NewValue
            Raise_Dirty_Flag = True
          End If
          'Call Update_Display
          Call Update_KP_Values
          'Call Update_Bed_Density_Display
          'Call Update_Several_Bed_Properties(1)
        Case 2:     'PARTICLE RADIUS.
          Carbon.ParticleRadius = NewValue
          'Call Update_Display
          Call Update_KP_Values
        Case 3:     'POROSITY.
          Carbon.Porosity = NewValue
          'Call Update_Display
          Call Update_KP_Values
        Case 4:     'PARTICLE SHAPE FACTOR.
          Carbon.ShapeFactor = NewValue
          'Call Update_Display
          Call Update_KP_Values
      End Select
      If (Raise_Dirty_Flag) Then
        'THROW DIRTY FLAG.
        Call DirtyStatus_Throw
      End If
      'REFRESH WINDOW.
      Call frmMain_Refresh
    End If
  End If
End Sub


Private Sub txtCarbonUnits_Click(Index As Integer)
Dim Ctl As Control
Set Ctl = txtCarbonUnits(Index)
  Call unitsys_control_cbox_click(Ctl)
End Sub
Private Sub txtCarbonUnits_KeyPress(Index As Integer, KeyAscii As Integer)
  KeyAscii = Global_TextKeyPress(KeyAscii)
End Sub


Private Sub txtNPoint_GotFocus(Index As Integer)
Dim Ctl As Control
Set Ctl = txtNPoint(Index)
Dim StatusMessagePanel As String
  Call unitsys_control_txtx_gotfocus(Ctl)
  Select Case Index
    Case 0:
      StatusMessagePanel = "Type in the number of collocation points in the axial direction (PSDM only)"
    Case 1:
      StatusMessagePanel = "Type in the number of collocation points in the radial direction (PSDM only)"
  End Select
  Call GenericStatus_Set(StatusMessagePanel)
End Sub
Private Sub txtNPoint_KeyPress(Index As Integer, KeyAscii As Integer)
  KeyAscii = Global_NumericKeyPress(KeyAscii)
End Sub
Private Sub txtNPoint_LostFocus(Index As Integer)
Dim NewValue_Okay As Integer
Dim NewValue As Double
Dim Ctl As Control
Set Ctl = txtNPoint(Index)
Dim Val_Low As Double
Dim Val_High As Double
Dim Raise_Dirty_Flag As Boolean
Dim Too_Small As Integer
  'NOTE: LOW AND HIGH VALUES IN BASE UNITS
  Select Case Index
    Case 0:   'AXIAL DIR.
      Val_Low = 1#
      Val_High = CDbl(Max_Axial_Collocation)
    Case 1:   'RADIAL DIR.
      Val_Low = 1#
      Val_High = CDbl(Max_Radial_Collocation)
  End Select
  NewValue_Okay = False
  If (unitsys_control_txtx_lostfocus_validate(Ctl, Val_Low, Val_High, NewValue, Raise_Dirty_Flag)) Then
    NewValue_Okay = True
  End If
  Call unitsys_control_txtx_lostfocus(Ctl, NewValue)
  Call GenericStatus_Set("")
  If (NewValue_Okay) Then
    If (Raise_Dirty_Flag) Then
      'STORE TO MEMORY.
      Select Case Index
        Case 0:     'AXIAL DIR.
          MC = CInt(NewValue)
        Case 1:     'RADIAL DIR.
          NC = CInt(NewValue)
      End Select
      If (Raise_Dirty_Flag) Then
        'THROW DIRTY FLAG.
        Call DirtyStatus_Throw
      End If
      'REFRESH WINDOW.
      Call frmMain_Refresh
    End If
  End If
End Sub


Private Sub txtNumberOfBeds_GotFocus()
Dim Ctl As Control
Set Ctl = txtNumberOfBeds
Dim StatusMessagePanel As String
  Call unitsys_control_txtx_gotfocus(Ctl)
  StatusMessagePanel = "Type in the number of axial elements (PSDM only)"
  Call GenericStatus_Set(StatusMessagePanel)
End Sub
Private Sub txtNumberOfBeds_KeyPress(KeyAscii As Integer)
  KeyAscii = Global_NumericKeyPress(KeyAscii)
End Sub
Private Sub txtNumberOfBeds_LostFocus()
Dim NewValue_Okay As Integer
Dim NewValue As Double
Dim Ctl As Control
Set Ctl = txtNumberOfBeds
Dim Val_Low As Double
Dim Val_High As Double
Dim Raise_Dirty_Flag As Boolean
Dim Too_Small As Integer
  'NOTE: LOW AND HIGH VALUES IN BASE UNITS
  Val_Low = 1#
  Val_High = CDbl(Maximum_Beds_In_Series)
  NewValue_Okay = False
  If (unitsys_control_txtx_lostfocus_validate(Ctl, Val_Low, Val_High, NewValue, Raise_Dirty_Flag)) Then
    NewValue_Okay = True
  End If
  Call unitsys_control_txtx_lostfocus(Ctl, NewValue)
  Call GenericStatus_Set("")
  If (NewValue_Okay) Then
    If (Raise_Dirty_Flag) Then
      'STORE TO MEMORY.
      Bed.NumberOfBeds = CInt(NewValue)
      If (Raise_Dirty_Flag) Then
        'THROW DIRTY FLAG.
        Call DirtyStatus_Throw
      End If
      'REFRESH WINDOW.
      Call frmMain_Refresh
    End If
  End If
End Sub


Private Sub txtTime_GotFocus(Index As Integer)
Dim Ctl As Control
Set Ctl = txtTime(Index)
Dim StatusMessagePanel As String
  Call unitsys_control_txtx_gotfocus(Ctl)
  Select Case Index
    Case 0
      StatusMessagePanel = "Type in the total run time of the fixed bed adsorber (PSDM only)"
    Case 1
      StatusMessagePanel = "Type in the time of the first point to be displayed (PSDM only)"
    Case 2
      StatusMessagePanel = "Type in the time step (PSDM only)"
  End Select
  Call GenericStatus_Set(StatusMessagePanel)
End Sub
Private Sub txtTime_KeyPress(Index As Integer, KeyAscii As Integer)
  KeyAscii = Global_NumericKeyPress(KeyAscii)
End Sub
Private Sub txtTime_LostFocus(Index As Integer)
Dim NewValue_Okay As Integer
Dim NewValue As Double
Dim Ctl As Control
Set Ctl = txtTime(Index)
Dim Val_Low As Double
Dim Val_High As Double
Dim Raise_Dirty_Flag As Boolean
Dim Too_Small As Integer
Dim ForceAbort As Integer
  'NOTE: LOW AND HIGH VALUES IN BASE UNITS
  Select Case Index
    Case 0, 2:      'TOTAL RUN TIME, TIME STEP.
      Val_Low = 1E-20
      Val_High = 1E+20
    Case 1:         'FIRST POINT DISPLAYED.
      Val_Low = 0#
      Val_High = 1E+20
  End Select
  NewValue_Okay = False
  If (unitsys_control_txtx_lostfocus_validate(Ctl, Val_Low, Val_High, NewValue, Raise_Dirty_Flag)) Then
    NewValue_Okay = True
  End If
  Call unitsys_control_txtx_lostfocus(Ctl, NewValue)
  Call GenericStatus_Set("")
  If (NewValue_Okay) Then
    If (Raise_Dirty_Flag) Then
      'STORE TO MEMORY.
      Select Case Index
        Case 0:       'TOTAL RUN TIME.
          Call Check_Time_Parameters(0, NewValue, ForceAbort)
          If Not (ForceAbort) Then
            TimeP.End = NewValue
          End If
        Case 1:       'FIRST POINT DISPLAYED.
          Call Check_Time_Parameters(1, NewValue, ForceAbort)
          If Not (ForceAbort) Then
            TimeP.Init = NewValue
          End If
        Case 2:       'TIME STEP.
          Call Check_Time_Parameters(2, NewValue, ForceAbort)
          If Not (ForceAbort) Then
            TimeP.Step = NewValue
          End If
      End Select
      If (Raise_Dirty_Flag) Then
        'THROW DIRTY FLAG.
        Call DirtyStatus_Throw
      End If
      'REFRESH WINDOW.
      Call frmMain_Refresh
    End If
  End If
End Sub


Private Sub txttimeunits_Click(Index As Integer)
Dim Ctl As Control
Set Ctl = txtTimeUnits(Index)
  Call unitsys_control_cbox_click(Ctl)
End Sub
Private Sub txttimeunits_KeyPress(Index As Integer, KeyAscii As Integer)
  KeyAscii = Global_TextKeyPress(KeyAscii)
End Sub


Private Sub txtWater_GotFocus(Index As Integer)
Dim Ctl As Control
Set Ctl = txtTime(Index)
Dim StatusMessagePanel As String
  Call unitsys_control_txtx_gotfocus(txtWater(Index))
  Select Case Index
    Case 0:
      StatusMessagePanel = "Type in the Fluid Temperature"
    Case 1:
      StatusMessagePanel = "Type in the Fluid Pressure"
  End Select
  Call GenericStatus_Set(StatusMessagePanel)
End Sub
Private Sub txtWater_KeyPress(Index As Integer, KeyAscii As Integer)
  KeyAscii = Global_NumericKeyPress(KeyAscii)
End Sub
Private Sub txtWater_LostFocus(Index As Integer)
Dim NewValue_Okay As Integer
Dim NewValue As Double
Dim Ctl As Control
Set Ctl = txtWater(Index)
Dim Val_Low As Double
Dim Val_High As Double
Dim Raise_Dirty_Flag As Boolean
Dim Too_Small As Integer
Dim ForceAbort As Integer
  'NOTE: LOW AND HIGH VALUES IN BASE UNITS
  Select Case Index
    Case 0:         'TEMPERATURE (degC).
      Val_Low = 0.01
      Val_High = 100#
    Case 1:         'PRESSURE (atm).
      Val_Low = 0.001
      Val_High = 100#
  End Select
  NewValue_Okay = False
  If (unitsys_control_txtx_lostfocus_validate(Ctl, Val_Low, Val_High, NewValue, Raise_Dirty_Flag)) Then
    NewValue_Okay = True
  End If
  Call unitsys_control_txtx_lostfocus(Ctl, NewValue)
  Call GenericStatus_Set("")
  If (NewValue_Okay) Then
    If (Raise_Dirty_Flag) Then
      'STORE TO MEMORY.
      Select Case Index
        Case 0:       'TEMPERATURE (degC).
          Bed.Temperature = NewValue
          'Call Update_Display_Water
        Case 1:       'PRESSURE (atm).
          Bed.Pressure = NewValue
          'Call Update_Display_Water
      End Select
      Call Update_FluidDensity(Bed.Temperature, Bed.Pressure, Bed.WaterDensity)
      Call Update_FluidViscosity(Bed.Temperature, Bed.WaterViscosity)
      If (Raise_Dirty_Flag) Then
        'THROW DIRTY FLAG.
        Call DirtyStatus_Throw
      End If
      'REFRESH WINDOW.
      Call frmMain_Refresh
    End If
  End If
End Sub


VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Object = "{F9043C88-F6F2-101A-A3C9-08002B2F49FB}#1.1#0"; "Comdlg32.ocx"
Object = "{0842D103-1E19-101B-9AAF-1A1626551E7C}#1.0#0"; "GRAPH32.OCX"
Begin VB.Form frmModelCPHSDMResults 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Results for the Constant Pattern Model (CPHSDM)"
   ClientHeight    =   6795
   ClientLeft      =   5325
   ClientTop       =   600
   ClientWidth     =   9480
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   6795
   ScaleWidth      =   9480
   Begin GraphLib.Graph grpBreak 
      Height          =   3555
      Left            =   60
      TabIndex        =   46
      Top             =   2490
      Width           =   7515
      _Version        =   65536
      _ExtentX        =   13256
      _ExtentY        =   6271
      _StockProps     =   96
      BorderStyle     =   1
      BottomTitle     =   "Testing"
      GraphStyle      =   4
      GraphType       =   6
      GridStyle       =   3
      LeftTitle       =   "Testing"
      RandomData      =   0
      ColorData       =   0
      ExtraData       =   0
      ExtraData[]     =   0
      FontFamily      =   4
      FontSize        =   4
      FontSize[0]     =   200
      FontSize[1]     =   150
      FontSize[2]     =   100
      FontSize[3]     =   100
      FontStyle       =   4
      GraphData       =   1
      GraphData[]     =   5
      GraphData[0,0]  =   0
      GraphData[0,1]  =   0
      GraphData[0,2]  =   0
      GraphData[0,3]  =   0
      GraphData[0,4]  =   0
      LabelText       =   0
      LegendText      =   0
      PatternData     =   0
      SymbolData      =   0
      XPosData        =   0
      XPosData[]      =   0
   End
   Begin VB.ComboBox cboGrid 
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   7830
      Style           =   2  'Dropdown List
      TabIndex        =   41
      Top             =   2640
      Width           =   1455
   End
   Begin Threed.SSFrame SSFrame2 
      Height          =   645
      Left            =   60
      TabIndex        =   37
      Top             =   6090
      Width           =   7485
      _Version        =   65536
      _ExtentX        =   13203
      _ExtentY        =   1138
      _StockProps     =   14
      Caption         =   "C/Co as a function of:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin Threed.SSOption optType 
         Height          =   255
         Index           =   2
         Left            =   3990
         TabIndex        =   2
         TabStop         =   0   'False
         Top             =   270
         Width           =   2775
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "Volume Treated by M&ass"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSOption optType 
         Height          =   255
         Index           =   1
         Left            =   2550
         TabIndex        =   1
         TabStop         =   0   'False
         Top             =   270
         Width           =   975
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "&BVT"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSOption optType 
         Height          =   255
         Index           =   0
         Left            =   750
         TabIndex        =   0
         TabStop         =   0   'False
         Top             =   270
         Width           =   1215
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "&Time"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
   End
   Begin Threed.SSFrame Frame3D1 
      Height          =   2385
      Left            =   60
      TabIndex        =   3
      Top             =   30
      Width           =   7515
      _Version        =   65536
      _ExtentX        =   13256
      _ExtentY        =   4207
      _StockProps     =   14
      Caption         =   "Results for {Component Name}"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin Threed.SSCommand cmdTreat 
         Height          =   255
         Left            =   90
         TabIndex        =   4
         TabStop         =   0   'False
         Top             =   2010
         Width           =   2535
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "Command3D1"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin VB.Label lblLegend 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "C (mg/L)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   7
         Left            =   6210
         TabIndex        =   36
         Top             =   1050
         Width           =   1215
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "999.99"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   11
         Left            =   6210
         TabIndex        =   35
         Top             =   1770
         Width           =   1215
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "999.99"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   10
         Left            =   6210
         TabIndex        =   34
         Top             =   1530
         Width           =   1215
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "999.99"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   9
         Left            =   6210
         TabIndex        =   33
         Top             =   1290
         Width           =   1215
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "999.99"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   8
         Left            =   5010
         TabIndex        =   32
         Top             =   1770
         Width           =   1215
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "999.99"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   7
         Left            =   5010
         TabIndex        =   31
         Top             =   1530
         Width           =   1215
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "999.99"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   6
         Left            =   5010
         TabIndex        =   30
         Top             =   1290
         Width           =   1215
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "999.99"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   3810
         TabIndex        =   29
         Top             =   1770
         Width           =   1215
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "999.99"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   3810
         TabIndex        =   28
         Top             =   1530
         Width           =   1215
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "999.99"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   3810
         TabIndex        =   27
         Top             =   1290
         Width           =   1215
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "999.99"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   2610
         TabIndex        =   26
         Top             =   1770
         Width           =   1215
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "999.99"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   2610
         TabIndex        =   25
         Top             =   1530
         Width           =   1215
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "999.99"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   2610
         TabIndex        =   24
         Top             =   1290
         Width           =   1215
      End
      Begin VB.Label lblLegend 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "95% of influent conc."
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   6
         Left            =   90
         TabIndex        =   23
         Top             =   1770
         Width           =   2535
      End
      Begin VB.Label lblLegend 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "50% of influent conc."
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   90
         TabIndex        =   22
         Top             =   1530
         Width           =   2535
      End
      Begin VB.Label lblLegend 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "5% of influent conc."
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   90
         TabIndex        =   21
         Top             =   1290
         Width           =   2535
      End
      Begin VB.Label lblLegend 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "Tr. Capacity"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   5010
         TabIndex        =   20
         Top             =   1050
         Width           =   1215
      End
      Begin VB.Label lblLegend 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "BVT"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   3810
         TabIndex        =   19
         Top             =   1050
         Width           =   1215
      End
      Begin VB.Label lblLegend 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "Time (days)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   2610
         TabIndex        =   18
         Top             =   1050
         Width           =   1215
      End
      Begin VB.Label lblLegend 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   90
         TabIndex        =   17
         Top             =   1050
         Width           =   2535
      End
      Begin VB.Label lblPara 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Minimum Stanton Number:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   390
         TabIndex        =   16
         Top             =   285
         Width           =   2295
      End
      Begin VB.Label lblPara 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Minimum EBCT (min):"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   630
         TabIndex        =   15
         Top             =   525
         Width           =   2055
      End
      Begin VB.Label lblPara 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Minimum Column Length(cm):"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   90
         TabIndex        =   14
         Top             =   765
         Width           =   2595
      End
      Begin VB.Label lblPara 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "MTZ Length(cm):"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   6
         Left            =   4110
         TabIndex        =   13
         Top             =   760
         Width           =   2055
      End
      Begin VB.Label lblParaValue 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "Label1"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   2730
         TabIndex        =   12
         Top             =   270
         Width           =   1215
      End
      Begin VB.Label lblParaValue 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "Label1"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   6210
         TabIndex        =   11
         Top             =   750
         Width           =   1215
      End
      Begin VB.Label lblParaValue 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "Label1"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   2730
         TabIndex        =   10
         Top             =   510
         Width           =   1215
      End
      Begin VB.Label lblParaValue 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "Label1"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   6
         Left            =   2730
         TabIndex        =   9
         Top             =   750
         Width           =   1215
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "999.99"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   15
         Left            =   2610
         TabIndex        =   8
         Top             =   2010
         Width           =   1215
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "999.99"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   16
         Left            =   3810
         TabIndex        =   7
         Top             =   2010
         Width           =   1215
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "999.99"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   17
         Left            =   5010
         TabIndex        =   6
         Top             =   2010
         Width           =   1215
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "999.99"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   18
         Left            =   6210
         TabIndex        =   5
         Top             =   2010
         Width           =   1215
      End
   End
   Begin Threed.SSCommand cmdFile 
      Height          =   435
      Left            =   7830
      TabIndex        =   38
      TabStop         =   0   'False
      Top             =   6300
      Width           =   1455
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      Caption         =   "Print to &File"
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdExcel 
      Height          =   435
      Left            =   7830
      TabIndex        =   39
      TabStop         =   0   'False
      Top             =   4140
      Width           =   1455
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      Caption         =   "&Excel..."
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin MSComDlg.CommonDialog CMDialog1 
      Left            =   7950
      Top             =   1560
      _ExtentX        =   847
      _ExtentY        =   847
      _Version        =   327681
      FontSize        =   0
      MaxFileSize     =   256
   End
   Begin Threed.SSCommand cmdSave 
      Height          =   435
      Left            =   7830
      TabIndex        =   40
      TabStop         =   0   'False
      Top             =   4680
      Width           =   1455
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      Caption         =   "S&ave Curve"
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdSelect 
      Height          =   435
      Left            =   7830
      TabIndex        =   42
      TabStop         =   0   'False
      Top             =   5220
      Width           =   1455
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      Caption         =   "&Select Printer"
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdPrint 
      Height          =   435
      Left            =   7830
      TabIndex        =   43
      TabStop         =   0   'False
      Top             =   5760
      Width           =   1455
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      Caption         =   "&Print"
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdExit 
      Height          =   435
      Left            =   7830
      TabIndex        =   45
      TabStop         =   0   'False
      Top             =   120
      Width           =   1455
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      Caption         =   "&Close"
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin VB.Label Label1 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Grid Style:"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Left            =   7830
      TabIndex        =   44
      Top             =   2400
      Width           =   1575
   End
End
Attribute VB_Name = "frmModelCPHSDMResults"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
Option Base 1

Dim Treatment_Objective As Throughput
Dim Flag_TO As Integer

Dim PopulatingScrollboxes As Integer



Const frmModelCPHSDMResults_declarations_end = True


Private Sub Draw_CPM()
Dim J As Integer, i As Integer, f As Integer, FileNamebis As String
Dim Data_Max As Double, factor  As Double
Dim Bottom_Title As String
ReDim X_Values(CPM_Max_Points) As Double

  Screen.MousePointer = 11
  
  If optType(0) Then  'Time
    factor = 1#
    Bottom_Title = "Time(days)"
  Else
    If optType(1) Then   'BVF
      factor = 24# * 3600# * CPM_Results.Bed.Flowrate / CPM_Results.Bed.length / PI / (CPM_Results.Bed.Diameter / 2#) ^ 2
      Bottom_Title = "Bed Volumes Treated"
    Else   'Treatment Capacity
      factor = 24# * 3600# * CPM_Results.Bed.Flowrate / CPM_Results.Bed.Weight
      Bottom_Title = "m" & Chr$(179) & " treated per kg of adsorbent"
    End If
  End If
  For i = 1 To CPM_Max_Points
    X_Values(i) = CPM_Results.T(i) * factor
  Next i
  
  'Define Graph
  grpBreak.NumSets = 1
  grpBreak.GraphType = 6      'SCATTER
  grpBreak.GraphStyle = 4
  grpBreak.NumPoints = 100
    
  
  'TEMP BEGINS.
  'grpBreak.ThisSet = 1
  'grpBreak.NumPoints = 100
  'grpBreak.AutoInc = 0
  'For i = 1 To 100
  '  grpBreak.ThisPoint = i
  '  grpBreak.GraphData = CDbl(i)
  '  grpBreak.XPosData = CDbl(i)
  'Next i
  'TEMP ENDS.
  
  
  grpBreak.AutoInc = 0
  grpBreak.GridStyle = cboGrid.ListIndex
  grpBreak.ThisSet = 1
  For i = 1 To grpBreak.NumPoints
    grpBreak.ThisPoint = i
    If CPM_Results.C_Over_C0(i) < 0 Then
      grpBreak.GraphData = 0#
    Else
      grpBreak.GraphData = CPM_Results.C_Over_C0(i)
    End If
    ''''grpBreak.ThisPoint = i
    ''''grpBreak.LabelText = ""
    ''''grpBreak.ThisPoint = i
    grpBreak.XPosData = X_Values(i)
  Next i
  grpBreak.ThisPoint = 1
  grpBreak.PatternData = 0
  grpBreak.PatternedLines = 0
  grpBreak.YAxisStyle = 2
  grpBreak.YAxisMin = 0#
  Data_Max = 0
  For i = 1 To grpBreak.NumPoints
    If CPM_Results.C_Over_C0(i) > Data_Max Then
      Data_Max = CPM_Results.C_Over_C0(i)
    End If
  Next i
  grpBreak.YAxisMax = (Int(Data_Max * 10# + 1)) / 10#
  grpBreak.YAxisTicks = 4
  grpBreak.BottomTitle = Bottom_Title
  ''''grpBreak.BottomTitle = "Testing"
  grpBreak.LeftTitle = "C/Co"
    
  Screen.MousePointer = 0
    
  grpBreak.DrawMode = 2

End Sub


Private Sub cboGrid_Click()
  If (Not PopulatingScrollboxes) Then
    grpBreak.GridStyle = cboGrid.ListIndex
    grpBreak.DrawMode = 2
  End If
End Sub


Private Sub cmdExcel_Click()
  PFPSDM_Excel = False
  CPHSDM_Excel = True
  frmExcelCurves.Show 1
End Sub


Private Sub cmdExit_Click()
   Unload Me
End Sub


Private Sub cmdFile_Click()
Dim f As Integer, Error_Code As Integer, temp As String
Dim i As Integer, J As Integer, k As Integer
Dim Eq1 As String
Dim Filename_Input As String

  On Error GoTo File_Error
  CMDialog1.Filename = ""
  CMDialog1.DialogTitle = "Print to File"
  CMDialog1.Filter = "All Files (*.*)|*.*|Text Files (*.txt)|*.txt|Data Files (*.dat)|*.dat"
  CMDialog1.FilterIndex = 2
  CMDialog1.flags = _
      cdlOFNOverwritePrompt + _
      cdlOFNPathMustExist
  CMDialog1.Action = 2
      
   'f = FileNameIsValid(Filename_Input, CMDialog1)
   'If Not (f) Then Exit Sub
  Filename_Input = CMDialog1.Filename
      
      f = FreeFile
      Open Filename_Input For Output As f

      Print #f, "Input data for the Constant Pattern Model"
    '-- Print Filename

      Print #f,
      Print #f, "From Data File :", Filename
      

      Print #f,
      Print #f, "Chemical:"; Tab(10); Trim$(CPM_Results.Component.Name)
      Print #f, Tab(5); "Molecular weight: "; Tab(28); Format(CPM_Results.Component.MW, "0.00") & " g/mol"
      Print #f, Tab(5); "Normal Boiling Point: "; Tab(28); Format(CPM_Results.Component.BP, "0.00") & " C"
      Print #f, Tab(5); "Molar Volume @ NBP: "; Tab(28); Format_It(CPM_Results.Component.MolarVolume, 2) & " cm" & Chr$(179) & "/mol"
      Print #f, Tab(5); "Initial Concentration: "; Tab(28); Format_It(CPM_Results.Component.InitialConcentration, 2) & " mg/L"
      Print #f, Tab(5); "K: "; Tab(28); Format(CPM_Results.Component.Use_K, "0.000") & " (mg/g)(L/mg)^(1/n)"
      Print #f, Tab(5); "1/n: "; Tab(28); Format(CPM_Results.Component.Use_OneOverN, "0.000")
      Print #f,

      '-----------------------Bed Data ----------------------
      Print #f, "Bed Data:"

      Print #f, Tab(5); "Bed Length: "; Tab(28); Format$(CPM_Results.Bed.length, "0.000E+00") & " m"
      Print #f, Tab(5); "Bed Diameter: "; Tab(28); Format$(CPM_Results.Bed.Diameter, "0.000E+00") & " m"
      Print #f, Tab(5); "Weight of GAC: "; Tab(28); Format$(CPM_Results.Bed.Weight, "0.000E+00") & " kg"
      Print #f, Tab(5); "Inlet Flowrate: "; Tab(28); Format$(CPM_Results.Bed.Flowrate, "0.000E+00") & " m" & Chr$(179) & "/s"
      Print #f, Tab(5); "EBCT: "; Tab(28); Format$(CPM_Results.Bed.length * PI * CPM_Results.Bed.Diameter * CPM_Results.Bed.Diameter / 4# / CPM_Results.Bed.Flowrate / 60#, "0.000E+00") & " mn"
      Print #f,
      Print #f, Tab(5); "Temperature:"; Tab(28); Format$(CPM_Results.Bed.Temperature, "0.00") & " C"
      If CPM_Results.Bed.Phase = 0 Then
        Print #f, Tab(5); "Water Density:"; Tab(28); Format$(CPM_Results.Bed.WaterDensity, "0.0000") & " g/cm" & Chr$(179)
        Print #f, Tab(5); "Water Viscosity:"; Tab(28); Format$(CPM_Results.Bed.WaterViscosity, "0.00E+00") & " g/cm.s"
      Else
        Print #f, Tab(5); "Pressure:"; Tab(28); Format$(CPM_Results.Bed.Pressure, "0.00000") & " atm"
        Print #f, Tab(5); "Air Density:"; Tab(28); Format$(CPM_Results.Bed.WaterDensity, "0.0000") & " g/cm" & Chr$(179)
        Print #f, Tab(5); "Air Viscosity:"; Tab(28); Format$(CPM_Results.Bed.WaterViscosity, "0.00E+00") & " g/cm.s"
      End If
      Print #f,

      '-----------------Carbon Properties -------------------------------
      Print #f, "Carbon Properties:"

      Print #f, Tab(5); "Name: "; Tab(28); Trim$(CPM_Results.Carbon.Name)
      Print #f, Tab(5); "Apparent Density: "; Tab(28); Format$(CPM_Results.Carbon.Density, "0.000") & " g/cm" & Chr$(179)
      Print #f, Tab(5); "Particle Radius: "; Tab(28); Format$(CPM_Results.Carbon.ParticleRadius * 100#, "0.000000") & " cm"
      Print #f, Tab(5); "Porosity: "; Tab(28); Format$(CPM_Results.Carbon.Porosity, "0.000")
      Print #f, Tab(5); "Shape Factor: "; Tab(28); Format$(CPM_Results.Carbon.ShapeFactor, "0.000")
      'Print #f, Tab(5); "Tortuosity: "; Tab(28); Format$(CPM_Results.Carbon.Tortuosity, "0.000")
      Print #f,

      '---------------Kinetic Parameters -----------------------------------------
      Print #f, "Kinetic parameters:"
      Print #f, Tab(5); "kf"; Tab(28); Format_It(CPM_Results.Component.kf, 2) & " cm/s"
      Print #f, Tab(5); "Ds"; Tab(28); Format_It(CPM_Results.Component.Ds, 2) & " cm" & Chr$(178) & "/s"
      Print #f, Tab(5); "SPDFR"; Tab(28); Format_It(CPM_Results.Component.SPDFR, 2)

      Component(0) = CPM_Results.Component
      Print #f, Tab(5); "St"; Tab(28); Format_It(ST(0), 2)
      Print #f, Tab(5); "Eds"; Tab(28); Format_It(Eds(0), 2)
    
      Print #f,

      'Fouling-----------------------------------------
      Print #f, "Fouling correlations:"
      Print #f,
      Print #f,
      Print #f, " Water type : "; Trim$(CPM_Results.Bed.Water_Correlation.Name)
      Eq1 = Format$(CPM_Results.Bed.Water_Correlation.Coeff(1), "0.00")

      If CPM_Results.Bed.Water_Correlation.Coeff(2) > 0 Then
        Eq1 = Eq1 & " + " & Format$(CPM_Results.Bed.Water_Correlation.Coeff(2), "0.00E+00") & "* t "
      Else
        If CPM_Results.Bed.Water_Correlation.Coeff(2) < 0 Then
          Eq1 = Eq1 & " - " & Format$(Abs(CPM_Results.Bed.Water_Correlation.Coeff(2)), "0.00E+00") & "* t "
        End If
      End If
      If CPM_Results.Bed.Water_Correlation.Coeff(3) > 0 Then
        Eq1 = Eq1 & " + " & Format$(CPM_Results.Bed.Water_Correlation.Coeff(3), "0.00") & "* EXP("
      Else
        If CPM_Results.Bed.Water_Correlation.Coeff(3) < 0 Then
          Eq1 = Eq1 & " - " & Format$(Abs(CPM_Results.Bed.Water_Correlation.Coeff(3)), "0.00") & "* EXP("
        End If
      End If
      If CPM_Results.Bed.Water_Correlation.Coeff(3) <> 0 Then
        If CPM_Results.Bed.Water_Correlation.Coeff(4) > 0 Then
          Eq1 = Eq1 & Format$(CPM_Results.Bed.Water_Correlation.Coeff(4), "0.00E+00") & "* t)"
        Else
          If CPM_Results.Bed.Water_Correlation.Coeff(4) < 0 Then
            Eq1 = Eq1 & Format$(CPM_Results.Bed.Water_Correlation.Coeff(4), "0.00E+00") & "* t)"
          End If
        End If
      End If
      Print #f, "K(t)/K0 = " & Eq1
      Print #f, "(t in minutes)"
      Print #f,
     
      Eq1 = ""
      If CPM_Results.Component.Correlation.Coeff(1) = 1# Then
        Eq1 = "(K/K0) "
      Else
        If CPM_Results.Component.Correlation.Coeff(1) <> 0 Then Eq1 = Format$(CPM_Results.Component.Correlation.Coeff(1), "0.00") & " * (K/K0) "
      End If
      If CPM_Results.Component.Correlation.Coeff(2) > 0 Then
        Eq1 = Eq1 & "+ " & Format$(CPM_Results.Component.Correlation.Coeff(2), "0.00")
      Else
        If CPM_Results.Component.Correlation.Coeff(2) <> 0 Then Eq1 = Eq1 & "- " & Format$(Abs(CPM_Results.Component.Correlation.Coeff(2)), "0.00")
      End If
      If Trim$(Eq1) = "" Then
        Eq1 = "K/K0"
      End If
      Print #f, Trim$(CPM_Results.Component.Name) & ":"
      Print #f, Tab(10); "Correlation type: " & Trim$(CPM_Results.Component.Correlation.Name)
      Print #f, Tab(10); "K/K0 = " & Eq1
      Print #f,
                             
      If (CPM_Results.Component.Use_Tortuosity_Correlation) Then
        If (CPM_Results.Component.Constant_Tortuosity) Then
          Print #f, "Correlation used when SOC competition is important:"
          Print #f, " Tortuosity = 0.782 * EBCT^0.925 "
        Else
          Print #f, "Correlation used when NOM fouling is important:"
          Print #f, " Tortuosity = 1.0 if t< 70 days"
          Print #f, " Tortuosity = 0.334 + 6.610E-06 * EBCT"
        End If
      End If
      Print #f,

      '--------- CPM Results ----------------------------------
      Print #f, "Constant Pattern Model Results for " & Trim$(CPM_Results.Component.Name) & ":"
      Print #f,
      Print #f, "Minimum Stanton number:"; Tab(30); Format_It(CPM_Results.Par(1), 2)
      Print #f, "Minimum EBCT:"; Tab(30); Format_It(CPM_Results.Par(2), 2) & " min"
      Print #f, "Minimum Column Length:"; Tab(30); Format_It(CPM_Results.Par(3), 2) & " cm"
      Print #f, "Throughput at 95% of the MTZ:"; Tab(30); Format_It(CPM_Results.Par(4), 2)
      Print #f, "Throughput at 5% of the MTZ:"; Tab(30); Format_It(CPM_Results.Par(5), 2)
      Print #f, "EBCT of the MTZ:"; Tab(30); Format_It(CPM_Results.Par(6), 2) & " min"
      Print #f, "Length of the MTZ:"; Tab(30); Format_It(CPM_Results.Par(7), 2) & " cm"

      Print #f,
      Print #f, Tab(30); "Time(days)"; Tab(40); "BVT"; Tab(50); "TC"; Tab(60); "C (mg/L)"
      Print #f, "5% of the influent conc."; Tab(30); Format_It(CPM_Results.ThroughPut_05.T, 2); Tab(40); Format_It(CPM_Results.ThroughPut_05.T * 24# * 3600# * CPM_Results.Bed.Flowrate / CPM_Results.Bed.length / PI / (Bed.Diameter / 2) ^ 2, 2); Tab(50); Format_It(CPM_Results.ThroughPut_05.T * 24# * 3600# * CPM_Results.Bed.Flowrate / CPM_Results.Bed.Weight, 2); Tab(60); Format_It(CPM_Results.ThroughPut_05.C, 2)
      Print #f, "50% of the influent conc."; Tab(30); Format_It(CPM_Results.ThroughPut_50.T, 2); Tab(40); Format_It(CPM_Results.ThroughPut_50.T * 24# * 3600# * CPM_Results.Bed.Flowrate / CPM_Results.Bed.length / PI / (Bed.Diameter / 2) ^ 2, 2); Tab(50); Format_It(CPM_Results.ThroughPut_50.T * 24# * 3600# * CPM_Results.Bed.Flowrate / CPM_Results.Bed.Weight, 2); Tab(60); Format_It(CPM_Results.ThroughPut_50.C, 2)
      Print #f, "95% of the influent conc."; Tab(30); Format_It(CPM_Results.ThroughPut_95.T, 2); Tab(40); Format_It(CPM_Results.ThroughPut_95.T * 24# * 3600# * CPM_Results.Bed.Flowrate / CPM_Results.Bed.length / PI / (Bed.Diameter / 2) ^ 2, 2); Tab(50); Format_It(CPM_Results.ThroughPut_95.T * 24# * 3600# * CPM_Results.Bed.Flowrate / CPM_Results.Bed.Weight, 2); Tab(60); Format_It(CPM_Results.ThroughPut_95.C, 2)
      Print #f,
      Print #f, "TC (Treatment Capacity) is in m" & Chr$(179) & "  / kg of GAC"
      Print #f,

      If Flag_TO Then
        Print #f, "Treatment Objective: " & Format_It(Treatment_Objective.C, 2) & " mg/L"
        Print #f,
        Print #f, "Time (days):"; Tab(20); Format_It(Treatment_Objective.T, 2)
        Print #f, "BVT:"; Tab(20); Format_It(Treatment_Objective.T * 24# * 3600# * CPM_Results.Bed.Flowrate / CPM_Results.Bed.length / PI / (CPM_Results.Bed.Diameter / 2) ^ 2, 2)
        Print #f, "Tr. Capacity:"; Tab(20); Format_It(Treatment_Objective.T * 24# * 3600# * CPM_Results.Bed.Flowrate / CPM_Results.Bed.Weight, 2)
      Else
        Print #f, "The breakthrough time for the treatment objective (" & Format_It(Treatment_Objective.C, 2) & "mg/L) could not be calculated."
      End If
      Close (f)
    CMDialog1.Filename = ""
    Exit Sub

File_Error:
  If (Err.number = cdlCancel) Then
    'DO NOTHING.
  Else
    Call Show_Trapped_Error("cmdFile_Click")
  End If
  Resume Exit_Print_File
Exit_Print_File:
End Sub


Private Sub cmdPrint_Click()
Dim Error_Code As Integer, temp  As String
Dim H As Single, W As Single, Eq1 As String, i As Integer

    On Error GoTo Print_Error

'---Print Graph ---------------------------------------------------
    H = grpBreak.Height
    W = grpBreak.Width

    grpBreak.Visible = False 'Hide it before printing

    If Printer.Width < Printer.Height Then
      grpBreak.Height = CSng(Printer.Height / 2#)
      grpBreak.Width = Printer.Width
    Else
      grpBreak.Height = Printer.Height
      grpBreak.Width = Printer.Width
    End If
    On Error GoTo Print_Error

    grpBreak.PrintStyle = 2
    grpBreak.DrawMode = 5

    grpBreak.Height = H
    grpBreak.Width = W

    grpBreak.Visible = True
    
    grpBreak.PrintStyle = 2
    grpBreak.DrawMode = 2

'---Print other results------------------------------------------
  Printer.ScaleLeft = -1080  'Set a 3/4-inch margin
  Printer.ScaleTop = -1080
  Printer.CurrentX = 0
  Printer.CurrentY = 0

    '-- Print Filename

    Printer.FontSize = 10
    Printer.Print "From Data File: "; Filename
    Printer.Print

    Printer.FontSize = 12
    Printer.FontBold = True
    Printer.FontUnderline = True
    Printer.Print "Input data for the Constant Pattern Model"
    Printer.FontSize = 10
    Printer.FontBold = False
    Printer.FontUnderline = True
    Printer.Print
    Printer.Print "Chemical:"; Tab(10); Trim$(CPM_Results.Component.Name)
    Printer.FontUnderline = False
    Printer.Print Tab(5); "Molecular weight: "; Tab(28); Format(CPM_Results.Component.MW, "0.00") & " g/mol"
    Printer.Print Tab(5); "Normal Boiling Point: "; Tab(28); Format(CPM_Results.Component.BP, "0.00") & " C"
    Printer.Print Tab(5); "Molar Volume @ NBP: "; Tab(28); Format_It(CPM_Results.Component.MolarVolume, 2) & " cm" & Chr$(179) & "/mol"
    Printer.Print Tab(5); "Initial Concentration: "; Tab(28); Format_It(CPM_Results.Component.InitialConcentration, 2) & " mg/L"
    Printer.Print Tab(5); "K: "; Tab(28); Format(CPM_Results.Component.Use_K, "0.000") & " (mg/g)(L/mg)^(1/n)"
    Printer.Print Tab(5); "1/n: "; Tab(28); Format(CPM_Results.Component.Use_OneOverN, "0.000")
    Printer.Print

    '-----------------------Bed Data ----------------------
    Printer.FontUnderline = True
    Printer.Print "Bed Data:"
    Printer.FontUnderline = False

    Printer.Print Tab(5); "Bed Length: "; Tab(28); Format$(CPM_Results.Bed.length, "0.000E+00") & " m"
    Printer.Print Tab(5); "Bed Diameter: "; Tab(28); Format$(CPM_Results.Bed.Diameter, "0.000E+00") & " m"
    Printer.Print Tab(5); "Weight of GAC: "; Tab(28); Format$(CPM_Results.Bed.Weight, "0.000E+00") & " kg"
    Printer.Print Tab(5); "Inlet Flowrate: "; Tab(28); Format$(CPM_Results.Bed.Flowrate, "0.000E+00") & " m" & Chr$(179) & "/s"
    Printer.Print Tab(5); "EBCT: "; Tab(28); Format$(CPM_Results.Bed.length * PI * CPM_Results.Bed.Diameter * CPM_Results.Bed.Diameter / 4# / CPM_Results.Bed.Flowrate / 60#, "0.000E+00") & " mn"
    Printer.Print
    Printer.Print Tab(5); "Temperature:"; Tab(28); Format$(CPM_Results.Bed.Temperature, "0.00") & " C"
    If CPM_Results.Bed.Phase = 0 Then
      Printer.Print Tab(5); "Water Density:"; Tab(28); Format$(CPM_Results.Bed.WaterDensity, "0.0000") & " g/cm" & Chr$(179)
      Printer.Print Tab(5); "Water Viscosity:"; Tab(28); Format$(CPM_Results.Bed.WaterViscosity, "0.00E+00") & " g/cm.s"
    Else
      Printer.Print Tab(5); "Pressure:"; Tab(28); Format$(CPM_Results.Bed.Pressure, "0.00000") & " atm"
      Printer.Print Tab(5); "Air Density:"; Tab(28); Format$(CPM_Results.Bed.WaterDensity, "0.0000") & " g/cm" & Chr$(179)
      Printer.Print Tab(5); "Air Viscosity:"; Tab(28); Format$(CPM_Results.Bed.WaterViscosity, "0.00E+00") & " g/cm.s"
    End If
    Printer.Print

    '-----------------Carbon Properties -------------------------------
    Printer.FontUnderline = True
    Printer.Print "Carbon Properties:"
    Printer.FontUnderline = False

    Printer.Print Tab(5); "Name: "; Tab(28); Trim$(CPM_Results.Carbon.Name)
    Printer.Print Tab(5); "Apparent Density: "; Tab(28); Format$(CPM_Results.Carbon.Density, "0.000") & " g/cm" & Chr$(179)
    Printer.Print Tab(5); "Particle Radius: "; Tab(28); Format$(CPM_Results.Carbon.ParticleRadius * 100#, "0.000000") & " cm"
    Printer.Print Tab(5); "Porosity: "; Tab(28); Format$(CPM_Results.Carbon.Porosity, "0.000")
    Printer.Print Tab(5); "Shape Factor: "; Tab(28); Format$(CPM_Results.Carbon.ShapeFactor, "0.000")
    'Printer.Print Tab(5); "Tortuosity: "; Tab(28); Format$(CPM_Results.Carbon.Tortuosity, "0.000")
    Printer.Print

    '---------------Kinetic Parameters -----------------------------------------
    Printer.FontUnderline = True
    Printer.Print "Kinetic parameters:"
    Printer.FontUnderline = False
    Printer.Print Tab(5); "kf"; Tab(28); Format_It(CPM_Results.Component.kf, 2) & " cm/s"
    Printer.Print Tab(5); "Ds"; Tab(28); Format_It(CPM_Results.Component.Ds, 2) & " cm" & Chr$(178) & "/s"
    Printer.Print Tab(5); "SPDFR"; Tab(28); Format_It(CPM_Results.Component.SPDFR, 2)

    Component(0) = CPM_Results.Component
    Printer.Print Tab(5); "St"; Tab(28); Format_It(ST(0), 2)
    Printer.Print Tab(5); "Eds"; Tab(28); Format_It(Eds(0), 2)
    
    Printer.Print

    'Fouling-----------------------------------------
    Printer.FontUnderline = True
    Printer.Print "Fouling correlations:"
    Printer.FontUnderline = False
    Printer.Print

    Printer.Print
    Printer.Print " Water type : "; Trim$(CPM_Results.Bed.Water_Correlation.Name)
    Eq1 = Format$(CPM_Results.Bed.Water_Correlation.Coeff(1), "0.00")

    If CPM_Results.Bed.Water_Correlation.Coeff(2) > 0 Then
     Eq1 = Eq1 & " + " & Format$(CPM_Results.Bed.Water_Correlation.Coeff(2), "0.00E+00") & "* t "
    Else
     If CPM_Results.Bed.Water_Correlation.Coeff(2) < 0 Then
     Eq1 = Eq1 & " - " & Format$(Abs(CPM_Results.Bed.Water_Correlation.Coeff(2)), "0.00E+00") & "* t "
     End If
    End If
    If CPM_Results.Bed.Water_Correlation.Coeff(3) > 0 Then
     Eq1 = Eq1 & " + " & Format$(CPM_Results.Bed.Water_Correlation.Coeff(3), "0.00") & "* EXP("
    Else
     If CPM_Results.Bed.Water_Correlation.Coeff(3) < 0 Then
     Eq1 = Eq1 & " - " & Format$(Abs(CPM_Results.Bed.Water_Correlation.Coeff(3)), "0.00") & "* EXP("
     End If
    End If
    If CPM_Results.Bed.Water_Correlation.Coeff(3) <> 0 Then
      If CPM_Results.Bed.Water_Correlation.Coeff(4) > 0 Then
       Eq1 = Eq1 & Format$(CPM_Results.Bed.Water_Correlation.Coeff(4), "0.00E+00") & "* t)"
      Else
       If CPM_Results.Bed.Water_Correlation.Coeff(4) < 0 Then
        Eq1 = Eq1 & Format$(CPM_Results.Bed.Water_Correlation.Coeff(4), "0.00E+00") & "* t)"
       End If
      End If
    End If
    Printer.Print "K(t)/K0 = " & Eq1
    Printer.Print "(t in minutes)"
    Printer.Print

     
    Eq1 = ""
    If CPM_Results.Component.Correlation.Coeff(1) = 1# Then
      Eq1 = "(K/K0) "
    Else
      If CPM_Results.Component.Correlation.Coeff(1) <> 0 Then Eq1 = Format$(CPM_Results.Component.Correlation.Coeff(1), "0.00") & " * (K/K0) "
    End If
    If CPM_Results.Component.Correlation.Coeff(2) > 0 Then
      Eq1 = Eq1 & "+ " & Format$(CPM_Results.Component.Correlation.Coeff(2), "0.00")
    Else
      If CPM_Results.Component.Correlation.Coeff(2) <> 0 Then Eq1 = Eq1 & "- " & Format$(Abs(CPM_Results.Component.Correlation.Coeff(2)), "0.00")
    End If
    If Trim$(Eq1) = "" Then
       Eq1 = "K/K0"
    End If
    Printer.Print Trim$(CPM_Results.Component.Name) & ":"
    Printer.Print Tab(10); "Correlation type: " & Trim$(CPM_Results.Component.Correlation.Name)

    Printer.Print Tab(10); "K/K0 = " & Eq1

    Printer.Print
                            
    If (CPM_Results.Component.Use_Tortuosity_Correlation) Then
      If (CPM_Results.Component.Constant_Tortuosity) Then
        Printer.Print "Correlation used when SOC competition is important:"
        Printer.Print " Tortuosity = 0.782 * EBCT^0.925 "
      Else
        Printer.Print "Correlation used when NOM fouling is important:"
        Printer.Print " Tortuosity = 1.0 if t< 70 days"
        Printer.Print " Tortuosity = 0.334 + 6.610E-06 * EBCT"
      End If
    End If
    Printer.Print

    '--------- CPM Results ----------------------------------
    Printer.Print
    Printer.FontSize = 12
    Printer.FontBold = True
    Printer.FontUnderline = True
    Printer.Print "Constant Pattern Model Results for " & Trim$(CPM_Results.Component.Name) & ":"
    Printer.Print
    Printer.FontSize = 10
    Printer.FontBold = False
    Printer.FontUnderline = False
    Printer.Print "Minimum Stanton number:"; Tab(30); Format_It(CPM_Results.Par(1), 2)
    Printer.Print "Minimum EBCT:"; Tab(30); Format_It(CPM_Results.Par(2), 2) & " min"
    Printer.Print "Minimum Column Length:"; Tab(30); Format_It(CPM_Results.Par(3), 2) & " cm"
    Printer.Print "MTZ Length:"; Tab(30); Format_It(CPM_Results.Par(7), 2) & " cm"

    Printer.Print
    Printer.Print Tab(30); "Time(days)"; Tab(40); "BVT"; Tab(50); "TC"; Tab(60); "C (mg/L)"
    Printer.Print "5% of the influent conc."; Tab(30); Format_It(CPM_Results.ThroughPut_05.T, 2); Tab(40); Format_It(CPM_Results.ThroughPut_05.T * 24# * 3600# * CPM_Results.Bed.Flowrate / CPM_Results.Bed.length / PI / (Bed.Diameter / 2) ^ 2, 2); Tab(50); Format_It(CPM_Results.ThroughPut_05.T * 24# * 3600# * CPM_Results.Bed.Flowrate / CPM_Results.Bed.Weight, 2); Tab(60); Format_It(CPM_Results.ThroughPut_05.C, 2)
    Printer.Print "50% of the influent conc."; Tab(30); Format_It(CPM_Results.ThroughPut_50.T, 2); Tab(40); Format_It(CPM_Results.ThroughPut_50.T * 24# * 3600# * CPM_Results.Bed.Flowrate / CPM_Results.Bed.length / PI / (Bed.Diameter / 2) ^ 2, 2); Tab(50); Format_It(CPM_Results.ThroughPut_50.T * 24# * 3600# * CPM_Results.Bed.Flowrate / CPM_Results.Bed.Weight, 2); Tab(60); Format_It(CPM_Results.ThroughPut_50.C, 2)
    Printer.Print "95% of the influent conc."; Tab(30); Format_It(CPM_Results.ThroughPut_95.T, 2); Tab(40); Format_It(CPM_Results.ThroughPut_95.T * 24# * 3600# * CPM_Results.Bed.Flowrate / CPM_Results.Bed.length / PI / (Bed.Diameter / 2) ^ 2, 2); Tab(50); Format_It(CPM_Results.ThroughPut_95.T * 24# * 3600# * CPM_Results.Bed.Flowrate / CPM_Results.Bed.Weight, 2); Tab(60); Format_It(CPM_Results.ThroughPut_95.C, 2)
    Printer.Print
    Printer.Print "TC (Treatment Capacity) is in m" & Chr$(179) & "  / kg of GAC"
    Printer.Print

    If Flag_TO Then
     Printer.Print "Treatment Objective: " & Format_It(Treatment_Objective.C, 2) & " mg/L"
     Printer.Print
     Printer.Print "Time (days):"; Tab(20); Format_It(Treatment_Objective.T, 2)
     Printer.Print "BVT:"; Tab(20); Format_It(Treatment_Objective.T * 24# * 3600# * CPM_Results.Bed.Flowrate / CPM_Results.Bed.length / PI / (CPM_Results.Bed.Diameter / 2) ^ 2, 2)
     Printer.Print "Tr. Capacity:"; Tab(20); Format_It(Treatment_Objective.T * 24# * 3600# * CPM_Results.Bed.Flowrate / CPM_Results.Bed.Weight, 2)
    Else
     Printer.Print "The breakthrough time for the treatment objective (" & Format_It(Treatment_Objective.C, 2) & "mg/L) could not be calculated."
    End If
    Printer.EndDoc
    Exit Sub

Print_Error:
  Call Show_Trapped_Error("cmdPrint_Click")
  Resume Exit_Print
Exit_Print:

End Sub


Private Sub cmdSave_Click()
Dim f As Integer, i As Integer, temp As String
Dim Filename_CPM As String
On Error GoTo Save_Results_CPM_Error
  CMDialog1.CancelError = True
  CMDialog1.Filename = ""
  CMDialog1.Filter = "All Files (*.*)|*.*|Text Files (*.txt)|*.txt|Data Files (*.dat)|*.dat"
  CMDialog1.FilterIndex = 2
  CMDialog1.DialogTitle = "Save curve from Constant Pattern Model"
  CMDialog1.flags = _
      cdlOFNOverwritePrompt + _
      cdlOFNPathMustExist
  CMDialog1.Action = 2

   'f = FileNameIsValid(Filename_CPM, CMDialog1)
   'If Not (f) Then Exit Sub
  Filename_CPM = CMDialog1.Filename

    f = FreeFile
    Open Filename_CPM For Output As f
    Write #f, "Results file for Constant Pattern Model"
    temp = "Time(days)       "
     temp = temp & "BVT" & "        " & "Usage Rate " & "     " & Trim$(CPM_Results.Component.Name)
    Print #f, temp
    Print #f, " days             -         m" & Chr$(179) & "/kg GAC  "
    Write #f,
    temp = ""
    For i = 1 To 100
     temp = Format$(CPM_Results.T(i), "0.00")
     temp = temp & "       " & Format$(CPM_Results.T(i) * 24# * 3600# * CPM_Results.Bed.Flowrate / CPM_Results.Bed.length / PI / (CPM_Results.Bed.Diameter / 2#) ^ 2, "0.00")
     temp = temp & "       " & Format$(CPM_Results.T(i) * 24# * 3600# * CPM_Results.Bed.Flowrate / CPM_Results.Bed.Weight, "0.00")
     temp = temp & "       " & Format$(CPM_Results.C_Over_C0(i), "0.000")
     Print #f, temp
     temp = ""
    Next i
    Close f
    CMDialog1.Filename = ""
    Exit Sub
Save_Results_CPM_Error:
  If (Err.number = cdlCancel) Then
    'DO NOTHING.
  Else
    Call Show_Trapped_Error("cmdSave_Click")
  End If
  Resume Exit_Save_Results_CPM
Exit_Save_Results_CPM:
End Sub


Private Sub cmdSelect_Click()
Dim Error_Code As Integer
Dim temp As String
  On Error GoTo Select_Print_Error
  'CMDialog1.flags = PD_PRINTSETUP
  'CMDialog1.Action = 5
  CMDialog1.CancelError = False
  CMDialog1.ShowPrinter
  Exit Sub
Select_Print_Error:
  Call Show_Trapped_Error("cmdSelect_Click")
  Resume Exit_Select_Print
Exit_Select_Print:
End Sub


Private Sub cmdTreat_Click()
Dim Objective As String, temp As Double, Tr_Obj As Double, J  As Integer
  Objective = InputBox$("Enter your treatment objective in mg/L:", Application_Name, lblData(9))
On Error GoTo Bad_Treament_Objective
  temp = CDbl(Objective)
  Tr_Obj = temp / CPM_Results.Component.InitialConcentration
  For J = 1 To CPM_Max_Points
    If J > 2 Then
      If (CPM_Results.C_Over_C0(J) >= Tr_Obj) And (CPM_Results.C_Over_C0(J - 1) < Tr_Obj) Then
        Treatment_Objective.T = (CPM_Results.T(J) - CPM_Results.T(J - 1)) / (CPM_Results.C_Over_C0(J) - CPM_Results.C_Over_C0(J - 1)) * (Tr_Obj - CPM_Results.C_Over_C0(J - 1)) + CPM_Results.T(J - 1)
        Treatment_Objective.C = ((CPM_Results.C_Over_C0(J) - CPM_Results.C_Over_C0(J - 1)) / (CPM_Results.T(J) - CPM_Results.T(J - 1)) * (Treatment_Objective.T - CPM_Results.T(J - 1)) + CPM_Results.C_Over_C0(J - 1)) * CPM_Results.Component.InitialConcentration
        GoTo Exit_Loop
      End If
    End If
  Next J
  Flag_TO = False
  lblData(15) = "N/A"
  lblData(16) = "N/A"
  lblData(17) = "N/A"
  lblData(18) = "N/A"
  Exit Sub
Exit_Loop:
  Flag_TO = True
  lblData(15) = Format_It(Treatment_Objective.T, 2)
  lblData(16) = Format_It(Treatment_Objective.T * 24# * 3600# * CPM_Results.Bed.Flowrate / CPM_Results.Bed.length / PI / (CPM_Results.Bed.Diameter / 2) ^ 2, 2)
  lblData(17) = Format_It(Treatment_Objective.T * 24# * 3600# * CPM_Results.Bed.Flowrate / CPM_Results.Bed.Weight, 2)
  lblData(18) = Format_It(Treatment_Objective.C, 2)
  Exit Sub
Bad_Treament_Objective:
   Resume Exit_lblLegend_Click
Exit_lblLegend_Click:
End Sub


Private Sub Form_Load()
Dim i As Integer
   
  PopulatingScrollboxes = False
  Screen.MousePointer = 11
  
  'Move frmPFPSDM.Left + (frmPFPSDM.Width / 2) - (frmCPM.Width / 2), frmPFPSDM.Top + (frmPFPSDM.Height / 2) - (frmCPM.Height / 2)
  Call CenterOnForm(Me, frmMain)
  
  Frame3D1.Caption = "Results for " & Trim$(CPM_Results.Component.Name) & ":"
  lblParaValue(0) = Format_It(CPM_Results.Par(1), 2) 'Minimum Stanton
  lblParaValue(2) = Format_It(CPM_Results.Par(7), 2) 'MTZ Length
  lblParaValue(5) = Format_It(CPM_Results.Par(2), 2) 'Minimum EBCT
  lblParaValue(6) = Format_It(CPM_Results.Par(3), 2) 'Minimum Column Length
  
  lblLegend(2) = "BVT(m" & Chr$(179) & "/m" & Chr$(179) & ")"
  lblLegend(3) = "VTM(m" & Chr$(179) & "/kg)"
  
  Treatment_Objective = CPM_Results.ThroughPut_05
  
  Call Populate_Scrollboxes
  Call cboGrid_Click
  Call optType_Click(1, CInt(optType(1).Value))
  
  'cboGrid.AddItem "None"
  'cboGrid.AddItem "Horizontal"
  'cboGrid.AddItem "Vertical"
  'cboGrid.AddItem "Both"
  'cboGrid.ListIndex = 0
  
  '    optType(0) = True
  
  Flag_TO = True
  lblData(0) = Format_It(CPM_Results.ThroughPut_05.T, 2)
  lblData(1) = Format_It(CPM_Results.ThroughPut_50.T, 2)
  lblData(2) = Format_It(CPM_Results.ThroughPut_95.T, 2)
  '------ C -------
  lblData(9) = Format_It(CPM_Results.ThroughPut_05.C, 2)
  lblData(10) = Format_It(CPM_Results.ThroughPut_50.C, 2)
  lblData(11) = Format_It(CPM_Results.ThroughPut_95.C, 2)
  
  '----- BVF ---------
  lblData(3) = Format_It(CPM_Results.ThroughPut_05.T * 24# * 3600# * CPM_Results.Bed.Flowrate / CPM_Results.Bed.length / PI / (CPM_Results.Bed.Diameter / 2) ^ 2, 2)
  lblData(4) = Format_It(CPM_Results.ThroughPut_50.T * 24# * 3600# * CPM_Results.Bed.Flowrate / CPM_Results.Bed.length / PI / (CPM_Results.Bed.Diameter / 2) ^ 2, 2)
  lblData(5) = Format_It(CPM_Results.ThroughPut_95.T * 24# * 3600# * CPM_Results.Bed.Flowrate / CPM_Results.Bed.length / PI / (CPM_Results.Bed.Diameter / 2) ^ 2, 2)
  
  '-----Carbon Us. rate --------- m3 of water/kg of GAC
  lblData(6) = Format_It(CPM_Results.ThroughPut_05.T * 24# * 3600# * CPM_Results.Bed.Flowrate / CPM_Results.Bed.Weight, 2)
  lblData(7) = Format_It(CPM_Results.ThroughPut_50.T * 24# * 3600# * CPM_Results.Bed.Flowrate / CPM_Results.Bed.Weight, 2)
  lblData(8) = Format_It(CPM_Results.ThroughPut_95.T * 24# * 3600# * CPM_Results.Bed.Flowrate / CPM_Results.Bed.Weight, 2)
  
  '-----Treatment Objective------
  cmdTreat.Caption = "Treat. Objective"
  lblData(15) = lblData(0)
  lblData(16) = lblData(3)
  lblData(17) = lblData(6)
  lblData(18) = lblData(9)
  
  '     grpBreak.GridStyle = 0

End Sub
Private Sub Form_Unload(Cancel As Integer)
  Call UserPrefs_Save
End Sub


Private Sub optType_Click(index As Integer, Value As Integer)
  If (Not PopulatingScrollboxes) Then
    Call Draw_CPM
  End If
End Sub


Private Sub Populate_Scrollboxes()
Dim i As Integer
  PopulatingScrollboxes = True
  cboGrid.AddItem "None"
  cboGrid.AddItem "Horizontal"
  cboGrid.AddItem "Vertical"
  cboGrid.AddItem "Both"
  '-- Read in INI settings
  cboGrid.ListIndex = 0
  Call UserPrefs_Load
  PopulatingScrollboxes = False
End Sub


Private Sub UserPrefs_Load()
Dim X As Long
  On Error GoTo err_FRMCPM_UserPrefs_Load
  X = CLng(INI_Getsetting("FRMCPM_cboGrid"))
  If ((X >= 0) And (X <= cboGrid.ListCount - 1)) Then
    cboGrid.ListIndex = X
  End If
  X = CLng(INI_Getsetting("FRMCPM_optType"))
  If ((X >= 0) And (X <= 2)) Then
    optType(X).Value = True
  End If
  Exit Sub
resume_err_FRMCPM_UserPrefs_Load:
  Call UserPrefs_Save
  Exit Sub
err_FRMCPM_UserPrefs_Load:
  Resume resume_err_FRMCPM_UserPrefs_Load
End Sub
Private Sub UserPrefs_Save()
Dim X As Long
  X = cboGrid.ListIndex
  Call INI_PutSetting("FRMCPM_cboGrid", Trim$(CStr(X)))
  If (optType(0)) Then X = 0
  If (optType(1)) Then X = 1
  If (optType(2)) Then X = 2
  Call INI_PutSetting("FRMCPM_optType", Trim$(CStr(X)))
End Sub


VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Object = "{0842D103-1E19-101B-9AAF-1A1626551E7C}#1.0#0"; "GRAPH32.OCX"
Begin VB.Form frmModelDataComparison 
   Caption         =   "Data Comparison"
   ClientHeight    =   6795
   ClientLeft      =   1005
   ClientTop       =   1995
   ClientWidth     =   9480
   LinkTopic       =   "Form1"
   ScaleHeight     =   6795
   ScaleWidth      =   9480
   Begin Threed.SSCommand cmdClose 
      Height          =   435
      Left            =   7950
      TabIndex        =   11
      Top             =   60
      Width           =   1455
      _Version        =   65536
      _ExtentX        =   2566
      _ExtentY        =   767
      _StockProps     =   78
      Caption         =   "&Close"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSFrame SSFrame1 
      Height          =   615
      Left            =   90
      TabIndex        =   7
      Top             =   420
      Width           =   1155
      _Version        =   65536
      _ExtentX        =   2037
      _ExtentY        =   1085
      _StockProps     =   14
      Caption         =   "C Units"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Alignment       =   2
      Begin VB.ComboBox cboCUnits 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Left            =   120
         Style           =   2  'Dropdown List
         TabIndex        =   8
         Top             =   240
         Width           =   915
      End
   End
   Begin VB.ComboBox cboGraphType 
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   6510
      Style           =   2  'Dropdown List
      TabIndex        =   2
      Top             =   60
      Width           =   1335
   End
   Begin VB.ComboBox cboCompo 
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   1890
      Style           =   2  'Dropdown List
      TabIndex        =   1
      Top             =   60
      Width           =   3195
   End
   Begin VB.ComboBox cboGrid 
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   6510
      Style           =   2  'Dropdown List
      TabIndex        =   0
      Top             =   420
      Width           =   1335
   End
   Begin GraphLib.Graph grpBreak 
      Height          =   5655
      Left            =   90
      TabIndex        =   3
      Top             =   1080
      Width           =   9315
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   2646
      _StockProps     =   96
      BorderStyle     =   1
      RandomData      =   1
      ColorData       =   0
      ExtraData       =   0
      ExtraData[]     =   0
      FontFamily      =   4
      FontSize        =   4
      FontSize[0]     =   200
      FontSize[1]     =   150
      FontSize[2]     =   100
      FontSize[3]     =   100
      FontStyle       =   4
      GraphData       =   0
      GraphData[]     =   0
      LabelText       =   0
      LegendText      =   0
      PatternData     =   0
      SymbolData      =   0
      XPosData        =   0
      XPosData[]      =   0
   End
   Begin Threed.SSFrame SSFrame2 
      Height          =   615
      Left            =   1230
      TabIndex        =   9
      Top             =   420
      Width           =   1155
      _Version        =   65536
      _ExtentX        =   2037
      _ExtentY        =   1085
      _StockProps     =   14
      Caption         =   "T Units"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Alignment       =   2
      Begin VB.ComboBox cboTUnits 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Left            =   120
         Style           =   2  'Dropdown List
         TabIndex        =   10
         Top             =   240
         Width           =   915
      End
   End
   Begin Threed.SSCommand cmdPrint 
      Height          =   435
      Left            =   7950
      TabIndex        =   12
      Top             =   480
      Width           =   1455
      _Version        =   65536
      _ExtentX        =   2566
      _ExtentY        =   767
      _StockProps     =   78
      Caption         =   "&Print Graph"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin VB.Label Label3 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H00C0C0C0&
      BackStyle       =   0  'Transparent
      Caption         =   "Select a component:"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Left            =   -30
      TabIndex        =   6
      Top             =   120
      Width           =   1875
   End
   Begin VB.Label Label4 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H00C0C0C0&
      BackStyle       =   0  'Transparent
      Caption         =   "Plot Patterns:"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Left            =   5250
      TabIndex        =   5
      Top             =   120
      Width           =   1215
   End
   Begin VB.Label Label5 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Grid Style:"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Left            =   5130
      TabIndex        =   4
      Top             =   480
      Width           =   1335
   End
End
Attribute VB_Name = "frmModelDataComparison"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
Option Base 1

Dim Cin() As Double, Td()  As Double, Cd() As Double, Fmin() As Double
Dim UnloadMe As Integer

Dim PopulatingScrollboxes As Integer

'---- Conc Units
Const CBOCUNITS_CC0 = 0
Const CBOCUNITS_mg_L = 1
Const CBOCUNITS_ug_L = 2

'---- Time Units
Const CBOTUNITS_days = 0
Const CBOTUNITS_BVF = 1
Const CBOTUNITS_VTM = 2





Const frmModelDataComparison_declarations_end = True


Private Sub Populate_Scrollboxes()
Dim i As Integer
  PopulatingScrollboxes = True
  'For i = 0 To 2
  '  cboDataset(i).Clear
  '  cboDataset(i).AddItem "Off"
  '  cboDataset(i).AddItem "Symbols"
  '  cboDataset(i).AddItem "Lines"
  '  cboDataset(i).AddItem "Symbols and Lines"
  'Next i
  cboCUnits.Clear
  cboCUnits.AddItem "C/C0"
  cboCUnits.AddItem "mg/L"
  cboCUnits.AddItem Chr$(181) & "g/L"
  cboTUnits.Clear
  cboTUnits.AddItem "days"
  cboTUnits.AddItem "BVF"
  cboTUnits.AddItem "VTM"
  cboGraphType.Clear
  cboGraphType.AddItem "Symbols"
  cboGraphType.AddItem "Lines"
  cboGrid.AddItem "None"
  cboGrid.AddItem "Horizontal"
  cboGrid.AddItem "Vertical"
  cboGrid.AddItem "Both"
  cboCompo.Clear
  Select Case frmCompareData_WhichSet
    Case frmCompareData_WhichSet_PSDM
      For i = 1 To Results.NComponent
        cboCompo.AddItem Trim$(Results.Component(i).Name)
      Next i
    Case frmCompareData_WhichSet_CPHSDM
      cboCompo.AddItem Trim$(CPM_Results.Component.Name)
  End Select
  '---- Read in INI settings
  'cboDataset(0).ListIndex = 1
  'cboDataset(1).ListIndex = 1
  'cboDataset(2).ListIndex = 1
  cboCUnits.ListIndex = 0
  cboTUnits.ListIndex = 0
  cboGraphType.ListIndex = 0
  cboGrid.ListIndex = 0
  cboCompo.ListIndex = 0
  Call UserPrefs_Load
  PopulatingScrollboxes = False
End Sub




Private Sub cboCompo_Click()
  If (Not PopulatingScrollboxes) Then
    Call Draw_Curves(cboCompo.ListIndex + 1)
    'lblErrorC = Format$(Fmin(cboCompo.ListIndex + 1), "0.0000E+00")
  End If
End Sub
Private Sub cboCUnits_Click()
  If (Not PopulatingScrollboxes) Then
    Call Draw_Curves(cboCompo.ListIndex + 1)
  End If
End Sub
Private Sub cboDataset_Click(index As Integer)
  'If (Not PopulatingScrollboxes) Then
  '  Call Draw_Curves(cboCompo.ListIndex + 1)
  'End If
End Sub
Private Sub cboGraphType_Click()
  If (Not PopulatingScrollboxes) Then
    Select Case cboGraphType.ListIndex
      Case 0 'Symbols
        grpBreak.GraphStyle = 1
      Case 1 'Lines
        grpBreak.GraphStyle = 4
    End Select
    grpBreak.DrawMode = 2
  End If
End Sub
Private Sub cboGrid_Click()
  If (Not PopulatingScrollboxes) Then
    grpBreak.GridStyle = cboGrid.ListIndex
    grpBreak.DrawMode = 2
  End If
End Sub
Private Sub cboTUnits_Click()
  If (Not PopulatingScrollboxes) Then
    Call Draw_Curves(cboCompo.ListIndex + 1)
  End If
End Sub


Private Sub cmdClose_Click()
  Unload Me
End Sub


Private Sub cmdPrint_Click()
Dim i As Integer
Dim H As Single
Dim W As Single
  'printer.ScaleLeft = -1080  'Set a 3/4-inch margin
  'printer.ScaleTop = -1080
  'printer.CurrentX = 0
  'printer.CurrentY = 0
  '
  '  printer.FontSize = 12
  '  printer.FontBold = True
  '  printer.FontUnderline = True
  '  printer.Print "Input data for the Plug-Flow Pore And Surface Diffusion Model"
  '  printer.FontSize = 10
  '  printer.FontBold = False
  '  printer.FontUnderline = False
  '  '-- Print Filename
  '  printer.Print
  '  printer.Print "From Data File: "; Filename
  '---- Print the graph ------------------------
  For i = 1 To Number_Component
    grpBreak.ThisPoint = i
    grpBreak.PatternData = i - 1
  Next i
  H = grpBreak.Height
  W = grpBreak.Width
  grpBreak.Visible = False 'Hide it before printing
  If (Printer.Width < Printer.Height) Then
    grpBreak.Height = CSng(Printer.Height / 2#)
    grpBreak.Width = Printer.Width
  Else
    grpBreak.Height = Printer.Height
    grpBreak.Width = Printer.Width
  End If
  grpBreak.PrintStyle = 2
  grpBreak.DrawMode = 5
  grpBreak.Height = H
  grpBreak.Width = W
  grpBreak.Visible = True
  grpBreak.PrintStyle = 2
  grpBreak.DrawMode = 2
  Printer.EndDoc
End Sub


Private Sub Draw_Curves(Component_Index As Integer)
Dim i As Integer, J As Integer
Dim Data_Max As Double, t_factor As Double, Bottom_Title As String
Dim c_factor As Double, Left_Title As String
Dim bigger As Integer
Dim SameX, SameY As Double
Dim LastPointI As Integer
Dim bed_data As BedPropertyType
Dim comp_data As ComponentPropertyType
Dim num_model_points As Integer

  Select Case frmCompareData_WhichSet
    Case frmCompareData_WhichSet_PSDM
      bed_data = Results.Bed
      comp_data = Results.Component(Component_Index)
      num_model_points = Results.npoints
    Case frmCompareData_WhichSet_CPHSDM
      bed_data = CPM_Results.Bed
      comp_data = CPM_Results.Component
      num_model_points = 100
  End Select
  
  Select Case cboTUnits.ListIndex
    Case CBOTUNITS_days:
      t_factor = 1# / 60# / 24#  'mn -> days
      Bottom_Title = "Time(days)"
    Case CBOTUNITS_BVF:
      t_factor = 60# * bed_data.Flowrate / bed_data.Length / PI / (bed_data.Diameter / 2#) ^ 2
      Bottom_Title = "Bed Volumes Treated"
    Case CBOTUNITS_VTM:
      t_factor = 60# * bed_data.Flowrate / bed_data.Weight
      Bottom_Title = "m" & Chr$(179) & " treated per kg of adsorbent"
  End Select

  Select Case cboCUnits.ListIndex
    Case CBOCUNITS_CC0:
      c_factor = 1#
      Left_Title = "C/C0"
    Case CBOCUNITS_mg_L:
      c_factor = comp_data.InitialConcentration
      Left_Title = "mg/L"
    Case CBOCUNITS_ug_L:
      c_factor = comp_data.InitialConcentration * 1000#
      Left_Title = Chr$(181) & "g/L"
  End Select

   'Define Graph
   If (Number_Influent_Points = 0) Then
     grpBreak.NumSets = 2
   Else
     grpBreak.NumSets = 3
   End If
   grpBreak.GraphType = 6 'Lines/Symbols
   grpBreak.GraphStyle = 1 'Symbols

'   grpBreak.ThisSet = 1
'   grpBreak.NumPoints = Results.NPoints
'   grpBreak.ThisSet = 2
'   grpBreak.NumPoints = NData_Points
   
   ' The following code where grpBreak.NumPoints is set is a rather
   ' unfortunate kludge, in my opinion.  I could find no other way to
   ' convince/force Visual Basic's graphical interface to accept two sets
   ' of data that were of two different sizes, so I determined which one
   ' was the smaller set and then filled the remainer of the smaller set
   ' with copies of the last data point in it (X,Y) (note, the default
   ' is for the data to hook back to the point (0,0) at the end of its
   ' plotting due to the fact that, by default, the (X,Y) data points
   ' that are unspecified are filled with 0's).
   ' -- If possible, it would be nice to replace this with something
   ' more elegant, but hey, it works. -- Eric J. Oman
   If (num_model_points > NData_Points) Then
     bigger = num_model_points
   Else
     bigger = NData_Points
   End If
   If (Number_Influent_Points > bigger) Then
     bigger = Number_Influent_Points
   End If

   grpBreak.ThisSet = 1
   grpBreak.NumPoints = bigger
   grpBreak.ThisSet = 2
   grpBreak.NumPoints = bigger
   If (Number_Influent_Points = 0) Then
     'Do nothing
   Else
     grpBreak.ThisSet = 3
     grpBreak.NumPoints = bigger
   End If
   
   grpBreak.SymbolData = 2 'triangle
   grpBreak.SymbolData = 6 'square
   If (Number_Influent_Points = 0) Then
     'Do nothing
   Else
     grpBreak.SymbolData = 8 'diamond
   End If

   grpBreak.ColorData = 9 'Blue
   grpBreak.ColorData = 12 'Red
   If (Number_Influent_Points = 0) Then
     'Do nothing
   Else
     grpBreak.ColorData = 10 'Green
   End If
   
   grpBreak.PatternData = 1
   grpBreak.PatternData = 1
   If (Number_Influent_Points = 0) Then
     'Do nothing
   Else
     grpBreak.PatternData = 1
   End If

   grpBreak.AutoInc = 0  'No autoincrementation
    
'**************************************************************
'   grpBreak.ThisSet = 1
'   For I = 1 To grpBreak.NumPoints
'     grpBreak.ThisPoint = I
'     If Cin(Component_Index, I) < 0 Then
'       grpBreak.GraphData = 0#
'     Else
'       grpBreak.GraphData = Cin(Component_Index, I) 'Results.CP(Component, I)
'     End If
'     grpBreak.ThisPoint = I
'     grpBreak.LabelText = ""
'     grpBreak.ThisPoint = I
'     grpBreak.XPosData = Td(I) * factor 'X_Values(I)
'   Next I
'   grpBreak.ThisPoint = 1
'   grpBreak.LegendText = Trim$(Results.Component(Component_Index).Name)
   
   '---- I. Display Effluent Prediction
   grpBreak.ThisSet = 1
   Select Case frmCompareData_WhichSet
     Case frmCompareData_WhichSet_PSDM
       For i = 1 To num_model_points
         grpBreak.ThisPoint = i
         If (Results.CP(Component_Index, i) < 0) Then
           grpBreak.GraphData = 0#
         Else
           grpBreak.GraphData = Results.CP(Component_Index, i) * c_factor
         End If
         ''''grpBreak.LabelText = ""
         grpBreak.XPosData = Results.T(i) * t_factor        'X_Values(I)
       Next i
     Case frmCompareData_WhichSet_CPHSDM
       For i = 1 To num_model_points
         grpBreak.ThisPoint = i
         If (CPM_Results.C_Over_C0(i) < 0) Then
           grpBreak.GraphData = 0#
         Else
           grpBreak.GraphData = CPM_Results.C_Over_C0(i) * c_factor
         End If
         ''''grpBreak.LabelText = ""
         grpBreak.XPosData = CPM_Results.T(i) * 24# * 60# * t_factor
       Next i
   End Select

   grpBreak.ThisPoint = 1
   grpBreak.LegendText = "Effluent Prediction"
   'grpBreak.LegendText = Trim$(Results.Component(Component_Index).Name)

   '---- II. Display Effluent Data
   grpBreak.ThisSet = 2
   For i = 1 To NData_Points
     grpBreak.ThisPoint = i
     If (C_Data_Points(Component_Index, i) < 0) Then
       grpBreak.GraphData = 0#
     Else
       grpBreak.GraphData = C_Data_Points(Component_Index, i) * c_factor
     End If
     ''''grpBreak.LabelText = ""
     grpBreak.XPosData = T_Data_Points(i) * 24# * 60# * t_factor
   Next i
   grpBreak.ThisPoint = 2
   grpBreak.LegendText = "Effluent Data"

   '---- III. Display Influent Data
   If (Number_Influent_Points = 0) Then
     'Do nothing
   Else
     grpBreak.ThisSet = 3
     For i = 1 To Number_Influent_Points
       grpBreak.ThisPoint = i
       If (C_Influent(Component_Index, i) < 0) Then
         grpBreak.GraphData = 0#
       Else
         grpBreak.GraphData = C_Influent(Component_Index, i) / comp_data.InitialConcentration * c_factor
       End If
       ''''grpBreak.LabelText = ""
       grpBreak.XPosData = T_Influent(i) * t_factor
     Next i
     grpBreak.ThisPoint = 3
     grpBreak.LegendText = "Influent Data"
   End If

   '---- Run the kludge mentioned above.
   If (bigger > NData_Points) Then
     grpBreak.ThisSet = 2
     LastPointI = NData_Points
     
     SameX = T_Data_Points(LastPointI) * 24# * 60# * t_factor
     SameY = C_Data_Points(Component_Index, LastPointI) * c_factor
     For i = LastPointI + 1 To bigger
       grpBreak.ThisPoint = i
       grpBreak.GraphData = SameY
       ''''grpBreak.ThisPoint = i
       grpBreak.XPosData = SameX
     Next i
   End If
   Select Case frmCompareData_WhichSet
     Case frmCompareData_WhichSet_PSDM
       If (bigger > num_model_points) Then
         grpBreak.ThisSet = 1
         LastPointI = num_model_points
         SameX = Results.T(LastPointI) * t_factor
         SameY = Results.CP(Component_Index, LastPointI) * c_factor
         For i = LastPointI + 1 To bigger
           grpBreak.ThisPoint = i
           grpBreak.GraphData = SameY
           ''''grpBreak.ThisPoint = i
           grpBreak.XPosData = SameX
         Next i
       End If
     Case frmCompareData_WhichSet_CPHSDM
       If (bigger > num_model_points) Then
         grpBreak.ThisSet = 1
         LastPointI = num_model_points
         SameX = CPM_Results.T(LastPointI) * 24# * 60# * t_factor
         SameY = CPM_Results.C_Over_C0(LastPointI) * c_factor
         For i = LastPointI + 1 To bigger
           grpBreak.ThisPoint = i
           grpBreak.GraphData = SameY
           ''''grpBreak.ThisPoint = i
           grpBreak.XPosData = SameX
         Next i
       End If
   End Select
   If (Number_Influent_Points = 0) Then
     'Do nothing
   Else
     If (bigger > Number_Influent_Points) Then
       grpBreak.ThisSet = 3
       LastPointI = Number_Influent_Points
       SameX = T_Influent(LastPointI) * t_factor
       SameY = C_Influent(Component_Index, LastPointI) / Component(Component_Index).InitialConcentration * c_factor
       For i = LastPointI + 1 To bigger
         grpBreak.ThisPoint = i
         grpBreak.GraphData = SameY
         ''''grpBreak.ThisPoint = i
         grpBreak.XPosData = SameX
       Next i
     End If
   End If

   grpBreak.PatternedLines = 0
   Data_Max = 0
   For J = 1 To grpBreak.NumSets
     grpBreak.ThisSet = J
     For i = 1 To grpBreak.NumPoints
       grpBreak.ThisPoint = i
       If grpBreak.GraphData > Data_Max Then
         Data_Max = grpBreak.GraphData
       End If
     Next i
   Next J
   
   grpBreak.YAxisMax = (Int(Data_Max * 10# + 1)) / 10#
   grpBreak.YAxisTicks = 4
   'grpBreak.GridStyle = 0

   grpBreak.YAxisStyle = 2
   grpBreak.YAxisMin = 0#
   grpBreak.BottomTitle = Bottom_Title
    
   grpBreak.LeftTitle = Left_Title
   grpBreak.DrawMode = 2

End Sub


Private Sub Form_Activate()
  If UnloadMe Then Unload Me
End Sub
Private Sub Form_Load()
Dim J As Integer, i As Integer
  Me.Caption = frmCompareData_caption
  Call Populate_Scrollboxes
  Call CenterOnForm(Me, frmMain)
  ''''Move frmPFPSDM.Left + (frmPFPSDM.Width / 2) - (frmShow_Data_And_Prediction.Width / 2), frmPFPSDM.Top + (frmPFPSDM.Height / 2) - (frmShow_Data_And_Prediction.Height / 2)
  'If Obj_Function() Then
  Screen.MousePointer = 11
  Call Draw_Curves(cboCompo.ListIndex + 1)
  Call cboGraphType_Click   'Wake cboGraphType up
  Screen.MousePointer = 0
  UnloadMe = False
  Call cboGrid_Click
  'Else
  '  UnloadMe = True
  'End If
End Sub
Private Sub Form_Resize()
  'If WindowState = 1 Then
  '  frmPFPSDM.WindowState = 1
  '  frmPlantData.WindowState = 1
  'End If
End Sub
Private Sub Form_Unload(Cancel As Integer)
  Call UserPrefs_Save
End Sub


Private Sub UserPrefs_Load()
Dim X As Long
  On Error GoTo err_DATAPRED_UserPrefs_Load
  X = CLng(INI_Getsetting("DATAPRED_cboCUnits"))
  If ((X >= 0) And (X <= cboCUnits.ListCount - 1)) Then
    cboCUnits.ListIndex = X
  End If
  X = CLng(INI_Getsetting("DATAPRED_cboTUnits"))
  If ((X >= 0) And (X <= cboTUnits.ListCount - 1)) Then
    cboTUnits.ListIndex = X
  End If
  X = CLng(INI_Getsetting("DATAPRED_cboGraphType"))
  If ((X >= 0) And (X <= cboGraphType.ListCount - 1)) Then
    cboGraphType.ListIndex = X
  End If
  X = CLng(INI_Getsetting("DATAPRED_cboGrid"))
  If ((X >= 0) And (X <= cboGrid.ListCount - 1)) Then
    cboGrid.ListIndex = X
  End If
  Exit Sub
resume_err_DATAPRED_UserPrefs_Load:
  Call UserPrefs_Save
  Exit Sub
err_DATAPRED_UserPrefs_Load:
  Resume resume_err_DATAPRED_UserPrefs_Load
End Sub
Private Sub UserPrefs_Save()
Dim X As Long
  X = cboCUnits.ListIndex
  Call INI_PutSetting("DATAPRED_cboCUnits", Trim$(CStr(X)))
  X = cboTUnits.ListIndex
  Call INI_PutSetting("DATAPRED_cboTUnits", Trim$(CStr(X)))
  X = cboGraphType.ListIndex
  Call INI_PutSetting("DATAPRED_cboGraphType", Trim$(CStr(X)))
  X = cboGrid.ListIndex
  Call INI_PutSetting("DATAPRED_cboGrid", Trim$(CStr(X)))
End Sub





'Private Function Obj_Function() As Integer
'Dim i, J As Integer
'Dim ncomp As Long, ndata  As Long, np As Long, temp As String, Error_Code As Integer
'ReDim Fmin(Results.NComponent) As Double
'ReDim TP(Results.npoints) As Double, CP(Results.NComponent, Results.npoints) As Double
'ReDim Td(NData_Points) As Double, Cd(Results.NComponent, NData_Points) As Double, Cin(Results.NComponent, NData_Points) As Double
'
'  ncomp = CLng(Results.NComponent)
'  ndata = CLng(NData_Points)
'  np = CLng(Results.npoints)
'
'  For i = 1 To Results.npoints
'    TP(i) = Results.T(i)
'    For J = 1 To Results.NComponent
'      CP(J, i) = Results.CP(J, i)
'    Next J
'  Next i
'  For i = 1 To NData_Points
'    Td(i) = T_Data_Points(i) * 24# * 60#
'    For J = 1 To Results.NComponent
'      Cd(J, i) = C_Data_Points(J, i)
'    Next J
'  Next i
'
'On Error GoTo Error_In_OBJFUN
'  'Call OBJFUN(ncomp, ndata, np, Tp(1), CP(1, 1), Td(1), Cd(1, 1), Cin(1, 1), Fmin(1))
'  Obj_Function = True
'  Exit Function
'
'Error_In_OBJFUN:
'  Error_Code = Err
'  temp = "Error " & Format$(Error_Code, "0") & " : " & Error$(Error_Code)
'  MsgBox "Fatal Error with OBJFUN.DLL. Calculations Stoppped." & Chr$(13) & temp, MB_ICONEXCLAMATION, Application_Name
'  Obj_Function = False
'  Resume Exit_Obj_Function
'Exit_Obj_Function:
'End Function

VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "Threed32.OCX"
Object = "{F9043C88-F6F2-101A-A3C9-08002B2F49FB}#1.2#0"; "Comdlg32.OCX"
Object = "{0842D103-1E19-101B-9AAF-1A1626551E7C}#1.0#0"; "GRAPH32.OCX"
Begin VB.Form frmModelECMResults 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Results for the Equilibrium Column Model (ECM)"
   ClientHeight    =   6420
   ClientLeft      =   960
   ClientTop       =   1440
   ClientWidth     =   9405
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   6420
   ScaleWidth      =   9405
   Begin VB.ComboBox cboGlob 
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   7500
      Style           =   2  'Dropdown List
      TabIndex        =   19
      Top             =   2910
      Width           =   1815
   End
   Begin Threed.SSFrame SSFrame1 
      Height          =   2775
      Left            =   60
      TabIndex        =   0
      Top             =   30
      Width           =   9255
      _Version        =   65536
      _ExtentX        =   16325
      _ExtentY        =   4895
      _StockProps     =   14
      Caption         =   "Results:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.Label Label1 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "VTM         (mg GAC/L)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   495
         Left            =   5310
         TabIndex        =   14
         Top             =   210
         Width           =   1215
      End
      Begin VB.Label Label2 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Wave velocity (cm/s)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   495
         Left            =   3930
         TabIndex        =   13
         Top             =   210
         Width           =   1335
      End
      Begin VB.Label Label3 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Bed Volume Fed"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   495
         Left            =   2790
         TabIndex        =   12
         Top             =   210
         Width           =   1095
      End
      Begin VB.Label Label4 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Components"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   510
         TabIndex        =   11
         Top             =   405
         Width           =   2235
      End
      Begin VB.Label Label5 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Zone"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   90
         TabIndex        =   10
         Top             =   405
         Width           =   555
      End
      Begin VB.Label lblData3 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "111E22"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   2055
         Left            =   5310
         TabIndex        =   9
         Top             =   630
         Width           =   1215
      End
      Begin VB.Label lblData2 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "1E-11"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   2055
         Left            =   3930
         TabIndex        =   8
         Top             =   630
         Width           =   1335
      End
      Begin VB.Label lblData1 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   " "
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   2055
         Left            =   2790
         TabIndex        =   7
         Top             =   630
         Width           =   1095
      End
      Begin VB.Label lblZone 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "1"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   2055
         Left            =   90
         TabIndex        =   6
         Top             =   630
         Width           =   375
      End
      Begin VB.Label Label6 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Time to break through (days)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   495
         Left            =   6570
         TabIndex        =   5
         Top             =   210
         Width           =   1335
      End
      Begin VB.Label lblData4 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "lblData4"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   2055
         Left            =   6570
         TabIndex        =   4
         Top             =   630
         Width           =   1335
      End
      Begin VB.Label lblCompo 
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "lblCompo"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   2055
         Left            =   510
         TabIndex        =   3
         Top             =   630
         Width           =   2235
      End
      Begin VB.Label lblData5 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "lblData5"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   2055
         Left            =   7950
         TabIndex        =   2
         Top             =   630
         Width           =   1215
      End
      Begin VB.Label Label7 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Mass Bal. Err. (%)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   495
         Left            =   8040
         TabIndex        =   1
         Top             =   210
         Width           =   915
      End
   End
   Begin GraphLib.Graph grpGlob 
      Height          =   3435
      Left            =   60
      TabIndex        =   15
      TabStop         =   0   'False
      Top             =   2910
      Width           =   7095
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   2646
      _StockProps     =   96
      BorderStyle     =   1
      RandomData      =   1
      ColorData       =   0
      ExtraData       =   0
      ExtraData[]     =   0
      FontFamily      =   4
      FontSize        =   4
      FontSize[0]     =   200
      FontSize[1]     =   150
      FontSize[2]     =   100
      FontSize[3]     =   100
      FontStyle       =   4
      GraphData       =   0
      GraphData[]     =   0
      LabelText       =   0
      LegendText      =   0
      PatternData     =   0
      SymbolData      =   0
      XPosData        =   0
      XPosData[]      =   0
   End
   Begin Threed.SSCommand cmdFile 
      Height          =   435
      Left            =   7860
      TabIndex        =   16
      Top             =   5370
      Width           =   1455
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      Caption         =   "Print to &File"
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin MSComDlg.CommonDialog CMDialog1 
      Left            =   7800
      Top             =   3570
      _ExtentX        =   847
      _ExtentY        =   847
      _Version        =   393216
      FontSize        =   0
      MaxFileSize     =   256
   End
   Begin Threed.SSCommand cmdSelect 
      Height          =   435
      Left            =   7860
      TabIndex        =   17
      Top             =   4290
      Width           =   1455
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      Caption         =   "&Select Printer"
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdPrint 
      Height          =   435
      Left            =   7860
      TabIndex        =   18
      Top             =   4830
      Width           =   1455
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      Caption         =   "&Print"
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdClose 
      Height          =   435
      Left            =   7860
      TabIndex        =   20
      Top             =   5910
      Width           =   1455
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      Caption         =   "&Close"
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
End
Attribute VB_Name = "frmModelECMResults"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
Option Base 1

Dim length As Double
Dim NumW As Integer
Dim Solid_ConcW(Number_Compo_Max, Number_Compo_Max), Liquid_ConcW(Number_Compo_Max, Number_Compo_Max), CoCW(Number_Compo_Max, Number_Compo_Max) As Double
Dim IndexW(Number_Compo_Max) As Integer
Dim Name_CompW(Number_Compo_Max) As String * 20
Dim Time_Break() As Double 'Breakthroug time for each chhemical
Dim Time_Min As Double, Time_Unit As String

Dim PopulatingScrollboxes As Integer




Const frmModelECMResults_declarations_end = True


Private Sub cboGlob_Click()
Dim i As Integer
    
  If (Not PopulatingScrollboxes) Then
    If cboGlob = "C/Co" Then i = 1
    If cboGlob = "Q" Then i = 2
    If cboGlob = "C (Liquid Conc.)" Then i = 3
    Call Draw(i)
    grpGlob.DrawMode = 2
  End If

End Sub

Private Sub cmdClose_Click()
    Unload Me
End Sub


Private Sub cmdFile_Click()
Dim f As Integer, Error_Code As Integer, temp As String
Dim i As Integer, j As Integer, k As Integer
Dim Filename_Input As String

On Error GoTo File_Error
    CMDialog1.CancelError = True
    CMDialog1.DialogTitle = "Print to File"
    CMDialog1.Filter = "All Files (*.*)|*.*|Text Files (*.txt)|*.txt|Data Files (*.dat)|*.dat"
    CMDialog1.FilterIndex = 2
    CMDialog1.flags = _
        cdlOFNOverwritePrompt + _
        cdlOFNPathMustExist
    CMDialog1.Action = 2

   'f = FileNameIsValid(Filename_Input, CMDialog1)
   'If Not (f) Then Exit Sub
      Filename_Input = CMDialog1.Filename
      f = FreeFile
      Open Filename_Input For Output As f
      Print #f, "Input data for the Equilibrium Colum Model"
    '-- Print Filename

      Print #f,
      Print #f, "From Data File : " & Filename
      Print #f, "Date/time stamp: " & Date$ & " " & Time$

      Print #f,
      Print #f, "Component"; Tab(30); "K*"; Tab(38); "1/n"; Tab(45); "Init. Conc."; Tab(59); "MW"
      Print #f, Tab(39); "-"; Tab(48); "mg/L", Tab(58); "g/mol"
                                                                     
      For i = 1 To Number_Component_ECM
        'K = Component_Index_ECM(i)
        k = IndexW(i)
'        Print #f, Trim$(Mid$(LTrim$(Component(K).Name), 1, 25)); Tab(29); Format$(Component(K).Use_K, "###,##0.000"); Tab(37); Format$(Component(K).Use_OneOverN, "0.000"); Tab(48); Format_It(Component(K).InitialConcentration, 2); Tab(58); Format$(Component(K).MW, "0.00")
        Print #f, Trim$(Mid$(LTrim$(Component(k).Name), 1, 25)); Tab(29); Format$(Component(k).Use_K, "###,##0.000"); Tab(37); Format$(Component(k).Use_OneOverN, "0.000"); Tab(48); Format_It(Component(k).InitialConcentration, 2); Tab(58); Format$(Component(k).MW, "0.00")
      Next i
      Print #f,
      Print #f, "* K in (mg/g)*(L/mg)^(1/n)"

      Print #f,

      '-----------------------Bed Data ----------------------
      Print #f, "Bed Data:"

      Print #f, Tab(5); "Bed Length: "; Tab(28); Format$(Bed.length, "0.000E+00") & " m"
      Print #f, Tab(5); "Bed Diameter: "; Tab(28); Format$(Bed.Diameter, "0.000E+00") & " m"
      Print #f, Tab(5); "Weight of GAC: "; Tab(28); Format$(Bed.Weight, "0.000E+00") & " kg"
      Print #f, Tab(5); "Inlet Flowrate: "; Tab(28); Format$(Bed.Flowrate, "0.000E+00") & " m" & Chr$(179) & "/s"
      Print #f, Tab(5); "EBCT: "; Tab(28); Format$(Bed.length * PI * Bed.Diameter * Bed.Diameter / 4# / Bed.Flowrate / 60#, "0.000E+00") & " mn"
      Print #f,
      Print #f, Tab(5); "Temperature:"; Tab(28); Format$(Bed.Temperature, "0.00") & " C"
      If Bed.Phase = 0 Then
        Print #f, Tab(5); "Water Density:"; Tab(28); Format$(Bed.WaterDensity, "0.0000") & " g/cm" & Chr$(179)
        Print #f, Tab(5); "Water Viscosity:"; Tab(28); Format$(Bed.WaterViscosity, "0.00E+00") & " g/cm.s"
      Else
        Print #f, Tab(5); "Pressure:"; Tab(28); Format$(Bed.Pressure, "0.00000") & " atm"
        Print #f, Tab(5); "Air Density:"; Tab(28); Format$(Bed.WaterDensity, "0.0000") & " g/cm" & Chr$(179)
        Print #f, Tab(5); "Air Viscosity:"; Tab(28); Format$(Bed.WaterViscosity, "0.00E+00") & " g/cm.s"
      End If
      Print #f,

      '-----------------Carbon Properties -------------------------------
      Print #f, "Carbon Properties:"

      Print #f, Tab(5); "Name: "; Tab(28); Trim$(Carbon.Name)
      Print #f, Tab(5); "Apparent Density: "; Tab(28); Format$(Carbon.Density, "0.000") & " g/cm" & Chr$(179)
      Print #f, Tab(5); "Particle Radius: "; Tab(28); Format$(Carbon.ParticleRadius * 100#, "0.000000") & " cm"
      Print #f, Tab(5); "Porosity: "; Tab(28); Format$(Carbon.Porosity, "0.000")
      Print #f, Tab(5); "Shape Factor: "; Tab(28); Format$(Carbon.ShapeFactor, "0.000")
      'Print #f, Tab(5); "Tortuosity: "; Tab(28); Format$(Carbon.Tortuosity, "0.000")
      Print #f,
      
      Print #f,
      '--- Print the results from the table
      Print #f, "Results for the Equilibrium Column Model"

      Print #f,
      Print #f, "Zone"; Tab(9); "Component"; Tab(35); "BVF"; Tab(44); "Wave Vel."; Tab(54); "TC"; Tab(63); "Breakthrough"
      Print #f, Tab(45); "cm/s"; Tab(54); "m3/kg"; Tab(63); Time_Unit
      For i = 1 To Number_Component_ECM
        Print #f, "Zone " & Format$(i, "0"); Tab(9); Mid$(Trim$(Component(IndexW(i)).Name), 1, 25); Tab(35); Format_It(Output_ECM(i).Bed_Volume_Fed, 2); Tab(45); Format_It(Output_ECM(i).Wave_Velocity, 2); Tab(54); Format_It(1 / Output_ECM(i).Carbon_Usage_Rate * 1000, 2); Tab(63); Format_It(Time_Break(i), 2)
        
      'Change made: (ejo, 3/1/96)
      '==========================
      'was: Format_It(Output_ECM(i).Carbon_Usage_Rate, 2)
      'is now: Format_It(1 / Output_ECM(i).Carbon_Usage_Rate * 1000, 2)
      
      Next i
      Print #f,
      Print #f, "TC (Treatment Capacity) is in m" & Chr$(179) & "  / kg of GAC"
      Print #f,

      For i = 1 To Number_Component_ECM
        Print #f, Mid$(Trim$(Component(IndexW(i)).Name), 1, 25)
        Print #f, "Zone "; Tab(9); "C/Co"; Tab(19); "C (mg/L)"; Tab(29); "Q (mg/L)"
        For j = 1 To Number_Component_ECM
          Print #f, "Zone " & Format$(j, "0"); Tab(9); Format_It(CoCW(i, j), 2); Tab(19); Format_It(Liquid_ConcW(i, j) / 1000#, 2); Tab(29); Format_It(Solid_ConcW(i, j) / 1000#, 2)
        Next j
        Print #f,
      Next i

      Print #f,
      Print #f,
      '--- Print the mass balance results
      Print #f, "Mass Balance Results"
      Print #f,
      Print #f, "Component"; Tab(30); "Percent Err."
      'Print #f, ""; Tab(30); "(ug/cm2/s)"; Tab(45); "(ug/cm2/s)"; Tab(60); "(%)"
      Print #f, ""; Tab(30); "(%)"
      For i = 1 To Number_Component_ECM
'        Print #f, Mid$(Trim$(Component(i).Name), 1, 25); Tab(30); Format_It(Output_ECM_MASSBAL.MASSBAL_C0_e_Vf(IndexW(i)), 3); Tab(45); Format_It(Output_ECM_MASSBAL.MASSBAL_TERM_SUM(IndexW(i)), 3); Tab(60); Format_It(Output_ECM_MASSBAL.MASSBAL_PERCENT_ERR(IndexW(i)), 3)
'        Print #f, Mid$(Trim$(Component(IndexW(i)).Name), 1, 25); Tab(30); Format_It(Output_ECM_MASSBAL.MASSBAL_C0_e_Vf(i), 3); Tab(45); Format_It(Output_ECM_MASSBAL.MASSBAL_TERM_SUM(i), 3); Tab(60); Format_It(Output_ECM_MASSBAL.MASSBAL_PERCENT_ERR(i), 3)
        Print #f, Mid$(Trim$(Component(IndexW(i)).Name), 1, 25); Tab(30); Format_It(Output_ECM_MASSBAL.MASSBAL_PERCENT_ERR(IndexW(i)), 3)
      Next i
      Print #f,
            
      
      Close (f)
    CMDialog1.Filename = ""
    Exit Sub

File_Error:
  If (Err.number = cdlCancel) Then
    'DO NOTHING.
  Else
    Call Show_Trapped_Error("cmdFile_Click")
  End If
  Resume Exit_Print_File
Exit_Print_File:
End Sub


Private Sub cmdPrint_Click()
Dim Error_Code As Integer, temp As String
Dim i As Integer, k As Integer, j As Integer

On Error GoTo Print_Error
'---Print other results-----------------------------------------------
  Printer.ScaleLeft = -1080  'Set a 3/4-inch margin
  Printer.ScaleTop = -1080
  Printer.CurrentX = 0
  Printer.CurrentY = 0

    Printer.FontSize = 12
    Printer.FontBold = True
    Printer.FontUnderline = True
    Printer.Print "Input data for the Equilibrium Colum Model"
    Printer.FontSize = 10
    Printer.FontBold = False
    Printer.FontUnderline = False
    '-- Print Filename
    Printer.Print
    Printer.Print "From Data File : " & Filename
    Printer.Print "Date/time stamp:" & Date$ & " " & Time$

    Printer.Print
    Printer.Print "Component"; Tab(30); "K*"; Tab(38); "1/n"; Tab(45); "Init. Conc."; Tab(59); "MW"
    Printer.Print Tab(39); "-"; Tab(48); "mg/L", Tab(58); "g/mol"
                                                                     
    For i = 1 To Number_Component_ECM
      'K = Component_Index_ECM(i)
      k = IndexW(i)
'      Printer.Print Trim$(Mid$(LTrim$(Component(K).Name), 1, 25)); Tab(29); Format$(Component(K).Use_K, "###,##0.000"); Tab(37); Format$(Component(K).Use_OneOverN, "0.000"); Tab(48); Format_It(Component(K).InitialConcentration, 2); Tab(58); Format$(Component(K).MW, "0.00")
      Printer.Print Trim$(Mid$(LTrim$(Component(k).Name), 1, 25)); Tab(29); Format$(Component(k).Use_K, "###,##0.000"); Tab(37); Format$(Component(k).Use_OneOverN, "0.000"); Tab(48); Format_It(Component(k).InitialConcentration, 2); Tab(58); Format$(Component(k).MW, "0.00")
    Next i
    Printer.Print
    Printer.Print "* K in (mg/g)*(L/mg)^(1/n)"

    Printer.Print

    '-----------------------Bed Data ----------------------
    Printer.FontUnderline = True
    Printer.Print "Bed Data:"
    Printer.FontUnderline = False

    Printer.Print Tab(5); "Bed Length: "; Tab(28); Format$(Bed.length, "0.000E+00") & " m"
    Printer.Print Tab(5); "Bed Diameter: "; Tab(28); Format$(Bed.Diameter, "0.000E+00") & " m"
    Printer.Print Tab(5); "Weight of GAC: "; Tab(28); Format$(Bed.Weight, "0.000E+00") & " kg"
    Printer.Print Tab(5); "Inlet Flowrate: "; Tab(28); Format$(Bed.Flowrate, "0.000E+00") & " m" & Chr$(179) & "/s"
    Printer.Print Tab(5); "EBCT: "; Tab(28); Format$(Bed.length * PI * Bed.Diameter * Bed.Diameter / 4# / Bed.Flowrate / 60#, "0.000E+00") & " mn"
    Printer.Print
    Printer.Print Tab(5); "Temperature:"; Tab(28); Format$(Bed.Temperature, "0.00") & " C"
    If Bed.Phase = 0 Then
      Printer.Print Tab(5); "Water Density:"; Tab(28); Format$(Bed.WaterDensity, "0.0000") & " g/cm" & Chr$(179)
      Printer.Print Tab(5); "Water Viscosity:"; Tab(28); Format$(Bed.WaterViscosity, "0.00E+00") & " g/cm.s"
    Else
      Printer.Print Tab(5); "Pressure:"; Tab(28); Format$(Bed.Pressure, "0.00000") & " atm"
      Printer.Print Tab(5); "Air Density:"; Tab(28); Format$(Bed.WaterDensity, "0.0000") & " g/cm" & Chr$(179)
      Printer.Print Tab(5); "Air Viscosity:"; Tab(28); Format$(Bed.WaterViscosity, "0.00E+00") & " g/cm.s"
    End If
    Printer.Print

    '-----------------Carbon Properties -------------------------------
    Printer.FontUnderline = True
    Printer.Print "Carbon Properties:"
    Printer.FontUnderline = False

    Printer.Print Tab(5); "Name: "; Tab(28); Trim$(Carbon.Name)
    Printer.Print Tab(5); "Apparent Density: "; Tab(28); Format$(Carbon.Density, "0.000") & " g/cm" & Chr$(179)
    Printer.Print Tab(5); "Particle Radius: "; Tab(28); Format$(Carbon.ParticleRadius * 100#, "0.000000") & " cm"
    Printer.Print Tab(5); "Porosity: "; Tab(28); Format$(Carbon.Porosity, "0.000")
    Printer.Print Tab(5); "Shape Factor: "; Tab(28); Format$(Carbon.ShapeFactor, "0.000")
    'Printer.Print Tab(5); "Tortuosity: "; Tab(28); Format$(Carbon.Tortuosity, "0.000")
    Printer.Print

                            
    Printer.Print
  '--- Print the results from the table
    Printer.FontSize = 12
    Printer.FontBold = True
    Printer.FontUnderline = True
    Printer.Print "Results for the Equilibrium Column Model"
    Printer.FontUnderline = False
    Printer.FontSize = 10
    Printer.FontBold = False

    Printer.Print
    Printer.Print "Zone"; Tab(9); "Component"; Tab(35); "BVF"; Tab(44); "Wave Vel."; Tab(54); "TC"; Tab(63); "Breakthrough"
    Printer.Print Tab(45); "cm/s"; Tab(54); "m3/kg"; Tab(63); Time_Unit
    For i = 1 To Number_Component_ECM
      Printer.Print "Zone " & Format$(i, "0"); Tab(9); Mid$(Trim$(Component(IndexW(i)).Name), 1, 25); Tab(35); Format_It(Output_ECM(i).Bed_Volume_Fed, 2); Tab(45); Format_It(Output_ECM(i).Wave_Velocity, 2); Tab(54); Format_It(1 / Output_ECM(i).Carbon_Usage_Rate * 1000, 2); Tab(63); Format_It(Time_Break(i), 2)
    
      'Change made: (ejo, 3/1/96)
      '==========================
      'was: Format_It(Output_ECM(i).Carbon_Usage_Rate, 2)
      'is now: Format_It(1 / Output_ECM(i).Carbon_Usage_Rate * 1000, 2)
    
    Next i
    Printer.Print
    Printer.Print "TC (Treatment Capacity) is in m" & Chr$(179) & "  / kg of GAC"
    Printer.Print

    For i = 1 To Number_Component_ECM
      Printer.FontBold = True
      Printer.Print Mid$(Trim$(Component(IndexW(i)).Name), 1, 25)
      Printer.FontBold = False
      Printer.Print "Zone "; Tab(9); "C/Co"; Tab(19); "C (mg/L)"; Tab(29); "Q (mg/L)"
      For j = 1 To Number_Component_ECM
       Printer.Print "Zone " & Format$(j, "0"); Tab(9); Format_It(CoCW(i, j), 2); Tab(19); Format_It(Liquid_ConcW(i, j) / 1000#, 2); Tab(29); Format_It(Solid_ConcW(i, j) / 1000#, 2)
      Next j
      Printer.Print
    Next i
    
    Printer.Print
  '--- Print the mass balance results
    Printer.FontSize = 12
    Printer.FontBold = True
    Printer.FontUnderline = True
    Printer.Print "Mass Balance Results"
    Printer.FontUnderline = False
    Printer.FontSize = 10
    Printer.FontBold = False

    Printer.Print
    'Printer.Print "Component"; Tab(30); "Left-Hand"; Tab(45); "Right-Hand"; Tab(60); "Percent Err."
    'Printer.Print ""; Tab(30); "(ug/cm2/s)"; Tab(45); "(ug/cm2/s)"; Tab(60); "(%)"
    Printer.Print "Component"; Tab(30); "Percent Err."
    Printer.Print ""; Tab(30); "(%)"
    For i = 1 To Number_Component_ECM
'      Printer.Print Mid$(Trim$(Component(i).Name), 1, 25); Tab(30); Format_It(Output_ECM_MASSBAL.MASSBAL_C0_e_Vf(i), 3); Tab(45); Format_It(Output_ECM_MASSBAL.MASSBAL_TERM_SUM(i), 3); Tab(60); Format_It(Output_ECM_MASSBAL.MASSBAL_PERCENT_ERR(i), 3)
'      Printer.Print Mid$(Trim$(Component(IndexW(i)).Name), 1, 25); Tab(30); Format_It(Output_ECM_MASSBAL.MASSBAL_C0_e_Vf(IndexW(i)), 3); Tab(45); Format_It(Output_ECM_MASSBAL.MASSBAL_TERM_SUM(IndexW(i)), 3); Tab(60); Format_It(Output_ECM_MASSBAL.MASSBAL_PERCENT_ERR(IndexW(i)), 3)
      Printer.Print Mid$(Trim$(Component(IndexW(i)).Name), 1, 25); Tab(30); Format_It(Output_ECM_MASSBAL.MASSBAL_PERCENT_ERR(IndexW(i)), 3)
    Next i
    Printer.Print


    Printer.EndDoc
    Exit Sub
Print_Error:
  Call Show_Trapped_Error("cmdPrint_Click")
  Resume Exit_Print
Exit_Print:

End Sub


Private Sub cmdSelect_Click()
Dim Error_Code As Integer
Dim temp As String
  On Error GoTo Select_Print_Error
  'CMDialog1.flags = PD_PRINTSETUP
  'CMDialog1.Action = 5
  CMDialog1.CancelError = False
  CMDialog1.ShowPrinter
  Exit Sub
Select_Print_Error:
  Call Show_Trapped_Error("cmdSelect_Click")
  Resume Exit_Select_Print
Exit_Select_Print:
End Sub


Private Sub Draw(GFlag As Integer)
Dim Num_Compo As Integer
  Num_Compo = Number_Component_ECM
Dim i As Integer, j As Integer, k As Integer
   Select Case GFlag
     Case 1
    grpGlob.NumSets = NumW
    grpGlob.GraphType = 4
    grpGlob.GraphStyle = 0
    
    For j = 1 To grpGlob.NumSets
     grpGlob.ThisSet = j
     If Num_Compo >= 2 Then
      grpGlob.NumPoints = NumW
     Else
      grpGlob.NumPoints = 2
     End If
    Next j
    grpGlob.GraphTitle = " C/Co for All Components"
    grpGlob.GridStyle = 3

    For j = 1 To grpGlob.NumSets
      grpGlob.ThisSet = j
       'K = IndexW(NumW - J + 1)
       k = j
       grpGlob.ThisPoint = j
       grpGlob.LegendText = Name_CompW(j)
      For i = 1 To grpGlob.NumPoints
        grpGlob.ThisPoint = i
        grpGlob.LabelText = "Zone " & Format$(i, "0")
        grpGlob.ThisPoint = i
        grpGlob.GraphData = CoCW(k, i)
      Next i
    Next j
   Case 2
    grpGlob.NumSets = NumW
    grpGlob.GraphType = 3
    grpGlob.GraphStyle = 0
    grpGlob.GraphTitle = " Q (" & Chr$(181) & "g/g) for All Components"
    grpGlob.GridStyle = 3
    
    For j = 1 To grpGlob.NumSets
     grpGlob.ThisSet = j
     If NumW > 2 Then
      grpGlob.NumPoints = NumW
     Else
      grpGlob.NumPoints = 2
     End If
    Next j

    For j = 1 To grpGlob.NumSets
      grpGlob.ThisSet = j
       'K = IndexW(NumW - J + 1)
       k = j
       grpGlob.ThisPoint = j
       grpGlob.LegendText = Name_CompW(k)
      For i = 1 To grpGlob.NumPoints
        grpGlob.ThisPoint = i
        grpGlob.LabelText = "Zone " & Format$(i, "0")
        grpGlob.ThisPoint = i
        grpGlob.GraphData = Solid_ConcW(k, i)
      Next i
    Next j

     Case 3
    grpGlob.NumSets = NumW
    grpGlob.GraphType = 3
    grpGlob.GraphStyle = 0
    grpGlob.GraphTitle = " C (" & Chr$(181) & "g/L) for All Components"
    grpGlob.GridStyle = 3
    
    For j = 1 To grpGlob.NumSets
     grpGlob.ThisSet = j
     If NumW > 2 Then
      grpGlob.NumPoints = NumW
     Else
      grpGlob.NumPoints = 2
     End If
    Next j

    For j = 1 To grpGlob.NumSets
      grpGlob.ThisSet = j
       'K = IndexW(NumW - J + 1)
        k = j
       grpGlob.ThisPoint = j
       grpGlob.LegendText = Name_CompW(k)
      For i = 1 To grpGlob.NumPoints
        grpGlob.ThisPoint = i
        grpGlob.LabelText = "Zone " & Format$(i, "0")
        grpGlob.ThisPoint = i
        grpGlob.GraphData = Liquid_ConcW(k, i)
      Next i
    Next j
   End Select
   If Number_Component_ECM = 1 Then
    grpGlob.ThisPoint = 2
    grpGlob.LabelText = ""
   End If
End Sub

Private Sub Form_Load()
Dim i As Integer, j As Integer
   
   'Move frmPFPSDM.Left + (frmPFPSDM.Width / 2) - (frmGlobal.Width / 2), frmPFPSDM.Top + (frmPFPSDM.Height / 2) - (frmGlobal.Height / 2)
   Call CenterOnForm(Me, frmMain)
    
    Label1 = "VTM" & Chr$(13) & "(m" & Chr$(179) & "/kg)"
    'Me.HelpContextID = Hlp_Global_Results
    ''''Caption = "Results for the Equilibrium Column Model"
    NumW = Number_Component_ECM
    For i = 1 To NumW
        IndexW(i) = Output_ECM(i).Index
        Name_CompW(i) = Component(IndexW(i)).Name
      For j = 1 To NumW
       Solid_ConcW(i, j) = Output_ECM(i).Solid_Concentration(j)
       Liquid_ConcW(i, j) = Output_ECM(i).Liquid_Concentration(j)
       CoCW(i, j) = Output_ECM(i).C_Over_C0(j)
      Next j
    Next i
    
    ''''fraGlob = "Results"
   lblZone = ""
    lblData1 = ""
    lblData2 = ""
    lblData3 = ""
    lblData4 = ""
    lblData5 = ""
    lblCompo = ""
    ReDim Time_Break(NumW)

    'Time_Min = 1E+100
    For i = 1 To NumW
      Time_Break(i) = Bed.length * 100# / Output_ECM(i).Wave_Velocity / 3600# / 24#
    '  If Time_Break(I) < Time_Min Then
    '   Time_Min = Time_Break(I)
    '  End If
    'Next I
    'If Time_Min < 1# Then
    ' For I = 1 To NumW
    '   Time_Break(I) = Time_Break(I) * 24# * 60#
     Next i
    ' Time_Unit = "mn"
    'Else Time_Unit = "days"
    'End If
    Time_Unit = "days"

    Label6 = "Breakthrough time(" & Time_Unit & ")"
    For i = 1 To NumW
      lblZone = lblZone & Format$(i, "0") & Chr$(10)
      lblCompo = lblCompo & LCase$(Trim$(Component(IndexW(i)).Name) & Chr$(10))
      lblData1 = lblData1 & Format_It(Output_ECM(i).Bed_Volume_Fed, 2) & Chr$(10)
      lblData2 = lblData2 & Format_It(Output_ECM(i).Wave_Velocity, 2) & Chr$(10)
      lblData3 = lblData3 & Format_It(1 / Output_ECM(i).Carbon_Usage_Rate * 1000, 2) & Chr$(10)
      lblData4 = lblData4 & Format_It(Time_Break(i), 3) & Chr$(10)
      lblData5 = lblData5 & Format_It(Output_ECM_MASSBAL.MASSBAL_PERCENT_ERR(i), 2) & Chr$(10)
    Next i
    
    Call Populate_Scrollboxes
    Call cboGlob_Click
    
    
    'Call Draw(1)
    'grpGlob.DrawMode = 2


End Sub

Private Sub Form_Unload(Cancel As Integer)

  Call UserPrefs_Save

End Sub


Private Sub Populate_Scrollboxes()

  PopulatingScrollboxes = True
    
  cboGlob.Clear
  cboGlob.AddItem "C/Co"
  cboGlob.AddItem "Q"
  cboGlob.AddItem "C (Liquid Conc.)"

  '-- Read in INI settings
  cboGlob.ListIndex = 0
  Call UserPrefs_Load
    
  PopulatingScrollboxes = False

End Sub

Private Sub UserPrefs_Load()
Dim X As Long

  On Error GoTo err_FRMGLOBAL_UserPrefs_Load

  X = CLng(INI_Getsetting("FRMGLOBAL_cboGlob"))
  If ((X >= 0) And (X <= cboGlob.ListCount - 1)) Then
    cboGlob.ListIndex = X
  End If
  Exit Sub

resume_err_FRMGLOBAL_UserPrefs_Load:
  Call UserPrefs_Save
  Exit Sub

err_FRMGLOBAL_UserPrefs_Load:
  Resume resume_err_FRMGLOBAL_UserPrefs_Load
           
End Sub

Private Sub UserPrefs_Save()
Dim X As Long

  X = cboGlob.ListIndex
  Call INI_PutSetting("FRMGLOBAL_cboGlob", Trim$(CStr(X)))

End Sub


VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmModelIPEResults 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Isotherm Parameter Estimation (IPE) Results"
   ClientHeight    =   6660
   ClientLeft      =   4530
   ClientTop       =   2160
   ClientWidth     =   6000
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   6660
   ScaleWidth      =   6000
   Begin Threed.SSFrame SSFrame1 
      Height          =   2235
      Left            =   150
      TabIndex        =   0
      Top             =   90
      Width           =   5685
      _Version        =   65536
      _ExtentX        =   10028
      _ExtentY        =   3942
      _StockProps     =   14
      Caption         =   "Input Data:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.TextBox txtData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   555
         Index           =   3
         Left            =   210
         Locked          =   -1  'True
         MultiLine       =   -1  'True
         TabIndex        =   10
         Text            =   "ModelIPEResults.frx":0000
         Top             =   1530
         Width           =   5265
      End
      Begin VB.TextBox txtData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   2
         Left            =   3870
         Locked          =   -1  'True
         TabIndex        =   8
         Text            =   "txtData(2)"
         Top             =   930
         Width           =   1600
      End
      Begin VB.TextBox txtData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   1
         Left            =   3870
         Locked          =   -1  'True
         TabIndex        =   6
         Text            =   "txtData(1)"
         Top             =   600
         Width           =   1600
      End
      Begin VB.TextBox txtData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   0
         Left            =   3870
         Locked          =   -1  'True
         TabIndex        =   4
         Text            =   "txtData(0)"
         Top             =   270
         Width           =   1600
      End
      Begin VB.Label lblDesc 
         BackStyle       =   0  'Transparent
         Caption         =   "Model Used:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   225
         Index           =   3
         Left            =   210
         TabIndex        =   9
         Top             =   1290
         Width           =   1485
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         BackStyle       =   0  'Transparent
         Caption         =   "Polanyi GM"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   225
         Index           =   2
         Left            =   105
         TabIndex        =   7
         Top             =   960
         Width           =   3600
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         BackStyle       =   0  'Transparent
         Caption         =   "Polanyi BB"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   225
         Index           =   1
         Left            =   105
         TabIndex        =   5
         Top             =   630
         Width           =   3600
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         BackStyle       =   0  'Transparent
         Caption         =   "Polanyi W0"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   225
         Index           =   0
         Left            =   105
         TabIndex        =   3
         Top             =   300
         Width           =   3600
      End
   End
   Begin Threed.SSFrame SSFrame2 
      Height          =   3525
      Left            =   150
      TabIndex        =   1
      Top             =   2430
      Width           =   5685
      _Version        =   65536
      _ExtentX        =   10028
      _ExtentY        =   6218
      _StockProps     =   14
      Caption         =   "Results:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.TextBox txtData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   12
         Left            =   3870
         Locked          =   -1  'True
         TabIndex        =   28
         Text            =   "txtData(12)"
         Top             =   3090
         Width           =   1600
      End
      Begin VB.TextBox txtData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   11
         Left            =   3870
         Locked          =   -1  'True
         TabIndex        =   26
         Text            =   "txtData(11)"
         Top             =   2760
         Width           =   1600
      End
      Begin VB.TextBox txtData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   10
         Left            =   3870
         Locked          =   -1  'True
         TabIndex        =   24
         Text            =   "txtData(10)"
         Top             =   2430
         Width           =   1600
      End
      Begin VB.TextBox txtData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   9
         Left            =   3870
         Locked          =   -1  'True
         TabIndex        =   22
         Text            =   "txtData(9)"
         Top             =   2100
         Width           =   1600
      End
      Begin VB.TextBox txtData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   8
         Left            =   3870
         Locked          =   -1  'True
         TabIndex        =   20
         Text            =   "txtData(8)"
         Top             =   1620
         Width           =   1600
      End
      Begin VB.TextBox txtData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   7
         Left            =   3870
         Locked          =   -1  'True
         TabIndex        =   18
         Text            =   "txtData(7)"
         Top             =   1290
         Width           =   1600
      End
      Begin VB.TextBox txtData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   6
         Left            =   3870
         Locked          =   -1  'True
         TabIndex        =   16
         Text            =   "txtData(6)"
         Top             =   960
         Width           =   1600
      End
      Begin VB.TextBox txtData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   5
         Left            =   3870
         Locked          =   -1  'True
         TabIndex        =   14
         Text            =   "txtData(5)"
         Top             =   630
         Width           =   1600
      End
      Begin VB.TextBox txtData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   4
         Left            =   3870
         Locked          =   -1  'True
         TabIndex        =   12
         Text            =   "txtData(4)"
         Top             =   300
         Width           =   1600
      End
      Begin VB.Line Line1 
         X1              =   60
         X2              =   5640
         Y1              =   1995
         Y2              =   1995
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         BackStyle       =   0  'Transparent
         Caption         =   "Root Mean Square Error"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   225
         Index           =   12
         Left            =   100
         TabIndex        =   27
         Top             =   3120
         Width           =   3600
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         BackStyle       =   0  'Transparent
         Caption         =   "Regression R Squared"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   225
         Index           =   11
         Left            =   100
         TabIndex        =   25
         Top             =   2790
         Width           =   3600
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         BackStyle       =   0  'Transparent
         Caption         =   "Upper Correlation Limit (mg/L)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   225
         Index           =   10
         Left            =   100
         TabIndex        =   23
         Top             =   2460
         Width           =   3600
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         BackStyle       =   0  'Transparent
         Caption         =   "Lower Correlation Limit (mg/L)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   225
         Index           =   9
         Left            =   100
         TabIndex        =   21
         Top             =   2130
         Width           =   3600
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         BackStyle       =   0  'Transparent
         Caption         =   "Freundlich 1/n"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   225
         Index           =   8
         Left            =   100
         TabIndex        =   19
         Top             =   1650
         Width           =   3600
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         BackStyle       =   0  'Transparent
         Caption         =   "Freundlich K (mmol/g)*(L/mmol)^(1/n)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   225
         Index           =   7
         Left            =   100
         TabIndex        =   17
         Top             =   1320
         Width           =   3600
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         BackStyle       =   0  'Transparent
         Caption         =   "Freundlich K (mg/g)*(L/mg)^(1/n)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   225
         Index           =   6
         Left            =   100
         TabIndex        =   15
         Top             =   990
         Width           =   3600
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         BackStyle       =   0  'Transparent
         Caption         =   "Polanyi Adsorption Capacity (mg/g)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   225
         Index           =   5
         Left            =   100
         TabIndex        =   13
         Top             =   660
         Width           =   3600
      End
      Begin VB.Label lblDesc 
         Alignment       =   1  'Right Justify
         BackStyle       =   0  'Transparent
         Caption         =   "Average Chemical Conc. (mg/L)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   225
         Index           =   4
         Left            =   105
         TabIndex        =   11
         Top             =   330
         Width           =   3600
      End
   End
   Begin Threed.SSCommand cmdClose 
      Height          =   495
      Left            =   3540
      TabIndex        =   2
      TabStop         =   0   'False
      Top             =   6060
      Width           =   2295
      _Version        =   65536
      _ExtentX        =   4048
      _ExtentY        =   873
      _StockProps     =   78
      Caption         =   "&Close"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
End
Attribute VB_Name = "frmModelIPEResults"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Dim WHICH_MODEL As Integer




Const frmModelIPEResults_declarations_end = True


Sub frmModelIPEResults_Run( _
    INPUT_WHICH_MODEL As Integer)
  WHICH_MODEL = INPUT_WHICH_MODEL
  frmModelIPEResults.Show 1
End Sub


Sub frmModelIPEResults_PopulateUnits()
Dim i As Integer
  For i = 0 To 12
    If (i <> 3) Then
      Call unitsys_register(frmModelIPEResults, lblDesc(i), _
          txtData(i), Nothing, "", _
          "", "", "", "", 100#, False)
    End If
  Next i
End Sub
Sub frmModelIPEResults_Refresh()
Dim frm As Form
Set frm = frmModelIPEResults
  'DISPLAY CURRENT VALUES FOR UNIT CONTROLS.
  Call unitsys_set_number_in_base_units( _
      frm.txtData(0), IPES_Data.Input.W0)
  Call unitsys_set_number_in_base_units( _
      frm.txtData(1), IPES_Data.Input.BB)
  Call unitsys_set_number_in_base_units( _
      frm.txtData(2), IPES_Data.Input.GM)
  Call unitsys_set_number_in_base_units( _
      frm.txtData(4), IPES_Data.Output.CSAV)
  Call unitsys_set_number_in_base_units( _
      frm.txtData(5), IPES_Data.Output.QSAV)
  Call unitsys_set_number_in_base_units( _
      frm.txtData(6), IPES_Data.Output.XK1)
  Call unitsys_set_number_in_base_units( _
      frm.txtData(7), IPES_Data.Output.XK2)
  Call unitsys_set_number_in_base_units( _
      frm.txtData(8), IPES_Data.Output.XN)
  Call unitsys_set_number_in_base_units( _
      frm.txtData(9), IPES_Data.Output.CBEG)
  Call unitsys_set_number_in_base_units( _
      frm.txtData(10), IPES_Data.Output.CEND)
  Call unitsys_set_number_in_base_units( _
      frm.txtData(11), IPES_Data.Output.RSQD)
  Call unitsys_set_number_in_base_units( _
      frm.txtData(12), IPES_Data.Output.RMSE)
End Sub


Private Sub cmdClose_Click()
  Unload Me
  Exit Sub
End Sub


Private Sub Form_Load()
  'MISC INITS.
  Call CenterOnForm(Me, frmFreundlich)
  Select Case WHICH_MODEL
    Case MODULECODE_ADLIQ:
      txtData(3).Text = "3-Parameter Polanyi Correlation"
    Case MODULECODE_SPEQ:
      txtData(3).Text = "D-R Equal Spreading Pressure Calculation"
    Case MODULECODE_HOFMAN:
      txtData(3).Text = "Estimated From Gas-Phase D-R Isotherm" & _
          vbCrLf & "Hansen-Fackler model, uniform adsorbate"
    Case Else:
  End Select
  'POPULATE UNIT CONTROLS.
  Call frmModelIPEResults_PopulateUnits
  'REFRESH DISPLAY.
  Call frmModelIPEResults_Refresh
End Sub
Private Sub Form_Unload(Cancel As Integer)
  Call unitsys_unregister_all_on_form(Me)
End Sub


Private Sub txtData_GotFocus(index As Integer)
Dim Ctl As Control
Set Ctl = txtData(index)
  If (index = 3) Then
    Call Global_GotFocus(Ctl)
    Exit Sub
  End If
  Call unitsys_control_txtx_gotfocus(Ctl)
End Sub
'Private Sub txtData_KeyPress(Index As Integer, KeyAscii As Integer)
'  KeyAscii = Global_NumericKeyPress(KeyAscii)
'End Sub
Private Sub txtData_LostFocus(index As Integer)
Dim NewValue_Okay As Integer
Dim NewValue As Double
Dim Ctl As Control
Set Ctl = txtData(index)
Dim Val_Low As Double
Dim Val_High As Double
Dim Raise_Dirty_Flag As Boolean
'Dim Too_Small As Integer
  If (index = 3) Then
    Call Global_LostFocus(Ctl)
    Exit Sub
  End If
  'NOTE: LOW AND HIGH VALUES IN BASE UNITS.
  Val_Low = -1E+20
  Val_High = 1E+20
  Select Case index
    Case 0: Val_Low = 0.05: Val_High = 2.5
    Case 1: Val_Low = 1E-20: Val_High = 1E+20
    Case 2: Val_Low = 1E-20: Val_High = 1E+20
  End Select
  'NOTE: THE VALUES SHOULD NEVER CHANGE BECAUSE ALL TEXT BOXES
  'ON THIS FORM ARE LOCKED!
  NewValue_Okay = False
  If (unitsys_control_txtx_lostfocus_validate(Ctl, Val_Low, Val_High, NewValue, Raise_Dirty_Flag)) Then
    NewValue_Okay = True
  End If
  Call unitsys_control_txtx_lostfocus(Ctl, NewValue)
'  If (NewValue_Okay) Then
'    If (Raise_Dirty_Flag) Then
'      'STORE TO MEMORY.
'      Select Case Index
'        Case 0:         'W0.
'          Carbon.W0 = NewValue
'        Case 1:         'BB.
'          Carbon.BB = NewValue
'        Case 2:         'GM.
'          Carbon.PolanyiExponent = NewValue
'      End Select
'      'RAISE DIRTY FLAG IF NECESSARY.
'      If (Raise_Dirty_Flag) Then
'        ''THROW DIRTY FLAG.
'        'Call frmCompoProp_DirtyStatus_Throw
'      End If
'      'REFRESH WINDOW.
'      Call frmPolanyi_Refresh
'    End If
'  End If
End Sub

VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "Threed32.ocx"
Object = "{F9043C88-F6F2-101A-A3C9-08002B2F49FB}#1.2#0"; "Comdlg32.ocx"
Object = "{0842D103-1E19-101B-9AAF-1A1626551E7C}#1.0#0"; "graph32.ocx"
Begin VB.Form frmModelPSDMResults 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Results for the Pore and Surface Diffusion Model (PSDM)"
   ClientHeight    =   7305
   ClientLeft      =   4530
   ClientTop       =   1530
   ClientWidth     =   9480
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   7305
   ScaleWidth      =   9480
   ShowInTaskbar   =   0   'False
   Begin Threed.SSFrame ssframe_SSConc 
      Height          =   555
      Left            =   60
      TabIndex        =   42
      Top             =   2040
      Width           =   7755
      _Version        =   65536
      _ExtentX        =   13679
      _ExtentY        =   979
      _StockProps     =   14
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.Label lblSSValueUnits 
         Caption         =   "{u}g/L"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   195
         Left            =   5400
         TabIndex        =   45
         Top             =   210
         Width           =   1065
      End
      Begin VB.Label lblSSValue 
         Alignment       =   2  'Center
         Caption         =   "lblSSValue"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   195
         Left            =   4140
         TabIndex        =   44
         Top             =   210
         Width           =   1065
      End
      Begin VB.Label lblMisc 
         Alignment       =   1  'Right Justify
         Caption         =   "Steady State Conc. at Saturation (Cr,ss)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   195
         Index           =   0
         Left            =   120
         TabIndex        =   43
         Top             =   210
         Width           =   3825
      End
   End
   Begin VB.ComboBox cboGrid 
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   7920
      Style           =   2  'Dropdown List
      TabIndex        =   33
      Top             =   2760
      Width           =   1455
   End
   Begin Threed.SSFrame SSFrame1 
      Height          =   1995
      Left            =   60
      TabIndex        =   0
      Top             =   30
      Width           =   7755
      _Version        =   65536
      _ExtentX        =   13679
      _ExtentY        =   3519
      _StockProps     =   14
      Caption         =   "Results for:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin VB.ComboBox cboCompo 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Left            =   90
         Style           =   2  'Dropdown List
         TabIndex        =   3
         Top             =   300
         Width           =   3975
      End
      Begin Threed.SSCommand cmdTreat 
         Height          =   315
         Left            =   90
         TabIndex        =   2
         Top             =   1620
         Width           =   2655
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "Treatment Objective"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin VB.Label lblLegend 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   90
         TabIndex        =   29
         Top             =   660
         Width           =   2655
      End
      Begin VB.Label lblLegend 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "Time (days)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   2730
         TabIndex        =   28
         Top             =   660
         Width           =   1215
      End
      Begin VB.Label lblLegend 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "BVT"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   3930
         TabIndex        =   27
         Top             =   660
         Width           =   1215
      End
      Begin VB.Label lblLegend 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "Tr. Capacity"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   5130
         TabIndex        =   26
         Top             =   660
         Width           =   1215
      End
      Begin VB.Label lblLegend 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "5% of influent conc."
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   90
         TabIndex        =   25
         Top             =   900
         Width           =   2655
      End
      Begin VB.Label lblLegend 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "50% of influent conc."
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   90
         TabIndex        =   24
         Top             =   1140
         Width           =   2655
      End
      Begin VB.Label lblLegend 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "95% of influent conc."
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   6
         Left            =   90
         TabIndex        =   23
         Top             =   1380
         Width           =   2655
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "999.99"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   0
         Left            =   2730
         TabIndex        =   22
         Top             =   900
         Width           =   1215
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "999.99"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   1
         Left            =   2730
         TabIndex        =   21
         Top             =   1140
         Width           =   1215
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "999.99"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   2
         Left            =   2730
         TabIndex        =   20
         Top             =   1380
         Width           =   1215
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "999.99"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   3
         Left            =   3930
         TabIndex        =   19
         Top             =   900
         Width           =   1215
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "999.99"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   4
         Left            =   3930
         TabIndex        =   18
         Top             =   1140
         Width           =   1215
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "999.99"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   5
         Left            =   3930
         TabIndex        =   17
         Top             =   1380
         Width           =   1215
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "999.99"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   6
         Left            =   5130
         TabIndex        =   16
         Top             =   900
         Width           =   1215
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "999.99"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   7
         Left            =   5130
         TabIndex        =   15
         Top             =   1140
         Width           =   1215
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "999.99"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   8
         Left            =   5130
         TabIndex        =   14
         Top             =   1380
         Width           =   1215
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "999.99"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   9
         Left            =   6330
         TabIndex        =   13
         Top             =   900
         Width           =   1215
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "999.99"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   10
         Left            =   6330
         TabIndex        =   12
         Top             =   1140
         Width           =   1215
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "999.99"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   11
         Left            =   6330
         TabIndex        =   11
         Top             =   1380
         Width           =   1215
      End
      Begin VB.Label lblLegend 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "C (mg/L)"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   7
         Left            =   6330
         TabIndex        =   10
         Top             =   660
         Width           =   1215
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "999.99"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   12
         Left            =   2730
         TabIndex        =   9
         Top             =   1620
         Width           =   1215
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "999.99"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   13
         Left            =   3930
         TabIndex        =   8
         Top             =   1620
         Width           =   1215
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "999.99"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   14
         Left            =   5130
         TabIndex        =   7
         Top             =   1620
         Width           =   1215
      End
      Begin VB.Label lblData 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "999.99"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Index           =   15
         Left            =   6330
         TabIndex        =   6
         Top             =   1620
         Width           =   1215
      End
      Begin VB.Label lblMTZ 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "lblMTZ"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   6330
         TabIndex        =   5
         Top             =   285
         Width           =   1215
      End
      Begin VB.Label Label2 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H80000005&
         BackStyle       =   0  'Transparent
         Caption         =   "Length of the MTZ (cm):"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   255
         Left            =   4050
         TabIndex        =   4
         Top             =   300
         Width           =   2235
      End
   End
   Begin Threed.SSFrame SSFrame2 
      Height          =   645
      Left            =   90
      TabIndex        =   1
      Top             =   6600
      Width           =   7755
      _Version        =   65536
      _ExtentX        =   13679
      _ExtentY        =   1138
      _StockProps     =   14
      Caption         =   "C/Co as a function of:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin Threed.SSOption optType 
         Height          =   255
         Index           =   0
         Left            =   1650
         TabIndex        =   39
         Top             =   270
         Width           =   1215
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "&Time"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSOption optType 
         Height          =   255
         Index           =   1
         Left            =   3330
         TabIndex        =   40
         Top             =   270
         Width           =   975
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "&BVT"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSOption optType 
         Height          =   255
         Index           =   2
         Left            =   4650
         TabIndex        =   41
         Top             =   270
         Width           =   2415
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "Volume Treated by M&ass"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
   End
   Begin Threed.SSCommand cmdFile 
      Height          =   435
      Left            =   7920
      TabIndex        =   30
      Top             =   6150
      Width           =   1455
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      Caption         =   "Print to &File"
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdExcel 
      Height          =   435
      Left            =   7920
      TabIndex        =   31
      Top             =   3990
      Width           =   1455
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      Caption         =   "&Excel..."
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdSave 
      Height          =   435
      Left            =   7920
      TabIndex        =   32
      Top             =   4530
      Width           =   1455
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      Caption         =   "S&ave Curves"
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin MSComDlg.CommonDialog CMDialog1 
      Left            =   8310
      Top             =   930
      _ExtentX        =   847
      _ExtentY        =   847
      _Version        =   393216
      FontSize        =   0
      MaxFileSize     =   256
   End
   Begin Threed.SSCommand cmdSelect 
      Height          =   435
      Left            =   7920
      TabIndex        =   34
      Top             =   5070
      Width           =   1455
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      Caption         =   "&Select Printer"
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdPrint 
      Height          =   435
      Left            =   7920
      TabIndex        =   36
      Top             =   5610
      Width           =   1455
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      Caption         =   "&Print"
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdExit 
      Height          =   435
      Left            =   7920
      TabIndex        =   37
      TabStop         =   0   'False
      Top             =   120
      Width           =   1455
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      Caption         =   "&Close"
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin GraphLib.Graph grpBreak 
      Height          =   3945
      Left            =   90
      TabIndex        =   38
      Top             =   2640
      Width           =   7755
      _Version        =   65536
      _ExtentX        =   13679
      _ExtentY        =   6959
      _StockProps     =   96
      BorderStyle     =   1
      BottomTitle     =   "Testing"
      GraphStyle      =   4
      GraphType       =   6
      GridStyle       =   3
      LeftTitle       =   "Testing"
      RandomData      =   0
      ColorData       =   0
      ExtraData       =   0
      ExtraData[]     =   0
      FontFamily      =   4
      FontSize        =   4
      FontSize[0]     =   200
      FontSize[1]     =   150
      FontSize[2]     =   100
      FontSize[3]     =   100
      FontStyle       =   4
      GraphData       =   1
      GraphData[]     =   5
      GraphData[0,0]  =   0
      GraphData[0,1]  =   0
      GraphData[0,2]  =   0
      GraphData[0,3]  =   0
      GraphData[0,4]  =   0
      LabelText       =   0
      LegendText      =   0
      PatternData     =   0
      SymbolData      =   0
      XPosData        =   0
      XPosData[]      =   0
   End
   Begin VB.Label Label1 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Grid Style:"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Left            =   7920
      TabIndex        =   35
      Top             =   2430
      Width           =   1335
   End
End
Attribute VB_Name = "frmModelPSDMResults"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
Option Base 1

Dim Flag_TO(Number_Compo_Max_PFPSDM) As Integer

Dim PopulatingScrollboxes As Integer



Const frmModelPSDMResults_declarations_end = True


Private Sub cboCompo_Click()
Dim f As Double
  If (PopulatingScrollboxes) Then Exit Sub
  If (Results.is_psdm_in_room_model) Then
    lblSSValue.Caption = _
        NumberToMFBString(Results.psdmroom_Crss( _
        cboCompo.ListIndex + 1))
  End If
  If (Results.ThroughPut_50(cboCompo.ListIndex + 1).C <> -1#) And (Results.ThroughPut_50(cboCompo.ListIndex + 1).T <> -1#) And (Results.ThroughPut_05(cboCompo.ListIndex + 1).T <> -1#) And (Results.ThroughPut_05(cboCompo.ListIndex + 1).C <> -1#) And (Results.ThroughPut_95(cboCompo.ListIndex + 1).T <> -1#) And (Results.ThroughPut_95(cboCompo.ListIndex + 1).C <> -1#) Then
    f = 100 * Results.Bed.length / Results.ThroughPut_50(cboCompo.ListIndex + 1).T  'in cm/days
    lblMTZ = Format_It(f * (Results.ThroughPut_95(cboCompo.ListIndex + 1).T - Results.ThroughPut_05(cboCompo.ListIndex + 1).T), 3)
  Else
    lblMTZ = "N/A"
  End If
  If (Results.ThroughPut_05(cboCompo.ListIndex + 1).T <> -1#) And (Results.ThroughPut_05(cboCompo.ListIndex + 1).C <> -1#) Then
    lblData(0) = Format_It(Results.ThroughPut_05(cboCompo.ListIndex + 1).T / 24# / 60#, 2)
    lblData(9) = Format_It(Results.ThroughPut_05(cboCompo.ListIndex + 1).C, 2)
    lblData(3) = Format_It(Results.ThroughPut_05(cboCompo.ListIndex + 1).T * 60# * Results.Bed.Flowrate / Results.Bed.length / PI / (Results.Bed.Diameter / 2) ^ 2, 2)
    lblData(6) = Format_It(Results.ThroughPut_05(cboCompo.ListIndex + 1).T * 60# * Results.Bed.Flowrate / Results.Bed.Weight, 2)
  Else
    lblData(0) = "N/A"
    lblData(9) = "N/A"
    'lblData(12) = "N/A"
    lblData(3) = "N/A"
    lblData(6) = "N/A"
  End If
  If (Results.ThroughPut_50(cboCompo.ListIndex + 1).T <> -1#) And (Results.ThroughPut_50(cboCompo.ListIndex + 1).C <> -1#) Then
    lblData(1) = Format_It(Results.ThroughPut_50(cboCompo.ListIndex + 1).T / 24# / 60#, 2)
    lblData(10) = Format_It(Results.ThroughPut_50(cboCompo.ListIndex + 1).C, 2)
    lblData(4) = Format_It(Results.ThroughPut_50(cboCompo.ListIndex + 1).T * 60# * Results.Bed.Flowrate / Results.Bed.length / PI / (Results.Bed.Diameter / 2) ^ 2, 2)
    lblData(7) = Format_It(Results.ThroughPut_50(cboCompo.ListIndex + 1).T * 60# * Results.Bed.Flowrate / Results.Bed.Weight, 2)
  Else
    lblData(1) = "N/A"
    lblData(10) = "N/A"
    lblData(4) = "N/A"
    lblData(7) = "N/A"
  End If
  If (Results.ThroughPut_95(cboCompo.ListIndex + 1).T <> -1#) And (Results.ThroughPut_95(cboCompo.ListIndex + 1).C <> -1#) Then
    lblData(2) = Format_It(Results.ThroughPut_95(cboCompo.ListIndex + 1).T / 24# / 60#, 2)
    lblData(11) = Format_It(Results.ThroughPut_95(cboCompo.ListIndex + 1).C, 2)
    'lblData(14) = Format_It(Results.ThroughPut_95(cboCompo.ListIndex + 1).Q)
    'lblData(14) = "N/A"
    lblData(5) = Format_It(Results.ThroughPut_95(cboCompo.ListIndex + 1).T * 60# * Results.Bed.Flowrate / Results.Bed.length / PI / (Results.Bed.Diameter / 2) ^ 2, 2)
    lblData(8) = Format_It(Results.ThroughPut_95(cboCompo.ListIndex + 1).T * 60# * Results.Bed.Flowrate / Results.Bed.Weight, 2)
  Else
    lblData(2) = "N/A"
    lblData(11) = "N/A"
    'lblData(14) = "N/A"
    lblData(5) = "N/A"
    lblData(8) = "N/A"
  End If
  'cmdTreat.Caption = Format_It(Treament_Objective(cboCompo.ListIndex + 1).C, 2) & " mg/L"
  If Flag_TO(cboCompo.ListIndex + 1) Then
    lblData(12) = Format_It(Treatment_Objective(cboCompo.ListIndex + 1).T / 60# / 24#, 2)
    lblData(13) = Format_It(Treatment_Objective(cboCompo.ListIndex + 1).T * 60# * Results.Bed.Flowrate / Results.Bed.length / PI / (Results.Bed.Diameter / 2) ^ 2, 2)
    lblData(14) = Format_It(Treatment_Objective(cboCompo.ListIndex + 1).T * 60# * Results.Bed.Flowrate / Results.Bed.Weight, 2)
    lblData(15) = Format_It(Treatment_Objective(cboCompo.ListIndex + 1).C, 2)
  Else
    lblData(12) = "N/A"
    lblData(13) = "N/A"
    lblData(14) = "N/A"
    lblData(15) = "N/A"
  End If
End Sub


Private Sub cboGrid_Click()
  If (Not PopulatingScrollboxes) Then
    grpBreak.GridStyle = cboGrid.ListIndex
    grpBreak.DrawMode = 2
  End If
End Sub


Private Sub cmdExcel_Click()
  PFPSDM_Excel = True
  CPHSDM_Excel = False
  frmExcelCurves.Show 1
End Sub


Private Sub cmdExit_Click()
  Unload Me
End Sub


Private Sub cmdFile_Click()
Dim f As Integer, Error_Code As Integer, temp As String
Dim i As Integer, j As Integer, k As Integer
Dim Eq1 As String, Filename_PFPSDM  As String

On Error GoTo File_Error
    CMDialog1.CancelError = True
    CMDialog1.Filename = ""
    CMDialog1.DialogTitle = "Print to File"
    CMDialog1.Filter = "All Files (*.*)|*.*|Text Files (*.txt)|*.txt|Data Files (*.dat)|*.dat"
    CMDialog1.FilterIndex = 2
    CMDialog1.flags = _
        cdlOFNOverwritePrompt + _
        cdlOFNPathMustExist
    CMDialog1.Action = 2

   'f = FileNameIsValid(Filename_PFPSDM, CMDialog1)
   'If Not (f) Then Exit Sub
   Filename_PFPSDM = CMDialog1.Filename

      f = FreeFile
      Open Filename_PFPSDM For Output As f
      Print #f, "Input data for the Plug-Flow Pore And Surface Diffusion Model"
    '-- Print Filename

      Print #f,
      Print #f, "From Data File :", Filename

      Print #f,
      Print #f, "Component"; Tab(30); "K*"; Tab(38); "1/n"; Tab(47); "C0"; Tab(57); "MW"; Tab(65); "Vm"; Tab(75); "NBP"
      Print #f, Tab(39); "-"; Tab(46); "mg/L"; Tab(56); "g/mol"; Tab(65); "cm" & Chr$(179) & "/mol"; Tab(76); "C"
                                                                     
      For i = 1 To Number_Component_PFPSDM
       Print #f, Trim$(Mid$(LTrim$(Results.Component(i).Name), 1, 25)); Tab(29); Format$(Results.Component(i).Use_K, "###,##0.000"); Tab(37); Format$(Results.Component(i).Use_OneOverN, "0.000"); Tab(46); Format_It(Results.Component(i).InitialConcentration, 2); Tab(55); Format_It(Results.Component(i).MW, 2); Tab(64); Format_It(Results.Component(i).MolarVolume, 2); Tab(73); Format_It(Results.Component(i).BP, 2)
      Next i
      Print #f,
      Print #f, "* K in (mg/g)*(L/mg)^(1/n) - Vm = Molar Volume at NBP"
      Print #f,

    '-----------------------Bed Data ----------------------
      Print #f, "Bed Data:"

      Print #f, Tab(5); "Bed Length: "; Tab(28); Format$(Results.Bed.length, "0.000E+00") & " m"
      Print #f, Tab(5); "Bed Diameter: "; Tab(28); Format$(Results.Bed.Diameter, "0.000E+00") & " m"
      Print #f, Tab(5); "Weight of GAC: "; Tab(28); Format$(Results.Bed.Weight, "0.000E+00") & " kg"
      Print #f, Tab(5); "Inlet Flowrate: "; Tab(28); Format$(Results.Bed.Flowrate, "0.000E+00") & " m" & Chr$(179) & "/s"
      Print #f, Tab(5); "EBCT: "; Tab(28); Format$(Results.Bed.length * PI * Results.Bed.Diameter * Results.Bed.Diameter / 4# / Results.Bed.Flowrate / 60#, "0.000E+00") & " mn"
      Print #f,
      Print #f, Tab(5); "Temperature:"; Tab(28); Format$(Results.Bed.Temperature, "0.00") & " C"
      If Results.Bed.Phase = 0 Then
        Print #f, Tab(5); "Water Density:"; Tab(28); Format$(Results.Bed.WaterDensity, "0.0000") & " g/cm" & Chr$(179)
        Print #f, Tab(5); "Water Viscosity:"; Tab(28); Format$(Results.Bed.WaterViscosity, "0.00E+00") & " g/cm.s"
      Else
        Print #f, Tab(5); "Pressure:"; Tab(28); Format$(Results.Bed.Pressure, "0.00000") & " atm"
        Print #f, Tab(5); "Air Density:"; Tab(28); Format$(Results.Bed.WaterDensity, "0.0000") & " g/cm" & Chr$(179)
        Print #f, Tab(5); "Air Viscosity:"; Tab(28); Format$(Results.Bed.WaterViscosity, "0.00E+00") & " g/cm.s"
      End If
      Print #f,

    '-----------------Carbon Properties -------------------------------
      Print #f, "Carbon Properties:"
      Print #f, Tab(5); "Name: "; Tab(28); Trim$(Results.Carbon.Name)
      Print #f, Tab(5); "Apparent Density: "; Tab(28); Format$(Results.Carbon.Density, "0.000") & " g/cm" & Chr$(179)
      Print #f, Tab(5); "Particle Radius: "; Tab(28); Format$(Results.Carbon.ParticleRadius * 100#, "0.000000") & " cm"
      Print #f, Tab(5); "Porosity: "; Tab(28); Format$(Results.Carbon.Porosity, "0.000")
      Print #f, Tab(5); "Shape Factor: "; Tab(28); Format$(Results.Carbon.ShapeFactor, "0.000")
      'Print #f, Tab(5); "Tortuosity: "; Tab(28); Format$(Results.Carbon.Tortuosity, "0.000")
      Print #f,

      '---------------Kinetic Parameters -----------------------------------------
      Print #f, "Kinetic parameters:"
      Print #f,
      Print #f, "Component"; Tab(24); "kf"; Tab(31); "Ds"; Tab(40); "Dp"; Tab(49); "St"; Tab(58); "Eds"; Tab(67); "Edp"; Tab(75); "SPDFR"
      Print #f, Tab(23); "cm/s"; Tab(32); "cm" & Chr$(178) & "/s"; Tab(41); "cm" & Chr$(178) & "/s"; Tab(50); "-"; Tab(59); "-"; Tab(68); "-"; Tab(76); "-"
      For i = 1 To Number_Component_PFPSDM
       Component(0) = Results.Component(i)
       Print #f, Trim$(Mid$(LTrim$(Results.Component(i).Name), 1, 20)); Tab(22); Format_It(Results.Component(i).kf, 2); Tab(35); Format_It(Results.Component(i).Ds, 2); Tab(44); Format_It(Results.Component(i).Dp, 2); Tab(54); Format_It(ST(0), 2); Tab(61); Format_It(Eds(0), 2); Tab(68); Format_It(Edp(0), 2); Tab(75); Format_It(Results.Component(i).SPDFR, 2)
      Next i
      Print #f,

      'Fouling-----------------------------------------
      Print #f, "Fouling correlations:"
      Print #f,
    
      Print #f, " Water type : "; Trim$(Results.Bed.Water_Correlation.Name)
      Eq1 = Format$(Results.Bed.Water_Correlation.Coeff(1), "0.00")

      If Results.Bed.Water_Correlation.Coeff(2) > 0 Then
        Eq1 = Eq1 & " + " & Format$(Results.Bed.Water_Correlation.Coeff(2), "0.00E+00") & "* t "
      Else
        If Results.Bed.Water_Correlation.Coeff(2) < 0 Then
        Eq1 = Eq1 & " - " & Format$(Abs(Results.Bed.Water_Correlation.Coeff(2)), "0.00E+00") & "* t "
       End If
      End If
      If Results.Bed.Water_Correlation.Coeff(3) > 0 Then
       Eq1 = Eq1 & " + " & Format$(Results.Bed.Water_Correlation.Coeff(3), "0.00") & "* EXP("
      Else
       If Results.Bed.Water_Correlation.Coeff(3) < 0 Then
         Eq1 = Eq1 & " - " & Format$(Abs(Results.Bed.Water_Correlation.Coeff(3)), "0.00") & "* EXP("
        End If
      End If
      If Results.Bed.Water_Correlation.Coeff(3) <> 0 Then
        If Results.Bed.Water_Correlation.Coeff(4) > 0 Then
         Eq1 = Eq1 & Format$(Results.Bed.Water_Correlation.Coeff(4), "0.00E+00") & "* t)"
        Else
         If Results.Bed.Water_Correlation.Coeff(4) < 0 Then
          Eq1 = Eq1 & Format$(Results.Bed.Water_Correlation.Coeff(4), "0.00E+00") & "* t)"
         End If
        End If
      End If
      Print #f, "K(t)/K0 = " & Eq1
      Print #f, "(t in minutes)"
      Print #f,

      For j = 1 To Number_Component_PFPSDM
       Eq1 = ""
       If Results.Component(j).Correlation.Coeff(1) = 1# Then
        Eq1 = "(K/K0) "
       Else
        If Results.Component(j).Correlation.Coeff(1) <> 0 Then Eq1 = Format$(Results.Component(j).Correlation.Coeff(1), "0.00") & " * (K/K0) "
      End If
      If Results.Component(j).Correlation.Coeff(2) > 0 Then
        Eq1 = Eq1 & "+ " & Format$(Results.Component(j).Correlation.Coeff(2), "0.00")
       Else
        If Results.Component(j).Correlation.Coeff(2) <> 0 Then Eq1 = Eq1 & "- " & Format$(Abs(Results.Component(j).Correlation.Coeff(2)), "0.00")
       End If
       If Trim$(Eq1) = "" Then
         Eq1 = "K/K0"
       End If
       Print #f, Trim$(Results.Component(j).Name) & ":"
       Print #f, Tab(10); "Correlation type: " & Trim$(Results.Component(j).Correlation.Name)
       Print #f, Tab(10); "K/K0 = " & Eq1
       
       If (Results.Component(j).Use_Tortuosity_Correlation) Then
         If (Results.Component(j).Constant_Tortuosity) Then
           Print #f, "Correlation used when SOC competition is important:"
           Print #f, " Tortuosity = 0.782 * EBCT^0.925 "
         Else
           Print #f, "Correlation used when NOM fouling is important:"
           Print #f, " Tortuosity = 1.0 if t< 70 days"
           Print #f, " Tortuosity = 0.334 + 6.610E-06 * EBCT"
         End If
       End If
       
       Print #f,
      Next j
                            
      'If Results.Use_Tortuosity_Correlation Then
      '  If Results.Constant_Tortuosity Then
      '    Print #f, "Correlation used when SOC competition is important:"
      '    Print #f, " Tortuosity = 0.782 * EBCT^0.925 "
      '  Else
      '    Print #f, "Correlation used when NOM fouling is important:"
      '    Print #f, " Tortuosity = 1.0 if t< 70 days"
      '    Print #f, " Tortuosity = 0.334 + 6.610E-06 * EBCT"
      '  End If
      'End If
      Print #f,

    '--- Print the results from the table
      Print #f, "Results for the Plug-Flow Pore And Surface Diffusion Model"
      Print #f,
      For i = 1 To Results.NComponent
        Print #f, Results.Component(i).Name
        Print #f, Tab(30); "Time(days)"; Tab(40); "BVT"; Tab(50); "TC"; Tab(60); "C (mg/L)"
        If (Results.ThroughPut_05(i).T <> -1#) And (Results.ThroughPut_05(i).C <> -1#) Then
          Print #f, "5% of the influent conc."; Tab(30); Format_It(Results.ThroughPut_05(i).T / 24# / 60#, 2); Tab(40); Format_It(Results.ThroughPut_05(i).T * 60# * Results.Bed.Flowrate / Results.Bed.length / PI / (Results.Bed.Diameter / 2) ^ 2, 2); Tab(50); Format_It(Results.ThroughPut_05(i).T * 60# * Results.Bed.Flowrate / Results.Bed.Weight, 2); Tab(60); Format_It(Results.ThroughPut_05(i).C, 2)
        Else
          Print #f, "5% of the influent conc."; Tab(30); "N/A"; Tab(40); "N/A"; Tab(50); "N/A"; Tab(60); "N/A"
        End If

        If (Results.ThroughPut_50(i).T <> -1#) And (Results.ThroughPut_50(i).C <> -1#) Then
          Print #f, "50% of the influent conc."; Tab(30); Format_It(Results.ThroughPut_50(i).T / 24# / 60#, 2); Tab(40); Format_It(Results.ThroughPut_50(i).T * 60# * Results.Bed.Flowrate / Results.Bed.length / PI / (Results.Bed.Diameter / 2) ^ 2, 2); Tab(50); Format_It(Results.ThroughPut_50(i).T * 60# * Results.Bed.Flowrate / Results.Bed.Weight, 2); Tab(60); Format_It(Results.ThroughPut_50(i).C, 2)
        Else
          Print #f, "50% of the influent conc."; Tab(30); "N/A"; Tab(40); "N/A"; Tab(50); "N/A"; Tab(60); "N/A"
        End If

        If (Results.ThroughPut_95(i).T <> -1#) And (Results.ThroughPut_95(i).C <> -1#) Then
          Print #f, "95% of the influent conc."; Tab(30); Format_It(Results.ThroughPut_95(i).T / 24# / 60#, 2); Tab(40); Format_It(Results.ThroughPut_95(i).T * 60# * Results.Bed.Flowrate / Results.Bed.length / PI / (Results.Bed.Diameter / 2) ^ 2, 2); Tab(50); Format_It(Results.ThroughPut_95(i).T * 60# * Results.Bed.Flowrate / Results.Bed.Weight, 2); Tab(60); Format_It(Results.ThroughPut_95(i).C, 2)
        Else
          Print #f, "95% of the influent conc."; Tab(30); "N/A"; Tab(40); "N/A"; Tab(50); "N/A"; Tab(60); "N/A"
        End If
        Print #f,
        If Flag_TO(i) Then
          Print #f, "Treatment Objective: " & Format_It(Treatment_Objective(i).C, 2) & " mg/L"
          Print #f,
          Print #f, Tab(10); "Time (days):"; Tab(25); Format_It(Treatment_Objective(i).T / 60# / 24#, 2)
          Print #f, Tab(10); "BVT:"; Tab(25); Format_It(Treatment_Objective(i).T * 60# * Results.Bed.Flowrate / Results.Bed.length / PI / (Results.Bed.Diameter / 2) ^ 2, 2)
          Print #f, Tab(10); "Tr. Capacity:"; Tab(25); Format_It(Treatment_Objective(i).T * 60# * Results.Bed.Flowrate / Results.Bed.Weight, 2)
        Else
          Print #f, "The breakthrough time for the treatment objective (" & Format_It(Treatment_Objective(i).C, 2) & "mg/L) could not be calculated."
        End If
        Print #f,
      Next i
      Print #f, "TC (Treatment Capacity) is in m" & Chr$(179) & "  / kg of GAC"
      
      '--- Print PSDM inputs/calculations that were returned from the FORTRAN routine.
      Print #f,
      Print #f, "PSDM Module Input Variables"
      Print #f, "Note: * designates a variable calculated in Visual BASIC"
      Print #f,

      Print #f, "Number of radial collocation points, NC            = " & Format$(PSDM_Inputs.VARS1(1), "0")
      Print #f, "Number of axial collocation points, MC             = " & Format$(PSDM_Inputs.VARS1(2), "0")
      Print #f, "Total no. of differential equations, NEQ           = " & Format$(PSDM_Inputs.VARS1(3), "0")
      Print #f, "Radius of adsorbent particle, RAD (cm)             = " & Format$(PSDM_Inputs.VARS1(4), "0.0000E+00")
      Print #f, "Apparent particle density, RHOP (g/cm^3)           = " & Format$(PSDM_Inputs.VARS1(5), "0.0000E+00")
      Print #f, "Void fraction of carbon, EPOR (-)                  = " & Format$(PSDM_Inputs.VARS1(6), "0.0000E+00")
      Print #f, "Void fraction of bed, EBED (-)                     = " & Format$(PSDM_Inputs.VARS1(7), "0.0000E+00")
      Print #f, "*Surface loading, SF (gpm/ft^2)                    = " & Format$(PSDM_Inputs.VARS1(8), "0.0000E+00")
      Print #f, "Packed bed contact time, TAU (sec)                 = " & Format$(PSDM_Inputs.VARS1(9), "0.0000E+00")
      Print #f, "Empty bed contact time, EBCT (min)                 = " & Format$(PSDM_Inputs.VARS1(10), "0.0000E+00")
      Print #f, "*Reynolds number, RE (-)                           = " & Format$(PSDM_Inputs.VARS1(11), "0.0000E+00")
      Print #f, "*Fluid density, DW (g/cm^3)                        = " & Format$(PSDM_Inputs.VARS1(12), "0.0000E+00")
      Print #f, "*Fluid viscosity, VW (g/cm-s)                      = " & Format$(PSDM_Inputs.VARS1(13), "0.0000E+00")
      Print #f, "Error flag, NFLAG                                  = " & Format$(PSDM_Inputs.VARS1(15), "0")
      Print #f,

      For i = 1 To Results.NComponent
        Print #f, Results.Component(i).Name
        Print #f, "Molal volume at the boiling pt., VB (cm^3/gmol)    = " & Format$(PSDM_Inputs.VARS2(i, 1), "0.0000E+00")
        Print #f, "Molecular weight of compound, XWT (g/gmol)         = " & Format$(PSDM_Inputs.VARS2(i, 2), "0.0000E+00")
        Print #f, "Initial bulk liquid-phase conc., CBO (umol/L)      = " & Format$(PSDM_Inputs.VARS2(i, 3), "0.0000E+00")
        Print #f, "Freundlich iso. cap., XK (umol/g)*(L/umol)^(1/n)   = " & Format$(PSDM_Inputs.VARS2(i, 4), "0.0000E+00")
        Print #f, "Freundlich isotherm constant, XN (-)               = " & Format$(PSDM_Inputs.VARS2(i, 5), "0.0000E+00")
        Print #f, "*Liquid diffusivity, DIFL (cm^2/sec)               = " & Format$(PSDM_Inputs.VARS2(i, 6), "0.0000E+00")
        Print #f, "Film transfer coefficient, KF (cm/sec)             = " & Format$(PSDM_Inputs.VARS2(i, 7), "0.0000E+00")
        Print #f, "Surface diffusion coefficient, DS (cm^2/s)         = " & Format$(PSDM_Inputs.VARS2(i, 8), "0.0000E+00")
        Print #f, "Stanton number, ST (-)                             = " & Format$(PSDM_Inputs.VARS2(i, 9), "0.0000E+00")
        Print #f, "Solute distribution parameter, DGS (-)             = " & Format$(PSDM_Inputs.VARS2(i, 10), "0.0000E+00")
        Print #f, "Biot number, BIS (-)                               = " & Format$(PSDM_Inputs.VARS2(i, 11), "0.0000E+00")
        Print #f, "Diffusivity modulus, EDS (-)                       = " & Format$(PSDM_Inputs.VARS2(i, 12), "0.0000E+00")
        Print #f, "Pore solute dist. parameter, DGP (-)               = " & Format$(PSDM_Inputs.VARS2(i, 13), "0.0000E+00")
        Print #f, "Pore diffusion coefficient, DP (cm^2/s)            = " & Format$(PSDM_Inputs.VARS2(i, 14), "0.0000E+00")
        Print #f, "Pore Biot number, BIP (-)                          = " & Format$(PSDM_Inputs.VARS2(i, 15), "0.0000E+00")
        Print #f, "Pore diffusion modulus, EDP (-)                    = " & Format$(PSDM_Inputs.VARS2(i, 16), "0.0000E+00")
        Print #f, "Surface to pore diffusivity ratio, D (-)           = " & Format$(PSDM_Inputs.VARS2(i, 17), "0.0000E+00")
        Print #f, "*Schmidt number, SC (-)                            = " & Format$(PSDM_Inputs.VARS2(i, 18), "0.0000E+00")
        Print #f, "*SPDFR (-)                                         = " & Format$(PSDM_Inputs.VARS2(i, 19), "0.0000E+00")
        Print #f,
      Next i
      
      Close (f)

    CMDialog1.Filename = ""
    Exit Sub

File_Error:
  If (Err.number = cdlCancel) Then
    'DO NOTHING.
  Else
    Call Show_Trapped_Error("cmdFile_Click")
  End If
  Resume Exit_Print_File
Exit_Print_File:
End Sub


Private Sub cmdPrint_Click()
 
Dim Error_Code As Integer, temp As String
Dim i As Integer, H  As Single, W As Single
Dim Eq1 As String, j As Integer, MTZ As String, f As Double

On Error GoTo Print_Error

    '---- Print the graph ------------------------
    For i = 1 To Number_Component
      grpBreak.ThisPoint = i
      grpBreak.PatternData = i - 1
    Next i

    H = grpBreak.Height
    W = grpBreak.Width

    grpBreak.Visible = False 'Hide it before printing

    If Printer.Width < Printer.Height Then
      grpBreak.Height = CSng(Printer.Height / 2#)
      grpBreak.Width = Printer.Width
    Else
      grpBreak.Height = Printer.Height
      grpBreak.Width = Printer.Width
    End If

    grpBreak.PrintStyle = 2
    grpBreak.DrawMode = 5

    grpBreak.Height = H
    grpBreak.Width = W

    grpBreak.Visible = True

    grpBreak.PrintStyle = 2
    grpBreak.DrawMode = 2

 'Print other results-----------------------------------------------
  Printer.ScaleLeft = -1080  'Set a 3/4-inch margin
  Printer.ScaleTop = -1080
  Printer.CurrentX = 0
  Printer.CurrentY = 0

    Printer.FontSize = 12
    Printer.FontBold = True
    Printer.FontUnderline = True
    Printer.Print "Input data for the Plug-Flow Pore And Surface Diffusion Model"
    Printer.FontSize = 10
    Printer.FontBold = False
    Printer.FontUnderline = False
    '-- Print Filename
    Printer.Print
    Printer.Print "From Data File: "; Filename
    

    Printer.Print
    Printer.Print "Component"; Tab(30); "K*"; Tab(38); "1/n"; Tab(47); "C0"; Tab(57); "MW"; Tab(65); "Vm"; Tab(75); "NBP"
    Printer.Print Tab(39); "-"; Tab(46); "mg/L"; Tab(56); "g/mol"; Tab(65); "cm" & Chr$(179) & "/mol"; Tab(76); "C"
                                                                     
    For i = 1 To Number_Component_PFPSDM
     Printer.Print Trim$(Mid$(LTrim$(Results.Component(i).Name), 1, 25)); Tab(29); Format$(Results.Component(i).Use_K, "###,##0.000"); Tab(37); Format$(Results.Component(i).Use_OneOverN, "0.000"); Tab(46); Format_It(Results.Component(i).InitialConcentration, 2); Tab(55); Format_It(Results.Component(i).MW, 2); Tab(64); Format_It(Results.Component(i).MolarVolume, 2); Tab(73); Format_It(Results.Component(i).BP, 2)
    Next i
    Printer.Print
    Printer.Print "* K in (mg/g)*(L/mg)^(1/n) - Vm = Molar Volume at NBP"
    Printer.Print

    '-----------------------Bed Data ----------------------
    Printer.FontUnderline = True
    Printer.Print "Bed Data:"
    Printer.FontUnderline = False

    Printer.Print Tab(5); "Bed Length: "; Tab(28); Format$(Results.Bed.length, "0.000E+00") & " m"
    Printer.Print Tab(5); "Bed Diameter: "; Tab(28); Format$(Results.Bed.Diameter, "0.000E+00") & " m"
    Printer.Print Tab(5); "Weight of GAC: "; Tab(28); Format$(Results.Bed.Weight, "0.000E+00") & " kg"
    Printer.Print Tab(5); "Inlet Flowrate: "; Tab(28); Format$(Results.Bed.Flowrate, "0.000E+00") & " m" & Chr$(179) & "/s"
    Printer.Print Tab(5); "EBCT: "; Tab(28); Format$(Results.Bed.length * PI * Results.Bed.Diameter * Results.Bed.Diameter / 4# / Results.Bed.Flowrate / 60#, "0.000E+00") & " mn"
    Printer.Print
    Printer.Print Tab(5); "Temperature:"; Tab(28); Format$(Results.Bed.Temperature, "0.00") & " C"
    If Results.Bed.Phase = 0 Then
      Printer.Print Tab(5); "Water Density:"; Tab(28); Format$(Results.Bed.WaterDensity, "0.0000") & " g/cm" & Chr$(179)
      Printer.Print Tab(5); "Water Viscosity:"; Tab(28); Format$(Results.Bed.WaterViscosity, "0.00E+00") & " g/cm.s"
    Else
      Printer.Print Tab(5); "Pressure:"; Tab(28); Format$(Results.Bed.Pressure, "0.00000") & " atm"
      Printer.Print Tab(5); "Air Density:"; Tab(28); Format$(Results.Bed.WaterDensity, "0.0000") & " g/cm" & Chr$(179)
      Printer.Print Tab(5); "Air Viscosity:"; Tab(28); Format$(Results.Bed.WaterViscosity, "0.00E+00") & " g/cm.s"
    End If
    Printer.Print

    '-----------------Carbon Properties -------------------------------
    Printer.FontUnderline = True
    Printer.Print "Carbon Properties:"
    Printer.FontUnderline = False

    Printer.Print Tab(5); "Name: "; Tab(28); Trim$(Results.Carbon.Name)
    Printer.Print Tab(5); "Apparent Density: "; Tab(28); Format$(Results.Carbon.Density, "0.000") & " g/cm" & Chr$(179)
    Printer.Print Tab(5); "Particle Radius: "; Tab(28); Format$(Results.Carbon.ParticleRadius * 100#, "0.000000") & " cm"
    Printer.Print Tab(5); "Porosity: "; Tab(28); Format$(Results.Carbon.Porosity, "0.000")
    Printer.Print Tab(5); "Shape Factor: "; Tab(28); Format$(Results.Carbon.ShapeFactor, "0.000")
    
    'Printer.Print Tab(5); "Tortuosity: "; Tab(28); Format$(Results.Carbon.Tortuosity, "0.000")
    Printer.Print

    '---------------Kinetic Parameters -----------------------------------------
    Printer.FontUnderline = True
    Printer.Print "Kinetic parameters:"
    Printer.FontUnderline = False
    
    Printer.Print
    Printer.Print "Component"; Tab(15); "kf"; Tab(22); "Ds"; Tab(29); "Dp"; Tab(36); "St"; Tab(43); "Eds"; Tab(50); "Edp"; Tab(57); "SPDFR"
    Printer.Print Tab(15); "cm/s"; Tab(22); "cm" & Chr$(178) & "/s"; Tab(29); "cm" & Chr$(178) & "/s"; Tab(36); "-"; Tab(43); "-"; Tab(50); "-"; Tab(57); "-"
    For i = 1 To Number_Component_PFPSDM
     Component(0) = Results.Component(i)
     Printer.Print Trim$(Mid$(LTrim$(Results.Component(i).Name), 1, 20)); Tab(15); Format_It(Results.Component(i).kf, 2); Tab(22); Format_It(Results.Component(i).Ds, 2); Tab(29); Format_It(Results.Component(i).Dp, 2); Tab(36); Format_It(ST(0), 2); Tab(43); Format_It(Eds(0), 2); Tab(50); Format_It(Edp(0), 2); Tab(57); Format_It(Results.Component(i).SPDFR, 2)
    Next i


    Printer.Print

    'Fouling-----------------------------------------
    Printer.FontUnderline = True
    Printer.Print "Fouling correlations:"
    Printer.FontUnderline = False
    Printer.Print
    
    Printer.Print " Water type : "; Trim$(Results.Bed.Water_Correlation.Name)
    Eq1 = Format$(Results.Bed.Water_Correlation.Coeff(1), "0.00")

    If Results.Bed.Water_Correlation.Coeff(2) > 0 Then
     Eq1 = Eq1 & " + " & Format$(Results.Bed.Water_Correlation.Coeff(2), "0.00E+00") & "* t "
    Else
     If Results.Bed.Water_Correlation.Coeff(2) < 0 Then
     Eq1 = Eq1 & " - " & Format$(Abs(Results.Bed.Water_Correlation.Coeff(2)), "0.00E+00") & "* t "
     End If
    End If
    If Results.Bed.Water_Correlation.Coeff(3) > 0 Then
     Eq1 = Eq1 & " + " & Format$(Results.Bed.Water_Correlation.Coeff(3), "0.00") & "* EXP("
    Else
     If Results.Bed.Water_Correlation.Coeff(3) < 0 Then
     Eq1 = Eq1 & " - " & Format$(Abs(Results.Bed.Water_Correlation.Coeff(3)), "0.00") & "* EXP("
     End If
    End If
    If Results.Bed.Water_Correlation.Coeff(3) <> 0 Then
      If Results.Bed.Water_Correlation.Coeff(4) > 0 Then
       Eq1 = Eq1 & Format$(Results.Bed.Water_Correlation.Coeff(4), "0.00E+00") & "* t)"
      Else
       If Results.Bed.Water_Correlation.Coeff(4) < 0 Then
        Eq1 = Eq1 & Format$(Results.Bed.Water_Correlation.Coeff(4), "0.00E+00") & "* t)"
       End If
      End If
    End If
    Printer.Print "K(t)/K0 = " & Eq1
    Printer.Print "(t in minutes)"
    Printer.Print

    For j = 1 To Number_Component_PFPSDM
     Eq1 = ""
     If Results.Component(j).Correlation.Coeff(1) = 1# Then
      Eq1 = "(K/K0) "
     Else
      If Results.Component(j).Correlation.Coeff(1) <> 0 Then Eq1 = Format$(Results.Component(j).Correlation.Coeff(1), "0.00") & " * (K/K0) "
     End If
     If Results.Component(j).Correlation.Coeff(2) > 0 Then
      Eq1 = Eq1 & "+ " & Format$(Results.Component(j).Correlation.Coeff(2), "0.00")
     Else
      If Results.Component(j).Correlation.Coeff(2) <> 0 Then Eq1 = Eq1 & "- " & Format$(Abs(Results.Component(j).Correlation.Coeff(2)), "0.00")
     End If
     If Trim$(Eq1) = "" Then
       Eq1 = "K/K0"
     End If
     Printer.Print Trim$(Results.Component(j).Name) & ":"
     Printer.Print Tab(10); "Correlation type: " & Trim$(Results.Component(j).Correlation.Name)

     Printer.Print Tab(10); "K/K0 = " & Eq1
    
     If (Results.Component(j).Use_Tortuosity_Correlation) Then
       If (Results.Component(j).Constant_Tortuosity) Then
         Printer.Print "Correlation used when SOC competition is important:"
         Printer.Print " Tortuosity = 0.782 * EBCT^0.925 "
       Else
         Printer.Print "Correlation used when NOM fouling is important:"
         Printer.Print " Tortuosity = 1.0 if t< 70 days"
         Printer.Print " Tortuosity = 0.334 + 6.610E-06 * EBCT"
       End If
     End If
     Printer.Print
    
    Next j
                            
    'If Results.Use_Tortuosity_Correlation Then
    '  If Results.Constant_Tortuosity Then
    '    Printer.Print "Correlation used when SOC competition is important:"
    '    Printer.Print " Tortuosity = 0.782 * EBCT^0.925 "
    '  Else
    '    Printer.Print "Correlation used when NOM fouling is important:"
    '    Printer.Print " Tortuosity = 1.0 if t< 70 days"
    '    Printer.Print " Tortuosity = 0.334 + 6.610E-06 * EBCT"
    '  End If
    'End If
    Printer.Print

'Model Parameters
    Printer.FontSize = 10
    Printer.FontBold = False
    Printer.FontUnderline = True
    Printer.Print "Model Parameters"
    Printer.FontUnderline = False
    Printer.FontSize = 10
    Printer.Print Tab(5); "Total Run Time:"; Tab(50); Format$(TimeP.End / 24# / 60#, "0.000"); " days"
    If (TimeP.Init / 60# / 24#) > 0.001 Then
       Printer.Print Tab(5); "First Point Displayed:"; Tab(50); Format$(TimeP.Init / 24# / 60#, "0.000"); " days"
    Else
       Printer.Print Tab(5); "First Point Displayed:"; Tab(50); Format$(TimeP.Init / 24# / 60#, "0.000E+00"); " days"
    End If
    Printer.Print Tab(5); "Time Step:"; Tab(50); Format$(TimeP.Step / 24# / 60#, "0.000"); " days"
    Printer.Print Tab(5); "Number of Axial Collocation Points:"; Tab(50); Format$(MC, "0")
    Printer.Print Tab(5); "Number of Radial Collocation Points:"; Tab(50); Format$(NC, "0")
    Printer.Print Tab(5); "Number of Axial Elements:"; Tab(50); Format$(Bed.NumberOfBeds, "0")
   
    Printer.NewPage

  '--- Print the results from the table
    Printer.FontSize = 10
    Printer.FontBold = True
    Printer.FontUnderline = True
    Printer.Print "Results for the Plug-Flow Pore And Surface Diffusion Model"
    Printer.FontUnderline = False
    Printer.Print
    For i = 1 To Results.NComponent
      Printer.FontSize = 12
      Printer.FontBold = True
      Printer.Print Results.Component(i).Name
      Printer.FontSize = 10
      Printer.FontBold = False
      Printer.Print Tab(30); "Time(days)"; Tab(40); "BVT"; Tab(50); "TC"; Tab(60); "C (mg/L)"
      If (Results.ThroughPut_05(i).T <> -1#) And (Results.ThroughPut_05(i).C <> -1#) Then
        Printer.Print "5% of the influent conc."; Tab(30); Format_It(Results.ThroughPut_05(i).T / 24# / 60#, 2); Tab(40); Format_It(Results.ThroughPut_05(i).T * 60# * Results.Bed.Flowrate / Results.Bed.length / PI / (Results.Bed.Diameter / 2) ^ 2, 2); Tab(50); Format_It(Results.ThroughPut_05(i).T * 60# * Results.Bed.Flowrate / Results.Bed.Weight, 2); Tab(60); Format_It(Results.ThroughPut_05(i).C, 2)
      Else
        Printer.Print "5% of the influent conc."; Tab(30); "N/A"; Tab(40); "N/A"; Tab(50); "N/A"; Tab(60); "N/A"
      End If

      If (Results.ThroughPut_50(i).T <> -1#) And (Results.ThroughPut_50(i).C <> -1#) Then
        Printer.Print "50% of the influent conc."; Tab(30); Format_It(Results.ThroughPut_50(i).T / 24# / 60#, 2); Tab(40); Format_It(Results.ThroughPut_50(i).T * 60# * Results.Bed.Flowrate / Results.Bed.length / PI / (Results.Bed.Diameter / 2) ^ 2, 2); Tab(50); Format_It(Results.ThroughPut_50(i).T * 60# * Results.Bed.Flowrate / Results.Bed.Weight, 2); Tab(60); Format_It(Results.ThroughPut_50(i).C, 2)
      Else
        Printer.Print "50% of the influent conc."; Tab(30); "N/A"; Tab(40); "N/A"; Tab(50); "N/A"; Tab(60); "N/A"
      End If

      If (Results.ThroughPut_95(i).T <> -1#) And (Results.ThroughPut_95(i).C <> -1#) Then
        Printer.Print "95% of the influent conc."; Tab(30); Format_It(Results.ThroughPut_95(i).T / 24# / 60#, 2); Tab(40); Format_It(Results.ThroughPut_95(i).T * 60# * Results.Bed.Flowrate / Results.Bed.length / PI / (Results.Bed.Diameter / 2) ^ 2, 2); Tab(50); Format_It(Results.ThroughPut_95(i).T * 60# * Results.Bed.Flowrate / Results.Bed.Weight, 2); Tab(60); Format_It(Results.ThroughPut_95(i).C, 2)
      Else
        Printer.Print "95% of the influent conc."; Tab(30); "N/A"; Tab(40); "N/A"; Tab(50); "N/A"; Tab(60); "N/A"
      End If
      Printer.Print
      If (Results.ThroughPut_50(i).C <> -1#) And (Results.ThroughPut_50(i).T <> -1#) And (Results.ThroughPut_05(i).T <> -1#) And (Results.ThroughPut_05(i).C <> -1#) And (Results.ThroughPut_95(i).T <> -1#) And (Results.ThroughPut_95(i).C <> -1#) Then
        f = 100# * Results.Bed.length / Results.ThroughPut_50(i).T   'in cm/dayss
        MTZ = Format$(f * (Results.ThroughPut_95(i).T - Results.ThroughPut_05(i).T), "0.00E+00")
      Else
        MTZ = "N/A"
      End If
      Printer.Print
      Printer.Print "MTZ Length 5%-95% (cm) :"; MTZ
      If Flag_TO(i) Then
        Printer.FontUnderline = True
        Printer.Print "Treatment Objective: " & Format_It(Treatment_Objective(i).C, 2) & " mg/L"
        Printer.FontUnderline = False
        Printer.Print
        Printer.Print Tab(10); "Time (days):"; Tab(25); Format_It(Treatment_Objective(i).T / 60# / 24#, 2)
        Printer.Print Tab(10); "BVT:"; Tab(25); Format_It(Treatment_Objective(i).T * 60# * Results.Bed.Flowrate / Results.Bed.length / PI / (Results.Bed.Diameter / 2) ^ 2, 2)
        Printer.Print Tab(10); "Tr. Capacity:"; Tab(25); Format_It(Treatment_Objective(i).T * 60# * Results.Bed.Flowrate / Results.Bed.Weight, 2)
      Else
        Printer.Print "The breakthrough time for the treatment objective (" & Format_It(Treatment_Objective(i).C, 2) & "mg/L) could not be calculated."
      End If
      Printer.Print
    Next i
    Printer.Print "TC (Treatment Capacity) is in m" & Chr$(179) & "  / kg of GAC"

      '--- Print PSDM inputs/calculations that were returned from the FORTRAN routine.
      Printer.Print
      Printer.Print "PSDM Module Input Variables"
      Printer.Print "Note: * designates a variable calculated in Visual BASIC"
      Printer.Print

      Printer.Print "Number of radial collocation points, NC            = " & Format$(PSDM_Inputs.VARS1(1), "0")
      Printer.Print "Number of axial collocation points, MC             = " & Format$(PSDM_Inputs.VARS1(2), "0")
      Printer.Print "Total no. of differential equations, NEQ           = " & Format$(PSDM_Inputs.VARS1(3), "0")
      Printer.Print "Radius of adsorbent particle, RAD (cm)             = " & Format$(PSDM_Inputs.VARS1(4), "0.0000E+00")
      Printer.Print "Apparent particle density, RHOP (g/cm^3)           = " & Format$(PSDM_Inputs.VARS1(5), "0.0000E+00")
      Printer.Print "Void fraction of carbon, EPOR (-)                  = " & Format$(PSDM_Inputs.VARS1(6), "0.0000E+00")
      Printer.Print "Void fraction of bed, EBED (-)                     = " & Format$(PSDM_Inputs.VARS1(7), "0.0000E+00")
      Printer.Print "*Surface loading, SF (gpm/ft^2)                    = " & Format$(PSDM_Inputs.VARS1(8), "0.0000E+00")
      Printer.Print "Packed bed contact time, TAU (sec)                 = " & Format$(PSDM_Inputs.VARS1(9), "0.0000E+00")
      Printer.Print "Empty bed contact time, EBCT (min)                 = " & Format$(PSDM_Inputs.VARS1(10), "0.0000E+00")
      Printer.Print "*Reynolds number, RE (-)                           = " & Format$(PSDM_Inputs.VARS1(11), "0.0000E+00")
      Printer.Print "*Fluid density, DW (g/cm^3)                        = " & Format$(PSDM_Inputs.VARS1(12), "0.0000E+00")
      Printer.Print "*Fluid viscosity, VW (g/cm-s)                      = " & Format$(PSDM_Inputs.VARS1(13), "0.0000E+00")
      Printer.Print "Error flag, NFLAG                                  = " & Format$(PSDM_Inputs.VARS1(15), "0")
      Printer.Print

      For i = 1 To Results.NComponent
        Printer.Print Results.Component(i).Name
        Printer.Print "Molal volume at the boiling pt., VB (cm^3/gmol)    = " & Format$(PSDM_Inputs.VARS2(i, 1), "0.0000E+00")
        Printer.Print "Molecular weight of compound, XWT (g/gmol)         = " & Format$(PSDM_Inputs.VARS2(i, 2), "0.0000E+00")
        Printer.Print "Initial bulk liquid-phase conc., CBO (umol/L)      = " & Format$(PSDM_Inputs.VARS2(i, 3), "0.0000E+00")
        Printer.Print "Freundlich iso. cap., XK (umol/g)*(L/umol)^(1/n)   = " & Format$(PSDM_Inputs.VARS2(i, 4), "0.0000E+00")
        Printer.Print "Freundlich isotherm constant, XN (-)               = " & Format$(PSDM_Inputs.VARS2(i, 5), "0.0000E+00")
        Printer.Print "*Liquid diffusivity, DIFL (cm^2/sec)               = " & Format$(PSDM_Inputs.VARS2(i, 6), "0.0000E+00")
        Printer.Print "Film transfer coefficient, KF (cm/sec)             = " & Format$(PSDM_Inputs.VARS2(i, 7), "0.0000E+00")
        Printer.Print "Surface diffusion coefficient, DS (cm^2/s)         = " & Format$(PSDM_Inputs.VARS2(i, 8), "0.0000E+00")
        Printer.Print "Stanton number, ST (-)                             = " & Format$(PSDM_Inputs.VARS2(i, 9), "0.0000E+00")
        Printer.Print "Solute distribution parameter, DGS (-)             = " & Format$(PSDM_Inputs.VARS2(i, 10), "0.0000E+00")
        Printer.Print "Biot number, BIS (-)                               = " & Format$(PSDM_Inputs.VARS2(i, 11), "0.0000E+00")
        Printer.Print "Diffusivity modulus, EDS (-)                       = " & Format$(PSDM_Inputs.VARS2(i, 12), "0.0000E+00")
        Printer.Print "Pore solute dist. parameter, DGP (-)               = " & Format$(PSDM_Inputs.VARS2(i, 13), "0.0000E+00")
        Printer.Print "Pore diffusion coefficient, DP (cm^2/s)            = " & Format$(PSDM_Inputs.VARS2(i, 14), "0.0000E+00")
        Printer.Print "Pore Biot number, BIP (-)                          = " & Format$(PSDM_Inputs.VARS2(i, 15), "0.0000E+00")
        Printer.Print "Pore diffusion modulus, EDP (-)                    = " & Format$(PSDM_Inputs.VARS2(i, 16), "0.0000E+00")
        Printer.Print "Surface to pore diffusivity ratio, D (-)           = " & Format$(PSDM_Inputs.VARS2(i, 17), "0.0000E+00")
        Printer.Print "*Schmidt number, SC (-)                            = " & Format$(PSDM_Inputs.VARS2(i, 18), "0.0000E+00")
        Printer.Print "*SPDFR (-)                                         = " & Format$(PSDM_Inputs.VARS2(i, 19), "0.0000E+00")
        Printer.Print
      Next i

    Printer.EndDoc
    Exit Sub

Print_Error:
  Call Show_Trapped_Error("cmdPrint_Click")
  Resume Exit_Print
Exit_Print:

End Sub


Private Sub cmdSave_Click()
Dim f As Integer, i As Integer, j As Integer, temp As String
Dim Filename_PFS As String
 
On Error GoTo Save_Results_PF_Error

  CMDialog1.CancelError = True
  CMDialog1.Filename = ""
  CMDialog1.Filter = "All Files (*.*)|*.*|Text Files (*.txt)|*.txt|Data Files (*.dat)|*.dat"
  CMDialog1.FilterIndex = 2
  CMDialog1.DialogTitle = "Save curves from PSDM"
  CMDialog1.flags = _
      cdlOFNOverwritePrompt + _
      cdlOFNPathMustExist
  CMDialog1.Action = 2
   
   'f = FileNameIsValid(Filename_PFS, CMDialog1)
   'If Not (f) Then Exit Sub
   Filename_PFS = CMDialog1.Filename

   'Save, T, BVF, Usage rate, C/C0
    f = FreeFile
    Open Filename_PFS For Output As f
    Write #f, "Results file for PSDM - Windows - Version " & Format$(NVersion, "0.00")
    temp = "Time(min)    BVT(-)   VTM(m^3/kg)   "
    For i = 1 To Results.NComponent
     temp = temp & Trim$(Results.Component(i).Name) & "          "
    Next i
    Write #f, temp
    Write #f,

    temp = ""
    For i = 1 To Results.npoints
     temp = Format$(Results.T(i), "0.00")
     temp = temp & "       " & Format$(Results.T(i) * 60 * Results.Bed.Flowrate / Results.Bed.length / PI / (Results.Bed.Diameter / 2) ^ 2, "0.00")
     temp = temp & "       " & Format$(Results.T(i) * 60 * Results.Bed.Flowrate / Results.Bed.Weight, "0.00")
     For j = 1 To Results.NComponent
       temp = temp & "          " & Format$(Results.CP(j, i), "0.000")
     Next j
     Print #f, temp
     temp = ""
    Next i
    Close f
    CMDialog1.Filename = ""
 Exit Sub

Save_Results_PF_Error:
  If (Err.number = cdlCancel) Then
    'DO NOTHING.
  Else
    Call Show_Trapped_Error("cmdSave_Click")
  End If
  Resume Exit_Save_Results_PF
Exit_Save_Results_PF:
End Sub


Private Sub cmdSelect_Click()
Dim Error_Code As Integer
Dim temp As String
  On Error GoTo Select_Print_Error
  'CMDialog1.flags = PD_PRINTSETUP
  'CMDialog1.Action = 5
  CMDialog1.CancelError = False
  CMDialog1.ShowPrinter
  Exit Sub
Select_Print_Error:
  Call Show_Trapped_Error("cmdSelect_Click")
  Resume Exit_Select_Print
Exit_Select_Print:
End Sub


Private Sub cmdTreat_Click()
Dim Objective As String, temp As Double, Tr_Obj As Double, j  As Integer, i As Integer

  Objective = InputBox$("Enter your treatment objective in mg/L for " & Trim$(Results.Component(cboCompo.ListIndex + 1).Name) & ":", Application_Name, lblData(9))
On Error GoTo Bad_Treament_Objective
  temp = CDbl(Objective)
  i = cboCompo.ListIndex + 1
  Tr_Obj = temp / Results.Component(cboCompo.ListIndex + 1).InitialConcentration
  For j = 1 To Number_Points_Max
    If j > 2 Then
      If (Results.CP(i, j) >= Tr_Obj) And (Results.CP(i, j - 1) < Tr_Obj) Then
        Treatment_Objective(cboCompo.ListIndex + 1).T = (Results.T(j) - Results.T(j - 1)) / (Results.CP(i, j) - Results.CP(i, j - 1)) * (Tr_Obj - Results.CP(i, j - 1)) + Results.T(j - 1)
          Treatment_Objective(cboCompo.ListIndex + 1).C = ((Results.CP(i, j) - Results.CP(i, j - 1)) / (Results.T(j) - Results.T(j - 1)) * (Treatment_Objective(cboCompo.ListIndex + 1).T - Results.T(j - 1)) + Results.CP(i, j - 1)) * Results.Component(i).InitialConcentration
        GoTo Exit_Loop
      End If
    End If
  Next j
   Flag_TO(cboCompo.ListIndex + 1) = False
   lblData(12) = "N/A"
   lblData(13) = "N/A"
   lblData(14) = "N/A"
   lblData(15) = "N/A"
  Exit Sub
Exit_Loop:
  Flag_TO(cboCompo.ListIndex + 1) = True
  lblData(12) = Format_It(Treatment_Objective(cboCompo.ListIndex + 1).T / 60# / 24#, 2)
  lblData(13) = Format_It(Treatment_Objective(cboCompo.ListIndex + 1).T * 60# * Results.Bed.Flowrate / Results.Bed.length / PI / (Results.Bed.Diameter / 2) ^ 2, 2)
  lblData(14) = Format_It(Treatment_Objective(cboCompo.ListIndex + 1).T * 60# * Results.Bed.Flowrate / Results.Bed.Weight, 2)
  lblData(15) = Format_It(Treatment_Objective(cboCompo.ListIndex + 1).C, 2)
  Exit Sub

Bad_Treament_Objective:
   Resume Exit_lblLegend_Click
Exit_lblLegend_Click:


End Sub

Private Sub Draw_PFPSDM()
Dim i As Integer, j As Integer
Dim Data_Max As Double, factor As Double, Bottom_Title As String
ReDim X_Values(Number_Points_Max) As Double
Dim biggest_numpoints As Integer
Dim index_with_biggest_numpoints As Integer
Dim LastPointI As Integer
Dim SameX As Double
Dim SameY As Double

Dim most_recent_x As Double
Dim most_recent_y As Double
Dim end_the_plot As Integer

'Copy the results
  If optType(0) Then  'Time
    factor = 1# / 60# / 24#  'mn > days
    Bottom_Title = "Time(days)"
  Else
    If optType(1) Then   'BVF         mn * (mn/s) * (m3/s) / m / (m2) -> dimensionless
      factor = 60# * Results.Bed.Flowrate / (Results.Bed.length * PI * (Results.Bed.Diameter / 2#) ^ 2)
      Bottom_Title = "Bed Volumes Treated"
    Else   'Treatment Capacity
      factor = 60# * Results.Bed.Flowrate / Results.Bed.Weight   'mn * (s/mn) * (m3/s) / (kg) -> m3/kg
      'factor = 60# * Results.Bed.Flowrate / Results.Bed.Length / Pi / (Results.Bed.Diameter / 2#) ^ 2
      'factor = factor / (Bed.density * 1000)
      Bottom_Title = "m" & Chr$(179) & " treated per kg of adsorbent"
    End If
  End If
  'Results.T(I,1) time is in mn
  'Results.T(I,2) is BVF
  For i = 1 To Number_Points_Max
    X_Values(i) = Results.T(i) * factor
  Next i

   ' The following code is a rather
   ' unfortunate kludge, in my opinion.  I could find no other way to
   ' convince/force Visual Basic's graphical interface to accept two sets
   ' of data that were of two different sizes, so I determined which one
   ' was the smaller set and then filled the remainer of the smaller set
   ' with copies of the last data point in it (X,Y) (note, the default
   ' is for the data to hook back to the point (0,0) at the end of its
   ' plotting due to the fact that, by default, the (X,Y) data points
   ' that are unspecified are filled with 0's).
   ' -- If possible, it would be nice to replace this with something
   ' more elegant, but hey, it works. -- Eric J. Oman, 7/31/96
     
    'Define Graph
    grpBreak.NumSets = Results.NComponent
    grpBreak.GraphType = 6
    grpBreak.GraphStyle = 4

    ''Determine the set with the largest number of data points
    'biggest_numpoints = -1
    'index_with_biggest_numpoints = -1
    'For j = 1 To grpBreak.NumSets
    '  'If (biggest_numpoints < Results.NumPoints_Before_ThroughPut_100(j)) Then
    '  If (biggest_numpoints < Results.NPoints) Then
    '    index_with_biggest_numpoints = j
    '    'biggest_numpoints = Results.NumPoints_Before_ThroughPut_100(j)
    '    biggest_numpoints = Results.NPoints
    '  End If
    'Next j
    biggest_numpoints = Results.npoints
    
    For j = 1 To grpBreak.NumSets
     grpBreak.ThisSet = j
     'grpBreak.NumPoints = Results.NPoints
     grpBreak.NumPoints = biggest_numpoints
     grpBreak.PatternData = 1
    Next j

    grpBreak.AutoInc = 0
    
    For j = 1 To grpBreak.NumSets
       grpBreak.ThisSet = j
       end_the_plot = False
       For i = 1 To grpBreak.NumPoints
         grpBreak.ThisPoint = i
         If (end_the_plot = False) Then
           If (Results.CP(j, i) < 0) Then
             If (Results.CP(j, i) = -10000#) Then
               end_the_plot = True
             Else
               grpBreak.GraphData = 0#
             End If
           Else                       'Results.CP(1,1)
             grpBreak.GraphData = Results.CP(j, i)
           End If
           If (end_the_plot = False) Then
             'grpBreak.ThisPoint = i
             'grpBreak.LabelText = ""
             'grpBreak.ThisPoint = i
             grpBreak.XPosData = X_Values(i)
             most_recent_x = X_Values(i)
             most_recent_y = Results.CP(j, i)
           End If
         End If
         If (end_the_plot = True) Then
           grpBreak.GraphData = most_recent_y
           'grpBreak.ThisPoint = i
           'grpBreak.LabelText = ""
           'grpBreak.ThisPoint = i
           grpBreak.XPosData = most_recent_x
         End If
       Next i
       grpBreak.ThisPoint = j
       grpBreak.LegendText = Trim$(Results.Component(j).Name)
    Next j

    ''Next, set values for remaining sets with # points < biggest_numpoints
    'For j = 1 To grpBreak.NumSets
    '  If (j <> index_with_biggest_numpoints) Then
    '    grpBreak.ThisSet = j
    '    LastPointI = Results.NumPoints_Before_ThroughPut_100(j)
    '    SameX = X_Values(LastPointI)
    '    SameY = Results.CP(j, LastPointI)
    '    For i = LastPointI + 1 To biggest_numpoints
    '      grpBreak.ThisPoint = i
    '      grpBreak.GraphData = SameY
    '      grpBreak.ThisPoint = i
    '      grpBreak.XPosData = SameX
    '    Next i
    '  End If
    'Next j
    
    'Other formatting
    grpBreak.PatternedLines = 0
    Data_Max = 0
    For j = 1 To grpBreak.NumSets
      grpBreak.ThisSet = j
      For i = 1 To grpBreak.NumPoints
        grpBreak.ThisPoint = i
        If grpBreak.GraphData > Data_Max Then
          Data_Max = grpBreak.GraphData
        End If
      Next i
    Next j
    grpBreak.YAxisMax = (Int(Data_Max * 10# + 1)) / 10#
    grpBreak.YAxisTicks = 4
    grpBreak.YAxisStyle = 2
    grpBreak.YAxisMin = 0#
    grpBreak.BottomTitle = Bottom_Title
    
    If (Results.is_psdm_in_room_model) Then
      If (Results.AnyCrCloseToZero = True) Then
        grpBreak.LeftTitle = "Cr, " & Chr$(181) & "g/L"
      Else
        grpBreak.LeftTitle = "Cr/Cr,ss"
      End If
    Else
      grpBreak.LeftTitle = "C/Co"
    End If
    
    grpBreak.DrawMode = 2

End Sub

Private Sub Form_Load()
Dim j As Integer, i As Integer
  'Set Window
  '
  ' MISC INITS.
  '
  If (Results.is_psdm_in_room_model) Then
    Me.Caption = "Results for the PSDM in Room Model"
    lblLegend(4).Caption = "5% of Cr,ss"
    lblLegend(5).Caption = "50% of Cr,ss"
    lblLegend(6).Caption = "95% of Cr,ss"
    ssframe_SSConc.Visible = True
  Else
    Me.Caption = "Results for the PSDM"
    lblLegend(4).Caption = "5% of influent conc."
    lblLegend(5).Caption = "50% of influent conc."
    lblLegend(6).Caption = "95% of influent conc."
    ssframe_SSConc.Visible = False
  End If
  
  Call CenterOnForm(Me, frmMain)
  
   PopulatingScrollboxes = False
   Screen.MousePointer = 11
   ''''Move frmPFPSDM.Left + (frmPFPSDM.Width / 2) - (frmbreak.Width / 2), frmPFPSDM.Top + (frmPFPSDM.Height / 2) - (frmbreak.Height / 2)
   ''''Me.HelpContextID = Hlp_Results_for
   ''''CMDialog1.CancelError = True
   lblLegend(2) = "BVT(m" & Chr$(179) & "/m" & Chr$(179) & ")"
   lblLegend(3) = "VTM(m" & Chr$(179) & "/kg)"
   Call Populate_Scrollboxes
   Call cboCompo_Click
   Call cboGrid_Click
   cboCompo.ListIndex = 0
   Call optType_Click(1, CInt(optType(1).Value))
'    optType(1) = True
   Screen.MousePointer = 0
   'grpBreak.GridStyle = 0
End Sub
Private Sub Form_Unload(Cancel As Integer)
  Call UserPrefs_Save
End Sub


Private Sub optType_Click(Index As Integer, Value As Integer)
  If (Not PopulatingScrollboxes) Then
    Call Draw_PFPSDM
  End If
End Sub


Private Sub Populate_Scrollboxes()
Dim i As Integer

    PopulatingScrollboxes = True
    
    cboGrid.AddItem "None"
    cboGrid.AddItem "Horizontal"
    cboGrid.AddItem "Vertical"
    cboGrid.AddItem "Both"
    
    For i = 1 To Results.NComponent
       cboCompo.AddItem Trim$(Results.Component(i).Name)
       Treatment_Objective(i) = Results.ThroughPut_05(i)
       If Treatment_Objective(i).C <> -1 Then
         Flag_TO(i) = True
       Else
         Flag_TO(i) = False
       End If
    Next i

    '-- Read in INI settings
    cboGrid.ListIndex = 0
    cboCompo.ListIndex = 0
    Call UserPrefs_Load
    
    PopulatingScrollboxes = False

End Sub

Private Sub UserPrefs_Load()
Dim X As Long

  On Error GoTo err_FRMBREAK_UserPrefs_Load

  X = CLng(INI_Getsetting("FRMBREAK_cboGrid"))
  If ((X >= 0) And (X <= cboGrid.ListCount - 1)) Then
    cboGrid.ListIndex = X
  End If
  X = CLng(INI_Getsetting("FRMBREAK_optType"))
  If ((X >= 0) And (X <= 2)) Then
    optType(X).Value = True
  End If
  
  Exit Sub

resume_err_FRMBREAK_UserPrefs_Load:
  Call UserPrefs_Save
  Exit Sub

err_FRMBREAK_UserPrefs_Load:
  Resume resume_err_FRMBREAK_UserPrefs_Load
           
End Sub

Private Sub UserPrefs_Save()
Dim X As Long

  X = cboGrid.ListIndex
  Call INI_PutSetting("FRMBREAK_cboGrid", Trim$(CStr(X)))
  If (optType(0)) Then X = 0
  If (optType(1)) Then X = 1
  If (optType(2)) Then X = 2
  Call INI_PutSetting("FRMBREAK_optType", Trim$(CStr(X)))

End Sub


VERSION 5.00
Begin VB.Form frmParamsPSDMInRoom 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Parameters for Room Model"
   ClientHeight    =   4635
   ClientLeft      =   4320
   ClientTop       =   2340
   ClientWidth     =   6825
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   4635
   ScaleWidth      =   6825
   ShowInTaskbar   =   0   'False
End
Attribute VB_Name = "frmParamsPSDMInRoom"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private Sub Form_Load()

End Sub
VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmPolanyi 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Polanyi Parameters of Adsorbent"
   ClientHeight    =   2115
   ClientLeft      =   3135
   ClientTop       =   4260
   ClientWidth     =   4500
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   2115
   ScaleWidth      =   4500
   ShowInTaskbar   =   0   'False
   Begin VB.TextBox txtPolanyi 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H8000000F&
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   285
      Left            =   1350
      Locked          =   -1  'True
      TabIndex        =   7
      TabStop         =   0   'False
      Text            =   "txtPolanyi"
      Top             =   60
      Width           =   2655
   End
   Begin VB.TextBox txtInput 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   285
      Index           =   2
      Left            =   2910
      TabIndex        =   2
      Text            =   "txtInput(2)"
      Top             =   990
      Width           =   1095
   End
   Begin VB.TextBox txtInput 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   285
      Index           =   1
      Left            =   2910
      TabIndex        =   1
      Text            =   "txtInput(1)"
      Top             =   690
      Width           =   1095
   End
   Begin VB.TextBox txtInput 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   285
      Index           =   0
      Left            =   2910
      TabIndex        =   0
      Text            =   "txtInput(0)"
      Top             =   390
      Width           =   1095
   End
   Begin Threed.SSCommand cmdCancelOK 
      Height          =   495
      Index           =   1
      Left            =   90
      TabIndex        =   8
      TabStop         =   0   'False
      Top             =   1440
      Width           =   2175
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      Caption         =   "&OK"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdCancelOK 
      Height          =   495
      Index           =   0
      Left            =   2250
      TabIndex        =   9
      TabStop         =   0   'False
      Top             =   1440
      Width           =   2175
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      Caption         =   "&Cancel"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin VB.Label lblInput 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H00C0C0C0&
      Caption         =   "GM"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   2
      Left            =   1230
      TabIndex        =   6
      Top             =   1020
      Width           =   1575
   End
   Begin VB.Label lblInput 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H00C0C0C0&
      Caption         =   "B (mol/cal)^GM"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   1
      Left            =   1230
      TabIndex        =   5
      Top             =   720
      Width           =   1575
   End
   Begin VB.Label lblInput 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H00C0C0C0&
      Caption         =   "W0 (cm3/g)"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   0
      Left            =   1290
      TabIndex        =   4
      Top             =   420
      Width           =   1515
   End
   Begin VB.Label Label10 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BackStyle       =   0  'Transparent
      Caption         =   "Adsorbent:"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Left            =   330
      TabIndex        =   3
      Top             =   90
      Width           =   975
   End
End
Attribute VB_Name = "frmPolanyi"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Dim frmPolanyi_ParentForm As Form

Dim USER_HIT_OK As Boolean
Dim USER_HIT_CANCEL As Boolean





Const frmPolanyi_declarations_end = True


Sub frmPolanyi_Edit( _
    INPUT_ParentForm As Form, _
    OUTPUT_Raise_Dirty_Flag As Boolean)
  Set frmPolanyi_ParentForm = INPUT_ParentForm
  frmPolanyi.Show 1
  If (USER_HIT_OK) Then
    OUTPUT_Raise_Dirty_Flag = True
  Else
    OUTPUT_Raise_Dirty_Flag = False
  End If
End Sub


Sub frmPolanyi_PopulateUnits()
  Call unitsys_register(frmPolanyi, lblInput(0), _
      txtInput(0), Nothing, "", _
      "", "", "", "", 100#, False)
  Call unitsys_register(frmPolanyi, lblInput(1), _
      txtInput(1), Nothing, "", _
      "", "", "", "", 100#, False)
  Call unitsys_register(frmPolanyi, lblInput(2), _
      txtInput(2), Nothing, "", _
      "", "", "", "", 100#, False)
End Sub


Private Sub cmdCancelOK_Click(Index As Integer)
Dim i As Integer
  Select Case Index
    Case 0:     'CANCEL.
      'EXIT OUT OF HERE.
      USER_HIT_CANCEL = True
      USER_HIT_OK = False
      Unload Me
      Exit Sub
    Case 1:     'OK.
      'EXIT OUT OF HERE.
      USER_HIT_CANCEL = False
      USER_HIT_OK = True
      Unload Me
      Exit Sub
  End Select
End Sub


Private Sub Form_Load()
  'MISC INITS.
  Me.Height = 2520
  Me.Width = 4620
  Call CenterOnForm(Me, frmPolanyi_ParentForm)
  txtPolanyi.Text = Carbon.Name
  'POPULATE UNIT CONTROLS.
  Call frmPolanyi_PopulateUnits
  'REFRESH DISPLAY.
  Call frmPolanyi_Refresh
End Sub
Private Sub Form_Unload(Cancel As Integer)
  Call unitsys_unregister_all_on_form(Me)
End Sub






Private Sub txtInput_GotFocus(Index As Integer)
Dim Ctl As Control
Set Ctl = txtInput(Index)
  Call unitsys_control_txtx_gotfocus(Ctl)
End Sub
Private Sub txtInput_KeyPress(Index As Integer, KeyAscii As Integer)
  KeyAscii = Global_NumericKeyPress(KeyAscii)
End Sub
Private Sub txtInput_LostFocus(Index As Integer)
Dim NewValue_Okay As Integer
Dim NewValue As Double
Dim Ctl As Control
Set Ctl = txtInput(Index)
Dim Val_Low As Double
Dim Val_High As Double
Dim Raise_Dirty_Flag As Boolean
Dim Too_Small As Integer
  'NOTE: LOW AND HIGH VALUES IN BASE UNITS.
  Select Case Index
    Case 0: Val_Low = 0.05: Val_High = 2.5
    Case 1: Val_Low = 1E-20: Val_High = 1E+20
    Case 2: Val_Low = 1E-20: Val_High = 1E+20
  End Select
  NewValue_Okay = False
  If (unitsys_control_txtx_lostfocus_validate(Ctl, Val_Low, Val_High, NewValue, Raise_Dirty_Flag)) Then
    NewValue_Okay = True
  End If
  Call unitsys_control_txtx_lostfocus(Ctl, NewValue)
  If (NewValue_Okay) Then
    If (Raise_Dirty_Flag) Then
      'STORE TO MEMORY.
      Select Case Index
        Case 0:         'W0.
          Carbon.W0 = NewValue
        Case 1:         'BB.
          Carbon.BB = NewValue
        Case 2:         'GM.
          Carbon.PolanyiExponent = NewValue
      End Select
      'RAISE DIRTY FLAG IF NECESSARY.
      If (Raise_Dirty_Flag) Then
        ''THROW DIRTY FLAG.
        'Call frmCompoProp_DirtyStatus_Throw
      End If
      'REFRESH WINDOW.
      Call frmPolanyi_Refresh
    End If
  End If
End Sub
VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Object = "{F9043C88-F6F2-101A-A3C9-08002B2F49FB}#1.1#0"; "Comdlg32.ocx"
Begin VB.Form frmPrintInputs 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Print Model Inputs"
   ClientHeight    =   3285
   ClientLeft      =   3615
   ClientTop       =   5820
   ClientWidth     =   4395
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   3285
   ScaleWidth      =   4395
   Begin Threed.SSFrame SSFrame1 
      Height          =   2445
      Left            =   60
      TabIndex        =   0
      Top             =   150
      Width           =   4245
      _Version        =   65536
      _ExtentX        =   7488
      _ExtentY        =   4313
      _StockProps     =   14
      Caption         =   "Print:"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin Threed.SSCheck chkSelect 
         Height          =   255
         Index           =   6
         Left            =   120
         TabIndex        =   1
         Top             =   2070
         Width           =   3000
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "      Effluent Data"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSCheck chkSelect 
         Height          =   255
         Index           =   5
         Left            =   120
         TabIndex        =   2
         Top             =   1770
         Width           =   3000
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "      Variable Influent Data"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSCheck chkSelect 
         Height          =   255
         Index           =   4
         Left            =   120
         TabIndex        =   3
         Top             =   1470
         Width           =   3000
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "      Fouling Correlations"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSCheck chkSelect 
         Height          =   255
         Index           =   1
         Left            =   120
         TabIndex        =   4
         Top             =   570
         Width           =   3000
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "      Bed Data"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSCheck chkSelect 
         Height          =   255
         Index           =   2
         Left            =   120
         TabIndex        =   5
         Top             =   870
         Width           =   3000
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "      Carbon Properties"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSCheck chkSelect 
         Height          =   255
         Index           =   0
         Left            =   120
         TabIndex        =   6
         Top             =   270
         Width           =   3000
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "      Component Properties"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin Threed.SSCheck chkSelect 
         Height          =   255
         Index           =   3
         Left            =   120
         TabIndex        =   7
         Top             =   1170
         Width           =   3000
         _Version        =   65536
         _ExtentX        =   2646
         _ExtentY        =   1323
         _StockProps     =   78
         Caption         =   "      Kinetic Parameters"
         ForeColor       =   -2147483640
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   24
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
   End
   Begin Threed.SSCommand cmdPrint 
      Height          =   435
      Left            =   2850
      TabIndex        =   8
      Top             =   2730
      Width           =   1455
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      Caption         =   "&Print"
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdCancel 
      Height          =   435
      Left            =   60
      TabIndex        =   9
      Top             =   2730
      Width           =   1455
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      Caption         =   "&Cancel"
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin MSComDlg.CommonDialog CMDialog1 
      Left            =   1740
      Top             =   2700
      _ExtentX        =   847
      _ExtentY        =   847
      _Version        =   327681
      FontSize        =   0
      MaxFileSize     =   256
   End
End
Attribute VB_Name = "frmPrintInputs"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
Option Base 1

Dim Filename_Input As String





Const frmPrintInputs_declarations_end = True


Private Sub chkSelect_Click(index As Integer, Value As Integer)
  chkSelect(index).Tag = CStr(Str$(Value))
End Sub


Private Sub cmdCancel_Click()
  Unload Me
End Sub


Private Sub cmdPrint_Click()
Dim Error_Code As Integer, temp As String, f  As Integer
Dim i As Integer, Dummy As Double, DFlag As Integer
Dim Eq1 As String, temporaryname As String, response As Integer
Dim s As String
Dim J As Integer

  DFlag = False
  For i = 0 To 4
    If chkSelect(i).Value Then DFlag = True
  Next i
  If Not (DFlag) Then
   Call Show_Error("You must select something to print!")
   Exit Sub
  End If

  If Print_To_Printer Then
On Error GoTo Print_Error
    Printer.ScaleLeft = -1080  'Set a 3/4-inch margin
    Printer.ScaleTop = -1080
    Printer.CurrentX = 0
    Printer.CurrentY = 0
    Printer.FontSize = 10
    Printer.Print Filename
    Printer.Print
    '---- Print Component Properties  ---------
    If chkSelect(0).Value Then
      Printer.FontSize = 12
      Printer.FontBold = True
      Printer.Print Tab(25); "Component Properties"
      Printer.FontSize = 10
      Printer.FontBold = False
      Printer.Print
      Printer.Print "Component"; Tab(30); "K*"; Tab(38); "1/n"; Tab(47); "C0"; Tab(57); "MW"; Tab(65); "Vm"; Tab(75); "NBP"
      Printer.Print Tab(39); "-"; Tab(46); "mg/L"; Tab(56); "g/mol"; Tab(65); "cm" & Chr$(179) & "/mol"; Tab(76); "C"
      For i = 1 To Number_Component
        Printer.Print Trim$(Mid$(LTrim$(Component(i).Name), 1, 25)); Tab(29); Format$(Component(i).Use_K, "###,##0.000"); Tab(37); Format$(Component(i).Use_OneOverN, "0.000"); Tab(46); Format_It(Component(i).InitialConcentration, 2); Tab(55); Format_It(Component(i).MW, 2); Tab(64); Format_It(Component(i).MolarVolume, 2); Tab(73); Format_It(Component(i).BP, 2)
      Next i
      Printer.Print
      Printer.Print "* K in (mg/g)*(L/mg)^(1/n) - Vm = Molar Volume at NBP"
      Printer.Print
    End If
    '---Print bed data-----
    Call GetMoreBedParameters
    If chkSelect(1).Value Then
      Printer.FontSize = 12
      Printer.FontBold = True
      Printer.Print Tab(25); "Fixed-Bed Properties"
      Printer.FontSize = 10
      Printer.FontBold = False
      Printer.Print
      Printer.Print "Bed Length:"; Tab(25); Format$(Bed.length, "0.000E+00") & " m"
      Printer.Print "Bed Diameter:"; Tab(25); Format$(Bed.Diameter, "0.000E+00") & " m"
      Printer.Print "Weight of GAC:"; Tab(25); Format$(Bed.Weight, "0.000E+00") & " kg"
      Printer.Print "Inlet Flowrate:"; Tab(25); Format$(Bed.Flowrate, "0.000E+00") & " m" & Chr$(179) & "/s"
      Printer.Print "EBCT:"; Tab(25); Format$(Bed.length * PI * Bed.Diameter * Bed.Diameter / 4# / Bed.Flowrate / 60#, "0.000E+00") & " mn"
      Printer.Print "Bed Density:"; Tab(25); Format$(Bed.Density, "0.000") & " g/cm3"
      Printer.Print "Bed Porosity:"; Tab(25); Format$(Bed.Porosity, "0.000")
      Printer.Print "Superficial Velocity:"; Tab(25); Format$(Bed.SuperficialVelocity * 3600#, "0.00E+00") & " m/hr"
      Printer.Print "Interstitial Velocity:"; Tab(25); Format$(Bed.InterstitialVelocity * 3600#, "0.00E+00") & " m/hr"
      Printer.Print
      Printer.Print "Temperature:"; Tab(25); Format$(Bed.Temperature, "0.00") & " C"
      Printer.Print "Water Density:"; Tab(25); Format$(Bed.WaterDensity, "0.0000") & " g/cm" & Chr$(179)
      Printer.Print "Water Viscosity:"; Tab(25); Format$(Bed.WaterViscosity, "0.00E+0") & " g/cm.s"
      Printer.Print
    End If
    '--- Print Carbon Properties -----
    If chkSelect(2).Value Then
      Printer.FontSize = 12
      Printer.FontBold = True
      Printer.Print Tab(25); "Carbon Properties"
      Printer.FontSize = 10
      Printer.FontBold = False
      Printer.Print
      Printer.Print "Name:"; Tab(19); Trim$(Carbon.Name)
      Printer.Print "Apparent Density:"; Tab(19); Format$(Carbon.Density, "0.000") & " g/cm" & Chr$(179)
      Printer.Print "Particle Radius:"; Tab(19); Format$(Carbon.ParticleRadius * 100#, "0.00000") & " cm"
      Printer.Print "Porosity:"; Tab(19); Format$(Carbon.Porosity, "0.000")
      Printer.Print "Shape Factor: "; Tab(19); Format$(Carbon.ShapeFactor, "0.000")
      'Printer.Print "Tortuosity:"; Tab(19); Format$(Carbon.Tortuosity, "0.000")
      Printer.Print
    End If
    '--- Print kinetic Parameters -----
    If chkSelect(3).Value Then
      Printer.FontSize = 12
      Printer.FontBold = True
      Printer.Print Tab(25); "Kinetic Parameters"
      Printer.FontSize = 10
      Printer.FontBold = False
      Printer.Print
      Printer.Print "Component"; Tab(24); "kf"; Tab(33); "Ds"; Tab(42); "Dp"; Tab(50); "St"; Tab(58); "Eds"; Tab(67); "Edp"; Tab(75); "SPDFR"
      Printer.Print Tab(23); "cm/s"; Tab(32); "cm" & Chr$(178) & "/s"; Tab(41); "cm" & Chr$(178) & "/s"; Tab(50); "-"; Tab(59); "-"; Tab(68); "-"; Tab(77); "-"
      For i = 1 To Number_Component
          Printer.Print Mid$(Trim$(Component(i).Name), 1, 20); Tab(22); Format_It(Component(i).kf, 2); Tab(31); Format$(Component(i).Ds, "0.00E+00"); Tab(40); Format$(Component(i).Dp, "0.00E+00"); Tab(49); Format_It(ST(i), 2); Tab(58); Format_It(Eds(i), 2); Tab(67); Format_It(Edp(i), 2); Tab(76); Format_It(Component(i).SPDFR, 2)
      Next i
    End If
    '--- Print fouling correlations ---
    If chkSelect(4).Value Then
        J = False
        
        For i = 1 To Number_Component
          'if and only if using correlation then print correlation
          If Component(i).Use_Tortuosity_Correlation = True Then J = True
        Next i
      
      If J Then
        Printer.Print
        Printer.FontSize = 12
        Printer.FontBold = True
        Printer.Print Tab(25); "Fouling Correlations"
        Printer.FontSize = 10
        Printer.FontBold = False
        Printer.Print
  
        Printer.Print " Water type : "; Trim$(Bed.Water_Correlation.Name)
        Eq1 = Format$(Bed.Water_Correlation.Coeff(1), "0.00")
  
        If Bed.Water_Correlation.Coeff(2) > 0 Then
          Eq1 = Eq1 & " + " & Format$(Bed.Water_Correlation.Coeff(2), "0.00E+00") & "* t "
        Else
        If Bed.Water_Correlation.Coeff(2) < 0 Then
          Eq1 = Eq1 & " - " & Format$(Abs(Bed.Water_Correlation.Coeff(2)), "0.00E+00") & "* t "
         End If
        End If
        If Bed.Water_Correlation.Coeff(3) > 0 Then
         Eq1 = Eq1 & " + " & Format$(Bed.Water_Correlation.Coeff(3), "0.00") & "* EXP("
        Else
         If Bed.Water_Correlation.Coeff(3) < 0 Then
          Eq1 = Eq1 & " - " & Format$(Abs(Bed.Water_Correlation.Coeff(3)), "0.00") & "* EXP("
         End If
        End If
        If Bed.Water_Correlation.Coeff(3) <> 0 Then
          If Bed.Water_Correlation.Coeff(4) > 0 Then
           Eq1 = Eq1 & Format$(Bed.Water_Correlation.Coeff(4), "0.00E+00") & "* t)"
          Else
           If Bed.Water_Correlation.Coeff(4) < 0 Then
            Eq1 = Eq1 & Format$(Bed.Water_Correlation.Coeff(4), "0.00E+00") & "* t)"
           End If
          End If
        End If
        Printer.Print "K(t)/K0 = " & Eq1
        Printer.Print "(t in minutes)"
        Printer.Print
  
        For i = 1 To Number_Component
         If Component(i).Use_Tortuosity_Correlation = True Then
            Eq1 = ""
            If Component(i).Correlation.Coeff(1) = 1# Then
            Eq1 = "(K/K0) "
           Else
            If Component(i).Correlation.Coeff(1) <> 0 Then Eq1 = Format$(Component(i).Correlation.Coeff(1), "0.00") & " * (K/K0) "
           End If
           If Component(i).Correlation.Coeff(2) > 0 Then
            Eq1 = Eq1 & "+ " & Format$(Component(i).Correlation.Coeff(2), "0.00")
           Else
            If Component(i).Correlation.Coeff(2) <> 0 Then Eq1 = Eq1 & "- " & Format$(Abs(Component(i).Correlation.Coeff(2)), "0.00")
           End If
           If Trim$(Eq1) = "" Then
             Eq1 = "K/K0"
           End If
           Printer.Print Trim$(Component(i).Name) & ":"
           Printer.Print Tab(10); "Correlation type: " & Trim$(Component(i).Correlation.Name)
    
           Printer.Print Tab(10); "K/K0 = " & Eq1
           If (Component(i).Use_Tortuosity_Correlation) Then
             If (Component(i).Constant_Tortuosity) Then
               Printer.Print "Correlation used when SOC competition is important:"
               Printer.Print " Tortuosity = 0.782 * EBCT^0.925 "
             Else
               Printer.Print "Correlation used when NOM fouling is important:"
               Printer.Print " Tortuosity = 1.0 if t< 70 days"
               Printer.Print " Tortuosity = 0.334 + 6.610E-06 * t   (t in minutes)"
             End If
           End If
           
           Printer.Print
         End If
        Next i
  
        Printer.Print
      End If
     End If

      '--- Print Variable Influent Data
      If chkSelect(5).Value Then
        Printer.Print
        Printer.Print Tab(25); "Variable Influent Data"
        Printer.Print
        s = "Time(days)"
        For J = 1 To Number_Component
          s = s & ",C of " & Trim$(Component(J).Name)
        Next J
        s = s & ":"
        Printer.Print s
        Printer.Print "(All C in mg/L)"
        For i = 1 To Number_Influent_Points
          s = Trim$(Str$(T_Influent(i) / 60# / 24#))     'Convert min--->days
          For J = 1 To Number_Component
            s = s & "," & Trim$(Str$(C_Influent(J, i)))
          Next J
          Printer.Print s
        Next i
      End If
      
      '--- Print Effluent Data
      If chkSelect(6).Value Then
        Printer.Print
        Printer.Print Tab(25); "Effluent Data"
        Printer.Print
        s = "Time(days)"
        For J = 1 To Number_Component
          s = s & ",C/C0 of " & Trim$(Component(J).Name)
        Next J
        s = s & ":"
        Printer.Print s
        Printer.Print "(All C/C0 are dimensionless and normalized)"
        For i = 1 To NData_Points
          s = Trim$(Str$(T_Data_Points(i)))
          For J = 1 To Number_Component
            s = s & "," & Trim$(Str$(C_Data_Points(J, i)))
          Next J
          Printer.Print s
        Next i
      End If

    Printer.EndDoc
  Else

On Error GoTo File_Error
    CMDialog1.CancelError = True
    CMDialog1.Filename = ""
    CMDialog1.DialogTitle = "Print to File"
    CMDialog1.Filter = "All Files (*.*)|*.*|Text Files (*.txt)|*.txt|Data Files (*.dat)|*.dat"
    CMDialog1.FilterIndex = 2
    CMDialog1.flags = _
        cdlOFNOverwritePrompt + _
        cdlOFNPathMustExist
    CMDialog1.Action = 2
    
   'f = FileNameIsValid(Filename_Input, CMDialog1)
   'If Not (f) Then Exit Sub
   Filename_Input = CMDialog1.Filename

      f = FreeFile
      Open Filename_Input For Output As f
      Print #f, Filename

      '---- Print Component Properties  ---------
      If chkSelect(0).Value Then
       Print #f, Tab(25); "Component Properties"
       Print #f,
       Print #f, "Component"; Tab(30); "K*"; Tab(38); "1/n"; Tab(47); "C0"; Tab(57); "MW"; Tab(65); "Vm"; Tab(75); "NBP"
       Print #f, Tab(39); "-"; Tab(46); "mg/L"; Tab(56); "g/mol"; Tab(65); "cm" & Chr$(179) & "/mol"; Tab(76); "C"
        For i = 1 To Number_Component
         Print #f, Trim$(Mid$(LTrim$(Component(i).Name), 1, 25)); Tab(29); Format$(Component(i).Use_K, "###,##0.000"); Tab(37); Format$(Component(i).Use_OneOverN, "0.000"); Tab(46); Format_It(Component(i).InitialConcentration, 2); Tab(55); Format_It(Component(i).MW, 2); Tab(64); Format_It(Component(i).MolarVolume, 2); Tab(73); Format_It(Component(i).BP, 2)
        Next i
       Print #f,
       Print #f, "* K in (mg/g)*(L/mg)^(1/n) - Vm = Molar Volume at NBP"
       Print #f,
      End If

      '---Print bed data-----
      Call GetMoreBedParameters
      If chkSelect(1).Value Then
        Print #f, Tab(25); "Bed Data"
        Print #f,
        Print #f, "Bed Length:"; Tab(18); Format$(Bed.length, "0.000E+00") & " m"
        Print #f, "Bed Diameter:"; Tab(18); Format$(Bed.Diameter, "0.000E+00") & " m"
        Print #f, "Weight of GAC:"; Tab(18); Format$(Bed.Weight, "0.000E+00") & " kg"
        Print #f, "Inlet Flowrate:"; Tab(18); Format$(Bed.Flowrate, "0.000E+00") & " m" & Chr$(179) & "/s"
        Print #f, "EBCT:"; Tab(18); Format$(Bed.length * PI * Bed.Diameter * Bed.Diameter / 4# / Bed.Flowrate / 60#, "0.000E+00") & " mn"
        Print #f, "Bed Density:"; Tab(25); Format$(Bed.Density, "0.000") & " g/cm3"
        Print #f, "Bed Porosity:"; Tab(25); Format$(Bed.Porosity, "0.000")
        Print #f, "Superficial Velocity:"; Tab(25); Format$(Bed.SuperficialVelocity * 3600#, "0.00E+00") & " m/hr"
        Print #f, "Interstitial Velocity:"; Tab(25); Format$(Bed.InterstitialVelocity * 3600#, "0.00E+00") & " m/hr"
        Print #f,
        Print #f, "Temperature:"; Tab(18); Format$(Bed.Temperature, "0.00") & " C"
        Print #f, "Water Density:"; Tab(18); Format$(Bed.WaterDensity, "0.0000") & " g/cm" & Chr$(179)
        Print #f, "Water Viscosity:"; Tab(18); Format$(Bed.WaterViscosity, "0.00E+0") & " g/cm.s"
        Print #f,
      End If
      '--- Print Carbon Properties -----
      If chkSelect(2).Value Then
        Print #f, Tab(25); "Carbon Properties"
        Print #f,
        Print #f, "Name:"; Tab(19); Trim$(Carbon.Name)
        Print #f, "Apparent Density:"; Tab(19); Format$(Carbon.Density, "0.000") & " g/cm" & Chr$(179)
        Print #f, "Particle Radius:"; Tab(19); Format$(Carbon.ParticleRadius * 100#, "0.00000") & " cm"
        Print #f, "Porosity:"; Tab(19); Format$(Carbon.Porosity, "0.000")
        Print #f, "Shape Factor: "; Tab(19); Format$(Carbon.ShapeFactor, "0.000")
        'Print #f, "Tortuosity:"; Tab(19); Format$(Carbon.Tortuosity, "0.000")
        Print #f,
      End If
      '--- Print kinetic Parameters -----
      If chkSelect(3).Value Then
       Print #f, Tab(25); "Kinetic Parameters"
       Print #f,
       Print #f, "Component"; Tab(24); "kf"; Tab(33); "Ds"; Tab(42); "Dp"; Tab(50); "St"; Tab(58); "Eds"; Tab(67); "Edp"; Tab(75); "SPDFR"
       Print #f, Tab(23); "cm/s"; Tab(32); "cm" & Chr$(178) & "/s"; Tab(41); "cm" & Chr$(178) & "/s"; Tab(50); "-"; Tab(59); "-"; Tab(68); "-"; Tab(77); "-"
        For i = 1 To Number_Component
         Print #f, Mid$(Trim$(Component(i).Name), 1, 20); Tab(22); Format_It(Component(i).kf, 2); Tab(31); Format$(Component(i).Ds, "0.00E+00"); Tab(40); Format$(Component(i).Dp, "0.00E+00"); Tab(49); Format_It(ST(i), 2); Tab(58); Format_It(Eds(i), 2); Tab(67); Format_It(Edp(i), 2); Tab(76); Format_It(Component(i).SPDFR, 2)
        Next i
      End If
    '--- Print fouling correlations ---
      If chkSelect(4).Value Then
        'check to see if fouling needed
        J = False
        For i = 1 To Number_Component
          'if and only if using correlation then print correlation
          If Component(i).Use_Tortuosity_Correlation = True Then J = True
        Next i

       If J Then
         Print #f,
         Print #f, Tab(25); "Fouling Correlations"
         Print #f,
  
         Print #f, " Water type : "; Trim$(Bed.Water_Correlation.Name)
          Eq1 = Format$(Bed.Water_Correlation.Coeff(1), "0.00")
  
          If Bed.Water_Correlation.Coeff(2) > 0 Then
            Eq1 = Eq1 & " + " & Format$(Bed.Water_Correlation.Coeff(2), "0.00E+00") & "* t "
          Else
          If Bed.Water_Correlation.Coeff(2) < 0 Then
            Eq1 = Eq1 & " - " & Format$(Abs(Bed.Water_Correlation.Coeff(2)), "0.00E+00") & "* t "
           End If
          End If
          If Bed.Water_Correlation.Coeff(3) > 0 Then
           Eq1 = Eq1 & " + " & Format$(Bed.Water_Correlation.Coeff(3), "0.00") & "* EXP("
          Else
           If Bed.Water_Correlation.Coeff(3) < 0 Then
            Eq1 = Eq1 & " - " & Format$(Abs(Bed.Water_Correlation.Coeff(3)), "0.00") & "* EXP("
           End If
          End If
          If Bed.Water_Correlation.Coeff(3) <> 0 Then
            If Bed.Water_Correlation.Coeff(4) > 0 Then
             Eq1 = Eq1 & Format$(Bed.Water_Correlation.Coeff(4), "0.00E+00") & "* t)"
            Else
             If Bed.Water_Correlation.Coeff(4) < 0 Then
              Eq1 = Eq1 & Format$(Bed.Water_Correlation.Coeff(4), "0.00E+00") & "* t)"
             End If
            End If
          End If
         Print #f, "K(t)/K0 = " & Eq1
         Print #f, "(t in minutes)"
         Print #f,
  
          For i = 1 To Number_Component
            'if and only if using correlation then print correlation
            If Component(i).Use_Tortuosity_Correlation = True Then
           
               Eq1 = ""
               If Component(i).Correlation.Coeff(1) = 1# Then
                Eq1 = "(K/K0) "
               Else
                If Component(i).Correlation.Coeff(1) <> 0 Then Eq1 = Format$(Component(i).Correlation.Coeff(1), "0.00") & " * (K/K0) "
               End If
               If Component(i).Correlation.Coeff(2) > 0 Then
                Eq1 = Eq1 & "+ " & Format$(Component(i).Correlation.Coeff(2), "0.00")
               Else
                If Component(i).Correlation.Coeff(2) <> 0 Then Eq1 = Eq1 & "- " & Format$(Abs(Component(i).Correlation.Coeff(2)), "0.00")
               End If
               If Trim$(Eq1) = "" Then
                 Eq1 = "K/K0"
               End If
              Print #f, Trim$(Component(i).Name) & ":"
              Print #f, Tab(10); "Correlation type: " & Trim$(Component(i).Correlation.Name)
      
              Print #f, Tab(10); "K/K0 = " & Eq1
              
              If (Component(i).Use_Tortuosity_Correlation) Then
                If (Component(i).Constant_Tortuosity) Then
                  Print #f, "Correlation used when SOC competition is important:"
                  Print #f, " Tortuosity = 0.782 * EBCT^0.925 "
                Else
                  Print #f, "Correlation used when NOM fouling is important:"
                  Print #f, " Tortuosity = 1.0 if t< 70 days"
                  Print #f, " Tortuosity = 0.334 + 6.610E-06 * t   (t in minutes)"
                End If
              End If
              Print #f,
            End If
          Next i
        End If
        'If Use_Tortuosity_Correlation Then
        '  If Constant_Tortuosity Then
        '   Print #f, "Correlation used when SOC competition is important:"
        '   Print #f, " Tortuosity = 0.782 * EBCT^0.925 "
        '  Else
        '   Print #f, "Correlation used when NOM fouling is important:"
        '   Print #f, " Tortuosity = 1.0 if t< 70 days"
        '   Print #f, " Tortuosity = 0.334 + 6.610E-06 * EBCT"
        '  End If
        'End If
       Print #f,
      End If
      
      '--- Print Variable Influent Data

      If chkSelect(5).Value Then
        Print #f,
        Print #f, Tab(25); "Variable Influent Data"
        Print #f,
        s = "Time(days)"
        For J = 1 To Number_Component
          s = s & ",C of " & Trim$(Component(J).Name)
        Next J
        s = s & ":"
        Print #f, s
        Print #f, "(All C in mg/L)"
        For i = 1 To Number_Influent_Points
          s = Trim$(Str$(T_Influent(i) / 60# / 24#))     'Convert min--->days
          For J = 1 To Number_Component
            s = s & "," & Trim$(Str$(C_Influent(J, i)))
          Next J
          Print #f, s
        Next i
      End If
      
      '--- Print Effluent Data
      If chkSelect(6).Value Then
        Print #f,
        Print #f, Tab(25); "Effluent Data"
        Print #f,
        s = "Time(days)"
        For J = 1 To Number_Component
          s = s & ",C/C0 of " & Trim$(Component(J).Name)
        Next J
        s = s & ":"
        Print #f, s
        Print #f, "(All C/C0 are dimensionless and normalized)"
        For i = 1 To NData_Points
          s = Trim$(Str$(T_Data_Points(i)))
          For J = 1 To Number_Component
            s = s & "," & Trim$(Str$(C_Data_Points(J, i)))
          Next J
          Print #f, s
        Next i
      End If

      Close (f)
    End If
  CMDialog1.Filename = ""
  Unload Me
  Exit Sub

Print_Error:
  If (Err.number = cdlCancel) Then
    'DO NOTHING.
  Else
    Call Show_Trapped_Error("cmdPrint_Click")
  End If
  Resume Exit_Print
File_Error:
  If (Err.number = cdlCancel) Then
    'DO NOTHING.
  Else
    Call Show_Trapped_Error("cmdPrint_Click")
  End If
  Resume Exit_Print
Exit_Print:
End Sub


Private Sub Form_Load()
Dim temp As String
Dim temp2 As String
Dim temp3 As String
Dim i As Integer
  ''''Me.HelpContextID = Hlp_Print_
  Call UserPrefs_Load
  For i = 0 To 6
    chkSelect(i).Tag = CStr(Str$(chkSelect(i).Value))
  Next i
  Call CenterOnForm(Me, frmMain)
  If Print_To_Printer Then
    Me.Caption = "Print to printer"
  Else
    Me.Caption = "Print to file"
  End If
  If (Number_Component <= 0) Then
    temp = chkSelect(0).Tag
    temp2 = chkSelect(3).Tag
    temp3 = chkSelect(4).Tag
    chkSelect(0).Enabled = False
    chkSelect(0).Value = False
    chkSelect(3).Enabled = False
    chkSelect(3).Value = False
    chkSelect(4).Enabled = False
    chkSelect(4).Value = False
    chkSelect(0).Tag = temp
    chkSelect(3).Tag = temp2
    chkSelect(4).Tag = temp3
  Else
    chkSelect(0).Value = True
    chkSelect(3).Value = True
    chkSelect(4).Value = True
  End If
  If (Number_Influent_Points = 0) Then
    temp = chkSelect(5).Tag
    chkSelect(5).Value = False
    chkSelect(5).Enabled = False
    chkSelect(5).Tag = temp
  End If
  If (NData_Points = 0) Then
    temp = chkSelect(6).Tag
    chkSelect(6).Value = False
    chkSelect(6).Enabled = False
    chkSelect(6).Tag = temp
  End If
End Sub
Private Sub Form_Unload(Cancel As Integer)
  Call UserPrefs_Save
End Sub


Private Sub UserPrefs_Load()
Dim X As Long
Dim i As Integer
Dim varname As String
  On Error GoTo err_FRMPRINT_UserPrefs_Load
  For i = 0 To 6
    varname = "FRMPRINT_chkSelect(" & Trim$(Str$(i)) & ")"
    X = CLng(INI_Getsetting(varname))
    chkSelect(i) = X
  Next i
  Exit Sub
resume_err_FRMPRINT_UserPrefs_Load:
  Call UserPrefs_Save
  Exit Sub
err_FRMPRINT_UserPrefs_Load:
  Resume resume_err_FRMPRINT_UserPrefs_Load
End Sub
Private Sub UserPrefs_Save()
Dim X As Long
Dim i As Integer
Dim varname As String
  For i = 0 To 6
    varname = "FRMPRINT_chkSelect(" & Trim$(Str$(i)) & ")"
    X = CLng(chkSelect(i).Value)
    Call INI_PutSetting(varname, Trim$(CStr(X)))
  Next i
End Sub


VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmSplash 
   Appearance      =   0  'Flat
   BackColor       =   &H00C0C0C0&
   BorderStyle     =   3  'Fixed Dialog
   ClientHeight    =   5745
   ClientLeft      =   2160
   ClientTop       =   2550
   ClientWidth     =   9180
   BeginProperty Font 
      Name            =   "MS Sans Serif"
      Size            =   8.25
      Charset         =   0
      Weight          =   700
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   ForeColor       =   &H80000008&
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   PaletteMode     =   1  'UseZOrder
   ScaleHeight     =   5745
   ScaleWidth      =   9180
   Begin Threed.SSPanel sspanel_disclaimer 
      Height          =   3795
      Left            =   9210
      TabIndex        =   19
      Top             =   4890
      Width           =   8325
      _Version        =   65536
      _ExtentX        =   14684
      _ExtentY        =   6694
      _StockProps     =   15
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin Threed.SSPanel SSPanel3 
         Height          =   3075
         Left            =   120
         TabIndex        =   21
         Top             =   570
         Width           =   8085
         _Version        =   65536
         _ExtentX        =   14261
         _ExtentY        =   5424
         _StockProps     =   15
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Begin VB.Label lblDisclaimer 
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            BackStyle       =   0  'Transparent
            Caption         =   "lblDisclaimer"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H80000008&
            Height          =   2895
            Left            =   90
            TabIndex        =   22
            Top             =   90
            Width           =   7845
         End
      End
      Begin VB.Label lblDisclaimerTitle 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Disclaimer"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   525
         Left            =   60
         TabIndex        =   20
         Top             =   60
         Width           =   8175
      End
   End
   Begin Threed.SSPanel sspanel_logos 
      Height          =   3795
      Left            =   420
      TabIndex        =   4
      Top             =   1170
      Width           =   8325
      _Version        =   65536
      _ExtentX        =   14684
      _ExtentY        =   6694
      _StockProps     =   15
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   18
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin Threed.SSPanel Panel3D3 
         Height          =   825
         Left            =   120
         TabIndex        =   9
         Top             =   900
         Width           =   8055
         _Version        =   65536
         _ExtentX        =   14208
         _ExtentY        =   1455
         _StockProps     =   15
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Begin VB.Label lbldesc 
            Alignment       =   1  'Right Justify
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            Caption         =   " "
            ForeColor       =   &H80000008&
            Height          =   225
            Index           =   1
            Left            =   120
            TabIndex        =   23
            Top             =   450
            Width           =   2055
         End
         Begin VB.Label lbldesc 
            Alignment       =   1  'Right Justify
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            Caption         =   "Model and Software:"
            ForeColor       =   &H80000008&
            Height          =   225
            Index           =   0
            Left            =   120
            TabIndex        =   12
            Top             =   180
            Width           =   2055
         End
         Begin VB.Label lblAuthors 
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            Caption         =   "David R. Hokanson     David W. Hand     John C. Crittenden"
            ForeColor       =   &H80000008&
            Height          =   225
            Index           =   0
            Left            =   2340
            TabIndex        =   11
            Top             =   180
            Width           =   5595
         End
         Begin VB.Label lblAuthors 
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            Caption         =   "Eric J. Oman"
            ForeColor       =   &H80000008&
            Height          =   225
            Index           =   1
            Left            =   2340
            TabIndex        =   10
            Top             =   450
            Width           =   5595
         End
      End
      Begin VB.PictureBox picLogos 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BorderStyle     =   0  'None
         ForeColor       =   &H80000008&
         Height          =   1755
         Index           =   0
         Left            =   120
         Picture         =   "splash.frx":0000
         ScaleHeight     =   1755
         ScaleWidth      =   1815
         TabIndex        =   6
         Top             =   1830
         Width           =   1815
      End
      Begin VB.PictureBox picLogos 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         BorderStyle     =   0  'None
         ForeColor       =   &H80000008&
         Height          =   1755
         Index           =   1
         Left            =   6360
         Picture         =   "splash.frx":3776
         ScaleHeight     =   1755
         ScaleWidth      =   1815
         TabIndex        =   5
         Top             =   1830
         Width           =   1815
      End
      Begin Threed.SSPanel SSPanel1 
         Height          =   1425
         Left            =   2190
         TabIndex        =   13
         Top             =   2010
         Width           =   3765
         _Version        =   65536
         _ExtentX        =   6641
         _ExtentY        =   2514
         _StockProps     =   15
         Caption         =   "SSPanel1"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Begin VB.Label lblVersionInfo 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            Caption         =   "Version {ver} {STANDARD}"
            ForeColor       =   &H80000008&
            Height          =   225
            Index           =   0
            Left            =   60
            TabIndex        =   18
            Top             =   120
            Width           =   3645
         End
         Begin VB.Label lblVersionInfo 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            Caption         =   "Expires on MM/DD/YYYY"
            ForeColor       =   &H80000008&
            Height          =   225
            Index           =   1
            Left            =   60
            TabIndex        =   17
            Top             =   360
            Width           =   3645
         End
         Begin VB.Label lblVersionInfo 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            Caption         =   "Copyright {years}"
            ForeColor       =   &H80000008&
            Height          =   225
            Index           =   2
            Left            =   60
            TabIndex        =   16
            Top             =   600
            Width           =   3645
         End
         Begin VB.Label lblVersionInfo 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            Caption         =   "Michigan Technological University"
            ForeColor       =   &H80000008&
            Height          =   225
            Index           =   3
            Left            =   60
            TabIndex        =   15
            Top             =   840
            Width           =   3645
         End
         Begin VB.Label lblVersionInfo 
            Alignment       =   2  'Center
            Appearance      =   0  'Flat
            BackColor       =   &H00C0C0C0&
            Caption         =   "Houghton, Michigan"
            ForeColor       =   &H80000008&
            Height          =   225
            Index           =   4
            Left            =   60
            TabIndex        =   14
            Top             =   1080
            Width           =   3645
         End
      End
      Begin VB.Label lblCompany 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "CenCITT"
         ForeColor       =   &H80000008&
         Height          =   225
         Index           =   0
         Left            =   60
         TabIndex        =   8
         Top             =   150
         Width           =   8175
      End
      Begin VB.Label lblCompany 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "Center for Clean Industrial and Treatment Technologies"
         ForeColor       =   &H80000008&
         Height          =   225
         Index           =   1
         Left            =   60
         TabIndex        =   7
         Top             =   420
         Width           =   8175
      End
   End
   Begin VB.CommandButton cmdExit 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      Caption         =   "E&xit"
      Height          =   525
      Left            =   7440
      TabIndex        =   2
      Top             =   5070
      Width           =   1305
   End
   Begin VB.CommandButton cmdButton2 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      Caption         =   "I agree, never show again"
      Height          =   525
      Left            =   1950
      TabIndex        =   1
      Top             =   5070
      Width           =   2535
   End
   Begin VB.CommandButton cmdButton1 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      Caption         =   "&Continue"
      Height          =   525
      Left            =   420
      TabIndex        =   0
      Top             =   5070
      Width           =   1455
   End
   Begin Threed.SSPanel sspanel_maintitle 
      Height          =   945
      Left            =   420
      TabIndex        =   3
      Top             =   120
      Width           =   8325
      _Version        =   65536
      _ExtentX        =   14684
      _ExtentY        =   1667
      _StockProps     =   15
      Caption         =   "Adsorption Design Software"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   18
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
End
Attribute VB_Name = "frmSplash"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit


Private Sub cmdButton1_Click()
  splash_button_pressed = 1
  Unload Me
End Sub

Private Sub cmdButton2_Click()
  splash_button_pressed = 2
  Unload Me
End Sub

Private Sub cmdExit_Click()
  splash_button_pressed = 3
  Unload Me
End Sub

Private Sub Form_Load()
Dim s As String
'Call debug_output("L1")
  Me.Height = 6165
  Me.Width = 9300
  Me.Left = (Screen.Width - Me.Width) / 2
  Me.Top = (Screen.Height - Me.Height) / 2
'Call debug_output("L2")
  If (splash_mode = 0) Then
    'SHOW THE CONTINUE/EXIT FRONT WINDOW.
'Call debug_output("L3")
    cmdButton1.Visible = True
    cmdButton1.Caption = "&Continue"
    cmdButton2.Visible = False
    cmdExit.Visible = True
    'VERSION INFO.
    lblVersionInfo(0).Caption = "Version " & get_program_version_with_build_info()
    'EXPIRATION INFO.
    lblVersionInfo(1).Caption = get_expiration_info()
    'COPYRIGHT INFO.
    lblVersionInfo(2).Caption = "Copyright " & AppCopyrightYears
    'ETC.
    sspanel_disclaimer.Visible = False
    'cmdButton1.SetFocus
    cmdButton1.TabIndex = 0
'Call debug_output("L4")
  End If
  ''''If (splash_mode = 1) Then
  If (splash_mode = 1) Or (splash_mode = 101) Then
'Call debug_output("L5")
    'SHOW THE DISCLAIMER WINDOW.
    If (splash_mode = 101) Then
      cmdButton1.Visible = False
      cmdButton2.Visible = False
      cmdExit.Visible = True
      cmdExit.Caption = "&Close"
    Else
      cmdButton1.Visible = True
      cmdButton1.Caption = "I Agree"
      cmdButton2.Visible = True
      cmdExit.Visible = True
    End If
    'cmdButton1.Visible = True
    'cmdButton1.Caption = "I Agree"
    'cmdButton2.Visible = True
    'cmdExit.Visible = True
    sspanel_logos.Visible = False
    sspanel_disclaimer.Left = sspanel_logos.Left
    sspanel_disclaimer.Top = sspanel_logos.Top
    sspanel_disclaimer.Visible = True
    s = "By choosing " & Chr$(34) & "I Agree" & Chr$(34) & " you acknowledge that "
    s = s & "this software is under development and not guaranteed to be free "
    s = s & "of errors.  Furthermore there may be errors in the software that "
    s = s & "lead to erroneous output.  MTU shall not be liable for any loss, "
    s = s & "damage, injury, or casualty of whatsoever kind, or by whomsoever "
    s = s & "caused to the person or property of anyone arising out of or "
    s = s & "resulting from receipt and use of any aspect of the software.  "
    s = s & "References to specific commercial products, processes, or services "
    s = s & "by trademark, manufacturer, or otherwise does not necessarily "
    s = s & "constitute or imply endorsement/recommendation by the authors or "
    s = s & "the respective organizations under which the software "
    s = s & "was developed."
    lblDisclaimer.Caption = s
    'cmdButton1.SetFocus
    cmdButton1.TabIndex = 0
'Call debug_output("L6")
  End If
End Sub

Private Sub Form_Unload(Cancel As Integer)
  If (splash_button_pressed = 0) Then
    'If they got here, they must have selected "Close",
    'so perform the exit functionality.
    splash_button_pressed = 3
  End If
End Sub

VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Object = "{F9043C88-F6F2-101A-A3C9-08002B2F49FB}#1.1#0"; "Comdlg32.ocx"
Object = "{042BADC8-5E58-11CE-B610-524153480001}#1.0#0"; "vcf132.ocx"
Begin VB.Form frmVarConcentrations 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Influent/Effluent Concentrations"
   ClientHeight    =   6450
   ClientLeft      =   3180
   ClientTop       =   2835
   ClientWidth     =   8040
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   6450
   ScaleWidth      =   8040
   Begin Threed.SSCommand cmdOK 
      Height          =   495
      Left            =   1410
      TabIndex        =   0
      Top             =   60
      Width           =   1335
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      Caption         =   "&OK"
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand cmdCancel 
      Height          =   495
      Left            =   90
      TabIndex        =   1
      Top             =   60
      Width           =   1335
      _Version        =   65536
      _ExtentX        =   2646
      _ExtentY        =   1323
      _StockProps     =   78
      Caption         =   "&Cancel"
      ForeColor       =   -2147483640
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin VCIF1Lib.F1Book Sheet1 
      Height          =   4275
      Left            =   60
      OleObjectBlob   =   "VarConcentrations.frx":0000
      TabIndex        =   22
      Top             =   1920
      Width           =   6345
   End
   Begin Threed.SSFrame SSFrame1 
      Height          =   1005
      Left            =   6720
      TabIndex        =   23
      Top             =   2100
      Visible         =   0   'False
      Width           =   2805
      _Version        =   65536
      _ExtentX        =   4948
      _ExtentY        =   1773
      _StockProps     =   14
      Caption         =   "Invisible"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Begin MSComDlg.CommonDialog CMDialog1 
         Left            =   330
         Top             =   270
         _ExtentX        =   847
         _ExtentY        =   847
         _Version        =   327681
      End
   End
   Begin VB.Label Label1 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H00C0C0C0&
      Caption         =   "A="
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   0
      Left            =   90
      TabIndex        =   21
      Top             =   615
      Visible         =   0   'False
      Width           =   555
   End
   Begin VB.Label Label2 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      Caption         =   "Label2"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   0
      Left            =   690
      TabIndex        =   20
      Top             =   600
      Visible         =   0   'False
      Width           =   3255
   End
   Begin VB.Label Label1 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H00C0C0C0&
      Caption         =   "B="
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   1
      Left            =   90
      TabIndex        =   19
      Top             =   855
      Visible         =   0   'False
      Width           =   555
   End
   Begin VB.Label Label1 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H00C0C0C0&
      Caption         =   "C="
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   2
      Left            =   90
      TabIndex        =   18
      Top             =   1095
      Visible         =   0   'False
      Width           =   555
   End
   Begin VB.Label Label1 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H00C0C0C0&
      Caption         =   "D="
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   3
      Left            =   90
      TabIndex        =   17
      Top             =   1335
      Visible         =   0   'False
      Width           =   555
   End
   Begin VB.Label Label1 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H00C0C0C0&
      Caption         =   "E="
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   4
      Left            =   90
      TabIndex        =   16
      Top             =   1575
      Visible         =   0   'False
      Width           =   555
   End
   Begin VB.Label Label1 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H00C0C0C0&
      Caption         =   "F="
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   5
      Left            =   4050
      TabIndex        =   15
      Top             =   615
      Visible         =   0   'False
      Width           =   555
   End
   Begin VB.Label Label1 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H00C0C0C0&
      Caption         =   "G="
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   6
      Left            =   4050
      TabIndex        =   14
      Top             =   855
      Visible         =   0   'False
      Width           =   555
   End
   Begin VB.Label Label1 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H00C0C0C0&
      Caption         =   "H="
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   7
      Left            =   4050
      TabIndex        =   13
      Top             =   1095
      Visible         =   0   'False
      Width           =   555
   End
   Begin VB.Label Label1 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H00C0C0C0&
      Caption         =   "I="
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   8
      Left            =   4050
      TabIndex        =   12
      Top             =   1335
      Visible         =   0   'False
      Width           =   555
   End
   Begin VB.Label Label1 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H00C0C0C0&
      Caption         =   "J="
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   9
      Left            =   4050
      TabIndex        =   11
      Top             =   1575
      Visible         =   0   'False
      Width           =   555
   End
   Begin VB.Label Label2 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      Caption         =   "Label2"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   1
      Left            =   690
      TabIndex        =   10
      Top             =   840
      Visible         =   0   'False
      Width           =   3255
   End
   Begin VB.Label Label2 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      Caption         =   "Label2"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   2
      Left            =   690
      TabIndex        =   9
      Top             =   1080
      Visible         =   0   'False
      Width           =   3255
   End
   Begin VB.Label Label2 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      Caption         =   "Label2"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   3
      Left            =   690
      TabIndex        =   8
      Top             =   1320
      Visible         =   0   'False
      Width           =   3255
   End
   Begin VB.Label Label2 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      Caption         =   "Label2"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   4
      Left            =   690
      TabIndex        =   7
      Top             =   1560
      Visible         =   0   'False
      Width           =   3255
   End
   Begin VB.Label Label2 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      Caption         =   "Label2"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   5
      Left            =   4650
      TabIndex        =   6
      Top             =   600
      Visible         =   0   'False
      Width           =   3255
   End
   Begin VB.Label Label2 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      Caption         =   "Label2"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   6
      Left            =   4650
      TabIndex        =   5
      Top             =   840
      Visible         =   0   'False
      Width           =   3255
   End
   Begin VB.Label Label2 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      Caption         =   "Label2"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   7
      Left            =   4650
      TabIndex        =   4
      Top             =   1080
      Visible         =   0   'False
      Width           =   3255
   End
   Begin VB.Label Label2 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      Caption         =   "Label2"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   8
      Left            =   4650
      TabIndex        =   3
      Top             =   1320
      Visible         =   0   'False
      Width           =   3255
   End
   Begin VB.Label Label2 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fixed Single
      Caption         =   "Label2"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   255
      Index           =   9
      Left            =   4650
      TabIndex        =   2
      Top             =   1560
      Visible         =   0   'False
      Width           =   3255
   End
   Begin VB.Menu mnuFile 
      Caption         =   "&File"
      Begin VB.Menu mnuFileItem 
         Caption         =   "&New"
         Index           =   0
      End
      Begin VB.Menu mnuFileItem 
         Caption         =   "&Open ..."
         Index           =   1
      End
      Begin VB.Menu mnuFileItem 
         Caption         =   "&Save"
         Index           =   2
      End
      Begin VB.Menu mnuFileItem 
         Caption         =   "Save &As ..."
         Index           =   3
      End
      Begin VB.Menu mnuFileItem 
         Caption         =   "-"
         Index           =   190
      End
      Begin VB.Menu mnuFileItem 
         Caption         =   "&1 Old File #1"
         Index           =   191
      End
      Begin VB.Menu mnuFileItem 
         Caption         =   "&2 Old File #2"
         Index           =   192
      End
      Begin VB.Menu mnuFileItem 
         Caption         =   "&3 Old File #3"
         Index           =   193
      End
      Begin VB.Menu mnuFileItem 
         Caption         =   "&4 Old File #4"
         Index           =   194
      End
   End
   Begin VB.Menu mnuEdit 
      Caption         =   "&Edit"
      Begin VB.Menu mnuEditItem 
         Caption         =   "Cu&t"
         Index           =   0
      End
      Begin VB.Menu mnuEditItem 
         Caption         =   "&Copy"
         Index           =   1
      End
      Begin VB.Menu mnuEditItem 
         Caption         =   "&Paste"
         Index           =   2
      End
   End
End
Attribute VB_Name = "frmVarConcentrations"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
Option Base 1

Dim Shifting As Integer, X1 As Integer, X2 As Integer, Y1 As Integer, Y2 As Integer
Dim TempStr As String, saveas  As Integer, Filename_Concentration As String
Dim Temp_Array() As String

Dim UserWantsCancel As Integer



Const frmVarConcentrations_declarations_end = True


Private Sub ClearGrid()
Dim i As Integer
Dim sserror As Integer
  Screen.MousePointer = 11
  For i = 1 To Sheet1.MaxCol
    Sheet1.ClearRange 1, i, 400, i, F1ClearAll
    'sserror = SSDeleteRange(Sheet1.ss, 1, i, 500, i, 3)
  Next i
  'sserror = SSDeleteTable(sheet1.SS)
  'sserror = SSDeleteRange(sheet1.SS, 1, 1, 500, 500, 1)
  Screen.MousePointer = 0
End Sub


Private Function CountConc(i As Integer, npoints As Integer) As Integer
On Error GoTo Error_In_CountConc
  npoints = 0
  Sheet1.Col = i
  Sheet1.Row = 1
  Do Until Sheet1.Text = "" Or Sheet1.Row = Number_Max_Influent_Points
    npoints = npoints + 1
    Sheet1.Row = Sheet1.Row + 1
  Loop
  If Sheet1.Text <> "" Then npoints = npoints + 1
  CountConc = True
  Exit Function
Error_In_CountConc:
  CountConc = False
  Call Show_Error("Invalid data.")
  Resume Exit_CountConc
Exit_CountConc:
End Function


Private Function Load_Concentrations(OverrideFilename As String) As Boolean
Dim f As Integer, npoints As Integer, i As Integer, J  As Integer
ReDim T(Number_Max_Influent_Points) As Double, C(Number_Compo_Max, Number_Max_Influent_Points) As Double
  Load_Concentrations = False
   On Error GoTo Error_In_Reading:
  If (OverrideFilename = "") Then
    CMDialog1.CancelError = True
    CMDialog1.DialogTitle = "Load Concentrations"
    CMDialog1.Filter = "All Files (*.*)|*.*|Text Files (*.txt)|*.txt|Excel 4.0 (*.xls)|*.xls"
    CMDialog1.FilterIndex = 2
    CMDialog1.flags = _
        cdlOFNFileMustExist + _
        cdlOFNPathMustExist
    CMDialog1.Action = 1
    If CMDialog1.Filename = "" Then
      Exit Function
    End If
    Filename_Concentration = CMDialog1.Filename
  Else
    Filename_Concentration = OverrideFilename
  End If
  ''''mnuFileItem(2).Enabled = True
  If Right(Filename_Concentration, 3) = "XLS" Then
    'OPEN EXCEL FORMAT.
    Sheet1.ReadFile = Filename_Concentration
  Else
    'OPEN TEXT FORMAT.
    f = FreeFile
    Open Filename_Concentration For Input As f
    Input #f, npoints
    For i = 1 To npoints
      Select Case Number_Component
        Case 1
          Input #f, T(i), C(1, i)
        Case 2
          Input #f, T(i), C(1, i), C(2, i)
        Case 3
          Input #f, T(i), C(1, i), C(2, i), C(3, i)
        Case 4
          Input #f, T(i), C(1, i), C(2, i), C(3, i), C(4, i)
        Case 5
          Input #f, T(i), C(1, i), C(2, i), C(3, i), C(4, i), C(5, i)
        Case 6
          Input #f, T(i), C(1, i), C(2, i), C(3, i), C(4, i), C(5, i), C(6, i)
        Case 7
          Input #f, T(i), C(1, i), C(2, i), C(3, i), C(4, i), C(5, i), C(6, i), C(7, i)
        Case 8
          Input #f, T(i), C(1, i), C(2, i), C(3, i), C(4, i), C(5, i), C(6, i), C(7, i), C(8, i)
        Case 9
          Input #f, T(i), C(1, i), C(2, i), C(3, i), C(4, i), C(5, i), C(6, i), C(7, i), C(8, i), C(9, i)
        Case 10
          Input #f, T(i), C(1, i), C(2, i), C(3, i), C(4, i), C(5, i), C(6, i), C(7, i), C(8, i), C(9, i), C(10, i)
      End Select
    Next i
    Close (f)
    'Sheet1.Row = 1
    'Sheet1.Col = 1
    For i = 1 To npoints
      Sheet1.EntryRC(i, 1) = T(i)
      'Sheet1.Text = T(i)
      'Sheet1.Row = Sheet1.Row + 1
    Next i
    'Sheet1.Col = 1
    For J = 1 To Number_Component
      'Sheet1.Col = Sheet1.Col + 1
      'Sheet1.Row = 1
      For i = 1 To npoints
        Sheet1.EntryRC(i, J + 1) = C(J, i)
        'Sheet1.Text = C(J, i)
        'Sheet1.Row = Sheet1.Row + 1
      Next i
    Next J
  End If
  Load_Concentrations = True
  Exit Function
Error_In_Reading:
  If (Err.number = cdlCancel) Then
    'DO NOTHING.
  Else
    Call Show_Trapped_Error("Load_Concentrations")
  End If
  Close #f
  Resume Exit_Load_Points
Exit_Load_Points:
End Function
Private Function SaveConcentrations() As Integer
Dim f As Integer, npoints As Integer, i As Integer, J As Integer
Dim Stemp As String, temp As String, Error_Code As Integer
Dim PreviousFilename_Concentration As String, temporaryname As String
  On Error GoTo Error_In_SaveConcentrations
  If Not (CountConc(1, npoints)) Then
    SaveConcentrations = False
    Call Show_Error("Invalid data.  No data has been saved.")
    Exit Function
  End If
  If (Trim$(Filename_Concentration) <> "") And Not (saveas) Then GoTo Save_File
  PreviousFilename_Concentration = Filename_Concentration
  CMDialog1.CancelError = True
  CMDialog1.DialogTitle = "Save Concentrations"
  CMDialog1.Filter = "All Files (*.*)|*.*|Text Files (*.txt)|*.txt|Excel 4.0 (*.xls)|*.xls"
  CMDialog1.FilterIndex = 2
  CMDialog1.flags = _
      cdlOFNOverwritePrompt + _
      cdlOFNPathMustExist
  CMDialog1.Action = 2
  temporaryname = CMDialog1.Filename
  Filename_Concentration = temporaryname
  'If IsValidPath(temporaryname, "C:") And CMDialog1.Filename <> "" Then
  '  temporaryname = Mid$(temporaryname, 1, Len(temporaryname) - 1)
  '  Filename_Concentration = temporaryname
  'Else
  '  Filename_Concentration = PreviousFilename_Concentration
  '  CMDialog1.Filename = ""
  '  MsgBox "No data has been saved.", 64, Application_Name
  '  Exit Function
  'End If
Save_File:
  If Right(Filename_Concentration, 4) = ".XLS" Then
    'EXCEL FORMAT.
    Sheet1.Write Filename_Concentration, F1FileExcel4
    'Sheet1.WriteFile = Filename_Concentration
  Else
    'TEXT FORMAT.
    mnuFileItem(2).Enabled = True
    f = FreeFile
    'Sheet1.Col = 1
    'Sheet1.Row = 1
    Open Filename_Concentration For Output As f
    Print #f, Format$(npoints, "0")
    For i = 1 To npoints
      Stemp = Format$(CDbl(Sheet1.EntryRC(i, 1)), "0.0000E+00")
      For J = 1 To Number_Component
        'Sheet1.Col = Sheet1.Col + 1
        Stemp = Stemp & "," & Format$(CDbl(Sheet1.EntryRC(i, J + 1)), "0.0000E+00")
      Next J
      Print #f, Stemp
      'Sheet1.Row = Sheet1.Row + 1
      'Sheet1.Col = 1
    Next i
    Close (f)
    SaveConcentrations = True
  End If
  Exit Function
Error_In_SaveConcentrations:
  SaveConcentrations = False
  If (Err.number = cdlCancel) Then
    'DO NOTHING.
  Else
    Call Show_Trapped_Error("SaveConcentrations")
  End If
  If Err = 13 Then
    Call Show_Error("The data entered are not valid data.")
  End If
  Close #f
  Resume Exit_Save_Points
Exit_Save_Points:
End Function


Private Sub cmdCancel_Click()
  frmConcentrations_cancelled = True
  Unload Me
End Sub
Private Sub cmdOK_Click()
Dim i As Integer, response As Integer
ReDim ndata(24) As Integer
Dim DFlag As Integer, f As Integer
Dim J As Integer, No_Var_Influent As Integer
  No_Var_Influent = False
  If Not (CountConc(1, frmConcentrations_NumPoints)) Then
    Sheet1.SetFocus
    Exit Sub
  End If
  Sheet1.Row = 1
  For i = 1 To frmConcentrations_NumConcs
    Sheet1.Col = i
    If Sheet1.Text = "" Then No_Var_Influent = True
  Next i
  If (No_Var_Influent) Then
    response = MsgBox( _
        "There is no data for the first row." & vbCrLf & _
        "It will be assumed that there is no concentration data.", _
        vbExclamation + vbOKCancel, Application_Name)
    Select Case response
      Case vbOK
        GoTo NoInfluent_Conc
      Case vbCancel
        Sheet1.SetFocus
        Exit Sub
    End Select
  End If
  For J = 1 To frmConcentrations_NumConcs + 1
    Sheet1.Col = J
    ndata(J) = 0
    Sheet1.Row = 1
    Do Until ((Sheet1.Text = "") Or (Sheet1.Row >= Number_Max_Influent_Points))
      Sheet1.Row = Sheet1.Row + 1
      ndata(J) = ndata(J) + 1
    Loop
  Next J
  DFlag = False
  For i = 1 To frmConcentrations_NumConcs + 1
    For J = i + 1 To frmConcentrations_NumConcs + 1
      If (ndata(i) <> ndata(J)) Then DFlag = True
    Next J
  Next i
  If (DFlag) Then
    response = MsgBox( _
        "There is not the same number of data in each column." & _
        vbCrLf & _
        "It will be assumed that there is no concentration data.", _
        vbExclamation + vbOKCancel, App.Title)
    Select Case response
      Case vbOK
      Case vbCancel
        Sheet1.SetFocus
        Exit Sub
    End Select
  End If
  'Store times
  On Error GoTo Time_Error
  Sheet1.Col = 1
  For i = 1 To frmConcentrations_NumPoints
    Sheet1.Row = i
    frmConcentrations_Times(i) = CDbl(Sheet1.Text) * 24# * 60#    'To convert from days to minutes
    If (i > 1) Then
      If (frmConcentrations_TimeOrderImportant) Then
        If (frmConcentrations_Times(i) <= frmConcentrations_Times(i - 1)) Then GoTo Time_Error2
      End If
    End If
  Next i
  'Store concentrations
  On Error GoTo Conc_Error
  For J = 2 To frmConcentrations_NumConcs + 1
    Sheet1.Col = J
    For i = 1 To frmConcentrations_NumPoints
      Sheet1.Row = i
      frmConcentrations_Concs(J - 1, i) = CDbl(Sheet1.Text)
    Next i
  Next J
  Unload Me
Exit_This_OK:
  frmConcentrations_cancelled = False
  Exit Sub
Time_Error:
  Call Show_Error( _
      "At least one value in time input (Row #" & Format$(i, "0") & _
      ") is not a real number." & vbCrLf & _
      "Change this cell (currently `" & _
      Sheet1.EntryRC(i, 1) & "`) to a number.")
  Resume Exit_This_OK:
Time_Error2:
  Call Show_Error( _
      "Time in row #" & Format$(i, "0") & _
      " is less than time in row #" & Format$(i - 1, "0") & "." & _
      vbCrLf & "Change your times to be in chronological order.")
  Sheet1.SetFocus
  Exit Sub
Conc_Error:
  Call Show_Error("At least one value of concentration (Row# " & _
      Format$(i, "0") & ", Col#" & Format$(J, "0") & _
      ") is not a real number." & vbCrLf & _
      "Change this cell (currently `" & Sheet1.EntryRC(i, J) & _
      "`) to a number.")
  Resume Exit_This_OK:
  Sheet1.SetFocus
NoInfluent_Conc:
  Number_Influent_Points = 0
  Unload Me
End Sub


Private Sub Form_Activate()
  Sheet1.SetFocus
End Sub
Private Sub Form_Load()
Dim i As Integer, J As Integer, TB As String, CB As String
Dim temp As String, LF  As String, C As Integer, SetWidth As Integer
  '-- Startup watch-for-cancel timer
  frmConcentrations_cancelled = True
  UserWantsCancel = False
  ''''Timer1.Enabled = True
  Me.Caption = frmConcentrations_caption
  '-- Initialize last-few-files list for this form
  'xaxaxaNC
  ''Call LastFewFiles_InitializeList(LASTFEW_WHICHAPP_ADSIM, LASTFEW_ADSIM_FRMCONCE_FRM)
  'Call LastFewFiles_InitializeList(LASTFEW_WHICHAPP_ADDESIGNS, LASTFEW_ADDESIGNS_FRMCONCE_FRM)
  '
  'POPULATE LAST-FEW-FILES LIST.
  Call OldFileList_Populate( _
      2, _
      Me.mnuFileItem(190), _
      Me.mnuFileItem(191), _
      Me.mnuFileItem(192), _
      Me.mnuFileItem(193), _
      Me.mnuFileItem(194))
  ''Me.HelpContextID = Hlp_Influent_Concentrations
  'mnuEditItem(0) = True
  'mnuEditItem(1) = True
  ''mnuEditItem(2) = False       '--- DON'T DO THIS!
  TB = Chr$(9)
  CB = Chr$(13)
  'set maxcols
  Sheet1.MaxCol = Number_Component + 1
  Sheet1.MaxRow = 400
  'set col headers
  Sheet1.ColText(1) = "Time (" & frmConcentrations_Tunits & ")"
  Sheet1.ColWidth(1) = 12 * 256
  'sserror = SSSetColText(Sheet1.ss, 1, "Time (" & frmConcentrations_Tunits & ")")
  'sserror = SSSetColWidth(Sheet1.ss, 1, 1, (12 * 256), False)
  For i = 1 To Number_Component
    Label1(i - 1).Visible = True
    Label2(i - 1).Visible = True
    Label2(i - 1).Caption = Trim$(Component(i).Name) & " (" & frmConcentrations_Cunits & ")"
    Sheet1.ColText(1 + i) = Chr$((Asc("A")) + i - 1)
    'sserror = SSSetColText(Sheet1.ss, 1 + i, Chr$((Asc("A")) + i - 1))
    ''sserror = SSSetColWidth(sheet1.SS, 1 + i, 1 + i, ((Len(LTrim(RTrim(temp))) + 3) * 256), False)
  Next i
  ' size for amount of chemicals
  If (Number_Component < 5) Then
    Sheet1.Top = 975 + (Number_Component * 255)
  Else
    Sheet1.Top = 975 + (5 * 255)
  End If
  'For I = 0 To Number_Component + 1
  ' grid1.FixedAlignment(I) = 2
  'Next I
  SetWidth = Screen.TwipsPerPixelX * 19
  If (frmConcentrations_NumPoints > 0) Then
    For i = 1 To frmConcentrations_NumPoints
      'CONVERT FROM minutes TO days.
      Sheet1.EntryRC(i, 1) = frmConcentrations_Times(i) / 60# / 24#
      'Sheet1.Row = i
      'Sheet1.Col = 1
      'Sheet1.number = frmConcentrations_Times(i) / 60# / 24#       'Convert form min. to days
      For J = 2 To Number_Component + 1
        Sheet1.EntryRC(i, J) = frmConcentrations_Concs(J - 1, i)
        'Sheet1.Col = J
        'Sheet1.number = frmConcentrations_Concs(J - 1, i)
      Next J
    Next i
  End If
  ''''Move frmPFPSDM.Left + (frmPFPSDM.Width / 2) - (frmConcentrations.Width / 2), frmPFPSDM.Top + (frmPFPSDM.Height / 2) - (frmConcentrations.Height / 2)
  Call CenterOnForm(Me, frmMain)
End Sub
Private Sub Form_Resize()
Dim XXX As Long
Dim USE_MARGIN As Long
  If (Me.WindowState = 1) Then
    'CANNOT RESIZE WHEN MINIMIZED; EXIT OUTTA HERE.
    Exit Sub
  End If
  USE_MARGIN = Sheet1.Left
  XXX = Me.ScaleWidth - 2 * USE_MARGIN
  If (XXX < 1000) Then XXX = 1000
  Sheet1.Width = XXX
  XXX = Me.ScaleHeight - Sheet1.Top + USE_MARGIN
  If (XXX < 1000) Then XXX = 1000
  Sheet1.Height = XXX
    'If WindowState <> 0 Then Exit Sub
    'If (Grid1.Left + Grid1.Width) > (cdmEdit(3).Left + cdmEdit(3).Width) Then
    '  Width = Grid1.Left + Grid1.Width + 20 * Screen.TwipsPerPixelX
    'Else
    '  Width = cdmEdit(3).Left + cdmEdit(3).Width + 20 * Screen.TwipsPerPixelX
    'End If
    'If Height > (Grid1.Top + 90 * Screen.TwipsPerPixelY + cmdCancel.Height) Then
    ' Grid1.Height = Height - Grid1.Top - 90 * Screen.TwipsPerPixelY - cmdCancel.Height
    ' cmdCancel.Top = Grid1.Top + Grid1.Height + 15 * Screen.TwipsPerPixelY
    ' cmdOK.Top = Grid1.Top + Grid1.Height + 15 * Screen.TwipsPerPixelY
    'End If
    'Top = Screen.Height / 2 - Height / 2
    'Left = Screen.Width / 2 - Width / 2
'Sheet1.SetFocus
End Sub


Private Sub mnuEditItem_Click(index As Integer)
  Select Case index
    Case 0:   'CUT.
      On Error Resume Next
      Sheet1.EditCut
    Case 1:   'COPY.
      On Error Resume Next
      Sheet1.EditCopy
    Case 2:   'PASTE.
      On Error Resume Next
      Sheet1.EditPaste
  End Select
'
'    Case 0  'cut
'      sserror = SSEditCut(Sheet1.ss)
'           mnuEditItem(2) = True
'           Sheet1.SetFocus
'           If sserror <> 0 Then
'              'oops
'           End If
'     Case 1  'copy
'           sserror = SSEditCopy(Sheet1.ss)
'           mnuEditItem(2) = True
'           If sserror <> 0 Then
'              'oops
'           End If
'
'     Case 2 'paste
'           If (CutString()) Then
'           Else
'             MsgBox "Impossible to paste data from the clipboard.", 64, Application_Name
'           End If
'           'sserror = SSEditpastevalues(sheet1.SS)
'           'sheet1.SetFocus
'           'If sserror <> 0 Then
'           '   'oops
'           'End If
End Sub


Private Sub mnuFileItem_Click(index As Integer)
Dim i As Integer, J As Integer, f As Integer
Dim response As Integer
Dim fn_new As String
  Select Case index
    Case 0  'new
       'save changes?
       response = MsgBox("Do you wish to save the changes?", _
          vbExclamation + vbYesNoCancel, Application_Name)
       If response = vbCancel Then Exit Sub
       If response = vbYes Then
         saveas = False
         f = SaveConcentrations()
       End If
       '-- clear grid
       Call ClearGrid

       '   screen.MousePointer = 11
       '   For i = 1 To sheet1.maxcol
       '         sheet1.Col = i
       '      For j = 1 To sheet1.MaxRow
       '          sheet1.Row = j
       '          sheet1.Text = ""
       '      Next
       '   Next
       '
       '   screen.MousePointer = 0
    Case 1  'open
        'save changes?
       response = MsgBox("Do you wish to save the changes?", _
          vbExclamation + vbYesNoCancel, Application_Name)
       If response = vbCancel Then Exit Sub
       If response = vbYes Then
         saveas = False
         f = SaveConcentrations()
       End If
      Call Load_Concentrations("")
      ''''cd_HomeDir
      'MOVE THIS FILENAME TO TOP OF LAST-FEW-FILES LIST.
      Call OldFileList_Promote( _
          Filename_Concentration, _
          2, _
          Me.mnuFileItem(190), _
          Me.mnuFileItem(191), _
          Me.mnuFileItem(192), _
          Me.mnuFileItem(193), _
          Me.mnuFileItem(194))
      ''''Call LastFewFiles_MoveFilenameToTop(Filename_Concentration)
    Case 2  'save
      saveas = False
      f = SaveConcentrations()
    Case 3 'saveas
      saveas = True
      f = SaveConcentrations()
      'MOVE THIS FILENAME TO TOP OF LAST-FEW-FILES LIST.
      Call OldFileList_Promote( _
          Filename_Concentration, _
          2, _
          Me.mnuFileItem(190), _
          Me.mnuFileItem(191), _
          Me.mnuFileItem(192), _
          Me.mnuFileItem(193), _
          Me.mnuFileItem(194))
      ''''Call LastFewFiles_MoveFilenameToTop(Filename_Concentration)
  End Select

  '---- Handle last-few-files stuff
  If ((index >= 191) And (index <= 194)) Then
    '---- save first?
    response = MsgBox("Do you wish to save the changes?", _
       vbExclamation + vbYesNoCancel, Application_Name)
    If response = vbCancel Then Exit Sub
    If response = vbYes Then
      saveas = False
      f = SaveConcentrations()
    End If
    '---- clear grid
    Call ClearGrid
    '---- start open
    fn_new = mnuFileItem(index).Caption
    fn_new = Right$(fn_new, Len(fn_new) - 5)
    If (Load_Concentrations(fn_new) = False) Then
      'DO NOTHING -- FILE NOT LOADED.
    Else
      mnuFileItem(2).Enabled = True
      'MOVE THIS FILENAME TO TOP OF LAST-FEW-FILES LIST.
      Call OldFileList_Promote( _
          Filename_Concentration, _
          2, _
          Me.mnuFileItem(190), _
          Me.mnuFileItem(191), _
          Me.mnuFileItem(192), _
          Me.mnuFileItem(193), _
          Me.mnuFileItem(194))
      ''''Call LastFewFiles_MoveFilenameToTop(Filename_Concentration)
    End If
  End If
End Sub


'Private Function PasteString(StringToTransfer As String, Row As Integer, Col As Integer) As Integer
'On Error GoTo Error_In_PasteString
'  Sheet1.Row = Row
'  Sheet1.Col = Col
'  Sheet1.Text = StringToTransfer
'  PasteString = True
'  Exit Function
'Error_In_PasteString:
'  PasteString = False
'  Resume Exit_PasteString
'Exit_PasteString:
'End Function
'Private Function CutString() As Integer
'Dim ClipString As String, Length As Integer
'Dim CurrentPosition As Integer, PreviousPosition As Integer, Character As String * 1
'Dim StringToTransfer As String, Row As Integer, Col As Integer
'On Error GoTo Error_In_CutString
'  ClipString = Clipboard.GetText()
'  Length = Len(ClipString)
'  If Length > 0 Then
'    PreviousPosition = 1
'    CurrentPosition = 1
'    Col = 1
'    Row = 1
'    While PreviousPosition <= Length
'      Character = Mid$(ClipString, CurrentPosition, 1)
'      Select Case Asc(Character)
'        Case 10
'          CurrentPosition = CurrentPosition + 1
'          PreviousPosition = CurrentPosition
'        Case 13, 9
'          StringToTransfer = Mid$(ClipString, PreviousPosition, CurrentPosition - PreviousPosition)
'          If Not (PasteString(StringToTransfer, Row, Col)) Then
'            MsgBox "Error while pasting data.", 64, Application_Name
'          End If
'          Col = Col Mod (Number_Component + 1) + 1
'          If Col = 1 Then
'           Row = Row + 1
'           If Row > Number_Max_Influent_Points Then GoTo Too_Many_Points
'          End If
'          CurrentPosition = CurrentPosition + 1
'          PreviousPosition = CurrentPosition
'        Case Else
'          CurrentPosition = CurrentPosition + 1
'          Character = Mid$(ClipString, CurrentPosition, 1)
'      End Select
'    Wend
'  Else
'  End If
'  CutString = True
'  Exit Function
'Too_Many_Points:
'  CutString = True
'  MsgBox "Too much data was selected. Only the first " & Format$(Number_Max_Influent_Points, "0") & " points were pasted.", 64, Application_Name
'  GoTo Exit_CutString
'Error_In_CutString:
'  CutString = False
'  Resume Exit_CutString
'Exit_CutString:
'End Function


VERSION 5.00
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "THREED32.OCX"
Begin VB.Form frmNewName 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "{use_title}"
   ClientHeight    =   1575
   ClientLeft      =   1755
   ClientTop       =   7380
   ClientWidth     =   5685
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   PaletteMode     =   1  'UseZOrder
   ScaleHeight     =   1575
   ScaleWidth      =   5685
   ShowInTaskbar   =   0   'False
   Begin VB.TextBox txtdata 
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   360
      Left            =   90
      TabIndex        =   0
      Text            =   "txtdata"
      Top             =   750
      Width           =   5505
   End
   Begin Threed.SSCommand Button 
      Height          =   315
      Index           =   0
      Left            =   90
      TabIndex        =   2
      TabStop         =   0   'False
      Top             =   1200
      Width           =   1305
      _Version        =   65536
      _ExtentX        =   2302
      _ExtentY        =   556
      _StockProps     =   78
      Caption         =   "&OK"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin Threed.SSCommand Button 
      Height          =   315
      Index           =   1
      Left            =   4290
      TabIndex        =   3
      TabStop         =   0   'False
      Top             =   1200
      Width           =   1305
      _Version        =   65536
      _ExtentX        =   2302
      _ExtentY        =   556
      _StockProps     =   78
      Caption         =   "&Cancel"
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin VB.Label lblInstructions 
      Caption         =   "lblInstructions"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   615
      Left            =   90
      TabIndex        =   1
      Top             =   60
      Width           =   5505
   End
End
Attribute VB_Name = "frmNewName"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Dim return_text As String
Dim USER_HIT_CANCEL As Boolean




Const frmNewName_declarations_end = True


Public Function frmNewName_GetName( _
    Use_Title As String, _
    use_label As String, _
    use_default As String, _
    is_aborted As Boolean) As String
  Load frmNewName
  Me.Caption = Use_Title
  lblInstructions.Caption = use_label
  txtData.Text = use_default
  frmNewName.Show 1
  is_aborted = USER_HIT_CANCEL
  frmNewName_GetName = return_text
End Function


Private Sub Button_Click(Index As Integer)
  Select Case Index
    Case 0:     'OK
      return_text = Trim$(txtData.Text)
      If (return_text = "") Then
        Call Show_Error("You must enter a non-blank string as a name.")
        Exit Sub
      End If
      USER_HIT_CANCEL = False
      Unload Me
    Case 1:     'Cancel
      USER_HIT_CANCEL = True
      Unload Me
  End Select
End Sub


Private Sub Form_Load()
  Me.Height = 1965
  Me.Width = 5805
  Call CenterOnForm(Me, frmMain)
End Sub


Private Sub txtData_GotFocus()
Dim txtCtl As Control
Set txtCtl = txtData
  'Call DisplayDataEntryError
  Call Global_GotFocus(txtCtl)
End Sub
Private Sub txtData_KeyPress(KeyAscii As Integer)
  If (KeyAscii = 13) Then
    Call Button_Click(0)
  End If
  'keyascii = Global_TextKeyPress(keyascii)
'  If (KeyAscii = 13) Then SendKeys "{TAB}", True
End Sub
Private Sub txtData_LostFocus()
Dim txtCtl As Control
Set txtCtl = txtData
  Call Global_LostFocus(txtCtl)
End Sub

